Warning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
/global/cfs/cdirs/ulens/vismcao/maos -o studies/reduced_ngs/9_lgs/8mag_lgs/1750count -c master_files/reduced_ngs/9_lgs/8mag_lgs/kola_1750act.conf -O 
Output folder is 'studies/reduced_ngs/9_lgs/8mag_lgs/1750count'.
SRC: /global/homes/b/bpeck/code/maos v2.9 4c88b7c2 2024-11-13 16:45:33 -0800
BUILT: /global/homes/b/bpeck/code/maos/optim by GCC (v12) on 2024/11/18 09:40:03 CPU(F64,+O3) with CUDA(v122,F32)
Launched at 2025/02/17 14:50:03 in nid001972 with PID 1690147.
The web based job monitor can be accessed at http://localhost:10300
Main config file is /global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_1750act.conf
Warning(path.c:48): Path not found: path=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; abspath=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; Ignored.
Warning(path.c:48): Path not found: path=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; abspath=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; Ignored.
Warning(readcfg.c:399): sim.apfsm has been renamed to powfs.apfsm.
Warning(readcfg.c:399): sim.epfsm has been renamed to powfs.epfsm.
Warning(readcfg.c:399): sim.alfsm has been renamed to powfs.alfsm.
Warning(readcfg.c:399): sim.commonfsm has been renamed to powfs.commonfsm.
Warning(readcfg.c:399): sim.idealfsm has been renamed to powfs.idealfsm.
Warning(readcfg.c:399): sim.zetafsm has been renamed to powfs.zetafsm.
Warning(readcfg.c:399): sim.f0fsm has been renamed to powfs.f0fsm.
Warning(readcfg.c:399): tsurf has been renamed to ncpa.tsurf.
loaded 132 (132 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_sim.conf'
loaded  19 ( 19 new) records from '/global/cfs/cdirs/ulens/vismcao/./dm_none.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_ASM.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_DM2.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_DM3.conf'
loaded   0 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_dm_multiple.conf'
loaded   7 (  5 new) records from '/global/cfs/cdirs/ulens/vismcao/./atm_mk13n50p_ground_detail.conf'
loaded  76 ( 69 new) records from '/global/homes/b/bpeck/code/maos/config/maos/powfs_common.conf'
loaded  44 ( 38 new) records from '/global/cfs/cdirs/ulens/vismcao/./powfs_none.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_lgs.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_ttf_strap.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_twfs_lbwfs.conf'
loaded   0 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_wfs_lgs_strap_lbwfs.conf'
loaded  71 ( 71 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_recon.conf'
Warning(readcfg.c:399): dbg.na_smooth has been renamed to powfs0_llt.na_smooth.
Warning(readcfg.c:399): dbg.na_interp has been renamed to powfs0_llt.na_interp.
Warning(readcfg.c:399): dbg.na_thres has been renamed to powfs0_llt.na_thres.
Warning(readcfg.c:399): dbg.na_fit_maxit has been renamed to powfs0_llt.na_fit_maxit.
Warning(readcfg.c:399): dbg.na_fit_svdthres has been renamed to powfs0_llt.na_fit_svdthres.
Warning(readcfg.c:399): dbg.na_fit_dh has been renamed to powfs0_llt.na_fit_dh.
Warning(readcfg.c:399): dbg.ncpa_preload has been renamed to ncpa.preload.
Warning(readcfg.c:399): dbg.ncpa_rmsci has been renamed to ncpa.rmsci.
Warning(readcfg.c:399): dbg.draw_opdmax has been renamed to plot.opdmax.
Warning(readcfg.c:399): dbg.draw_gmax has been renamed to plot.gmax.
loaded  95 ( 93 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_dbg.conf'
loaded   4 (  4 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_fit_mcao.conf'
Warning(readcfg.c:399): surf has been renamed to ncpa.surf.
loaded  39 (  7 new) records from '/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_1750act.conf'
loaded   0 (  0 new) records from 'command line'
loaded  24 ( 18 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_llt_CL.conf'
Adjust LGS range by telescope altitude 4145m.
Zenith angle is 30 degree.
    Scaling turbulence height and LGS hs by sec(za).
    Scaling r0 by cos(za)^(3/5).
    Scaling wind speed and LGS signal level by cos(za).
powfs0: Adjusting dx from 0.0078125 to 0.00776667. 
powfs0.llt.fsm: f0=0 Hz, LPF ep=0
powfs0.epfsm is set to 0.517618 (auto)
powfs2: Adjusting dx from 0.03125 to 0.0312778. 
powfs2 is TWFS for powfs0
sim.ephi is set to 0.427717 (auto)
sim.eplo is set to 0.427717 (auto)
Warning(parms.c:2296): Layer 1 at 17.3205m is very close to layer 0 at 0m (OK).
Warning(parms.c:2296): Layer 2 at 34.641m is very close to layer 1 at 17.3205m (OK).
Warning(parms.c:2296): Layer 3 at 51.9615m is very close to layer 2 at 34.641m (OK).
dm 0: stroke=30 um is provided in micron.
dm 0: assume ia stroke=2 um is provided in micron.
dm 1: stroke=7 um is provided in micron.
dm 1: assume ia stroke=2 um is provided in micron.
dm 2: stroke=7 um is provided in micron.
dm 2: assume ia stroke=2 um is provided in micron.
Focus blending is not implemented yet for integrated tomography
parms->sim.mffocus is reset to 0
There are 1 valid simulation seeds:  1
Output PSF for 1 directions
Used 449 of 456 supplied keys
Warning(readcfg.c:158): key "dbg.pwfs_flate" is not recognized, value is 0
Warning(readcfg.c:158): key "dbg.pwfs_flatv" is not recognized, value is 0
Warning(readcfg.c:158): key "dbg.pwfs_psx" is not recognized, value is [0 0 0 0]
Warning(readcfg.c:158): key "dbg.pwfs_psy" is not recognized, value is [0 0 0 0]
Warning(readcfg.c:158): key "dbg.pwfs_pupelong" is not recognized, value is 0
Warning(readcfg.c:158): key "dbg.pwfs_raw" is not recognized, value is 0
Warning(readcfg.c:158): key "dbg.pwfs_side" is not recognized, value is 4
[00;00mAperture[00;00m is 11 m with sampling 1/128 m
[00;00mTurbulence at 30 degree zenith angle:[00;00m r0=0.128424m, L0=30m, 14 layers.
    Greenwood freq is 25.1Hz, anisoplanatic angle is 1.58 as
    Sampled 8192x8192 at 1/128m. wind dir is randomized.
    layer 0: ht=      0 m, wt= 0.302, ws=  4.8 m/s
    layer 1: ht=     17 m, wt= 0.154, ws=  5.0 m/s
    layer 2: ht=     35 m, wt= 0.041, ws=  5.4 m/s
    layer 3: ht=     52 m, wt= 0.002, ws=  6.6 m/s
    layer 4: ht=    139 m, wt= 0.021, ws=  6.1 m/s
    layer 5: ht=    231 m, wt= 0.010, ws=  6.1 m/s
    layer 6: ht=    323 m, wt= 0.008, ws=  6.1 m/s
    layer 7: ht=    416 m, wt= 0.005, ws=  6.1 m/s
    layer 8: ht=    508 m, wt= 0.001, ws=  6.1 m/s
    layer 9: ht=    932 m, wt= 0.107, ws=  5.6 m/s
    layer 10: ht=   5022 m, wt= 0.144, ws= 11.1 m/s
    layer 11: ht=   9238 m, wt= 0.093, ws= 19.1 m/s
    layer 12: ht=  13856 m, wt= 0.075, ws=  8.2 m/s
    layer 13: ht=  22518 m, wt= 0.036, ws=  4.8 m/s
[00;00mReconstruction[00;00m: r0=0.128424m L0=30m. 14 layers. use cone coordinate.
    layer 0: ht=      0 m, wt= 0.302
    layer 1: ht=     17 m, wt= 0.154
    layer 2: ht=     35 m, wt= 0.041
    layer 3: ht=     52 m, wt= 0.002
    layer 4: ht=    139 m, wt= 0.021
    layer 5: ht=    231 m, wt= 0.010
    layer 6: ht=    323 m, wt= 0.008
    layer 7: ht=    416 m, wt= 0.005
    layer 8: ht=    508 m, wt= 0.001
    layer 9: ht=    932 m, wt= 0.107
    layer 10: ht=   5022 m, wt= 0.144
    layer 11: ht=   9238 m, wt= 0.093
    layer 12: ht=  13856 m, wt= 0.075
    layer 13: ht=  22518 m, wt= 0.036
[00;00mThere are 3 powfs[00;00m
  powfs0: Order 48, LGS at 99.1 km. Sampling 1/128.755 m. Thres 30%. [00;00mT/T is removed in right hand side in tomography.[00;00m
    CCD image is 25x25 @ 500x500 mas, blur 27% (sigma), 1500Hz, wvl: [ 5.89e-07]
    Gtilt in reconstruction. Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
  powfs1: Order  2, NGS at inf km. Sampling 1/16 m. Thres 30%. 
    Ztilt in reconstruction. Geomtric optics start at 2 with ztilt [00;00m(noisy)[00;00m
  powfs2: Order 20, NGS at inf km. Sampling 1/31.9716 m. Thres 50%. 
    CCD image is 4x4 @ 1500x1500 mas, blur 0% (sigma), 0.015Hz, wvl: [ 7.2e-07]
    Gtilt in reconstruction. Geomtric optics start at 50 with gtilt Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
[00;00mThere are 13 wfs[00;00m
    wfs 0: type 0, at (  30.00,    0.00) arcsec,  99 km, siglev is 65.0948 bkgrnd is 0.1
    wfs 1: type 0, at (  22.98,   19.28) arcsec,  99 km, siglev is 65.0948 bkgrnd is 0.1
    wfs 2: type 0, at (   5.21,   29.54) arcsec,  99 km, siglev is 65.0948 bkgrnd is 0.1
    wfs 3: type 0, at ( -15.00,   25.98) arcsec,  99 km, siglev is 65.0948 bkgrnd is 0.1
    wfs 4: type 0, at ( -28.19,   10.26) arcsec,  99 km, siglev is 65.0948 bkgrnd is 0.1
    wfs 5: type 0, at ( -28.19,  -10.26) arcsec,  99 km, siglev is 65.0948 bkgrnd is 0.1
    wfs 6: type 0, at ( -15.00,  -25.98) arcsec,  99 km, siglev is 65.0948 bkgrnd is 0.1
    wfs 7: type 0, at (   5.21,  -29.54) arcsec,  99 km, siglev is 65.0948 bkgrnd is 0.1
    wfs 8: type 0, at (  22.98,  -19.28) arcsec,  99 km, siglev is 65.0948 bkgrnd is 0.1
    wfs 9: type 1, at (   5.00,    8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 10: type 1, at ( -10.00,    0.00) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 11: type 1, at (   5.00,   -8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 12: type 2, at (   0.00,    0.00) arcsec, inf km, siglev is 4.1558e+06 bkgrnd is 0.001
[00;00mThere are 3 DMs[00;00m
  DM 0 at -0.1km, actuator pitch 0.233m, offset   0, with 30.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 1 at    6km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 2 at   10km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
[00;00mTomography[00;00m is using CG, with [00;00mFourer Domain[00;00m preconditioner, [00;00m12[00;00m iterations, integrated tomo.
[00;00mDM Fitting [00;00mis using CG, with [00;00mNo[00;00m preconditioner, [00;00m10[00;00m iterations
[00;00mThere are 9 fit directions[00;00m
    Fit 0: weight is 0.444, at (   0.00,    0.00) arcsec
    Fit 1: weight is 0.111, at (  15.00,    0.00) arcsec
    Fit 2: weight is 0.111, at (   0.00,   15.00) arcsec
    Fit 3: weight is 0.111, at ( -15.00,    0.00) arcsec
    Fit 4: weight is 0.111, at (   0.00,  -15.00) arcsec
    Fit 5: weight is 0.028, at (  15.00,   15.00) arcsec
    Fit 6: weight is 0.028, at ( -15.00,   15.00) arcsec
    Fit 7: weight is 0.028, at ( -15.00,  -15.00) arcsec
    Fit 8: weight is 0.028, at (  15.00,  -15.00) arcsec
[00;00mThere are 1 evaluation directions[00;00m at sampling 1/128 m.
    Evl 0: weight is 1.000, at (   0.00,    0.00) arcsec
[00;00mSimulation[00;00m start at step 0, end at step 1600, with time step 1/1500s, [00;00mclose loop[00;00m.
After setup_parms:	120.5 MiB.
Warning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
CUDA: minimum memory requirement is 0.4GB
GPU 0 is NVIDIA A100-SXM4-40GB with arch 8.0, 38.9GB free, 39.3GB total device memory.
Using GPU 0
Use 1 GPUs for WFS Tomo Fit Evl

*** Preparation started at 2025/02/17 14:50:04 in nid001972. ***

Using OpenMP version 201511 with 128 threads
Reading aperture amplitude map from KECK.fits
Warning(accphi.c:477): 108300 points not covered by input screen
Warning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
 ->maos.c:447->setup.c:148->aper.c:74->utils.c:478->accphi.c:478
iwvl 0: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 1: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 2: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 3: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 4: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 5: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 6: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 7: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 8: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
After setup_aper:	344.5 MiB.

[00;00mSetting up powfs 0 geom[00;00m

There are 30 points in each subaperture of 0.233m.
There are 1383 valid subaperture.

[00;00mSetting up powfs 1 geom[00;00m

There are 88 points in each subaperture of 5.5m.
There are 4 valid subaperture.

[00;00mSetting up powfs 2 geom[00;00m

There are 18 points in each subaperture of 0.563m.
There are 236 valid subaperture.
After setup_powfs_init:	429.3 MiB.

[00;00mSetting up reconstructor geometry.[00;00m

PLOC is 99x99, with sampling of 0.12m (square)
    DM 0: grid is 51 x 51
    DM 1: grid is 75 x 75
    DM 2: grid is 80 x 79
FLOC is 99x99, with sampling of 0.12m (not square)
Tomography grid is square:
    layer 0: xloc grid is 180 x 180, sampling is 0.117 m, 32400 points
    layer 1: xloc grid is 180 x 180, sampling is 0.116 m, 32400 points
    layer 2: xloc grid is 180 x 180, sampling is 0.116 m, 32400 points
    layer 3: xloc grid is 180 x 180, sampling is 0.116 m, 32400 points
    layer 4: xloc grid is 180 x 180, sampling is 0.116 m, 32400 points
    layer 5: xloc grid is 180 x 180, sampling is 0.116 m, 32400 points
    layer 6: xloc grid is 180 x 180, sampling is 0.116 m, 32400 points
    layer 7: xloc grid is 180 x 180, sampling is 0.116 m, 32400 points
    layer 8: xloc grid is 180 x 180, sampling is 0.116 m, 32400 points
    layer 9: xloc grid is 180 x 180, sampling is 0.115 m, 32400 points
    layer 10: xloc grid is 180 x 180, sampling is 0.111 m, 32400 points
    layer 11: xloc grid is 180 x 180, sampling is 0.106 m, 32400 points
    layer 12: xloc grid is 180 x 180, sampling is 0.100 m, 32400 points
    layer 13: xloc grid is 180 x 180, sampling is 0.090 m, 32400 points

[00;00mSetting up powfs 0 PO WFS[00;00m

OTF dimension is 60x60 (calculated)
Uplink FWHM (illt 0, iwvl 0) is 0.577825"
Downlink FWHM (illt 0, iwvl 0) is 1.13399"
Generating matched filter for powfs 0
sa index   location       noise equivalent angle
     688: (  4.9,  -0.2) m, (5000.00, 5000.00) mas
     683: (  3.7,  -0.2) m, (5000.00, 5000.00) mas
     678: (  2.6,  -0.2) m, (5000.00, 5000.00) mas
     674: (  1.6,  -0.2) m, (5000.00, 5000.00) mas
     673: (  1.4,  -0.2) m, (5000.00, 5000.00) mas
     493: (  0.5,  -1.4) m, (5000.00, 5000.00) mas
     669: ( -1.9,  -0.2) m, (5000.00, 5000.00) mas
     665: ( -2.8,  -0.2) m, (5000.00, 5000.00) mas
     660: ( -4.0,  -0.2) m, (5000.00, 5000.00) mas
     655: ( -5.1,  -0.2) m, (5000.00, 5000.00) mas
     654: ( -5.4,  -0.2) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    1094: (  2.8,   2.3) m, (5000.00, 5000.00) mas
    1059: (  2.6,   2.1) m, (5000.00, 5000.00) mas
     858: (  1.2,   0.9) m, (5000.00, 5000.00) mas
     820: (  0.9,   0.7) m, (5000.00, 5000.00) mas
     493: (  0.5,  -1.4) m, (5000.00, 5000.00) mas
     525: ( -1.4,  -1.2) m, (5000.00, 5000.00) mas
     484: ( -1.6,  -1.4) m, (5000.00, 5000.00) mas
     324: ( -2.8,  -2.3) m, (5000.00, 5000.00) mas
     254: ( -3.3,  -2.8) m, (5000.00, 5000.00) mas
      41: ( -3.0,  -4.4) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    1377: (  0.7,   4.7) m, (5000.00, 5000.00) mas
    1359: (  0.7,   4.4) m, (5000.00, 5000.00) mas
    1218: (  0.5,   3.3) m, (5000.00, 5000.00) mas
    1013: (  0.2,   1.9) m, (5000.00, 5000.00) mas
     894: (  0.2,   1.2) m, (5000.00, 5000.00) mas
     597: (  1.2,  -0.7) m, (5000.00, 5000.00) mas
     409: ( -0.5,  -1.9) m, (5000.00, 5000.00) mas
     370: ( -0.5,  -2.1) m, (5000.00, 5000.00) mas
     165: ( -0.7,  -3.5) m, (5000.00, 5000.00) mas
       5: ( -0.9,  -4.9) m, (5000.00, 5000.00) mas
       2: ( -2.3,  -4.9) m, (100.45, 173.75) mas
sa index   location       noise equivalent angle
    1318: ( -2.6,   4.2) m, (5000.00, 5000.00) mas
    1263: ( -2.3,   3.7) m, (5000.00, 5000.00) mas
    1109: ( -1.6,   2.6) m, (5000.00, 5000.00) mas
    1042: ( -1.4,   2.1) m, (5000.00, 5000.00) mas
     889: ( -0.9,   1.2) m, (5000.00, 5000.00) mas
     748: (  1.2,   0.2) m, (5000.00, 5000.00) mas
     454: (  0.7,  -1.6) m, (5000.00, 5000.00) mas
     341: (  1.2,  -2.3) m, (5000.00, 5000.00) mas
     274: (  1.4,  -2.8) m, (5000.00, 5000.00) mas
     119: (  2.1,  -4.0) m, (5000.00, 5000.00) mas
      38: (  2.6,  -4.7) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
     953: ( -4.7,   1.6) m, (5000.00, 5000.00) mas
     877: ( -3.7,   1.2) m, (5000.00, 5000.00) mas
     844: ( -3.0,   0.9) m, (5000.00, 5000.00) mas
     814: ( -2.3,   0.7) m, (5000.00, 5000.00) mas
     784: ( -1.4,   0.5) m, (5000.00, 5000.00) mas
     856: (  0.7,   0.9) m, (5000.00, 5000.00) mas
     598: (  1.4,  -0.7) m, (5000.00, 5000.00) mas
     567: (  2.1,  -0.9) m, (5000.00, 5000.00) mas
     537: (  2.8,  -1.2) m, (5000.00, 5000.00) mas
     468: (  4.0,  -1.6) m, (5000.00, 5000.00) mas
     651: (  5.1,  -0.5) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
     391: ( -4.7,  -1.9) m, (5000.00, 5000.00) mas
     475: ( -3.7,  -1.4) m, (5000.00, 5000.00) mas
     518: ( -3.0,  -1.2) m, (5000.00, 5000.00) mas
     556: ( -2.3,  -0.9) m, (5000.00, 5000.00) mas
     596: ( -1.4,  -0.7) m, (5000.00, 5000.00) mas
     891: ( -0.5,   1.2) m, (5000.00, 5000.00) mas
     786: (  1.4,   0.5) m, (5000.00, 5000.00) mas
     825: (  2.1,   0.7) m, (5000.00, 5000.00) mas
     865: (  2.8,   0.9) m, (5000.00, 5000.00) mas
     950: (  4.0,   1.4) m, (5000.00, 5000.00) mas
     765: (  5.1,   0.2) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
      43: ( -2.6,  -4.4) m, (5000.00, 5000.00) mas
     100: ( -2.3,  -4.0) m, (5000.00, 5000.00) mas
     261: ( -1.6,  -2.8) m, (5000.00, 5000.00) mas
     330: ( -1.4,  -2.3) m, (5000.00, 5000.00) mas
     487: ( -0.9,  -1.4) m, (5000.00, 5000.00) mas
     634: (  1.2,  -0.5) m, (5000.00, 5000.00) mas
     936: (  0.7,   1.4) m, (5000.00, 5000.00) mas
    1053: (  1.2,   2.1) m, (5000.00, 5000.00) mas
    1122: (  1.4,   2.6) m, (5000.00, 5000.00) mas
    1282: (  2.1,   3.7) m, (5000.00, 5000.00) mas
    1367: (  2.6,   4.4) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
       8: (  0.7,  -4.9) m, (5000.00, 5000.00) mas
      30: (  0.7,  -4.7) m, (5000.00, 5000.00) mas
     170: (  0.5,  -3.5) m, (5000.00, 5000.00) mas
     373: (  0.2,  -2.1) m, (5000.00, 5000.00) mas
     451: (  0.0,  -1.6) m, (5000.00, 5000.00) mas
     785: (  1.2,   0.5) m, (5000.00, 5000.00) mas
     971: ( -0.5,   1.6) m, (5000.00, 5000.00) mas
    1010: ( -0.5,   1.9) m, (5000.00, 5000.00) mas
    1213: ( -0.7,   3.3) m, (5000.00, 5000.00) mas
    1374: ( -0.9,   4.7) m, (5000.00, 5000.00) mas
    1370: ( -2.6,   4.7) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
     314: (  2.8,  -2.6) m, (5000.00, 5000.00) mas
     347: (  2.6,  -2.3) m, (5000.00, 5000.00) mas
     530: (  1.2,  -1.2) m, (5000.00, 5000.00) mas
     529: (  0.9,  -1.2) m, (5000.00, 5000.00) mas
     895: (  0.5,   1.2) m, (5000.00, 5000.00) mas
     851: ( -1.4,   0.9) m, (5000.00, 5000.00) mas
     886: ( -1.6,   1.2) m, (5000.00, 5000.00) mas
    1036: ( -2.8,   2.1) m, (5000.00, 5000.00) mas
    1102: ( -3.3,   2.6) m, (5000.00, 5000.00) mas
    1316: ( -3.0,   4.2) m, (5000.00, 5000.00) mas

[00;00mSetting up powfs 2 PO WFS[00;00m

OTF dimension is 48x48 (calculated)
Generating matched filter for powfs 2
Use sanea to derive neasim
Use sanea to derive neasim

[00;00mSetting up reconstructor[00;00m

Recon NEA: cmf(4995.94) cmf(4995.94) cmf(4995.94) cmf(4995.94) cmf(4995.94) cmf(4995.94) cmf(4995.94) cmf(4995.94) cmf(4995.94) geom(0.31) geom(0.31) geom(0.31) mf(0.14)  mas
Setup or update control matrix parameters.
RRtwfs svd threshold is 1e-10
Replacing HA by HA*fit->actextrap
Adding piston cr to fit matrix
Adding TT cr on upper DMs to fit matrix.
Before assembling fit matrix:	3384.2 MiB.
Building fit->FR
Building fit->FL
Adding tikhonov constraint of 1.0e-07 to FLM
The maximum eigen value is estimated to be around 3.4e-04
DM Fit number of Low rank terms: 16 in LHS
After assemble fit matrix:	4348.5 MiB.
After setup_recon:	4348.5 MiB.
GPU 0: mem used 1898 MB (wfs init)
GPU 0: mem used 2452 MB (recon init)
GPU 0: mem used 2482 MB (perf init)

*** Simulation started at 2025/02/17 14:50:52 in nid001972. ***

Running seed 1
GPU 0: mem used 2482 MB (wfs seeding)
Wind dir: 267.3 261.7 167.0 130.5 300.7  32.3 119.8 139.0 150.8 277.7 203.0 133.1  45.9 265.1 deg
Using /global/homes/b/bpeck/.aos/cache/atm/vonkarman_14_8192x8192_0.0078125_1115374592d.bin
After genatm:	4286.7 MiB.
Step     #  Open Loop  PR TT  On axis  PR TT  Field RMS PR TT     Timing 
Step     0: OL  884.6  248.3  OA  884.6 248.3 CL  884.6 248.3 nm  0.122 s
Step    17: OL  910.7  254.8  OA  727.3 272.3 CL  727.3 272.3 nm  0.038 s
Step    38: OL  942.9  260.3  OA  711.7 272.9 CL  711.7 272.9 nm  0.054 s
Step    59: OL  974.2  261.0  OA  697.1 273.1 CL  697.1 273.1 nm  0.047 s
Step    79: OL 1005.0  259.0  OA  677.1 271.0 CL  677.1 271.0 nm  0.047 s
Step   100: OL 1038.3  257.8  OA  665.7 276.9 CL  665.7 276.9 nm  0.050 s
Step   121: OL 1071.6  259.0  OA  667.7 279.3 CL  667.7 279.3 nm  0.047 s
Step   142: OL 1102.1  264.5  OA  664.1 275.3 CL  664.1 275.3 nm  0.047 s
Step   163: OL 1128.1  274.3  OA  656.0 270.1 CL  656.0 270.1 nm  0.057 s
Step   184: OL 1148.2  287.1  OA  652.5 275.2 CL  652.5 275.2 nm  0.046 s
Step   204: OL 1161.1  299.9  OA  654.5 285.4 CL  654.5 285.4 nm  0.046 s
Step   225: OL 1169.5  313.4  OA  666.1 300.8 CL  666.1 300.8 nm  0.050 s
Step   246: OL 1171.5  327.6  OA  672.0 316.4 CL  672.0 316.4 nm  0.046 s
Step   255 updated high order loop gain: 0.423
Step   267: OL 1164.2  342.6  OA  683.2 333.8 CL  683.2 333.8 nm  0.046 s
Step   288: OL 1147.8  358.3  OA  690.0 349.3 CL  690.0 349.3 nm  0.055 s
Step   309: OL 1126.2  376.7  OA  694.3 362.5 CL  694.3 362.5 nm  0.049 s
Step   330: OL 1099.6  397.5  OA  699.9 370.4 CL  699.9 370.4 nm  0.046 s
Step   351: OL 1071.7  422.6  OA  702.1 379.6 CL  702.1 379.6 nm  0.055 s
Step   370: OL 1047.3  448.9  OA  707.4 390.8 CL  707.4 390.8 nm  0.048 s
Step   391: OL 1022.3  479.2  OA  707.0 405.5 CL  707.0 405.5 nm  0.048 s
Step   412: OL  997.6  509.0  OA  707.9 420.1 CL  707.9 420.1 nm  0.053 s
Step   433: OL  972.4  537.0  OA  707.9 434.5 CL  707.9 434.5 nm  0.047 s
Step   454: OL  949.6  564.4  OA  704.5 447.2 CL  704.5 447.2 nm  0.047 s
Step   475: OL  934.7  591.7  OA  707.2 462.0 CL  707.2 462.0 nm  0.054 s
Step   496: OL  930.6  617.5  OA  717.3 473.0 CL  717.3 473.0 nm  0.047 s
Step   511 updated high order loop gain: 0.425
Step   517: OL  933.4  640.2  OA  732.0 486.9 CL  732.0 486.9 nm  0.047 s
Step   538: OL  941.3  656.9  OA  746.9 495.9 CL  746.9 495.9 nm  0.057 s
Step   559: OL  955.2  666.6  OA  757.5 497.8 CL  757.5 497.8 nm  0.048 s
Step   580: OL  973.8  670.5  OA  764.1 491.9 CL  764.1 491.9 nm  0.048 s
Step   601: OL  996.5  668.8  OA  771.4 483.5 CL  771.4 483.5 nm  0.051 s
Step   621: OL 1019.7  660.4  OA  768.2 469.0 CL  768.2 469.0 nm  0.048 s
Step   642: OL 1043.1  645.6  OA  753.2 445.9 CL  753.2 445.9 nm  0.045 s
Step   663: OL 1063.3  626.3  OA  731.5 424.1 CL  731.5 424.1 nm  0.056 s
Step   682: OL 1079.3  606.6  OA  709.2 403.6 CL  709.2 403.6 nm  0.046 s
Step   703: OL 1094.0  583.5  OA  689.4 383.6 CL  689.4 383.6 nm  0.046 s
Step   724: OL 1102.2  557.9  OA  665.9 356.9 CL  665.9 356.9 nm  0.053 s
Step   745: OL 1102.5  531.9  OA  639.3 330.2 CL  639.3 330.2 nm  0.046 s
Step   766: OL 1095.3  507.1  OA  611.5 309.0 CL  611.5 309.0 nm  0.048 s
Step   767 updated high order loop gain: 0.427
Step   786: OL 1081.2  484.5  OA  590.5 292.1 CL  590.5 292.1 nm  0.058 s
Step   807: OL 1059.1  461.1  OA  566.5 267.7 CL  566.5 267.7 nm  0.049 s
Step   828: OL 1031.0  437.8  OA  552.1 248.1 CL  552.1 248.1 nm  0.046 s
Step   849: OL  998.4  415.9  OA  539.4 217.4 CL  539.4 217.4 nm  0.046 s
Step   870: OL  965.6  396.7  OA  534.4 185.0 CL  534.4 185.0 nm  0.046 s
Step   891: OL  935.2  381.1  OA  539.1 158.2 CL  539.1 158.2 nm  0.051 s
Step   912: OL  903.5  368.6  OA  538.3 138.2 CL  538.3 138.2 nm  0.048 s
Step   933: OL  871.7  358.5  OA  536.6 126.8 CL  536.6 126.8 nm  0.052 s
Step   954: OL  841.7  348.3  OA  536.6 116.4 CL  536.6 116.4 nm  0.057 s
Step   974: OL  817.5  337.2  OA  533.7 108.7 CL  533.7 108.7 nm  0.048 s
Step   995: OL  796.8  323.4  OA  536.2  98.4 CL  536.2  98.4 nm  0.046 s
Step  1015: OL  779.4  308.4  OA  538.7  81.2 CL  538.7  81.2 nm  0.053 s
Step  1023 updated high order loop gain: 0.427
Step  1036: OL  764.7  291.8  OA  534.3  70.8 CL  534.3  70.8 nm  0.049 s
Step  1057: OL  751.5  273.0  OA  525.2  71.5 CL  525.2  71.5 nm  0.048 s
Step  1078: OL  740.4  250.6  OA  519.8  68.1 CL  519.8  68.1 nm  0.048 s
Step  1099: OL  734.7  226.4  OA  521.0  52.4 CL  521.0  52.4 nm  0.046 s
Step  1120: OL  732.9  205.3  OA  521.5  33.2 CL  521.5  33.2 nm  0.048 s
Step  1141: OL  732.9  188.8  OA  527.6  13.3 CL  527.6  13.3 nm  0.053 s
Step  1162: OL  733.5  177.2  OA  532.3  14.3 CL  532.3  14.3 nm  0.046 s
Step  1183: OL  735.2  170.6  OA  537.8  17.3 CL  537.8  17.3 nm  0.049 s
Step  1204: OL  739.9  166.2  OA  550.5  21.3 CL  550.5  21.3 nm  0.048 s
Step  1224: OL  744.9  163.5  OA  570.1  41.2 CL  570.1  41.2 nm  0.046 s
Step  1245: OL  749.2  164.9  OA  590.3  65.4 CL  590.3  65.4 nm  0.046 s
Step  1266: OL  754.4  171.8  OA  604.5  85.1 CL  604.5  85.1 nm  0.046 s
Step  1279 updated high order loop gain: 0.427
Step  1286: OL  761.1  182.5  OA  615.1  99.3 CL  615.1  99.3 nm  0.047 s
Step  1307: OL  769.5  196.7  OA  619.4 107.6 CL  619.4 107.6 nm  0.051 s
Step  1328: OL  776.6  213.5  OA  616.5 112.2 CL  616.5 112.2 nm  0.048 s
Step  1349: OL  785.7  232.5  OA  606.6 110.5 CL  606.6 110.5 nm  0.045 s
Step  1370: OL  798.1  249.8  OA  597.9  95.9 CL  597.9  95.9 nm  0.051 s
Step  1390: OL  811.3  261.9  OA  599.5  85.8 CL  599.5  85.8 nm  0.048 s
Step  1411: OL  827.6  270.2  OA  608.7  81.8 CL  608.7  81.8 nm  0.047 s
Step  1431: OL  844.4  275.3  OA  620.3  77.5 CL  620.3  77.5 nm  0.048 s
Step  1452: OL  860.5  279.0  OA  624.6  71.0 CL  624.6  71.0 nm  0.050 s
Step  1473: OL  872.9  279.4  OA  626.0  73.9 CL  626.0  73.9 nm  0.048 s
Step  1493: OL  877.0  275.6  OA  622.6  74.5 CL  622.6  74.5 nm  0.047 s
Step  1514: OL  874.0  267.3  OA  609.1  77.4 CL  609.1  77.4 nm  0.049 s
Step  1535: OL  866.0  256.2  OA  594.6  63.3 CL  594.6  63.3 nm  0.045 s
Step  1535 updated high order loop gain: 0.428
Step  1555: OL  856.4  243.1  OA  586.4  53.8 CL  586.4  53.8 nm  0.049 s
Step  1575: OL  847.0  230.9  OA  581.7  46.2 CL  581.7  46.2 nm  0.046 s
Step  1596: OL  836.6  221.2  OA  577.9  27.8 CL  577.9  27.8 nm  0.047 s
Step 1599: Output PSF
Step  1599: OL  835.0  220.0  OA  576.7  27.9 CL  576.7  27.9 nm  3.347 s
Mean: 625.90 273.02 563.21  nm.

*** Simulation Finished at 2025/02/17 14:52:23 in nid001972. ***

