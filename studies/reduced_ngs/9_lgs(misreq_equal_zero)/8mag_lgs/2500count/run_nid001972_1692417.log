Warning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
/global/cfs/cdirs/ulens/vismcao/maos -o studies/reduced_ngs/9_lgs/8mag_lgs/2500count -c master_files/reduced_ngs/9_lgs/8mag_lgs/kola_2500act.conf -O 
Output folder is 'studies/reduced_ngs/9_lgs/8mag_lgs/2500count'.
SRC: /global/homes/b/bpeck/code/maos v2.9 4c88b7c2 2024-11-13 16:45:33 -0800
BUILT: /global/homes/b/bpeck/code/maos/optim by GCC (v12) on 2024/11/18 09:40:03 CPU(F64,+O3) with CUDA(v122,F32)
Launched at 2025/02/17 14:57:07 in nid001972 with PID 1692417.
The web based job monitor can be accessed at http://localhost:10300
Main config file is /global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_2500act.conf
Warning(path.c:48): Path not found: path=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; abspath=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; Ignored.
Warning(path.c:48): Path not found: path=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; abspath=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; Ignored.
Warning(readcfg.c:399): sim.apfsm has been renamed to powfs.apfsm.
Warning(readcfg.c:399): sim.epfsm has been renamed to powfs.epfsm.
Warning(readcfg.c:399): sim.alfsm has been renamed to powfs.alfsm.
Warning(readcfg.c:399): sim.commonfsm has been renamed to powfs.commonfsm.
Warning(readcfg.c:399): sim.idealfsm has been renamed to powfs.idealfsm.
Warning(readcfg.c:399): sim.zetafsm has been renamed to powfs.zetafsm.
Warning(readcfg.c:399): sim.f0fsm has been renamed to powfs.f0fsm.
Warning(readcfg.c:399): tsurf has been renamed to ncpa.tsurf.
loaded 132 (132 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_sim.conf'
loaded  19 ( 19 new) records from '/global/cfs/cdirs/ulens/vismcao/./dm_none.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_ASM.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_DM2.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_DM3.conf'
loaded   0 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_dm_multiple.conf'
loaded   7 (  5 new) records from '/global/cfs/cdirs/ulens/vismcao/./atm_mk13n50p_ground_detail.conf'
loaded  76 ( 69 new) records from '/global/homes/b/bpeck/code/maos/config/maos/powfs_common.conf'
loaded  44 ( 38 new) records from '/global/cfs/cdirs/ulens/vismcao/./powfs_none.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_lgs.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_ttf_strap.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_twfs_lbwfs.conf'
loaded   0 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_wfs_lgs_strap_lbwfs.conf'
loaded  71 ( 71 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_recon.conf'
Warning(readcfg.c:399): dbg.na_smooth has been renamed to powfs0_llt.na_smooth.
Warning(readcfg.c:399): dbg.na_interp has been renamed to powfs0_llt.na_interp.
Warning(readcfg.c:399): dbg.na_thres has been renamed to powfs0_llt.na_thres.
Warning(readcfg.c:399): dbg.na_fit_maxit has been renamed to powfs0_llt.na_fit_maxit.
Warning(readcfg.c:399): dbg.na_fit_svdthres has been renamed to powfs0_llt.na_fit_svdthres.
Warning(readcfg.c:399): dbg.na_fit_dh has been renamed to powfs0_llt.na_fit_dh.
Warning(readcfg.c:399): dbg.ncpa_preload has been renamed to ncpa.preload.
Warning(readcfg.c:399): dbg.ncpa_rmsci has been renamed to ncpa.rmsci.
Warning(readcfg.c:399): dbg.draw_opdmax has been renamed to plot.opdmax.
Warning(readcfg.c:399): dbg.draw_gmax has been renamed to plot.gmax.
loaded  95 ( 93 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_dbg.conf'
loaded   4 (  4 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_fit_mcao.conf'
Warning(readcfg.c:399): surf has been renamed to ncpa.surf.
loaded  39 (  7 new) records from '/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_2500act.conf'
loaded   0 (  0 new) records from 'command line'
loaded  24 ( 18 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_llt_CL.conf'
Adjust LGS range by telescope altitude 4145m.
Zenith angle is 30 degree.
    Scaling turbulence height and LGS hs by sec(za).
    Scaling r0 by cos(za)^(3/5).
    Scaling wind speed and LGS signal level by cos(za).
powfs0: Adjusting dx from 0.0078125 to 0.008125. 
powfs0.llt.fsm: f0=0 Hz, LPF ep=0
powfs0.epfsm is set to 0.517618 (auto)
powfs2: Adjusting dx from 0.03125 to 0.0312778. 
powfs2 is TWFS for powfs0
sim.ephi is set to 0.427717 (auto)
sim.eplo is set to 0.427717 (auto)
Warning(parms.c:2296): Layer 1 at 17.3205m is very close to layer 0 at 0m (OK).
Warning(parms.c:2296): Layer 2 at 34.641m is very close to layer 1 at 17.3205m (OK).
Warning(parms.c:2296): Layer 3 at 51.9615m is very close to layer 2 at 34.641m (OK).
dm 0: stroke=30 um is provided in micron.
dm 0: assume ia stroke=2 um is provided in micron.
dm 1: stroke=7 um is provided in micron.
dm 1: assume ia stroke=2 um is provided in micron.
dm 2: stroke=7 um is provided in micron.
dm 2: assume ia stroke=2 um is provided in micron.
Focus blending is not implemented yet for integrated tomography
parms->sim.mffocus is reset to 0
There are 1 valid simulation seeds:  1
Output PSF for 1 directions
Used 449 of 456 supplied keys
Warning(readcfg.c:158): key "dbg.pwfs_flate" is not recognized, value is 0
Warning(readcfg.c:158): key "dbg.pwfs_flatv" is not recognized, value is 0
Warning(readcfg.c:158): key "dbg.pwfs_psx" is not recognized, value is [0 0 0 0]
Warning(readcfg.c:158): key "dbg.pwfs_psy" is not recognized, value is [0 0 0 0]
Warning(readcfg.c:158): key "dbg.pwfs_pupelong" is not recognized, value is 0
Warning(readcfg.c:158): key "dbg.pwfs_raw" is not recognized, value is 0
Warning(readcfg.c:158): key "dbg.pwfs_side" is not recognized, value is 4
[00;00mAperture[00;00m is 11 m with sampling 1/128 m
[00;00mTurbulence at 30 degree zenith angle:[00;00m r0=0.128424m, L0=30m, 14 layers.
    Greenwood freq is 25.1Hz, anisoplanatic angle is 1.58 as
    Sampled 8192x8192 at 1/128m. wind dir is randomized.
    layer 0: ht=      0 m, wt= 0.302, ws=  4.8 m/s
    layer 1: ht=     17 m, wt= 0.154, ws=  5.0 m/s
    layer 2: ht=     35 m, wt= 0.041, ws=  5.4 m/s
    layer 3: ht=     52 m, wt= 0.002, ws=  6.6 m/s
    layer 4: ht=    139 m, wt= 0.021, ws=  6.1 m/s
    layer 5: ht=    231 m, wt= 0.010, ws=  6.1 m/s
    layer 6: ht=    323 m, wt= 0.008, ws=  6.1 m/s
    layer 7: ht=    416 m, wt= 0.005, ws=  6.1 m/s
    layer 8: ht=    508 m, wt= 0.001, ws=  6.1 m/s
    layer 9: ht=    932 m, wt= 0.107, ws=  5.6 m/s
    layer 10: ht=   5022 m, wt= 0.144, ws= 11.1 m/s
    layer 11: ht=   9238 m, wt= 0.093, ws= 19.1 m/s
    layer 12: ht=  13856 m, wt= 0.075, ws=  8.2 m/s
    layer 13: ht=  22518 m, wt= 0.036, ws=  4.8 m/s
[00;00mReconstruction[00;00m: r0=0.128424m L0=30m. 14 layers. use cone coordinate.
    layer 0: ht=      0 m, wt= 0.302
    layer 1: ht=     17 m, wt= 0.154
    layer 2: ht=     35 m, wt= 0.041
    layer 3: ht=     52 m, wt= 0.002
    layer 4: ht=    139 m, wt= 0.021
    layer 5: ht=    231 m, wt= 0.010
    layer 6: ht=    323 m, wt= 0.008
    layer 7: ht=    416 m, wt= 0.005
    layer 8: ht=    508 m, wt= 0.001
    layer 9: ht=    932 m, wt= 0.107
    layer 10: ht=   5022 m, wt= 0.144
    layer 11: ht=   9238 m, wt= 0.093
    layer 12: ht=  13856 m, wt= 0.075
    layer 13: ht=  22518 m, wt= 0.036
[00;00mThere are 3 powfs[00;00m
  powfs0: Order 57, LGS at 99.1 km. Sampling 1/123.077 m. Thres 30%. [00;00mT/T is removed in right hand side in tomography.[00;00m
    CCD image is 25x25 @ 500x500 mas, blur 27% (sigma), 1500Hz, wvl: [ 5.89e-07]
    Gtilt in reconstruction. Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
  powfs1: Order  2, NGS at inf km. Sampling 1/16 m. Thres 30%. 
    Ztilt in reconstruction. Geomtric optics start at 2 with ztilt [00;00m(noisy)[00;00m
  powfs2: Order 20, NGS at inf km. Sampling 1/31.9716 m. Thres 50%. 
    CCD image is 4x4 @ 1500x1500 mas, blur 0% (sigma), 0.015Hz, wvl: [ 7.2e-07]
    Gtilt in reconstruction. Geomtric optics start at 50 with gtilt Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
[00;00mThere are 13 wfs[00;00m
    wfs 0: type 0, at (  30.00,    0.00) arcsec,  99 km, siglev is 45.5936 bkgrnd is 0.1
    wfs 1: type 0, at (  22.98,   19.28) arcsec,  99 km, siglev is 45.5936 bkgrnd is 0.1
    wfs 2: type 0, at (   5.21,   29.54) arcsec,  99 km, siglev is 45.5936 bkgrnd is 0.1
    wfs 3: type 0, at ( -15.00,   25.98) arcsec,  99 km, siglev is 45.5936 bkgrnd is 0.1
    wfs 4: type 0, at ( -28.19,   10.26) arcsec,  99 km, siglev is 45.5936 bkgrnd is 0.1
    wfs 5: type 0, at ( -28.19,  -10.26) arcsec,  99 km, siglev is 45.5936 bkgrnd is 0.1
    wfs 6: type 0, at ( -15.00,  -25.98) arcsec,  99 km, siglev is 45.5936 bkgrnd is 0.1
    wfs 7: type 0, at (   5.21,  -29.54) arcsec,  99 km, siglev is 45.5936 bkgrnd is 0.1
    wfs 8: type 0, at (  22.98,  -19.28) arcsec,  99 km, siglev is 45.5936 bkgrnd is 0.1
    wfs 9: type 1, at (   5.00,    8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 10: type 1, at ( -10.00,    0.00) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 11: type 1, at (   5.00,   -8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 12: type 2, at (   0.00,    0.00) arcsec, inf km, siglev is 4.1558e+06 bkgrnd is 0.001
[00;00mThere are 3 DMs[00;00m
  DM 0 at -0.1km, actuator pitch 0.195m, offset   0, with 30.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 1 at    6km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 2 at   10km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
[00;00mTomography[00;00m is using CG, with [00;00mFourer Domain[00;00m preconditioner, [00;00m12[00;00m iterations, integrated tomo.
[00;00mDM Fitting [00;00mis using CG, with [00;00mNo[00;00m preconditioner, [00;00m10[00;00m iterations
[00;00mThere are 9 fit directions[00;00m
    Fit 0: weight is 0.444, at (   0.00,    0.00) arcsec
    Fit 1: weight is 0.111, at (  15.00,    0.00) arcsec
    Fit 2: weight is 0.111, at (   0.00,   15.00) arcsec
    Fit 3: weight is 0.111, at ( -15.00,    0.00) arcsec
    Fit 4: weight is 0.111, at (   0.00,  -15.00) arcsec
    Fit 5: weight is 0.028, at (  15.00,   15.00) arcsec
    Fit 6: weight is 0.028, at ( -15.00,   15.00) arcsec
    Fit 7: weight is 0.028, at ( -15.00,  -15.00) arcsec
    Fit 8: weight is 0.028, at (  15.00,  -15.00) arcsec
[00;00mThere are 1 evaluation directions[00;00m at sampling 1/128 m.
    Evl 0: weight is 1.000, at (   0.00,    0.00) arcsec
[00;00mSimulation[00;00m start at step 0, end at step 1600, with time step 1/1500s, [00;00mclose loop[00;00m.
After setup_parms:	120.5 MiB.
Warning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
CUDA: minimum memory requirement is 0.3GB
GPU 0 is NVIDIA A100-SXM4-40GB with arch 8.0, 38.9GB free, 39.3GB total device memory.
Using GPU 0
Use 1 GPUs for WFS Tomo Fit Evl

*** Preparation started at 2025/02/17 14:57:08 in nid001972. ***

Using OpenMP version 201511 with 128 threads
Reading aperture amplitude map from KECK.fits
Warning(accphi.c:477): 108650 points not covered by input screen
Warning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
 ->maos.c:447->setup.c:148->aper.c:74->utils.c:478->accphi.c:478
iwvl 0: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 1: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 2: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 3: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 4: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 5: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 6: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 7: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 8: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
After setup_aper:	343.0 MiB.

[00;00mSetting up powfs 0 geom[00;00m

There are 24 points in each subaperture of 0.195m.
There are 1993 valid subaperture.

[00;00mSetting up powfs 1 geom[00;00m

There are 88 points in each subaperture of 5.5m.
There are 4 valid subaperture.

[00;00mSetting up powfs 2 geom[00;00m

There are 18 points in each subaperture of 0.563m.
There are 236 valid subaperture.
After setup_powfs_init:	408.7 MiB.

[00;00mSetting up reconstructor geometry.[00;00m

PLOC is 117x117, with sampling of 0.10m (square)
    DM 0: grid is 60 x 60
    DM 1: grid is 75 x 75
    DM 2: grid is 80 x 79
FLOC is 117x117, with sampling of 0.10m (not square)
Tomography grid is square:
    layer 0: xloc grid is 216 x 216, sampling is 0.098 m, 46656 points
    layer 1: xloc grid is 216 x 216, sampling is 0.097 m, 46656 points
    layer 2: xloc grid is 216 x 216, sampling is 0.097 m, 46656 points
    layer 3: xloc grid is 216 x 216, sampling is 0.097 m, 46656 points
    layer 4: xloc grid is 216 x 216, sampling is 0.097 m, 46656 points
    layer 5: xloc grid is 216 x 216, sampling is 0.097 m, 46656 points
    layer 6: xloc grid is 216 x 216, sampling is 0.097 m, 46656 points
    layer 7: xloc grid is 216 x 216, sampling is 0.097 m, 46656 points
    layer 8: xloc grid is 216 x 216, sampling is 0.097 m, 46656 points
    layer 9: xloc grid is 216 x 216, sampling is 0.097 m, 46656 points
    layer 10: xloc grid is 216 x 216, sampling is 0.093 m, 46656 points
    layer 11: xloc grid is 216 x 216, sampling is 0.088 m, 46656 points
    layer 12: xloc grid is 216 x 216, sampling is 0.084 m, 46656 points
    layer 13: xloc grid is 216 x 216, sampling is 0.075 m, 46656 points

[00;00mSetting up powfs 0 PO WFS[00;00m

OTF dimension is 48x48 (calculated)
Uplink FWHM (illt 0, iwvl 0) is 0.581676"
Downlink FWHM (illt 0, iwvl 0) is 0"
Generating matched filter for powfs 0
sa index   location       noise equivalent angle
     972: (  4.8,  -0.3) m, (5000.00, 5000.00) mas
     967: (  3.8,  -0.3) m, (5000.00, 5000.00) mas
     961: (  2.6,  -0.3) m, (5000.00, 5000.00) mas
     955: (  1.5,  -0.3) m, (5000.00, 5000.00) mas
     954: (  1.3,  -0.3) m, (5000.00, 5000.00) mas
     685: ( -0.5,  -1.5) m, (5000.00, 5000.00) mas
     952: ( -1.7,  -0.3) m, (5000.00, 5000.00) mas
     946: ( -2.8,  -0.3) m, (5000.00, 5000.00) mas
     940: ( -4.0,  -0.3) m, (5000.00, 5000.00) mas
     935: ( -5.0,  -0.3) m, (5000.00, 5000.00) mas
     933: ( -5.4,  -0.3) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    1681: (  3.4,   2.8) m, (5000.00, 5000.00) mas
    1466: (  2.2,   1.9) m, (5000.00, 5000.00) mas
    1266: (  1.3,   1.1) m, (5000.00, 5000.00) mas
    1219: (  1.1,   0.9) m, (5000.00, 5000.00) mas
    1173: ( -1.3,   0.7) m, (5000.00, 5000.00) mas
     776: ( -1.3,  -1.1) m, (5000.00, 5000.00) mas
     578: ( -2.2,  -1.9) m, (5000.00, 5000.00) mas
     529: ( -2.4,  -2.0) m, (5000.00, 5000.00) mas
     313: ( -3.6,  -3.0) m, (5000.00, 5000.00) mas
      66: ( -3.0,  -4.4) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    1949: (  0.7,   4.4) m, (5000.00, 5000.00) mas
    1746: (  0.5,   3.2) m, (5000.00, 5000.00) mas
    1542: (  0.3,   2.2) m, (5000.00, 5000.00) mas
    1309: (  0.1,   1.3) m, (5000.00, 5000.00) mas
     953: ( -1.5,  -0.3) m, (5000.00, 5000.00) mas
     686: ( -0.3,  -1.5) m, (5000.00, 5000.00) mas
     452: ( -0.5,  -2.4) m, (5000.00, 5000.00) mas
     248: ( -0.7,  -3.4) m, (5000.00, 5000.00) mas
      44: ( -0.9,  -4.6) m, (5000.00, 5000.00) mas
      14: ( -2.4,  -4.8) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    1932: ( -2.6,   4.4) m, (5000.00, 5000.00) mas
    1802: ( -2.2,   3.6) m, (5000.00, 5000.00) mas
    1614: ( -1.7,   2.6) m, (5000.00, 5000.00) mas
    1401: ( -1.1,   1.7) m, (5000.00, 5000.00) mas
    1304: ( -0.9,   1.3) m, (5000.00, 5000.00) mas
    1042: (  1.3,   0.1) m, (5000.00, 5000.00) mas
     691: (  0.7,  -1.5) m, (5000.00, 5000.00) mas
     461: (  1.3,  -2.4) m, (5000.00, 5000.00) mas
     380: (  1.5,  -2.8) m, (5000.00, 5000.00) mas
     126: (  2.2,  -4.2) m, (5000.00, 5000.00) mas
      61: (  2.4,  -4.6) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    1335: ( -4.4,   1.5) m, (5000.00, 5000.00) mas
    1206: ( -2.8,   0.9) m, (5000.00, 5000.00) mas
    1168: ( -2.2,   0.7) m, (5000.00, 5000.00) mas
    1130: ( -1.5,   0.5) m, (5000.00, 5000.00) mas
     686: ( -0.3,  -1.5) m, (5000.00, 5000.00) mas
     866: (  1.5,  -0.7) m, (5000.00, 5000.00) mas
     827: (  2.0,  -0.9) m, (5000.00, 5000.00) mas
     789: (  2.6,  -1.1) m, (5000.00, 5000.00) mas
     660: (  4.2,  -1.7) m, (5000.00, 5000.00) mas
     930: (  5.2,  -0.5) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
     616: ( -4.4,  -1.7) m, (5000.00, 5000.00) mas
     768: ( -2.8,  -1.1) m, (5000.00, 5000.00) mas
     814: ( -2.2,  -0.9) m, (5000.00, 5000.00) mas
     862: ( -1.5,  -0.7) m, (5000.00, 5000.00) mas
    1307: ( -0.3,   1.3) m, (5000.00, 5000.00) mas
    1134: (  1.5,   0.5) m, (5000.00, 5000.00) mas
    1181: (  2.0,   0.7) m, (5000.00, 5000.00) mas
    1227: (  2.6,   0.9) m, (5000.00, 5000.00) mas
    1379: (  4.2,   1.5) m, (5000.00, 5000.00) mas
    1108: (  5.2,   0.3) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
      35: ( -2.6,  -4.6) m, (5000.00, 5000.00) mas
     169: ( -2.2,  -3.8) m, (5000.00, 5000.00) mas
     364: ( -1.7,  -2.8) m, (5000.00, 5000.00) mas
     584: ( -1.1,  -1.9) m, (5000.00, 5000.00) mas
     683: ( -0.9,  -1.5) m, (5000.00, 5000.00) mas
     954: (  1.3,  -0.3) m, (5000.00, 5000.00) mas
    1312: (  0.7,   1.3) m, (5000.00, 5000.00) mas
    1547: (  1.3,   2.2) m, (5000.00, 5000.00) mas
    1630: (  1.5,   2.6) m, (5000.00, 5000.00) mas
    1891: (  2.2,   4.0) m, (5000.00, 5000.00) mas
    1958: (  2.4,   4.4) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
      52: (  0.7,  -4.6) m, (5000.00, 5000.00) mas
     254: (  0.5,  -3.4) m, (5000.00, 5000.00) mas
     456: (  0.3,  -2.4) m, (5000.00, 5000.00) mas
     688: (  0.1,  -1.5) m, (5000.00, 5000.00) mas
    1041: ( -1.5,   0.1) m, (5000.00, 5000.00) mas
    1307: ( -0.3,   1.3) m, (5000.00, 5000.00) mas
    1538: ( -0.5,   2.2) m, (5000.00, 5000.00) mas
    1740: ( -0.7,   3.2) m, (5000.00, 5000.00) mas
    1941: ( -0.9,   4.4) m, (5000.00, 5000.00) mas
    1964: ( -2.4,   4.6) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
     349: (  3.4,  -3.0) m, (5000.00, 5000.00) mas
     553: (  2.2,  -2.0) m, (5000.00, 5000.00) mas
     740: (  1.3,  -1.3) m, (5000.00, 5000.00) mas
     781: (  1.1,  -1.1) m, (5000.00, 5000.00) mas
     819: ( -1.3,  -0.9) m, (5000.00, 5000.00) mas
    1214: ( -1.3,   0.9) m, (5000.00, 5000.00) mas
    1395: ( -2.2,   1.7) m, (5000.00, 5000.00) mas
    1442: ( -2.4,   1.9) m, (5000.00, 5000.00) mas
    1645: ( -3.6,   2.8) m, (5000.00, 5000.00) mas
    1897: ( -3.0,   4.2) m, (5000.00, 5000.00) mas

[00;00mSetting up powfs 2 PO WFS[00;00m

OTF dimension is 48x48 (calculated)
Generating matched filter for powfs 2
Use sanea to derive neasim
Use sanea to derive neasim

[00;00mSetting up reconstructor[00;00m

Recon NEA: cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) geom(0.31) geom(0.31) geom(0.31) mf(0.14)  mas
Setup or update control matrix parameters.
RRtwfs svd threshold is 1e-10
Replacing HA by HA*fit->actextrap
Adding piston cr to fit matrix
Adding TT cr on upper DMs to fit matrix.
Before assembling fit matrix:	3878.4 MiB.
Building fit->FR
Building fit->FL
Adding tikhonov constraint of 1.0e-07 to FLM
The maximum eigen value is estimated to be around 3.1e-04
DM Fit number of Low rank terms: 16 in LHS
After assemble fit matrix:	5074.3 MiB.
After setup_recon:	5074.3 MiB.
GPU 0: mem used 1638 MB (wfs init)
GPU 0: mem used 2384 MB (recon init)
GPU 0: mem used 2414 MB (perf init)

*** Simulation started at 2025/02/17 14:58:10 in nid001972. ***

Running seed 1
GPU 0: mem used 2416 MB (wfs seeding)
Wind dir: 267.3 261.7 167.0 130.5 300.7  32.3 119.8 139.0 150.8 277.7 203.0 133.1  45.9 265.1 deg
Using /global/homes/b/bpeck/.aos/cache/atm/vonkarman_14_8192x8192_0.0078125_1115374592d.bin
After genatm:	5036.4 MiB.
Step     #  Open Loop  PR TT  On axis  PR TT  Field RMS PR TT     Timing 
Step     0: OL  884.6  248.3  OA  884.6 248.3 CL  884.6 248.3 nm  0.088 s
Step    20: OL  915.2  255.8  OA  729.3 251.5 CL  729.3 251.5 nm  0.092 s
Step    37: OL  941.4  260.2  OA  716.0 249.0 CL  716.0 249.0 nm  0.054 s
Step    55: OL  968.2  261.3  OA  698.5 242.8 CL  698.5 242.8 nm  0.054 s
Step    73: OL  995.7  259.7  OA  682.4 237.3 CL  682.4 237.3 nm  0.056 s
Step    91: OL 1024.2  258.2  OA  669.5 232.0 CL  669.5 232.0 nm  0.065 s
Step   109: OL 1053.1  257.9  OA  660.2 228.1 CL  660.2 228.1 nm  0.054 s
Step   127: OL 1081.1  260.0  OA  656.3 223.7 CL  656.3 223.7 nm  0.056 s
Step   145: OL 1106.8  265.7  OA  653.6 221.1 CL  653.6 221.1 nm  0.061 s
Step   163: OL 1128.9  274.3  OA  652.5 219.9 CL  652.5 219.9 nm  0.056 s
Step   180: OL 1146.1  284.5  OA  655.2 223.9 CL  655.2 223.9 nm  0.056 s
Step   198: OL 1159.3  296.2  OA  660.4 229.7 CL  660.4 229.7 nm  0.057 s
Step   216: OL 1168.8  307.6  OA  669.4 239.5 CL  669.4 239.5 nm  0.059 s
Step   234: OL 1174.0  319.4  OA  681.9 251.6 CL  681.9 251.6 nm  0.056 s
Step   252: OL 1174.2  332.0  OA  690.5 266.0 CL  690.5 266.0 nm  0.055 s
Step   255 updated high order loop gain: 0.423
Step   270: OL 1166.9  344.9  OA  699.1 281.5 CL  699.1 281.5 nm  0.056 s
Step   288: OL 1153.2  358.4  OA  704.2 297.6 CL  704.2 297.6 nm  0.063 s
Step   305: OL 1136.9  373.2  OA  707.6 312.8 CL  707.6 312.8 nm  0.054 s
Step   323: OL 1115.9  390.2  OA  710.5 327.4 CL  710.5 327.4 nm  0.055 s
Step   341: OL 1093.0  410.2  OA  714.1 346.2 CL  714.1 346.2 nm  0.061 s
Step   359: OL 1069.7  433.5  OA  719.7 366.8 CL  719.7 366.8 nm  0.054 s
Step   377: OL 1047.7  459.1  OA  727.4 388.0 CL  727.4 388.0 nm  0.057 s
Step   394: OL 1027.9  483.7  OA  736.0 407.9 CL  736.0 407.9 nm  0.062 s
Step   412: OL 1006.6  509.2  OA  742.8 426.5 CL  742.8 426.5 nm  0.057 s
Step   430: OL  984.5  533.2  OA  748.8 444.9 CL  748.8 444.9 nm  0.055 s
Step   448: OL  963.7  556.7  OA  752.5 463.5 CL  752.5 463.5 nm  0.055 s
Step   466: OL  947.3  580.3  OA  756.6 480.1 CL  756.6 480.1 nm  0.055 s
Step   484: OL  938.2  603.2  OA  767.7 496.9 CL  767.7 496.9 nm  0.062 s
Step   502: OL  936.4  624.6  OA  782.4 512.6 CL  782.4 512.6 nm  0.056 s
Step   511 updated high order loop gain: 0.426
Step   520: OL  938.8  643.2  OA  798.0 526.6 CL  798.0 526.6 nm  0.055 s
Step   537: OL  944.6  656.4  OA  811.7 534.6 CL  811.7 534.6 nm  0.079 s
Step   554: OL  954.5  664.9  OA  823.8 539.3 CL  823.8 539.3 nm  0.056 s
Step   572: OL  968.7  669.7  OA  835.0 538.9 CL  835.0 538.9 nm  0.056 s
Step   590: OL  986.2  670.7  OA  841.6 532.1 CL  841.6 532.1 nm  0.064 s
Step   608: OL 1006.1  666.6  OA  849.7 523.5 CL  849.7 523.5 nm  0.056 s
Step   626: OL 1026.6  657.5  OA  848.0 508.6 CL  848.0 508.6 nm  0.055 s
Step   644: OL 1046.0  644.1  OA  840.4 491.1 CL  840.4 491.1 nm  0.063 s
Step   662: OL 1062.9  627.4  OA  826.3 471.5 CL  826.3 471.5 nm  0.057 s
Step   680: OL 1077.8  608.7  OA  811.0 449.4 CL  811.0 449.4 nm  0.058 s
Step   696: OL 1089.5  591.7  OA  796.0 429.2 CL  796.0 429.2 nm  0.055 s
Step   714: OL 1098.7  570.4  OA  777.3 403.3 CL  777.3 403.3 nm  0.056 s
Step   732: OL 1102.3  548.1  OA  757.9 377.5 CL  757.9 377.5 nm  0.057 s
Step   750: OL 1100.1  526.0  OA  735.3 352.8 CL  735.3 352.8 nm  0.056 s
Step   767 updated high order loop gain: 0.427
Step   768: OL 1092.5  504.9  OA  710.3 330.3 CL  710.3 330.3 nm  0.068 s
Step   786: OL 1079.3  484.7  OA  685.9 309.9 CL  685.9 309.9 nm  0.056 s
Step   804: OL 1060.4  464.6  OA  662.5 290.9 CL  662.5 290.9 nm  0.055 s
Step   821: OL 1038.7  445.7  OA  645.4 273.1 CL  645.4 273.1 nm  0.064 s
Step   839: OL 1011.7  426.2  OA  629.3 253.6 CL  629.3 253.6 nm  0.056 s
Step   857: OL  983.3  408.3  OA  617.3 234.6 CL  617.3 234.6 nm  0.058 s
Step   875: OL  956.0  392.8  OA  609.6 218.0 CL  609.6 218.0 nm  0.066 s
Step   893: OL  930.7  380.0  OA  607.8 203.9 CL  607.8 203.9 nm  0.057 s
Step   911: OL  904.3  369.3  OA  602.9 194.0 CL  602.9 194.0 nm  0.057 s
Step   929: OL  877.9  360.6  OA  597.0 186.6 CL  597.0 186.6 nm  0.056 s
Step   947: OL  852.7  352.0  OA  589.3 180.9 CL  589.3 180.9 nm  0.055 s
Step   965: OL  830.1  342.6  OA  583.2 175.2 CL  583.2 175.2 nm  0.061 s
Step   983: OL  811.7  331.8  OA  583.0 169.0 CL  583.0 169.0 nm  0.056 s
Step  1001: OL  795.9  319.2  OA  583.6 162.1 CL  583.6 162.1 nm  0.057 s
Step  1019: OL  782.1  305.5  OA  580.6 155.3 CL  580.6 155.3 nm  0.062 s
Step  1023 updated high order loop gain: 0.427
Step  1036: OL  771.3  291.9  OA  576.7 149.5 CL  576.7 149.5 nm  0.056 s
Step  1047: OL  764.9  282.4  OA  574.7 145.7 CL  574.7 145.7 nm  0.056 s
Step  1064: OL  754.8  266.2  OA  567.2 135.6 CL  567.2 135.6 nm  0.065 s
Step  1082: OL  746.5  246.1  OA  562.8 122.5 CL  562.8 122.5 nm  0.055 s
Step  1100: OL  742.0  225.5  OA  556.4 103.6 CL  556.4 103.6 nm  0.055 s
Step  1118: OL  739.8  207.3  OA  553.9  85.8 CL  553.9  85.8 nm  0.063 s
Step  1136: OL  738.9  192.5  OA  551.8  66.9 CL  551.8  66.9 nm  0.055 s
Step  1154: OL  738.6  181.2  OA  553.3  53.2 CL  553.3  53.2 nm  0.055 s
Step  1172: OL  738.2  173.7  OA  554.4  44.0 CL  554.4  44.0 nm  0.056 s
Step  1190: OL  740.0  169.1  OA  565.4  38.2 CL  565.4  38.2 nm  0.055 s
Step  1206: OL  742.9  166.0  OA  578.3  34.5 CL  578.3  34.5 nm  0.056 s
Step  1224: OL  746.5  163.7  OA  592.3  35.9 CL  592.3  35.9 nm  0.056 s
Step  1242: OL  749.4  164.5  OA  603.6  43.5 CL  603.6  43.5 nm  0.056 s
Step  1260: OL  752.8  169.4  OA  612.6  55.3 CL  612.6  55.3 nm  0.056 s
Step  1278: OL  757.5  178.0  OA  620.6  67.4 CL  620.6  67.4 nm  0.065 s
Step  1279 updated high order loop gain: 0.427
Step  1296: OL  764.4  189.0  OA  626.3  77.3 CL  626.3  77.3 nm  0.056 s
Step  1314: OL  770.7  202.0  OA  628.1  84.8 CL  628.1  84.8 nm  0.054 s
Step  1331: OL  776.4  216.2  OA  625.9  93.3 CL  625.9  93.3 nm  0.061 s
Step  1349: OL  784.4  232.5  OA  620.9  99.7 CL  620.9  99.7 nm  0.055 s
Step  1367: OL  795.1  247.7  OA  621.5 103.0 CL  621.5 103.0 nm  0.055 s
Step  1381: OL  804.1  257.0  OA  622.3 103.8 CL  622.3 103.8 nm  0.070 s
Step  1399: OL  817.2  266.0  OA  628.9  99.7 CL  628.9  99.7 nm  0.056 s
Step  1417: OL  832.2  271.9  OA  636.4  96.0 CL  636.4  96.0 nm  0.055 s
Step  1435: OL  847.5  276.1  OA  642.4  90.2 CL  642.4  90.2 nm  0.056 s
Step  1453: OL  861.4  279.1  OA  646.3  83.3 CL  646.3  83.3 nm  0.055 s
Step  1471: OL  872.6  279.5  OA  646.4  77.5 CL  646.4  77.5 nm  0.059 s
Step  1489: OL  877.5  276.6  OA  642.2  72.4 CL  642.2  72.4 nm  0.055 s
Step  1507: OL  876.6  270.4  OA  631.9  70.9 CL  631.9  70.9 nm  0.056 s
Step  1525: OL  871.5  261.9  OA  621.0  68.9 CL  621.0  68.9 nm  0.065 s
Step  1535 updated high order loop gain: 0.428
Step  1542: OL  863.8  251.7  OA  612.6  65.2 CL  612.6  65.2 nm  0.055 s
Step  1559: OL  855.5  240.5  OA  606.7  58.7 CL  606.7  58.7 nm  0.057 s
Step  1577: OL  846.9  229.8  OA  603.2  55.8 CL  603.2  55.8 nm  0.061 s
Step  1595: OL  837.7  221.6  OA  598.1  56.9 CL  598.1  56.9 nm  0.055 s
Step 1599: Output PSF
Step  1599: OL  835.6  219.9  OA  597.9  58.0 CL  597.9  58.0 nm  1.961 s
Mean: 673.54 294.47 605.76  nm.

*** Simulation Finished at 2025/02/17 14:59:53 in nid001972. ***

