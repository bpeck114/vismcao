Warning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
/global/cfs/cdirs/ulens/vismcao/maos -o studies/reduced_ngs/9_lgs/8mag_lgs/1500count -c master_files/reduced_ngs/9_lgs/8mag_lgs/kola_1500act.conf -O 
Output folder is 'studies/reduced_ngs/9_lgs/8mag_lgs/1500count'.
SRC: /global/homes/b/bpeck/code/maos v2.9 4c88b7c2 2024-11-13 16:45:33 -0800
BUILT: /global/homes/b/bpeck/code/maos/optim by GCC (v12) on 2024/11/18 09:40:03 CPU(F64,+O3) with CUDA(v122,F32)
Launched at 2025/02/17 14:47:55 in nid001972 with PID 1689837.
The web based job monitor can be accessed at http://localhost:10300
Main config file is /global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_1500act.conf
Warning(path.c:48): Path not found: path=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; abspath=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; Ignored.
Warning(path.c:48): Path not found: path=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; abspath=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; Ignored.
Warning(readcfg.c:399): sim.apfsm has been renamed to powfs.apfsm.
Warning(readcfg.c:399): sim.epfsm has been renamed to powfs.epfsm.
Warning(readcfg.c:399): sim.alfsm has been renamed to powfs.alfsm.
Warning(readcfg.c:399): sim.commonfsm has been renamed to powfs.commonfsm.
Warning(readcfg.c:399): sim.idealfsm has been renamed to powfs.idealfsm.
Warning(readcfg.c:399): sim.zetafsm has been renamed to powfs.zetafsm.
Warning(readcfg.c:399): sim.f0fsm has been renamed to powfs.f0fsm.
Warning(readcfg.c:399): tsurf has been renamed to ncpa.tsurf.
loaded 132 (132 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_sim.conf'
loaded  19 ( 19 new) records from '/global/cfs/cdirs/ulens/vismcao/./dm_none.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_ASM.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_DM2.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_DM3.conf'
loaded   0 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_dm_multiple.conf'
loaded   7 (  5 new) records from '/global/cfs/cdirs/ulens/vismcao/./atm_mk13n50p_ground_detail.conf'
loaded  76 ( 69 new) records from '/global/homes/b/bpeck/code/maos/config/maos/powfs_common.conf'
loaded  44 ( 38 new) records from '/global/cfs/cdirs/ulens/vismcao/./powfs_none.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_lgs.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_ttf_strap.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_twfs_lbwfs.conf'
loaded   0 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_wfs_lgs_strap_lbwfs.conf'
loaded  71 ( 71 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_recon.conf'
Warning(readcfg.c:399): dbg.na_smooth has been renamed to powfs0_llt.na_smooth.
Warning(readcfg.c:399): dbg.na_interp has been renamed to powfs0_llt.na_interp.
Warning(readcfg.c:399): dbg.na_thres has been renamed to powfs0_llt.na_thres.
Warning(readcfg.c:399): dbg.na_fit_maxit has been renamed to powfs0_llt.na_fit_maxit.
Warning(readcfg.c:399): dbg.na_fit_svdthres has been renamed to powfs0_llt.na_fit_svdthres.
Warning(readcfg.c:399): dbg.na_fit_dh has been renamed to powfs0_llt.na_fit_dh.
Warning(readcfg.c:399): dbg.ncpa_preload has been renamed to ncpa.preload.
Warning(readcfg.c:399): dbg.ncpa_rmsci has been renamed to ncpa.rmsci.
Warning(readcfg.c:399): dbg.draw_opdmax has been renamed to plot.opdmax.
Warning(readcfg.c:399): dbg.draw_gmax has been renamed to plot.gmax.
loaded  95 ( 93 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_dbg.conf'
loaded   4 (  4 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_fit_mcao.conf'
Warning(readcfg.c:399): surf has been renamed to ncpa.surf.
loaded  39 (  7 new) records from '/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_1500act.conf'
loaded   0 (  0 new) records from 'command line'
loaded  24 ( 18 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_llt_CL.conf'
Adjust LGS range by telescope altitude 4145m.
Zenith angle is 30 degree.
    Scaling turbulence height and LGS hs by sec(za).
    Scaling r0 by cos(za)^(3/5).
    Scaling wind speed and LGS signal level by cos(za).
powfs0: Adjusting dx from 0.0078125 to 0.007875. 
powfs0.llt.fsm: f0=0 Hz, LPF ep=0
powfs0.epfsm is set to 0.517618 (auto)
powfs2: Adjusting dx from 0.03125 to 0.0312778. 
powfs2 is TWFS for powfs0
sim.ephi is set to 0.427717 (auto)
sim.eplo is set to 0.427717 (auto)
Warning(parms.c:2296): Layer 1 at 17.3205m is very close to layer 0 at 0m (OK).
Warning(parms.c:2296): Layer 2 at 34.641m is very close to layer 1 at 17.3205m (OK).
Warning(parms.c:2296): Layer 3 at 51.9615m is very close to layer 2 at 34.641m (OK).
dm 0: stroke=30 um is provided in micron.
dm 0: assume ia stroke=2 um is provided in micron.
dm 1: stroke=7 um is provided in micron.
dm 1: assume ia stroke=2 um is provided in micron.
dm 2: stroke=7 um is provided in micron.
dm 2: assume ia stroke=2 um is provided in micron.
Focus blending is not implemented yet for integrated tomography
parms->sim.mffocus is reset to 0
There are 1 valid simulation seeds:  1
Output PSF for 1 directions
Used 449 of 456 supplied keys
Warning(readcfg.c:158): key "dbg.pwfs_flate" is not recognized, value is 0
Warning(readcfg.c:158): key "dbg.pwfs_flatv" is not recognized, value is 0
Warning(readcfg.c:158): key "dbg.pwfs_psx" is not recognized, value is [0 0 0 0]
Warning(readcfg.c:158): key "dbg.pwfs_psy" is not recognized, value is [0 0 0 0]
Warning(readcfg.c:158): key "dbg.pwfs_pupelong" is not recognized, value is 0
Warning(readcfg.c:158): key "dbg.pwfs_raw" is not recognized, value is 0
Warning(readcfg.c:158): key "dbg.pwfs_side" is not recognized, value is 4
[00;00mAperture[00;00m is 11 m with sampling 1/128 m
[00;00mTurbulence at 30 degree zenith angle:[00;00m r0=0.128424m, L0=30m, 14 layers.
    Greenwood freq is 25.1Hz, anisoplanatic angle is 1.58 as
    Sampled 8192x8192 at 1/128m. wind dir is randomized.
    layer 0: ht=      0 m, wt= 0.302, ws=  4.8 m/s
    layer 1: ht=     17 m, wt= 0.154, ws=  5.0 m/s
    layer 2: ht=     35 m, wt= 0.041, ws=  5.4 m/s
    layer 3: ht=     52 m, wt= 0.002, ws=  6.6 m/s
    layer 4: ht=    139 m, wt= 0.021, ws=  6.1 m/s
    layer 5: ht=    231 m, wt= 0.010, ws=  6.1 m/s
    layer 6: ht=    323 m, wt= 0.008, ws=  6.1 m/s
    layer 7: ht=    416 m, wt= 0.005, ws=  6.1 m/s
    layer 8: ht=    508 m, wt= 0.001, ws=  6.1 m/s
    layer 9: ht=    932 m, wt= 0.107, ws=  5.6 m/s
    layer 10: ht=   5022 m, wt= 0.144, ws= 11.1 m/s
    layer 11: ht=   9238 m, wt= 0.093, ws= 19.1 m/s
    layer 12: ht=  13856 m, wt= 0.075, ws=  8.2 m/s
    layer 13: ht=  22518 m, wt= 0.036, ws=  4.8 m/s
[00;00mReconstruction[00;00m: r0=0.128424m L0=30m. 14 layers. use cone coordinate.
    layer 0: ht=      0 m, wt= 0.302
    layer 1: ht=     17 m, wt= 0.154
    layer 2: ht=     35 m, wt= 0.041
    layer 3: ht=     52 m, wt= 0.002
    layer 4: ht=    139 m, wt= 0.021
    layer 5: ht=    231 m, wt= 0.010
    layer 6: ht=    323 m, wt= 0.008
    layer 7: ht=    416 m, wt= 0.005
    layer 8: ht=    508 m, wt= 0.001
    layer 9: ht=    932 m, wt= 0.107
    layer 10: ht=   5022 m, wt= 0.144
    layer 11: ht=   9238 m, wt= 0.093
    layer 12: ht=  13856 m, wt= 0.075
    layer 13: ht=  22518 m, wt= 0.036
[00;00mThere are 3 powfs[00;00m
  powfs0: Order 44, LGS at 99.1 km. Sampling 1/126.984 m. Thres 30%. [00;00mT/T is removed in right hand side in tomography.[00;00m
    CCD image is 25x25 @ 500x500 mas, blur 27% (sigma), 1500Hz, wvl: [ 5.89e-07]
    Gtilt in reconstruction. Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
  powfs1: Order  2, NGS at inf km. Sampling 1/16 m. Thres 30%. 
    Ztilt in reconstruction. Geomtric optics start at 2 with ztilt [00;00m(noisy)[00;00m
  powfs2: Order 20, NGS at inf km. Sampling 1/31.9716 m. Thres 50%. 
    CCD image is 4x4 @ 1500x1500 mas, blur 0% (sigma), 0.015Hz, wvl: [ 7.2e-07]
    Gtilt in reconstruction. Geomtric optics start at 50 with gtilt Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
[00;00mThere are 13 wfs[00;00m
    wfs 0: type 0, at (  30.00,    0.00) arcsec,  99 km, siglev is 76.1436 bkgrnd is 0.1
    wfs 1: type 0, at (  22.98,   19.28) arcsec,  99 km, siglev is 76.1436 bkgrnd is 0.1
    wfs 2: type 0, at (   5.21,   29.54) arcsec,  99 km, siglev is 76.1436 bkgrnd is 0.1
    wfs 3: type 0, at ( -15.00,   25.98) arcsec,  99 km, siglev is 76.1436 bkgrnd is 0.1
    wfs 4: type 0, at ( -28.19,   10.26) arcsec,  99 km, siglev is 76.1436 bkgrnd is 0.1
    wfs 5: type 0, at ( -28.19,  -10.26) arcsec,  99 km, siglev is 76.1436 bkgrnd is 0.1
    wfs 6: type 0, at ( -15.00,  -25.98) arcsec,  99 km, siglev is 76.1436 bkgrnd is 0.1
    wfs 7: type 0, at (   5.21,  -29.54) arcsec,  99 km, siglev is 76.1436 bkgrnd is 0.1
    wfs 8: type 0, at (  22.98,  -19.28) arcsec,  99 km, siglev is 76.1436 bkgrnd is 0.1
    wfs 9: type 1, at (   5.00,    8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 10: type 1, at ( -10.00,    0.00) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 11: type 1, at (   5.00,   -8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 12: type 2, at (   0.00,    0.00) arcsec, inf km, siglev is 4.1558e+06 bkgrnd is 0.001
[00;00mThere are 3 DMs[00;00m
  DM 0 at -0.1km, actuator pitch 0.252m, offset   0, with 30.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 1 at    6km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 2 at   10km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
[00;00mTomography[00;00m is using CG, with [00;00mFourer Domain[00;00m preconditioner, [00;00m12[00;00m iterations, integrated tomo.
[00;00mDM Fitting [00;00mis using CG, with [00;00mNo[00;00m preconditioner, [00;00m10[00;00m iterations
[00;00mThere are 9 fit directions[00;00m
    Fit 0: weight is 0.444, at (   0.00,    0.00) arcsec
    Fit 1: weight is 0.111, at (  15.00,    0.00) arcsec
    Fit 2: weight is 0.111, at (   0.00,   15.00) arcsec
    Fit 3: weight is 0.111, at ( -15.00,    0.00) arcsec
    Fit 4: weight is 0.111, at (   0.00,  -15.00) arcsec
    Fit 5: weight is 0.028, at (  15.00,   15.00) arcsec
    Fit 6: weight is 0.028, at ( -15.00,   15.00) arcsec
    Fit 7: weight is 0.028, at ( -15.00,  -15.00) arcsec
    Fit 8: weight is 0.028, at (  15.00,  -15.00) arcsec
[00;00mThere are 1 evaluation directions[00;00m at sampling 1/128 m.
    Evl 0: weight is 1.000, at (   0.00,    0.00) arcsec
[00;00mSimulation[00;00m start at step 0, end at step 1600, with time step 1/1500s, [00;00mclose loop[00;00m.
After setup_parms:	120.5 MiB.
Warning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
CUDA: minimum memory requirement is 0.3GB
GPU 0 is NVIDIA A100-SXM4-40GB with arch 8.0, 38.9GB free, 39.3GB total device memory.
Using GPU 0
Use 1 GPUs for WFS Tomo Fit Evl

*** Preparation started at 2025/02/17 14:47:56 in nid001972. ***

Using OpenMP version 201511 with 128 threads
Reading aperture amplitude map from KECK.fits
Warning(accphi.c:477): 108520 points not covered by input screen
Warning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
 ->maos.c:447->setup.c:148->aper.c:74->utils.c:478->accphi.c:478
iwvl 0: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 1: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 2: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 3: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 4: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 5: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 6: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 7: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 8: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
After setup_aper:	344.7 MiB.

[00;00mSetting up powfs 0 geom[00;00m

There are 32 points in each subaperture of 0.252m.
There are 1201 valid subaperture.

[00;00mSetting up powfs 1 geom[00;00m

There are 88 points in each subaperture of 5.5m.
There are 4 valid subaperture.

[00;00mSetting up powfs 2 geom[00;00m

There are 18 points in each subaperture of 0.563m.
There are 236 valid subaperture.
After setup_powfs_init:	425.5 MiB.

[00;00mSetting up reconstructor geometry.[00;00m

PLOC is 91x91, with sampling of 0.13m (square)
    DM 0: grid is 47 x 47
    DM 1: grid is 75 x 75
    DM 2: grid is 80 x 79
FLOC is 91x91, with sampling of 0.13m (not square)
Tomography grid is square:
    layer 0: xloc grid is 160 x 160, sampling is 0.126 m, 25600 points
    layer 1: xloc grid is 160 x 160, sampling is 0.126 m, 25600 points
    layer 2: xloc grid is 160 x 160, sampling is 0.126 m, 25600 points
    layer 3: xloc grid is 160 x 160, sampling is 0.126 m, 25600 points
    layer 4: xloc grid is 160 x 160, sampling is 0.126 m, 25600 points
    layer 5: xloc grid is 160 x 160, sampling is 0.126 m, 25600 points
    layer 6: xloc grid is 160 x 160, sampling is 0.126 m, 25600 points
    layer 7: xloc grid is 160 x 160, sampling is 0.125 m, 25600 points
    layer 8: xloc grid is 160 x 160, sampling is 0.125 m, 25600 points
    layer 9: xloc grid is 160 x 160, sampling is 0.125 m, 25600 points
    layer 10: xloc grid is 160 x 160, sampling is 0.120 m, 25600 points
    layer 11: xloc grid is 160 x 160, sampling is 0.114 m, 25600 points
    layer 12: xloc grid is 160 x 160, sampling is 0.108 m, 25600 points
    layer 13: xloc grid is 160 x 160, sampling is 0.097 m, 25600 points

[00;00mSetting up powfs 0 PO WFS[00;00m

OTF dimension is 64x64 (calculated)
Uplink FWHM (illt 0, iwvl 0) is 0.579373"
Downlink FWHM (illt 0, iwvl 0) is 1.12518"
Generating matched filter for powfs 0
sa index   location       noise equivalent angle
     598: (  4.8,  -0.3) m, ( 74.61,  72.44) mas
     594: (  3.8,  -0.3) m, ( 78.78,  72.92) mas
     590: (  2.8,  -0.3) m, ( 84.75,  73.49) mas
     585: (  1.5,  -0.3) m, ( 93.98,  74.26) mas
     584: (  1.3,  -0.3) m, ( 95.72,  74.40) mas
     411: ( -0.5,  -1.5) m, (109.99,  76.32) mas
     582: ( -1.8,  -0.3) m, (120.72,  76.18) mas
     578: ( -2.8,  -0.3) m, (129.71,  76.76) mas
     573: ( -4.0,  -0.3) m, (141.30,  77.44) mas
     569: ( -5.0,  -0.3) m, (150.67,  77.97) mas
     568: ( -5.3,  -0.3) m, (153.21,  78.10) mas
sa index   location       noise equivalent angle
     945: (  2.8,   2.3) m, ( 76.63,  75.43) mas
     911: (  2.5,   2.0) m, ( 80.46,  79.11) mas
     758: (  1.3,   1.0) m, ( 84.88,  81.34) mas
     721: (  1.0,   0.8) m, ( 86.38,  82.68) mas
     718: ( -1.3,   0.8) m, (103.36,  83.14) mas
     480: ( -1.3,  -1.0) m, (102.99,  94.58) mas
     445: ( -1.5,  -1.3) m, (104.90,  96.34) mas
     258: ( -3.0,  -2.5) m, (117.29, 105.81) mas
     225: ( -3.3,  -2.8) m, (119.43, 107.84) mas
      27: ( -3.0,  -4.5) m, (116.96, 122.80) mas
sa index   location       noise equivalent angle
    1115: (  0.5,   3.8) m, ( 72.99,  78.06) mas
    1089: (  0.5,   3.5) m, ( 73.13,  79.43) mas
     902: (  0.3,   2.0) m, ( 75.50,  90.59) mas
     791: (  0.0,   1.3) m, ( 75.70,  95.84) mas
     583: ( -1.5,  -0.3) m, ( 79.42, 106.47) mas
     373: ( -0.5,  -1.8) m, ( 76.99, 119.61) mas
     301: ( -0.5,  -2.3) m, ( 78.77, 126.48) mas
     114: ( -0.8,  -3.8) m, ( 78.36, 137.79) mas
      13: ( -1.0,  -4.8) m, ( 79.39, 147.18) mas
       8: ( -2.5,  -4.8) m, ( 85.66, 147.06) mas
sa index   location       noise equivalent angle
    1179: ( -2.8,   4.5) m, ( 75.57,  76.34) mas
    1129: ( -2.5,   4.0) m, ( 73.05,  74.38) mas
     928: ( -1.5,   2.3) m, ( 75.99,  82.36) mas
     861: ( -1.3,   1.8) m, ( 77.44,  86.03) mas
     788: ( -0.8,   1.3) m, ( 79.32,  89.24) mas
     653: (  1.3,   0.3) m, ( 91.74,  96.41) mas
     416: (  0.8,  -1.5) m, ( 88.39, 110.61) mas
     275: (  1.3,  -2.5) m, ( 91.84, 119.31) mas
     212: (  1.5,  -3.0) m, ( 93.59, 123.65) mas
      74: (  2.3,  -4.3) m, ( 98.90, 134.68) mas
      24: (  2.5,  -4.8) m, (105.00, 145.29) mas
sa index   location       noise equivalent angle
     775: ( -4.0,   1.3) m, ( 76.91,  73.25) mas
     742: ( -3.3,   1.0) m, ( 80.63,  73.94) mas
     713: ( -2.5,   0.8) m, ( 85.53,  74.77) mas
     651: ( -1.5,   0.3) m, ( 92.62,  76.43) mas
     412: ( -0.3,  -1.5) m, (106.49,  88.37) mas
     550: (  1.3,  -0.5) m, (115.19,  80.18) mas
     488: (  2.3,  -1.0) m, (123.78,  82.81) mas
     459: (  3.0,  -1.3) m, (130.51,  84.32) mas
     428: (  3.8,  -1.5) m, (137.41,  85.88) mas
     565: (  5.0,  -0.5) m, (149.57,  81.51) mas
sa index   location       noise equivalent angle
     397: ( -4.0,  -1.5) m, ( 76.91,  73.25) mas
     438: ( -3.3,  -1.3) m, ( 80.63,  73.94) mas
     475: ( -2.5,  -1.0) m, ( 85.53,  74.77) mas
     548: ( -1.5,  -0.5) m, ( 92.62,  76.43) mas
     790: ( -0.3,   1.3) m, (106.49,  88.37) mas
     653: (  1.3,   0.3) m, (115.19,  80.18) mas
     726: (  2.3,   0.8) m, (123.78,  82.81) mas
     765: (  3.0,   1.0) m, (130.51,  84.32) mas
     806: (  3.8,   1.3) m, (137.41,  85.88) mas
     668: (  5.0,   0.3) m, (149.57,  81.51) mas
sa index   location       noise equivalent angle
       7: ( -2.8,  -4.8) m, ( 74.59,  75.31) mas
      55: ( -2.5,  -4.3) m, ( 73.05,  74.38) mas
     264: ( -1.5,  -2.5) m, ( 75.99,  82.36) mas
     333: ( -1.3,  -2.0) m, ( 77.21,  85.90) mas
     410: ( -0.8,  -1.5) m, ( 79.32,  89.24) mas
     550: (  1.3,  -0.5) m, ( 91.74,  96.41) mas
     794: (  0.8,   1.3) m, ( 88.39, 110.61) mas
     939: (  1.3,   2.3) m, ( 91.84, 119.31) mas
    1004: (  1.5,   2.8) m, ( 93.59, 123.65) mas
    1148: (  2.3,   4.0) m, ( 98.90, 134.68) mas
    1194: (  2.5,   4.5) m, (106.61, 147.55) mas
sa index   location       noise equivalent angle
      93: (  0.5,  -4.0) m, ( 72.99,  78.06) mas
     119: (  0.5,  -3.8) m, ( 73.13,  79.43) mas
     304: (  0.3,  -2.3) m, ( 75.75,  90.91) mas
     413: (  0.0,  -1.5) m, ( 75.70,  95.84) mas
     617: ( -1.5,   0.0) m, ( 79.42, 106.47) mas
     827: ( -0.5,   1.5) m, ( 76.99, 119.61) mas
     899: ( -0.5,   2.0) m, ( 78.51, 125.97) mas
    1084: ( -0.8,   3.5) m, ( 78.36, 137.79) mas
    1184: ( -1.0,   4.5) m, ( 79.39, 147.18) mas
    1180: ( -2.5,   4.5) m, ( 85.66, 147.06) mas
sa index   location       noise equivalent angle
     281: (  2.8,  -2.5) m, ( 76.63,  75.43) mas
     313: (  2.5,  -2.3) m, ( 80.58,  79.45) mas
     452: (  1.3,  -1.3) m, ( 84.88,  81.34) mas
     483: (  1.0,  -1.0) m, ( 86.38,  82.68) mas
     480: ( -1.3,  -1.0) m, (103.36,  83.14) mas
     718: ( -1.3,   0.8) m, (102.99,  94.58) mas
     749: ( -1.5,   1.0) m, (104.90,  96.34) mas
     922: ( -3.0,   2.3) m, (117.29, 105.81) mas
     953: ( -3.3,   2.5) m, (119.43, 107.84) mas
    1153: ( -3.0,   4.3) m, (116.96, 122.80) mas

[00;00mSetting up powfs 2 PO WFS[00;00m

OTF dimension is 48x48 (calculated)
Generating matched filter for powfs 2
Use sanea to derive neasim
Use sanea to derive neasim

[00;00mSetting up reconstructor[00;00m

Recon NEA: cmf(97.26) cmf(97.07) cmf(97.02) cmf(97.18) cmf(97.17) cmf(97.18) cmf(97.21) cmf(97.06) cmf(97.10) geom(0.31) geom(0.31) geom(0.31) mf(0.14)  mas
Setup or update control matrix parameters.
RRtwfs svd threshold is 1e-10
Replacing HA by HA*fit->actextrap
Adding piston cr to fit matrix
Adding TT cr on upper DMs to fit matrix.
Before assembling fit matrix:	3150.4 MiB.
Building fit->FR
Building fit->FL
Adding tikhonov constraint of 1.0e-07 to FLM
The maximum eigen value is estimated to be around 3.4e-04
DM Fit number of Low rank terms: 16 in LHS
After assemble fit matrix:	3927.0 MiB.
After setup_recon:	3927.0 MiB.
GPU 0: mem used 1880 MB (wfs init)
GPU 0: mem used 2364 MB (recon init)
GPU 0: mem used 2394 MB (perf init)

*** Simulation started at 2025/02/17 14:48:38 in nid001972. ***

Running seed 1
GPU 0: mem used 2394 MB (wfs seeding)
Wind dir: 267.3 261.7 167.0 130.5 300.7  32.3 119.8 139.0 150.8 277.7 203.0 133.1  45.9 265.1 deg
Using /global/homes/b/bpeck/.aos/cache/atm/vonkarman_14_8192x8192_0.0078125_1115374592d.bin
After genatm:	3890.0 MiB.
Step     #  Open Loop  PR TT  On axis  PR TT  Field RMS PR TT     Timing 
Step     0: OL  884.6  248.3  OA  884.6 248.3 CL  884.6 248.3 nm  0.169 s
Step    26: OL  925.8  257.6  OA  105.7  17.6 CL  105.7  17.6 nm  0.044 s
Step    48: OL  959.5  261.0  OA  107.5  14.7 CL  107.5  14.7 nm  0.043 s
Step    71: OL  993.8  259.6  OA  107.0  12.2 CL  107.0  12.2 nm  0.045 s
Step    94: OL 1028.7  257.6  OA  107.4  14.4 CL  107.4  14.4 nm  0.043 s
Step   117: OL 1063.6  258.0  OA  104.5   7.6 CL  104.5   7.6 nm  0.046 s
Step   140: OL 1095.8  263.2  OA  105.1  21.5 CL  105.1  21.5 nm  0.044 s
Step   162: OL 1122.0  273.1  OA  102.8   9.6 CL  102.8   9.6 nm  0.043 s
Step   185: OL 1142.4  287.1  OA  105.2  19.1 CL  105.2  19.1 nm  0.052 s
Step   208: OL 1154.9  301.9  OA  104.6  11.3 CL  104.6  11.3 nm  0.042 s
Step   231: OL 1160.6  316.7  OA  102.1  12.5 CL  102.1  12.5 nm  0.045 s
Step   253: OL 1158.5  332.0  OA  100.5   7.8 CL  100.5   7.8 nm  0.043 s
Step   255 updated high order loop gain: 0.377
Step   275: OL 1145.6  347.9  OA  102.0   8.9 CL  102.0   8.9 nm  0.049 s
Step   293: OL 1129.3  362.0  OA  103.2  14.9 CL  103.2  14.9 nm  0.043 s
Step   316: OL 1104.5  382.8  OA  103.8  16.5 CL  103.8  16.5 nm  0.044 s
Step   338: OL 1077.2  406.2  OA  100.7  11.4 CL  100.7  11.4 nm  0.041 s
Step   361: OL 1048.7  435.9  OA  103.4  11.1 CL  103.4  11.1 nm  0.043 s
Step   383: OL 1024.0  467.4  OA  104.9  11.2 CL  104.9  11.2 nm  0.044 s
Step   406: OL 1000.0  500.5  OA  107.2   5.0 CL  107.2   5.0 nm  0.043 s
Step   429: OL  974.7  531.7  OA  103.8   9.2 CL  103.8   9.2 nm  0.044 s
Step   452: OL  951.3  561.7  OA  105.1  18.5 CL  105.1  18.5 nm  0.051 s
Step   475: OL  937.0  591.7  OA  105.6  20.0 CL  105.6  20.0 nm  0.044 s
Step   498: OL  934.0  620.0  OA  106.3  19.3 CL  106.3  19.3 nm  0.051 s
Step   511 updated high order loop gain: 0.357
Step   521: OL  938.0  644.1  OA  105.8  12.2 CL  105.8  12.2 nm  0.044 s
Step   544: OL  947.9  660.4  OA  105.0  14.3 CL  105.0  14.3 nm  0.051 s
Step   567: OL  964.4  668.7  OA  105.1  11.4 CL  105.1  11.4 nm  0.043 s
Step   588: OL  984.0  670.8  OA  104.5   9.1 CL  104.5   9.1 nm  0.044 s
Step   610: OL 1007.8  665.8  OA  106.4  12.9 CL  106.4  12.9 nm  0.052 s
Step   632: OL 1032.6  653.4  OA  105.0  20.9 CL  105.0  20.9 nm  0.042 s
Step   655: OL 1056.0  634.1  OA  104.2   2.5 CL  104.2   2.5 nm  0.043 s
Step   677: OL 1075.2  611.7  OA  106.3   6.5 CL  106.3   6.5 nm  0.052 s
Step   699: OL 1091.9  588.1  OA  106.5   4.7 CL  106.5   4.7 nm  0.044 s
Step   720: OL 1102.1  562.7  OA  106.5   9.9 CL  106.5   9.9 nm  0.051 s
Step   743: OL 1104.4  534.3  OA  104.7  10.8 CL  104.7  10.8 nm  0.042 s
Step   766: OL 1097.7  506.9  OA  106.3  15.8 CL  106.3  15.8 nm  0.044 s
Step   767 updated high order loop gain: 0.350
Step   789: OL 1081.5  481.0  OA  105.2   3.7 CL  105.2   3.7 nm  0.044 s
Step   812: OL 1056.7  455.3  OA  104.9   1.3 CL  104.9   1.3 nm  0.042 s
Step   835: OL 1024.8  430.0  OA  105.0   5.9 CL  105.0   5.9 nm  0.047 s
Step   858: OL  988.8  407.0  OA  105.7   6.2 CL  105.7   6.2 nm  0.042 s
Step   880: OL  955.1  388.6  OA  104.6   8.6 CL  104.6   8.6 nm  0.044 s
Step   902: OL  922.0  373.8  OA  101.3   5.7 CL  101.3   5.7 nm  0.045 s
Step   925: OL  885.4  362.1  OA  105.2  11.3 CL  105.2  11.3 nm  0.052 s
Step   948: OL  850.3  351.2  OA  108.1   9.3 CL  108.1   9.3 nm  0.043 s
Step   971: OL  819.8  338.9  OA  104.3   7.4 CL  104.3   7.4 nm  0.044 s
Step   993: OL  797.0  324.7  OA  102.2   7.8 CL  102.2   7.8 nm  0.052 s
Step  1014: OL  778.6  309.1  OA  107.8  17.4 CL  107.8  17.4 nm  0.042 s
Step  1023 updated high order loop gain: 0.346
Step  1036: OL  763.7  291.7  OA  109.3  21.5 CL  109.3  21.5 nm  0.056 s
Step  1059: OL  750.7  271.1  OA  106.9  16.2 CL  106.9  16.2 nm  0.054 s
Step  1082: OL  741.1  246.0  OA  105.6   8.8 CL  105.6   8.8 nm  0.042 s
Step  1104: OL  737.6  221.2  OA  106.5  17.2 CL  106.5  17.2 nm  0.043 s
Step  1127: OL  737.6  199.4  OA  106.7  27.4 CL  106.7  27.4 nm  0.042 s
Step  1150: OL  739.0  183.4  OA  105.8  19.3 CL  105.8  19.3 nm  0.042 s
Step  1173: OL  740.3  173.4  OA  103.6  20.2 CL  103.6  20.2 nm  0.052 s
Step  1195: OL  744.1  168.2  OA  107.1  26.0 CL  107.1  26.0 nm  0.044 s
Step  1217: OL  748.7  164.5  OA  105.3  23.5 CL  105.3  23.5 nm  0.045 s
Step  1239: OL  752.0  164.3  OA  105.1  17.5 CL  105.1  17.5 nm  0.043 s
Step  1262: OL  754.9  170.4  OA  104.1  15.9 CL  104.1  15.9 nm  0.049 s
Step  1279 updated high order loop gain: 0.339
Step  1285: OL  759.6  182.2  OA  103.4  19.2 CL  103.4  19.2 nm  0.043 s
Step  1307: OL  766.2  196.9  OA  107.1  16.9 CL  107.1  16.9 nm  0.044 s
Step  1329: OL  772.5  214.5  OA  103.0  13.4 CL  103.0  13.4 nm  0.052 s
Step  1350: OL  781.5  233.5  OA  102.3  19.8 CL  102.3  19.8 nm  0.043 s
Step  1367: OL  792.0  247.8  OA  106.8  34.8 CL  106.8  34.8 nm  0.043 s
Step  1389: OL  808.5  261.4  OA  102.4  17.3 CL  102.4  17.3 nm  0.048 s
Step  1412: OL  829.8  270.5  OA  103.1  10.3 CL  103.1  10.3 nm  0.043 s
Step  1435: OL  852.7  276.0  OA  103.1  20.3 CL  103.1  20.3 nm  0.044 s
Step  1457: OL  873.2  279.3  OA  105.5  15.1 CL  105.5  15.1 nm  0.050 s
Step  1480: OL  888.9  278.3  OA  102.8   9.6 CL  102.8   9.6 nm  0.042 s
Step  1503: OL  893.8  271.7  OA  101.1   8.3 CL  101.1   8.3 nm  0.043 s
Step  1526: OL  890.8  261.0  OA   99.1   7.8 CL   99.1   7.8 nm  0.054 s
Step  1535 updated high order loop gain: 0.340
Step  1548: OL  881.9  247.3  OA  100.8   8.8 CL  100.8   8.8 nm  0.042 s
Step  1563: OL  875.0  237.4  OA  102.4  13.3 CL  102.4  13.3 nm  0.044 s
Step  1586: OL  862.3  224.8  OA  105.8  15.7 CL  105.8  15.7 nm  0.043 s
Step 1599: Output PSF
Step  1599: OL  854.0  219.3  OA  106.9  19.3 CL  106.9  19.3 nm  2.043 s
Mean: 105.10 15.76 103.92  nm.

*** Simulation Finished at 2025/02/17 14:50:02 in nid001972. ***

