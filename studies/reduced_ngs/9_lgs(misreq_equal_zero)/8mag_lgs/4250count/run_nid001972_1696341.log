Warning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
/global/cfs/cdirs/ulens/vismcao/maos -o studies/reduced_ngs/9_lgs/8mag_lgs/4250count -c master_files/reduced_ngs/9_lgs/8mag_lgs/kola_4250act.conf -O 
Output folder is 'studies/reduced_ngs/9_lgs/8mag_lgs/4250count'.
SRC: /global/homes/b/bpeck/code/maos v2.9 4c88b7c2 2024-11-13 16:45:33 -0800
BUILT: /global/homes/b/bpeck/code/maos/optim by GCC (v12) on 2024/11/18 09:40:03 CPU(F64,+O3) with CUDA(v122,F32)
Launched at 2025/02/17 15:21:38 in nid001972 with PID 1696341.
The web based job monitor can be accessed at http://localhost:10300
Main config file is /global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_4250act.conf
Warning(path.c:48): Path not found: path=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; abspath=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; Ignored.
Warning(path.c:48): Path not found: path=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; abspath=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; Ignored.
Warning(readcfg.c:399): sim.apfsm has been renamed to powfs.apfsm.
Warning(readcfg.c:399): sim.epfsm has been renamed to powfs.epfsm.
Warning(readcfg.c:399): sim.alfsm has been renamed to powfs.alfsm.
Warning(readcfg.c:399): sim.commonfsm has been renamed to powfs.commonfsm.
Warning(readcfg.c:399): sim.idealfsm has been renamed to powfs.idealfsm.
Warning(readcfg.c:399): sim.zetafsm has been renamed to powfs.zetafsm.
Warning(readcfg.c:399): sim.f0fsm has been renamed to powfs.f0fsm.
Warning(readcfg.c:399): tsurf has been renamed to ncpa.tsurf.
loaded 132 (132 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_sim.conf'
loaded  19 ( 19 new) records from '/global/cfs/cdirs/ulens/vismcao/./dm_none.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_ASM.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_DM2.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_DM3.conf'
loaded   0 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_dm_multiple.conf'
loaded   7 (  5 new) records from '/global/cfs/cdirs/ulens/vismcao/./atm_mk13n50p_ground_detail.conf'
loaded  76 ( 69 new) records from '/global/homes/b/bpeck/code/maos/config/maos/powfs_common.conf'
loaded  44 ( 38 new) records from '/global/cfs/cdirs/ulens/vismcao/./powfs_none.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_lgs.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_ttf_strap.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_twfs_lbwfs.conf'
loaded   0 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_wfs_lgs_strap_lbwfs.conf'
loaded  71 ( 71 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_recon.conf'
Warning(readcfg.c:399): dbg.na_smooth has been renamed to powfs0_llt.na_smooth.
Warning(readcfg.c:399): dbg.na_interp has been renamed to powfs0_llt.na_interp.
Warning(readcfg.c:399): dbg.na_thres has been renamed to powfs0_llt.na_thres.
Warning(readcfg.c:399): dbg.na_fit_maxit has been renamed to powfs0_llt.na_fit_maxit.
Warning(readcfg.c:399): dbg.na_fit_svdthres has been renamed to powfs0_llt.na_fit_svdthres.
Warning(readcfg.c:399): dbg.na_fit_dh has been renamed to powfs0_llt.na_fit_dh.
Warning(readcfg.c:399): dbg.ncpa_preload has been renamed to ncpa.preload.
Warning(readcfg.c:399): dbg.ncpa_rmsci has been renamed to ncpa.rmsci.
Warning(readcfg.c:399): dbg.draw_opdmax has been renamed to plot.opdmax.
Warning(readcfg.c:399): dbg.draw_gmax has been renamed to plot.gmax.
loaded  95 ( 93 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_dbg.conf'
loaded   4 (  4 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_fit_mcao.conf'
Warning(readcfg.c:399): surf has been renamed to ncpa.surf.
loaded  39 (  7 new) records from '/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_4250act.conf'
loaded   0 (  0 new) records from 'command line'
loaded  24 ( 18 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_llt_CL.conf'
Adjust LGS range by telescope altitude 4145m.
Zenith angle is 30 degree.
    Scaling turbulence height and LGS hs by sec(za).
    Scaling r0 by cos(za)^(3/5).
    Scaling wind speed and LGS signal level by cos(za).
powfs0: Adjusting dx from 0.0078125 to 0.0075. 
powfs0.llt.fsm: f0=0 Hz, LPF ep=0
powfs0.epfsm is set to 0.517618 (auto)
powfs2: Adjusting dx from 0.03125 to 0.0312778. 
powfs2 is TWFS for powfs0
sim.ephi is set to 0.427717 (auto)
sim.eplo is set to 0.427717 (auto)
Warning(parms.c:2296): Layer 1 at 17.3205m is very close to layer 0 at 0m (OK).
Warning(parms.c:2296): Layer 2 at 34.641m is very close to layer 1 at 17.3205m (OK).
Warning(parms.c:2296): Layer 3 at 51.9615m is very close to layer 2 at 34.641m (OK).
dm 0: stroke=30 um is provided in micron.
dm 0: assume ia stroke=2 um is provided in micron.
dm 1: stroke=7 um is provided in micron.
dm 1: assume ia stroke=2 um is provided in micron.
dm 2: stroke=7 um is provided in micron.
dm 2: assume ia stroke=2 um is provided in micron.
Focus blending is not implemented yet for integrated tomography
parms->sim.mffocus is reset to 0
There are 1 valid simulation seeds:  1
Output PSF for 1 directions
Used 449 of 456 supplied keys
Warning(readcfg.c:158): key "dbg.pwfs_flate" is not recognized, value is 0
Warning(readcfg.c:158): key "dbg.pwfs_flatv" is not recognized, value is 0
Warning(readcfg.c:158): key "dbg.pwfs_psx" is not recognized, value is [0 0 0 0]
Warning(readcfg.c:158): key "dbg.pwfs_psy" is not recognized, value is [0 0 0 0]
Warning(readcfg.c:158): key "dbg.pwfs_pupelong" is not recognized, value is 0
Warning(readcfg.c:158): key "dbg.pwfs_raw" is not recognized, value is 0
Warning(readcfg.c:158): key "dbg.pwfs_side" is not recognized, value is 4
[00;00mAperture[00;00m is 11 m with sampling 1/128 m
[00;00mTurbulence at 30 degree zenith angle:[00;00m r0=0.128424m, L0=30m, 14 layers.
    Greenwood freq is 25.1Hz, anisoplanatic angle is 1.58 as
    Sampled 8192x8192 at 1/128m. wind dir is randomized.
    layer 0: ht=      0 m, wt= 0.302, ws=  4.8 m/s
    layer 1: ht=     17 m, wt= 0.154, ws=  5.0 m/s
    layer 2: ht=     35 m, wt= 0.041, ws=  5.4 m/s
    layer 3: ht=     52 m, wt= 0.002, ws=  6.6 m/s
    layer 4: ht=    139 m, wt= 0.021, ws=  6.1 m/s
    layer 5: ht=    231 m, wt= 0.010, ws=  6.1 m/s
    layer 6: ht=    323 m, wt= 0.008, ws=  6.1 m/s
    layer 7: ht=    416 m, wt= 0.005, ws=  6.1 m/s
    layer 8: ht=    508 m, wt= 0.001, ws=  6.1 m/s
    layer 9: ht=    932 m, wt= 0.107, ws=  5.6 m/s
    layer 10: ht=   5022 m, wt= 0.144, ws= 11.1 m/s
    layer 11: ht=   9238 m, wt= 0.093, ws= 19.1 m/s
    layer 12: ht=  13856 m, wt= 0.075, ws=  8.2 m/s
    layer 13: ht=  22518 m, wt= 0.036, ws=  4.8 m/s
[00;00mReconstruction[00;00m: r0=0.128424m L0=30m. 14 layers. use cone coordinate.
    layer 0: ht=      0 m, wt= 0.302
    layer 1: ht=     17 m, wt= 0.154
    layer 2: ht=     35 m, wt= 0.041
    layer 3: ht=     52 m, wt= 0.002
    layer 4: ht=    139 m, wt= 0.021
    layer 5: ht=    231 m, wt= 0.010
    layer 6: ht=    323 m, wt= 0.008
    layer 7: ht=    416 m, wt= 0.005
    layer 8: ht=    508 m, wt= 0.001
    layer 9: ht=    932 m, wt= 0.107
    layer 10: ht=   5022 m, wt= 0.144
    layer 11: ht=   9238 m, wt= 0.093
    layer 12: ht=  13856 m, wt= 0.075
    layer 13: ht=  22518 m, wt= 0.036
[00;00mThere are 3 powfs[00;00m
  powfs0: Order 74, LGS at 99.1 km. Sampling 1/133.333 m. Thres 30%. [00;00mT/T is removed in right hand side in tomography.[00;00m
    CCD image is 25x25 @ 500x500 mas, blur 27% (sigma), 1500Hz, wvl: [ 5.89e-07]
    Gtilt in reconstruction. Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
  powfs1: Order  2, NGS at inf km. Sampling 1/16 m. Thres 30%. 
    Ztilt in reconstruction. Geomtric optics start at 2 with ztilt [00;00m(noisy)[00;00m
  powfs2: Order 20, NGS at inf km. Sampling 1/31.9716 m. Thres 50%. 
    CCD image is 4x4 @ 1500x1500 mas, blur 0% (sigma), 0.015Hz, wvl: [ 7.2e-07]
    Gtilt in reconstruction. Geomtric optics start at 50 with gtilt Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
[00;00mThere are 13 wfs[00;00m
    wfs 0: type 0, at (  30.00,    0.00) arcsec,  99 km, siglev is 26.9784 bkgrnd is 0.1
    wfs 1: type 0, at (  22.98,   19.28) arcsec,  99 km, siglev is 26.9784 bkgrnd is 0.1
    wfs 2: type 0, at (   5.21,   29.54) arcsec,  99 km, siglev is 26.9784 bkgrnd is 0.1
    wfs 3: type 0, at ( -15.00,   25.98) arcsec,  99 km, siglev is 26.9784 bkgrnd is 0.1
    wfs 4: type 0, at ( -28.19,   10.26) arcsec,  99 km, siglev is 26.9784 bkgrnd is 0.1
    wfs 5: type 0, at ( -28.19,  -10.26) arcsec,  99 km, siglev is 26.9784 bkgrnd is 0.1
    wfs 6: type 0, at ( -15.00,  -25.98) arcsec,  99 km, siglev is 26.9784 bkgrnd is 0.1
    wfs 7: type 0, at (   5.21,  -29.54) arcsec,  99 km, siglev is 26.9784 bkgrnd is 0.1
    wfs 8: type 0, at (  22.98,  -19.28) arcsec,  99 km, siglev is 26.9784 bkgrnd is 0.1
    wfs 9: type 1, at (   5.00,    8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 10: type 1, at ( -10.00,    0.00) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 11: type 1, at (   5.00,   -8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 12: type 2, at (   0.00,    0.00) arcsec, inf km, siglev is 4.1558e+06 bkgrnd is 0.001
[00;00mThere are 3 DMs[00;00m
  DM 0 at -0.1km, actuator pitch 0.15m, offset   0, with 30.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 1 at    6km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 2 at   10km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
[00;00mTomography[00;00m is using CG, with [00;00mFourer Domain[00;00m preconditioner, [00;00m12[00;00m iterations, integrated tomo.
[00;00mDM Fitting [00;00mis using CG, with [00;00mNo[00;00m preconditioner, [00;00m10[00;00m iterations
[00;00mThere are 9 fit directions[00;00m
    Fit 0: weight is 0.444, at (   0.00,    0.00) arcsec
    Fit 1: weight is 0.111, at (  15.00,    0.00) arcsec
    Fit 2: weight is 0.111, at (   0.00,   15.00) arcsec
    Fit 3: weight is 0.111, at ( -15.00,    0.00) arcsec
    Fit 4: weight is 0.111, at (   0.00,  -15.00) arcsec
    Fit 5: weight is 0.028, at (  15.00,   15.00) arcsec
    Fit 6: weight is 0.028, at ( -15.00,   15.00) arcsec
    Fit 7: weight is 0.028, at ( -15.00,  -15.00) arcsec
    Fit 8: weight is 0.028, at (  15.00,  -15.00) arcsec
[00;00mThere are 1 evaluation directions[00;00m at sampling 1/128 m.
    Evl 0: weight is 1.000, at (   0.00,    0.00) arcsec
[00;00mSimulation[00;00m start at step 0, end at step 1600, with time step 1/1500s, [00;00mclose loop[00;00m.
After setup_parms:	120.5 MiB.
Warning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
CUDA: minimum memory requirement is 0.4GB
GPU 0 is NVIDIA A100-SXM4-40GB with arch 8.0, 38.9GB free, 39.3GB total device memory.
Using GPU 0
Use 1 GPUs for WFS Tomo Fit Evl

*** Preparation started at 2025/02/17 15:21:38 in nid001972. ***

Using OpenMP version 201511 with 128 threads
Reading aperture amplitude map from KECK.fits
Warning(accphi.c:477): 108396 points not covered by input screen
Warning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
 ->maos.c:447->setup.c:148->aper.c:74->utils.c:478->accphi.c:478
iwvl 0: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 1: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 2: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 3: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 4: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 5: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 6: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 7: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 8: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
After setup_aper:	349.7 MiB.

[00;00mSetting up powfs 0 geom[00;00m

There are 20 points in each subaperture of 0.15m.
There are 3300 valid subaperture.

[00;00mSetting up powfs 1 geom[00;00m

There are 88 points in each subaperture of 5.5m.
There are 4 valid subaperture.

[00;00mSetting up powfs 2 geom[00;00m

There are 18 points in each subaperture of 0.563m.
There are 236 valid subaperture.
After setup_powfs_init:	451.9 MiB.

[00;00mSetting up reconstructor geometry.[00;00m

PLOC is 151x151, with sampling of 0.07m (square)
    DM 0: grid is 77 x 77
    DM 1: grid is 75 x 75
    DM 2: grid is 80 x 79
FLOC is 151x151, with sampling of 0.07m (not square)
Tomography grid is square:
    layer 0: xloc grid is 280 x 280, sampling is 0.075 m, 78400 points
    layer 1: xloc grid is 280 x 280, sampling is 0.075 m, 78400 points
    layer 2: xloc grid is 280 x 280, sampling is 0.075 m, 78400 points
    layer 3: xloc grid is 280 x 280, sampling is 0.075 m, 78400 points
    layer 4: xloc grid is 280 x 280, sampling is 0.075 m, 78400 points
    layer 5: xloc grid is 280 x 280, sampling is 0.075 m, 78400 points
    layer 6: xloc grid is 280 x 280, sampling is 0.075 m, 78400 points
    layer 7: xloc grid is 280 x 280, sampling is 0.075 m, 78400 points
    layer 8: xloc grid is 280 x 280, sampling is 0.075 m, 78400 points
    layer 9: xloc grid is 280 x 280, sampling is 0.074 m, 78400 points
    layer 10: xloc grid is 280 x 280, sampling is 0.071 m, 78400 points
    layer 11: xloc grid is 280 x 280, sampling is 0.068 m, 78400 points
    layer 12: xloc grid is 280 x 280, sampling is 0.065 m, 78400 points
    layer 13: xloc grid is 280 x 280, sampling is 0.058 m, 78400 points

[00;00mSetting up powfs 0 PO WFS[00;00m

OTF dimension is 40x40 (calculated)
Uplink FWHM (illt 0, iwvl 0) is 0.576822"
Downlink FWHM (illt 0, iwvl 0) is 0"
Generating matched filter for powfs 0
sa index   location       noise equivalent angle
    1648: (  4.8,  -0.1) m, (5000.00, 5000.00) mas
    1641: (  3.8,  -0.1) m, (5000.00, 5000.00) mas
    1634: (  2.7,  -0.1) m, (5000.00, 5000.00) mas
    1626: (  1.5,  -0.1) m, (5000.00, 5000.00) mas
    1625: (  1.3,  -0.1) m, (5000.00, 5000.00) mas
    1171: ( -0.6,  -1.3) m, (5000.00, 5000.00) mas
    1620: ( -1.8,  -0.1) m, (5000.00, 5000.00) mas
    1613: ( -2.9,  -0.1) m, (5000.00, 5000.00) mas
    1606: ( -3.9,  -0.1) m, (5000.00, 5000.00) mas
    1598: ( -5.1,  -0.1) m, (5000.00, 5000.00) mas
    1596: ( -5.4,  -0.1) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    2832: (  3.8,   3.0) m, (5000.00, 5000.00) mas
    2778: (  3.4,   2.9) m, (5000.00, 5000.00) mas
    2511: (  2.5,   2.1) m, (5000.00, 5000.00) mas
    2203: (  1.6,   1.3) m, (5000.00, 5000.00) mas
    2019: (  1.1,   0.9) m, (5000.00, 5000.00) mas
    1177: (  0.3,  -1.3) m, (5000.00, 5000.00) mas
    1285: ( -1.2,  -1.1) m, (5000.00, 5000.00) mas
    1101: ( -1.8,  -1.5) m, (5000.00, 5000.00) mas
     793: ( -2.7,  -2.2) m, (5000.00, 5000.00) mas
     526: ( -3.6,  -3.0) m, (5000.00, 5000.00) mas
     119: ( -3.0,  -4.3) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    3280: (  0.8,   4.6) m, (5000.00, 5000.00) mas
    2810: (  0.4,   3.0) m, (5000.00, 5000.00) mas
    2496: (  0.3,   2.1) m, (5000.00, 5000.00) mas
    2131: (  0.1,   1.2) m, (5000.00, 5000.00) mas
    1564: ( -1.5,  -0.3) m, (5000.00, 5000.00) mas
    1111: ( -0.3,  -1.5) m, (5000.00, 5000.00) mas
     808: ( -0.4,  -2.2) m, (5000.00, 5000.00) mas
     494: ( -0.6,  -3.1) m, (5000.00, 5000.00) mas
      20: ( -0.9,  -4.8) m, (5000.00, 5000.00) mas
      16: ( -2.2,  -4.8) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    3230: ( -2.7,   4.5) m, (5000.00, 5000.00) mas
    2940: ( -2.1,   3.4) m, (5000.00, 5000.00) mas
    2589: ( -1.5,   2.4) m, (5000.00, 5000.00) mas
    2186: ( -0.9,   1.3) m, (5000.00, 5000.00) mas
    2069: ( -0.8,   1.1) m, (5000.00, 5000.00) mas
    1740: (  1.2,   0.1) m, (5000.00, 5000.00) mas
    1118: (  0.8,  -1.5) m, (5000.00, 5000.00) mas
     995: (  0.9,  -1.8) m, (5000.00, 5000.00) mas
     715: (  1.3,  -2.5) m, (5000.00, 5000.00) mas
     363: (  1.9,  -3.6) m, (5000.00, 5000.00) mas
      73: (  2.5,  -4.6) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    2285: ( -4.6,   1.6) m, (5000.00, 5000.00) mas
    2106: ( -3.6,   1.2) m, (5000.00, 5000.00) mas
    2053: ( -3.1,   1.1) m, (5000.00, 5000.00) mas
    1906: ( -1.9,   0.6) m, (5000.00, 5000.00) mas
    1853: ( -1.5,   0.4) m, (5000.00, 5000.00) mas
    2072: (  0.6,   1.1) m, (5000.00, 5000.00) mas
    1452: (  1.3,  -0.6) m, (5000.00, 5000.00) mas
    1399: (  1.8,  -0.8) m, (5000.00, 5000.00) mas
    1198: (  3.4,  -1.3) m, (5000.00, 5000.00) mas
    1139: (  3.9,  -1.5) m, (5000.00, 5000.00) mas
    1477: (  5.1,  -0.6) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
     958: ( -4.6,  -1.8) m, (5000.00, 5000.00) mas
    1151: ( -3.6,  -1.3) m, (5000.00, 5000.00) mas
    1216: ( -3.1,  -1.2) m, (5000.00, 5000.00) mas
    1388: ( -1.9,  -0.8) m, (5000.00, 5000.00) mas
    1447: ( -1.5,  -0.6) m, (5000.00, 5000.00) mas
    1235: (  0.6,  -1.2) m, (5000.00, 5000.00) mas
    1858: (  1.3,   0.4) m, (5000.00, 5000.00) mas
    1917: (  1.8,   0.6) m, (5000.00, 5000.00) mas
    2153: (  3.4,   1.2) m, (5000.00, 5000.00) mas
    2218: (  3.9,   1.3) m, (5000.00, 5000.00) mas
    1883: (  5.1,   0.4) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
      40: ( -2.7,  -4.6) m, (5000.00, 5000.00) mas
     336: ( -2.1,  -3.6) m, (5000.00, 5000.00) mas
     696: ( -1.5,  -2.5) m, (5000.00, 5000.00) mas
    1107: ( -0.9,  -1.5) m, (5000.00, 5000.00) mas
    1232: ( -0.8,  -1.2) m, (5000.00, 5000.00) mas
    1508: (  1.2,  -0.4) m, (5000.00, 5000.00) mas
    2197: (  0.8,   1.3) m, (5000.00, 5000.00) mas
    2322: (  0.9,   1.6) m, (5000.00, 5000.00) mas
    2608: (  1.3,   2.4) m, (5000.00, 5000.00) mas
    2967: (  1.9,   3.4) m, (5000.00, 5000.00) mas
    3262: (  2.5,   4.5) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
      27: (  0.8,  -4.8) m, (5000.00, 5000.00) mas
     501: (  0.4,  -3.1) m, (5000.00, 5000.00) mas
     813: (  0.3,  -2.2) m, (5000.00, 5000.00) mas
    1114: (  0.1,  -1.5) m, (5000.00, 5000.00) mas
    1738: ( -1.5,   0.1) m, (5000.00, 5000.00) mas
    2190: ( -0.3,   1.3) m, (5000.00, 5000.00) mas
    2491: ( -0.4,   2.1) m, (5000.00, 5000.00) mas
    2803: ( -0.6,   3.0) m, (5000.00, 5000.00) mas
    3273: ( -0.9,   4.6) m, (5000.00, 5000.00) mas
    3269: ( -2.2,   4.6) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
     523: (  3.8,  -3.1) m, (5000.00, 5000.00) mas
     573: (  3.4,  -3.0) m, (5000.00, 5000.00) mas
     828: (  2.5,  -2.2) m, (5000.00, 5000.00) mas
    1124: (  1.6,  -1.5) m, (5000.00, 5000.00) mas
    1290: (  1.1,  -1.1) m, (5000.00, 5000.00) mas
    2132: (  0.3,   1.2) m, (5000.00, 5000.00) mas
    2014: ( -1.2,   0.9) m, (5000.00, 5000.00) mas
    2180: ( -1.8,   1.3) m, (5000.00, 5000.00) mas
    2476: ( -2.7,   2.1) m, (5000.00, 5000.00) mas
    2731: ( -3.6,   2.9) m, (5000.00, 5000.00) mas
    3145: ( -3.0,   4.2) m, (5000.00, 5000.00) mas

[00;00mSetting up powfs 2 PO WFS[00;00m

OTF dimension is 48x48 (calculated)
Generating matched filter for powfs 2
Use sanea to derive neasim
Use sanea to derive neasim

[00;00mSetting up reconstructor[00;00m

Recon NEA: cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) geom(0.31) geom(0.31) geom(0.31) mf(0.14)  mas
Setup or update control matrix parameters.
RRtwfs svd threshold is 1e-10
Replacing HA by HA*fit->actextrap
Adding piston cr to fit matrix
Adding TT cr on upper DMs to fit matrix.
Before assembling fit matrix:	5459.0 MiB.
Building fit->FR
Building fit->FL
Adding tikhonov constraint of 1.0e-07 to FLM
The maximum eigen value is estimated to be around 2.7e-04
DM Fit number of Low rank terms: 16 in LHS
After assemble fit matrix:	7370.5 MiB.
After setup_recon:	7370.5 MiB.
GPU 0: mem used 1650 MB (wfs init)
GPU 0: mem used 2818 MB (recon init)
GPU 0: mem used 2848 MB (perf init)

*** Simulation started at 2025/02/17 15:23:18 in nid001972. ***

Running seed 1
GPU 0: mem used 2850 MB (wfs seeding)
Wind dir: 267.3 261.7 167.0 130.5 300.7  32.3 119.8 139.0 150.8 277.7 203.0 133.1  45.9 265.1 deg
Using /global/homes/b/bpeck/.aos/cache/atm/vonkarman_14_8192x8192_0.0078125_1115374592d.bin
After genatm:	7255.2 MiB.
Step     #  Open Loop  PR TT  On axis  PR TT  Field RMS PR TT     Timing 
Step     0: OL  884.6  248.3  OA  884.6 248.3 CL  884.6 248.3 nm  0.125 s
Step    14: OL  906.0  253.8  OA  753.3 236.4 CL  753.3 236.4 nm  0.074 s
Step    27: OL  926.0  258.0  OA  750.5 239.8 CL  750.5 239.8 nm  0.091 s
Step    39: OL  944.3  260.5  OA  744.3 238.4 CL  744.3 238.4 nm  0.081 s
Step    51: OL  962.2  261.3  OA  735.7 236.4 CL  735.7 236.4 nm  0.081 s
Step    63: OL  980.3  260.7  OA  728.2 233.3 CL  728.2 233.3 nm  0.096 s
Step    75: OL  998.9  259.5  OA  719.1 230.2 CL  719.1 230.2 nm  0.084 s
Step    87: OL 1018.0  258.5  OA  711.9 228.0 CL  711.9 228.0 nm  0.082 s
Step    99: OL 1037.4  257.8  OA  706.5 227.1 CL  706.5 227.1 nm  0.096 s
Step   111: OL 1056.8  258.1  OA  703.4 223.6 CL  703.4 223.6 nm  0.081 s
Step   123: OL 1075.8  259.3  OA  702.4 220.3 CL  702.4 220.3 nm  0.094 s
Step   135: OL 1093.6  262.2  OA  703.4 216.3 CL  703.4 216.3 nm  0.081 s
Step   147: OL 1110.6  266.6  OA  701.4 210.9 CL  701.4 210.9 nm  0.086 s
Step   159: OL 1125.7  272.2  OA  700.6 207.3 CL  700.6 207.3 nm  0.081 s
Step   171: OL 1139.2  279.0  OA  699.6 205.4 CL  699.6 205.4 nm  0.091 s
Step   183: OL 1150.7  286.6  OA  700.7 204.1 CL  700.7 204.1 nm  0.085 s
Step   195: OL 1159.9  294.4  OA  701.4 203.6 CL  701.4 203.6 nm  0.081 s
Step   207: OL 1167.5  302.0  OA  702.4 205.2 CL  702.4 205.2 nm  0.082 s
Step   219: OL 1173.6  309.7  OA  704.8 206.3 CL  704.8 206.3 nm  0.091 s
Step   231: OL 1177.7  317.6  OA  709.2 209.4 CL  709.2 209.4 nm  0.081 s
Step   243: OL 1180.0  325.7  OA  711.7 214.0 CL  711.7 214.0 nm  0.081 s
Step   255: OL 1179.3  334.3  OA  715.0 219.4 CL  715.0 219.4 nm  0.086 s
Step   255 updated high order loop gain: 0.424
Step   267: OL 1175.3  342.9  OA  715.6 226.3 CL  715.6 226.3 nm  0.082 s
Step   279: OL 1168.2  351.6  OA  714.9 234.0 CL  714.9 234.0 nm  0.086 s
Step   291: OL 1159.0  361.1  OA  713.9 242.6 CL  713.9 242.6 nm  0.137 s
Step   303: OL 1148.5  371.6  OA  713.6 251.6 CL  713.6 251.6 nm  0.084 s
Step   315: OL 1136.1  382.7  OA  713.7 261.4 CL  713.7 261.4 nm  0.081 s
Step   327: OL 1122.0  394.6  OA  710.9 272.0 CL  710.9 272.0 nm  0.096 s
Step   340: OL 1106.1  409.3  OA  712.6 285.7 CL  712.6 285.7 nm  0.081 s
Step   352: OL 1091.0  424.3  OA  711.2 298.4 CL  711.2 298.4 nm  0.080 s
Step   364: OL 1076.1  440.7  OA  713.6 312.6 CL  713.6 312.6 nm  0.082 s
Step   376: OL 1061.7  457.8  OA  717.6 327.6 CL  717.6 327.6 nm  0.080 s
Step   388: OL 1047.7  475.2  OA  719.7 342.1 CL  719.7 342.1 nm  0.092 s
Step   399: OL 1034.7  491.0  OA  721.2 356.8 CL  721.2 356.8 nm  0.086 s
Step   411: OL 1020.2  508.0  OA  726.5 371.5 CL  726.5 371.5 nm  0.080 s
Step   423: OL 1005.1  524.1  OA  729.0 386.9 CL  729.0 386.9 nm  0.090 s
Step   435: OL  990.3  540.1  OA  731.0 401.7 CL  731.0 401.7 nm  0.080 s
Step   447: OL  976.0  555.6  OA  730.4 416.1 CL  730.4 416.1 nm  0.083 s
Step   459: OL  963.7  571.3  OA  732.0 430.0 CL  732.0 430.0 nm  0.096 s
Step   471: OL  954.1  586.9  OA  736.2 444.6 CL  736.2 444.6 nm  0.084 s
Step   482: OL  948.4  600.9  OA  741.5 457.1 CL  741.5 457.1 nm  0.081 s
Step   494: OL  945.5  615.5  OA  751.0 470.8 CL  751.0 470.8 nm  0.093 s
Step   506: OL  944.8  629.2  OA  761.8 484.3 CL  761.8 484.3 nm  0.083 s
Step   511 updated high order loop gain: 0.426
Step   518: OL  945.8  641.5  OA  772.6 495.4 CL  772.6 495.4 nm  0.081 s
Step   530: OL  948.5  651.7  OA  782.5 504.4 CL  782.5 504.4 nm  0.092 s
Step   542: OL  953.1  659.5  OA  790.8 509.4 CL  790.8 509.4 nm  0.082 s
Step   554: OL  959.7  665.1  OA  800.1 514.1 CL  800.1 514.1 nm  0.082 s
Step   566: OL  968.2  668.7  OA  808.1 515.6 CL  808.1 515.6 nm  0.094 s
Step   578: OL  978.1  670.6  OA  813.2 514.2 CL  813.2 514.2 nm  0.085 s
Step   590: OL  989.6  670.8  OA  818.0 512.4 CL  818.0 512.4 nm  0.081 s
Step   602: OL 1002.2  668.7  OA  822.9 509.1 CL  822.9 509.1 nm  0.093 s
Step   614: OL 1015.4  664.2  OA  824.6 502.0 CL  824.6 502.0 nm  0.083 s
Step   626: OL 1028.7  657.7  OA  823.1 493.2 CL  823.1 493.2 nm  0.083 s
Step   638: OL 1041.5  649.0  OA  818.9 483.3 CL  818.9 483.3 nm  0.085 s
Step   650: OL 1053.3  638.9  OA  810.9 471.0 CL  810.9 471.0 nm  0.085 s
Step   662: OL 1063.9  627.5  OA  801.5 459.2 CL  801.5 459.2 nm  0.083 s
Step   674: OL 1073.6  615.1  OA  790.6 445.3 CL  790.6 445.3 nm  0.082 s
Step   686: OL 1082.9  602.6  OA  780.0 430.0 CL  780.0 430.0 nm  0.081 s
Step   698: OL 1090.9  589.5  OA  769.4 413.9 CL  769.4 413.9 nm  0.081 s
Step   710: OL 1097.0  575.4  OA  759.7 398.4 CL  759.7 398.4 nm  0.081 s
Step   722: OL 1100.7  560.6  OA  747.7 379.0 CL  747.7 379.0 nm  0.079 s
Step   734: OL 1101.8  545.8  OA  736.6 361.8 CL  736.6 361.8 nm  0.092 s
Step   746: OL 1100.3  531.0  OA  724.7 342.8 CL  724.7 342.8 nm  0.082 s
Step   758: OL 1096.5  516.7  OA  712.4 326.2 CL  712.4 326.2 nm  0.081 s
Step   767 updated high order loop gain: 0.427
Step   770: OL 1090.3  502.8  OA  699.8 311.0 CL  699.8 311.0 nm  0.091 s
Step   782: OL 1081.6  489.3  OA  686.7 296.1 CL  686.7 296.1 nm  0.086 s
Step   794: OL 1070.1  475.9  OA  672.6 280.6 CL  672.6 280.6 nm  0.082 s
Step   806: OL 1056.7  462.5  OA  661.7 266.1 CL  661.7 266.1 nm  0.099 s
Step   818: OL 1041.4  449.1  OA  650.3 251.2 CL  650.3 251.2 nm  0.082 s
Step   829: OL 1025.6  437.0  OA  640.4 237.6 CL  640.4 237.6 nm  0.083 s
Step   841: OL 1007.1  424.3  OA  630.9 221.6 CL  630.9 221.6 nm  0.084 s
Step   853: OL  988.2  412.3  OA  623.6 206.3 CL  623.6 206.3 nm  0.083 s
Step   865: OL  969.7  401.3  OA  619.0 193.7 CL  619.0 193.7 nm  0.081 s
Step   877: OL  952.3  391.4  OA  615.0 182.2 CL  615.0 182.2 nm  0.084 s
Step   889: OL  936.0  382.8  OA  613.5 172.8 CL  613.5 172.8 nm  0.079 s
Step   901: OL  919.2  375.0  OA  611.6 165.2 CL  611.6 165.2 nm  0.081 s
Step   913: OL  902.0  368.5  OA  606.8 160.7 CL  606.8 160.7 nm  0.083 s
Step   925: OL  884.9  362.7  OA  600.8 156.7 CL  600.8 156.7 nm  0.086 s
Step   937: OL  868.4  356.9  OA  595.1 154.9 CL  595.1 154.9 nm  0.082 s
Step   948: OL  853.8  351.7  OA  588.5 152.7 CL  588.5 152.7 nm  0.089 s
Step   960: OL  838.9  345.5  OA  583.6 151.8 CL  583.6 151.8 nm  0.081 s
Step   973: OL  825.1  338.1  OA  578.7 149.4 CL  578.7 149.4 nm  0.080 s
Step   985: OL  814.0  330.6  OA  576.5 148.1 CL  576.5 148.1 nm  0.096 s
Step   997: OL  803.8  322.3  OA  575.3 145.3 CL  575.3 145.3 nm  0.083 s
Step  1009: OL  794.2  313.3  OA  574.2 142.0 CL  574.2 142.0 nm  0.082 s
Step  1021: OL  785.6  304.1  OA  570.6 138.2 CL  570.6 138.2 nm  0.094 s
Step  1023 updated high order loop gain: 0.427
Step  1033: OL  777.8  294.5  OA  567.2 134.9 CL  567.2 134.9 nm  0.082 s
Step  1045: OL  770.7  284.3  OA  565.7 130.6 CL  565.7 130.6 nm  0.081 s
Step  1057: OL  763.2  273.3  OA  561.5 125.7 CL  561.5 125.7 nm  0.082 s
Step  1067: OL  757.1  263.1  OA  558.9 121.1 CL  558.9 121.1 nm  0.086 s
Step  1079: OL  751.2  249.7  OA  556.9 112.7 CL  556.9 112.7 nm  0.094 s
Step  1091: OL  746.9  235.6  OA  555.8 102.9 CL  555.8 102.9 nm  0.082 s
Step  1103: OL  743.9  222.4  OA  555.4  92.7 CL  555.4  92.7 nm  0.086 s
Step  1115: OL  741.9  210.2  OA  557.4  83.5 CL  557.4  83.5 nm  0.096 s
Step  1127: OL  740.6  199.5  OA  557.7  76.0 CL  557.7  76.0 nm  0.080 s
Step  1139: OL  739.7  190.4  OA  561.5  71.0 CL  561.5  71.0 nm  0.081 s
Step  1151: OL  739.1  182.8  OA  563.0  66.1 CL  563.0  66.1 nm  0.089 s
Step  1163: OL  738.4  176.9  OA  566.8  64.6 CL  566.8  64.6 nm  0.081 s
Step  1175: OL  738.0  172.7  OA  570.7  63.7 CL  570.7  63.7 nm  0.082 s
Step  1187: OL  739.0  169.8  OA  575.7  63.6 CL  575.7  63.6 nm  0.083 s
Step  1199: OL  740.9  167.2  OA  584.1  62.8 CL  584.1  62.8 nm  0.091 s
Step  1211: OL  743.1  165.1  OA  592.9  63.5 CL  592.9  63.5 nm  0.081 s
Step  1223: OL  745.7  163.7  OA  600.5  64.4 CL  600.5  64.4 nm  0.079 s
Step  1235: OL  747.9  163.7  OA  608.7  65.6 CL  608.7  65.6 nm  0.091 s
Step  1248: OL  750.0  165.6  OA  615.7  71.0 CL  615.7  71.0 nm  0.080 s
Step  1260: OL  752.7  169.3  OA  621.2  75.1 CL  621.2  75.1 nm  0.082 s
Step  1272: OL  755.9  174.7  OA  627.6  80.1 CL  627.6  80.1 nm  0.086 s
Step  1279 updated high order loop gain: 0.428
Step  1284: OL  760.1  181.4  OA  632.4  86.3 CL  632.4  86.3 nm  0.088 s
Step  1296: OL  765.0  188.9  OA  636.1  90.0 CL  636.1  90.0 nm  0.092 s
Step  1308: OL  769.5  197.4  OA  638.0  94.1 CL  638.0  94.1 nm  0.086 s
Step  1320: OL  773.5  206.8  OA  636.7  98.4 CL  636.7  98.4 nm  0.082 s
Step  1332: OL  777.6  217.0  OA  636.7 102.1 CL  636.7 102.1 nm  0.092 s
Step  1344: OL  782.7  227.9  OA  633.4 106.2 CL  633.4 106.2 nm  0.082 s
Step  1356: OL  789.0  238.8  OA  633.4 107.9 CL  633.4 107.9 nm  0.081 s
Step  1368: OL  796.2  248.4  OA  635.8 108.7 CL  635.8 108.7 nm  0.086 s
Step  1380: OL  803.7  256.4  OA  637.2 108.1 CL  637.2 108.1 nm  0.082 s
Step  1393: OL  812.7  263.4  OA  642.7 106.2 CL  642.7 106.2 nm  0.081 s
Step  1405: OL  822.0  268.3  OA  648.0 103.4 CL  648.0 103.4 nm  0.094 s
Step  1417: OL  831.9  271.9  OA  656.1 101.8 CL  656.1 101.8 nm  0.082 s
Step  1429: OL  842.0  274.8  OA  661.9  99.1 CL  661.9  99.1 nm  0.087 s
Step  1441: OL  851.5  277.3  OA  666.1  95.7 CL  666.1  95.7 nm  0.082 s
Step  1453: OL  860.5  279.1  OA  669.9  93.2 CL  669.9  93.2 nm  0.082 s
Step  1465: OL  868.3  279.7  OA  669.9  90.4 CL  669.9  90.4 nm  0.080 s
Step  1477: OL  873.7  279.0  OA  670.6  88.6 CL  670.6  88.6 nm  0.082 s
Step  1489: OL  876.2  276.7  OA  668.7  88.5 CL  668.7  88.5 nm  0.083 s
Step  1501: OL  876.1  272.9  OA  664.2  88.5 CL  664.2  88.5 nm  0.084 s
Step  1513: OL  873.9  267.8  OA  655.4  90.1 CL  655.4  90.1 nm  0.085 s
Step  1524: OL  870.7  262.5  OA  651.3  91.4 CL  651.3  91.4 nm  0.085 s
Step  1535 updated high order loop gain: 0.428
Step  1536: OL  865.6  255.5  OA  644.5  91.8 CL  644.5  91.8 nm  0.116 s
Step  1548: OL  859.9  247.8  OA  640.4  91.0 CL  640.4  91.0 nm  0.083 s
Step  1560: OL  854.3  239.9  OA  638.0  89.5 CL  638.0  89.5 nm  0.081 s
Step  1572: OL  848.8  232.6  OA  635.1  90.3 CL  635.1  90.3 nm  0.086 s
Step  1584: OL  843.0  226.3  OA  632.8  92.9 CL  632.8  92.9 nm  0.083 s
Step  1596: OL  837.0  221.2  OA  632.2  95.9 CL  632.2  95.9 nm  0.082 s
Step 1599: Output PSF
Step  1599: OL  835.4  219.9  OA  632.4  97.9 CL  632.4  97.9 nm  1.437 s
Mean: 671.37 275.61 612.19  nm.

*** Simulation Finished at 2025/02/17 15:25:42 in nid001972. ***

