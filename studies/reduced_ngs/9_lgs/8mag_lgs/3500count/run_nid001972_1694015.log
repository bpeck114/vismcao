Warning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
/global/cfs/cdirs/ulens/vismcao/maos -o studies/reduced_ngs/9_lgs/8mag_lgs/3500count -c master_files/reduced_ngs/9_lgs/8mag_lgs/kola_3500act.conf -O 
Output folder is 'studies/reduced_ngs/9_lgs/8mag_lgs/3500count'.
SRC: /global/homes/b/bpeck/code/maos v2.9 4c88b7c2 2024-11-13 16:45:33 -0800
BUILT: /global/homes/b/bpeck/code/maos/optim by GCC (v12) on 2024/11/18 09:40:03 CPU(F64,+O3) with CUDA(v122,F32)
Launched at 2025/02/17 15:09:57 in nid001972 with PID 1694015.
The web based job monitor can be accessed at http://localhost:10300
Main config file is /global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_3500act.conf
Warning(path.c:48): Path not found: path=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; abspath=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; Ignored.
Warning(path.c:48): Path not found: path=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; abspath=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; Ignored.
Warning(readcfg.c:399): sim.apfsm has been renamed to powfs.apfsm.
Warning(readcfg.c:399): sim.epfsm has been renamed to powfs.epfsm.
Warning(readcfg.c:399): sim.alfsm has been renamed to powfs.alfsm.
Warning(readcfg.c:399): sim.commonfsm has been renamed to powfs.commonfsm.
Warning(readcfg.c:399): sim.idealfsm has been renamed to powfs.idealfsm.
Warning(readcfg.c:399): sim.zetafsm has been renamed to powfs.zetafsm.
Warning(readcfg.c:399): sim.f0fsm has been renamed to powfs.f0fsm.
Warning(readcfg.c:399): tsurf has been renamed to ncpa.tsurf.
loaded 132 (132 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_sim.conf'
loaded  19 ( 19 new) records from '/global/cfs/cdirs/ulens/vismcao/./dm_none.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_ASM.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_DM2.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_DM3.conf'
loaded   0 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_dm_multiple.conf'
loaded   7 (  5 new) records from '/global/cfs/cdirs/ulens/vismcao/./atm_mk13n50p_ground_detail.conf'
loaded  76 ( 69 new) records from '/global/homes/b/bpeck/code/maos/config/maos/powfs_common.conf'
loaded  44 ( 38 new) records from '/global/cfs/cdirs/ulens/vismcao/./powfs_none.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_lgs.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_ttf_strap.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_twfs_lbwfs.conf'
loaded   0 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_wfs_lgs_strap_lbwfs.conf'
loaded  71 ( 71 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_recon.conf'
Warning(readcfg.c:399): dbg.na_smooth has been renamed to powfs0_llt.na_smooth.
Warning(readcfg.c:399): dbg.na_interp has been renamed to powfs0_llt.na_interp.
Warning(readcfg.c:399): dbg.na_thres has been renamed to powfs0_llt.na_thres.
Warning(readcfg.c:399): dbg.na_fit_maxit has been renamed to powfs0_llt.na_fit_maxit.
Warning(readcfg.c:399): dbg.na_fit_svdthres has been renamed to powfs0_llt.na_fit_svdthres.
Warning(readcfg.c:399): dbg.na_fit_dh has been renamed to powfs0_llt.na_fit_dh.
Warning(readcfg.c:399): dbg.ncpa_preload has been renamed to ncpa.preload.
Warning(readcfg.c:399): dbg.ncpa_rmsci has been renamed to ncpa.rmsci.
Warning(readcfg.c:399): dbg.draw_opdmax has been renamed to plot.opdmax.
Warning(readcfg.c:399): dbg.draw_gmax has been renamed to plot.gmax.
loaded  95 ( 93 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_dbg.conf'
loaded   4 (  4 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_fit_mcao.conf'
Warning(readcfg.c:399): surf has been renamed to ncpa.surf.
loaded  39 (  7 new) records from '/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_3500act.conf'
loaded   0 (  0 new) records from 'command line'
loaded  24 ( 18 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_llt_CL.conf'
Adjust LGS range by telescope altitude 4145m.
Zenith angle is 30 degree.
    Scaling turbulence height and LGS hs by sec(za).
    Scaling r0 by cos(za)^(3/5).
    Scaling wind speed and LGS signal level by cos(za).
powfs0: Adjusting dx from 0.0078125 to 0.0075. 
powfs0.llt.fsm: f0=0 Hz, LPF ep=0
powfs0.epfsm is set to 0.517618 (auto)
powfs2: Adjusting dx from 0.03125 to 0.0312778. 
powfs2 is TWFS for powfs0
sim.ephi is set to 0.427717 (auto)
sim.eplo is set to 0.427717 (auto)
Warning(parms.c:2296): Layer 1 at 17.3205m is very close to layer 0 at 0m (OK).
Warning(parms.c:2296): Layer 2 at 34.641m is very close to layer 1 at 17.3205m (OK).
Warning(parms.c:2296): Layer 3 at 51.9615m is very close to layer 2 at 34.641m (OK).
dm 0: stroke=30 um is provided in micron.
dm 0: assume ia stroke=2 um is provided in micron.
dm 1: stroke=7 um is provided in micron.
dm 1: assume ia stroke=2 um is provided in micron.
dm 2: stroke=7 um is provided in micron.
dm 2: assume ia stroke=2 um is provided in micron.
Focus blending is not implemented yet for integrated tomography
parms->sim.mffocus is reset to 0
There are 1 valid simulation seeds:  1
Output PSF for 1 directions
Used 449 of 456 supplied keys
Warning(readcfg.c:158): key "dbg.pwfs_flate" is not recognized, value is 0
Warning(readcfg.c:158): key "dbg.pwfs_flatv" is not recognized, value is 0
Warning(readcfg.c:158): key "dbg.pwfs_psx" is not recognized, value is [0 0 0 0]
Warning(readcfg.c:158): key "dbg.pwfs_psy" is not recognized, value is [0 0 0 0]
Warning(readcfg.c:158): key "dbg.pwfs_pupelong" is not recognized, value is 0
Warning(readcfg.c:158): key "dbg.pwfs_raw" is not recognized, value is 0
Warning(readcfg.c:158): key "dbg.pwfs_side" is not recognized, value is 4
[00;00mAperture[00;00m is 11 m with sampling 1/128 m
[00;00mTurbulence at 30 degree zenith angle:[00;00m r0=0.128424m, L0=30m, 14 layers.
    Greenwood freq is 25.1Hz, anisoplanatic angle is 1.58 as
    Sampled 8192x8192 at 1/128m. wind dir is randomized.
    layer 0: ht=      0 m, wt= 0.302, ws=  4.8 m/s
    layer 1: ht=     17 m, wt= 0.154, ws=  5.0 m/s
    layer 2: ht=     35 m, wt= 0.041, ws=  5.4 m/s
    layer 3: ht=     52 m, wt= 0.002, ws=  6.6 m/s
    layer 4: ht=    139 m, wt= 0.021, ws=  6.1 m/s
    layer 5: ht=    231 m, wt= 0.010, ws=  6.1 m/s
    layer 6: ht=    323 m, wt= 0.008, ws=  6.1 m/s
    layer 7: ht=    416 m, wt= 0.005, ws=  6.1 m/s
    layer 8: ht=    508 m, wt= 0.001, ws=  6.1 m/s
    layer 9: ht=    932 m, wt= 0.107, ws=  5.6 m/s
    layer 10: ht=   5022 m, wt= 0.144, ws= 11.1 m/s
    layer 11: ht=   9238 m, wt= 0.093, ws= 19.1 m/s
    layer 12: ht=  13856 m, wt= 0.075, ws=  8.2 m/s
    layer 13: ht=  22518 m, wt= 0.036, ws=  4.8 m/s
[00;00mReconstruction[00;00m: r0=0.128424m L0=30m. 14 layers. use cone coordinate.
    layer 0: ht=      0 m, wt= 0.302
    layer 1: ht=     17 m, wt= 0.154
    layer 2: ht=     35 m, wt= 0.041
    layer 3: ht=     52 m, wt= 0.002
    layer 4: ht=    139 m, wt= 0.021
    layer 5: ht=    231 m, wt= 0.010
    layer 6: ht=    323 m, wt= 0.008
    layer 7: ht=    416 m, wt= 0.005
    layer 8: ht=    508 m, wt= 0.001
    layer 9: ht=    932 m, wt= 0.107
    layer 10: ht=   5022 m, wt= 0.144
    layer 11: ht=   9238 m, wt= 0.093
    layer 12: ht=  13856 m, wt= 0.075
    layer 13: ht=  22518 m, wt= 0.036
[00;00mThere are 3 powfs[00;00m
  powfs0: Order 67, LGS at 99.1 km. Sampling 1/133.333 m. Thres 30%. [00;00mT/T is removed in right hand side in tomography.[00;00m
    CCD image is 25x25 @ 500x500 mas, blur 27% (sigma), 1500Hz, wvl: [ 5.89e-07]
    Gtilt in reconstruction. Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
  powfs1: Order  2, NGS at inf km. Sampling 1/16 m. Thres 30%. 
    Ztilt in reconstruction. Geomtric optics start at 2 with ztilt [00;00m(noisy)[00;00m
  powfs2: Order 20, NGS at inf km. Sampling 1/31.9716 m. Thres 50%. 
    CCD image is 4x4 @ 1500x1500 mas, blur 0% (sigma), 0.015Hz, wvl: [ 7.2e-07]
    Gtilt in reconstruction. Geomtric optics start at 50 with gtilt Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
[00;00mThere are 13 wfs[00;00m
    wfs 0: type 0, at (  30.00,    0.00) arcsec,  99 km, siglev is 32.644 bkgrnd is 0.1
    wfs 1: type 0, at (  22.98,   19.28) arcsec,  99 km, siglev is 32.644 bkgrnd is 0.1
    wfs 2: type 0, at (   5.21,   29.54) arcsec,  99 km, siglev is 32.644 bkgrnd is 0.1
    wfs 3: type 0, at ( -15.00,   25.98) arcsec,  99 km, siglev is 32.644 bkgrnd is 0.1
    wfs 4: type 0, at ( -28.19,   10.26) arcsec,  99 km, siglev is 32.644 bkgrnd is 0.1
    wfs 5: type 0, at ( -28.19,  -10.26) arcsec,  99 km, siglev is 32.644 bkgrnd is 0.1
    wfs 6: type 0, at ( -15.00,  -25.98) arcsec,  99 km, siglev is 32.644 bkgrnd is 0.1
    wfs 7: type 0, at (   5.21,  -29.54) arcsec,  99 km, siglev is 32.644 bkgrnd is 0.1
    wfs 8: type 0, at (  22.98,  -19.28) arcsec,  99 km, siglev is 32.644 bkgrnd is 0.1
    wfs 9: type 1, at (   5.00,    8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 10: type 1, at ( -10.00,    0.00) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 11: type 1, at (   5.00,   -8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 12: type 2, at (   0.00,    0.00) arcsec, inf km, siglev is 4.1558e+06 bkgrnd is 0.001
[00;00mThere are 3 DMs[00;00m
  DM 0 at -0.1km, actuator pitch 0.165m, offset   0, with 30.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 1 at    6km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 2 at   10km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
[00;00mTomography[00;00m is using CG, with [00;00mFourer Domain[00;00m preconditioner, [00;00m12[00;00m iterations, integrated tomo.
[00;00mDM Fitting [00;00mis using CG, with [00;00mNo[00;00m preconditioner, [00;00m10[00;00m iterations
[00;00mThere are 9 fit directions[00;00m
    Fit 0: weight is 0.444, at (   0.00,    0.00) arcsec
    Fit 1: weight is 0.111, at (  15.00,    0.00) arcsec
    Fit 2: weight is 0.111, at (   0.00,   15.00) arcsec
    Fit 3: weight is 0.111, at ( -15.00,    0.00) arcsec
    Fit 4: weight is 0.111, at (   0.00,  -15.00) arcsec
    Fit 5: weight is 0.028, at (  15.00,   15.00) arcsec
    Fit 6: weight is 0.028, at ( -15.00,   15.00) arcsec
    Fit 7: weight is 0.028, at ( -15.00,  -15.00) arcsec
    Fit 8: weight is 0.028, at (  15.00,  -15.00) arcsec
[00;00mThere are 1 evaluation directions[00;00m at sampling 1/128 m.
    Evl 0: weight is 1.000, at (   0.00,    0.00) arcsec
[00;00mSimulation[00;00m start at step 0, end at step 1600, with time step 1/1500s, [00;00mclose loop[00;00m.
After setup_parms:	120.6 MiB.
Warning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
CUDA: minimum memory requirement is 0.4GB
GPU 0 is NVIDIA A100-SXM4-40GB with arch 8.0, 38.9GB free, 39.3GB total device memory.
Using GPU 0
Use 1 GPUs for WFS Tomo Fit Evl

*** Preparation started at 2025/02/17 15:09:58 in nid001972. ***

Using OpenMP version 201511 with 128 threads
Reading aperture amplitude map from KECK.fits
Warning(accphi.c:477): 108646 points not covered by input screen
Warning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
 ->maos.c:447->setup.c:148->aper.c:74->utils.c:478->accphi.c:478
iwvl 0: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 1: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 2: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 3: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 4: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 5: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 6: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 7: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 8: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
After setup_aper:	343.1 MiB.

[00;00mSetting up powfs 0 geom[00;00m

There are 22 points in each subaperture of 0.165m.
There are 2734 valid subaperture.

[00;00mSetting up powfs 1 geom[00;00m

There are 88 points in each subaperture of 5.5m.
There are 4 valid subaperture.

[00;00mSetting up powfs 2 geom[00;00m

There are 18 points in each subaperture of 0.563m.
There are 236 valid subaperture.
After setup_powfs_init:	427.9 MiB.

[00;00mSetting up reconstructor geometry.[00;00m

PLOC is 137x137, with sampling of 0.08m (square)
    DM 0: grid is 70 x 70
    DM 1: grid is 75 x 75
    DM 2: grid is 80 x 79
FLOC is 137x137, with sampling of 0.08m (not square)
Tomography grid is square:
    layer 0: xloc grid is 240 x 240, sampling is 0.083 m, 57600 points
    layer 1: xloc grid is 240 x 240, sampling is 0.082 m, 57600 points
    layer 2: xloc grid is 240 x 240, sampling is 0.082 m, 57600 points
    layer 3: xloc grid is 240 x 240, sampling is 0.082 m, 57600 points
    layer 4: xloc grid is 240 x 240, sampling is 0.082 m, 57600 points
    layer 5: xloc grid is 240 x 240, sampling is 0.082 m, 57600 points
    layer 6: xloc grid is 240 x 240, sampling is 0.082 m, 57600 points
    layer 7: xloc grid is 240 x 240, sampling is 0.082 m, 57600 points
    layer 8: xloc grid is 240 x 240, sampling is 0.082 m, 57600 points
    layer 9: xloc grid is 240 x 240, sampling is 0.082 m, 57600 points
    layer 10: xloc grid is 240 x 240, sampling is 0.078 m, 57600 points
    layer 11: xloc grid is 240 x 240, sampling is 0.075 m, 57600 points
    layer 12: xloc grid is 240 x 240, sampling is 0.071 m, 57600 points
Warning(map.c:195): ninx=240 is too small. need 241
Warning(map.c:200): niny=240 is too small. need 241
    layer 13: xloc grid is 240 x 240, sampling is 0.064 m, 57600 points

[00;00mSetting up powfs 0 PO WFS[00;00m

OTF dimension is 48x48 (calculated)
Uplink FWHM (illt 0, iwvl 0) is 0.576822"
Downlink FWHM (illt 0, iwvl 0) is 0"
Generating matched filter for powfs 0
sa index   location       noise equivalent angle
    1338: (  4.9,  -0.2) m, (5000.00, 5000.00) mas
    1331: (  3.7,  -0.2) m, (5000.00, 5000.00) mas
    1325: (  2.7,  -0.2) m, (5000.00, 5000.00) mas
    1318: (  1.6,  -0.2) m, (5000.00, 5000.00) mas
    1316: (  1.2,  -0.2) m, (5000.00, 5000.00) mas
     956: ( -0.6,  -1.4) m, (5000.00, 5000.00) mas
    1313: ( -1.7,  -0.2) m, (5000.00, 5000.00) mas
    1306: ( -2.9,  -0.2) m, (5000.00, 5000.00) mas
    1300: ( -3.9,  -0.2) m, (5000.00, 5000.00) mas
    1293: ( -5.0,  -0.2) m, (5000.00, 5000.00) mas
    1291: ( -5.4,  -0.2) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    2361: (  3.7,   3.1) m, (5000.00, 5000.00) mas
    2168: (  2.9,   2.4) m, (5000.00, 5000.00) mas
    2120: (  2.7,   2.2) m, (5000.00, 5000.00) mas
    1902: (  1.9,   1.6) m, (5000.00, 5000.00) mas
    1674: (  1.1,   0.9) m, (5000.00, 5000.00) mas
     962: (  0.4,  -1.4) m, (5000.00, 5000.00) mas
    1061: ( -1.2,  -1.1) m, (5000.00, 5000.00) mas
     833: ( -2.1,  -1.7) m, (5000.00, 5000.00) mas
     567: ( -3.1,  -2.6) m, (5000.00, 5000.00) mas
     374: ( -3.9,  -3.2) m, (5000.00, 5000.00) mas
      94: ( -3.1,  -4.4) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    2724: (  0.7,   4.7) m, (5000.00, 5000.00) mas
    2510: (  0.6,   3.7) m, (5000.00, 5000.00) mas
    2247: (  0.4,   2.7) m, (5000.00, 5000.00) mas
    2004: (  0.2,   1.9) m, (5000.00, 5000.00) mas
    1777: (  0.1,   1.2) m, (5000.00, 5000.00) mas
    1263: ( -1.4,  -0.4) m, (5000.00, 5000.00) mas
     843: ( -0.4,  -1.7) m, (5000.00, 5000.00) mas
     488: ( -0.6,  -2.9) m, (5000.00, 5000.00) mas
     225: ( -0.7,  -3.9) m, (5000.00, 5000.00) mas
      10: ( -0.9,  -4.9) m, (5000.00, 5000.00) mas
       6: ( -2.4,  -4.9) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    2608: ( -2.6,   4.2) m, (5000.00, 5000.00) mas
    2415: ( -2.1,   3.4) m, (5000.00, 5000.00) mas
    2327: ( -1.9,   3.1) m, (5000.00, 5000.00) mas
    2095: ( -1.4,   2.2) m, (5000.00, 5000.00) mas
    1720: ( -0.7,   1.1) m, (5000.00, 5000.00) mas
    1420: (  1.2,   0.1) m, (5000.00, 5000.00) mas
    1015: (  0.6,  -1.2) m, (5000.00, 5000.00) mas
     640: (  1.2,  -2.4) m, (5000.00, 5000.00) mas
     408: (  1.7,  -3.2) m, (5000.00, 5000.00) mas
     127: (  2.4,  -4.4) m, (5000.00, 5000.00) mas
      51: (  2.6,  -4.7) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    1862: ( -4.7,   1.6) m, (5000.00, 5000.00) mas
    1754: ( -3.7,   1.2) m, (5000.00, 5000.00) mas
    1705: ( -3.2,   1.1) m, (5000.00, 5000.00) mas
    1570: ( -1.9,   0.6) m, (5000.00, 5000.00) mas
    1522: ( -1.4,   0.4) m, (5000.00, 5000.00) mas
     958: ( -0.2,  -1.4) m, (5000.00, 5000.00) mas
    1213: (  1.2,  -0.6) m, (5000.00, 5000.00) mas
    1165: (  1.7,  -0.7) m, (5000.00, 5000.00) mas
     981: (  3.5,  -1.4) m, (5000.00, 5000.00) mas
     927: (  4.0,  -1.6) m, (5000.00, 5000.00) mas
    1288: (  5.2,  -0.4) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
     817: ( -4.7,  -1.7) m, (5000.00, 5000.00) mas
     937: ( -3.7,  -1.4) m, (5000.00, 5000.00) mas
     997: ( -3.2,  -1.2) m, (5000.00, 5000.00) mas
    1156: ( -1.9,  -0.7) m, (5000.00, 5000.00) mas
    1210: ( -1.4,  -0.6) m, (5000.00, 5000.00) mas
    1775: ( -0.2,   1.2) m, (5000.00, 5000.00) mas
    1525: (  1.2,   0.4) m, (5000.00, 5000.00) mas
    1579: (  1.7,   0.6) m, (5000.00, 5000.00) mas
    1798: (  3.5,   1.2) m, (5000.00, 5000.00) mas
    1858: (  4.0,   1.4) m, (5000.00, 5000.00) mas
    1496: (  5.2,   0.2) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
      97: ( -2.6,  -4.4) m, (5000.00, 5000.00) mas
     296: ( -2.1,  -3.5) m, (5000.00, 5000.00) mas
     386: ( -1.9,  -3.2) m, (5000.00, 5000.00) mas
     624: ( -1.4,  -2.4) m, (5000.00, 5000.00) mas
    1012: ( -0.7,  -1.2) m, (5000.00, 5000.00) mas
    1316: (  1.2,  -0.2) m, (5000.00, 5000.00) mas
    1723: (  0.6,   1.1) m, (5000.00, 5000.00) mas
    2111: (  1.2,   2.2) m, (5000.00, 5000.00) mas
    2349: (  1.7,   3.1) m, (5000.00, 5000.00) mas
    2638: (  2.4,   4.2) m, (5000.00, 5000.00) mas
    2711: (  2.6,   4.5) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
      15: (  0.7,  -4.9) m, (5000.00, 5000.00) mas
     233: (  0.6,  -3.9) m, (5000.00, 5000.00) mas
     494: (  0.4,  -2.9) m, (5000.00, 5000.00) mas
     735: (  0.2,  -2.1) m, (5000.00, 5000.00) mas
     960: (  0.1,  -1.4) m, (5000.00, 5000.00) mas
    1471: ( -1.4,   0.2) m, (5000.00, 5000.00) mas
    1888: ( -0.4,   1.6) m, (5000.00, 5000.00) mas
    2241: ( -0.6,   2.7) m, (5000.00, 5000.00) mas
    2502: ( -0.7,   3.7) m, (5000.00, 5000.00) mas
    2719: ( -0.9,   4.7) m, (5000.00, 5000.00) mas
    2716: ( -2.4,   4.7) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
     420: (  3.7,  -3.2) m, (5000.00, 5000.00) mas
     603: (  2.9,  -2.6) m, (5000.00, 5000.00) mas
     649: (  2.7,  -2.4) m, (5000.00, 5000.00) mas
     857: (  1.9,  -1.7) m, (5000.00, 5000.00) mas
    1066: (  1.1,  -1.1) m, (5000.00, 5000.00) mas
    1779: (  0.4,   1.2) m, (5000.00, 5000.00) mas
    1669: ( -1.2,   0.9) m, (5000.00, 5000.00) mas
    1878: ( -2.1,   1.6) m, (5000.00, 5000.00) mas
    2132: ( -3.1,   2.4) m, (5000.00, 5000.00) mas
    2315: ( -3.9,   3.1) m, (5000.00, 5000.00) mas
    2605: ( -3.1,   4.2) m, (5000.00, 5000.00) mas

[00;00mSetting up powfs 2 PO WFS[00;00m

OTF dimension is 48x48 (calculated)
Generating matched filter for powfs 2
Use sanea to derive neasim
Use sanea to derive neasim

[00;00mSetting up reconstructor[00;00m

Recon NEA: cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) geom(0.31) geom(0.31) geom(0.31) mf(0.14)  mas
Setup or update control matrix parameters.
RRtwfs svd threshold is 1e-10
Replacing HA by HA*fit->actextrap
Adding piston cr to fit matrix
Adding TT cr on upper DMs to fit matrix.
Before assembling fit matrix:	5010.5 MiB.
Building fit->FR
Building fit->FL
Adding tikhonov constraint of 1.0e-07 to FLM
The maximum eigen value is estimated to be around 2.9e-04
DM Fit number of Low rank terms: 16 in LHS
After assemble fit matrix:	6546.7 MiB.
After setup_recon:	6546.7 MiB.
GPU 0: mem used 1902 MB (wfs init)
GPU 0: mem used 2856 MB (recon init)
GPU 0: mem used 2888 MB (perf init)

*** Simulation started at 2025/02/17 15:10:57 in nid001972. ***

Running seed 1
GPU 0: mem used 2888 MB (wfs seeding)
Wind dir: 267.3 261.7 167.0 130.5 300.7  32.3 119.8 139.0 150.8 277.7 203.0 133.1  45.9 265.1 deg
Using /global/homes/b/bpeck/.aos/cache/atm/vonkarman_14_8192x8192_0.0078125_1115374592d.bin
After genatm:	6465.7 MiB.
Step     #  Open Loop  PR TT  On axis  PR TT  Field RMS PR TT     Timing 
Step     0: OL  884.6  248.3  OA  884.6 248.3 CL  884.6 248.3 nm  0.103 s
Step    15: OL  907.5  254.1  OA  756.3 234.0 CL  756.3 234.0 nm  0.066 s
Step    29: OL  929.1  258.5  OA  752.7 234.4 CL  752.7 234.4 nm  0.076 s
Step    43: OL  950.3  261.0  OA  744.5 230.5 CL  744.5 230.5 nm  0.085 s
Step    56: OL  969.6  261.2  OA  731.2 225.4 CL  731.2 225.4 nm  0.073 s
Step    69: OL  989.6  260.2  OA  720.2 219.8 CL  720.2 219.8 nm  0.078 s
Step    83: OL 1011.7  258.7  OA  708.9 213.9 CL  708.9 213.9 nm  0.081 s
Step    97: OL 1034.2  257.9  OA  703.8 210.9 CL  703.8 210.9 nm  0.071 s
Step   111: OL 1056.8  258.1  OA  697.1 205.9 CL  697.1 205.9 nm  0.076 s
Step   125: OL 1078.8  259.7  OA  694.6 201.4 CL  694.6 201.4 nm  0.075 s
Step   138: OL 1097.9  263.2  OA  694.6 197.3 CL  694.6 197.3 nm  0.085 s
Step   152: OL 1116.9  268.8  OA  691.1 193.2 CL  691.1 193.2 nm  0.078 s
Step   166: OL 1133.5  276.1  OA  688.8 191.5 CL  688.8 191.5 nm  0.074 s
Step   180: OL 1147.6  284.6  OA  689.1 192.4 CL  689.1 192.4 nm  0.083 s
Step   193: OL 1157.9  293.0  OA  689.4 194.4 CL  689.4 194.4 nm  0.076 s
Step   206: OL 1166.2  301.4  OA  691.6 198.2 CL  691.6 198.2 nm  0.075 s
Step   220: OL 1173.0  310.3  OA  696.8 204.0 CL  696.8 204.0 nm  0.076 s
Step   234: OL 1177.1  319.5  OA  704.4 211.7 CL  704.4 211.7 nm  0.073 s
Step   248: OL 1178.3  329.2  OA  707.1 220.6 CL  707.1 220.6 nm  0.076 s
Step   255 updated high order loop gain: 0.424
Step   261: OL 1175.5  338.5  OA  712.4 231.9 CL  712.4 231.9 nm  0.080 s
Step   275: OL 1168.1  348.6  OA  713.7 243.9 CL  713.7 243.9 nm  0.073 s
Step   289: OL 1157.2  359.4  OA  716.5 256.8 CL  716.5 256.8 nm  0.088 s
Step   303: OL 1144.4  371.5  OA  717.2 269.5 CL  717.2 269.5 nm  0.073 s
Step   317: OL 1129.1  384.5  OA  718.3 283.3 CL  718.3 283.3 nm  0.077 s
Step   330: OL 1113.0  397.7  OA  720.9 297.5 CL  720.9 297.5 nm  0.079 s
Step   344: OL 1095.1  414.0  OA  722.9 312.5 CL  722.9 312.5 nm  0.076 s
Step   358: OL 1076.9  432.3  OA  727.3 331.2 CL  727.3 331.2 nm  0.083 s
Step   372: OL 1059.4  452.0  OA  730.7 350.9 CL  730.7 350.9 nm  0.077 s
Step   386: OL 1042.5  472.2  OA  736.2 369.7 CL  736.2 369.7 nm  0.080 s
Step   397: OL 1029.4  488.1  OA  739.7 384.0 CL  739.7 384.0 nm  0.078 s
Step   410: OL 1013.5  506.5  OA  746.2 400.2 CL  746.2 400.2 nm  0.073 s
Step   424: OL  995.9  525.3  OA  750.3 418.5 CL  750.3 418.5 nm  0.071 s
Step   437: OL  979.8  542.6  OA  753.5 434.6 CL  753.5 434.6 nm  0.073 s
Step   451: OL  963.7  560.7  OA  754.7 449.7 CL  754.7 449.7 nm  0.078 s
Step   464: OL  951.8  577.7  OA  757.1 464.1 CL  757.1 464.1 nm  0.078 s
Step   478: OL  942.9  595.7  OA  763.1 480.1 CL  763.1 480.1 nm  0.076 s
Step   492: OL  939.1  613.0  OA  774.7 495.2 CL  774.7 495.2 nm  0.081 s
Step   506: OL  938.6  629.1  OA  788.0 509.8 CL  788.0 509.8 nm  0.075 s
Step   511 updated high order loop gain: 0.426
Step   519: OL  940.4  642.3  OA  799.9 520.8 CL  799.9 520.8 nm  0.076 s
Step   532: OL  944.2  653.1  OA  810.1 528.8 CL  810.1 528.8 nm  0.084 s
Step   546: OL  950.7  661.5  OA  820.7 533.3 CL  820.7 533.3 nm  0.074 s
Step   560: OL  960.0  667.0  OA  830.2 535.8 CL  830.2 535.8 nm  0.082 s
Step   573: OL  970.6  669.9  OA  837.9 536.0 CL  837.9 536.0 nm  0.080 s
Step   586: OL  982.9  670.9  OA  843.8 532.8 CL  843.8 532.8 nm  0.078 s
Step   599: OL  996.7  669.4  OA  847.3 527.1 CL  847.3 527.1 nm  0.076 s
Step   613: OL 1012.4  664.6  OA  849.6 518.4 CL  849.6 518.4 nm  0.078 s
Step   627: OL 1028.2  656.9  OA  848.2 506.6 CL  848.2 506.6 nm  0.073 s
Step   641: OL 1043.4  646.6  OA  842.5 493.0 CL  842.5 493.0 nm  0.077 s
Step   654: OL 1055.9  635.2  OA  832.6 478.2 CL  832.6 478.2 nm  0.078 s
Step   668: OL 1068.2  621.3  OA  821.2 461.4 CL  821.2 461.4 nm  0.085 s
Step   682: OL 1079.5  606.7  OA  809.9 444.4 CL  809.9 444.4 nm  0.073 s
Step   695: OL 1088.9  592.8  OA  798.1 426.3 CL  798.1 426.3 nm  0.076 s
Step   708: OL 1096.1  577.7  OA  787.6 407.6 CL  787.6 407.6 nm  0.081 s
Step   722: OL 1100.8  560.5  OA  772.9 384.4 CL  772.9 384.4 nm  0.075 s
Step   736: OL 1101.9  543.2  OA  758.2 362.2 CL  758.2 362.2 nm  0.077 s
Step   749: OL 1099.8  527.3  OA  744.6 342.2 CL  744.6 342.2 nm  0.084 s
Step   762: OL 1094.9  511.9  OA  728.8 323.2 CL  728.8 323.2 nm  0.075 s
Step   767 updated high order loop gain: 0.427
Step   776: OL 1086.6  496.0  OA  711.4 304.9 CL  711.4 304.9 nm  0.086 s
Step   787: OL 1077.4  483.6  OA  699.8 292.8 CL  699.8 292.8 nm  0.138 s
Step   791: OL 1073.5  479.2  OA  694.7 288.3 CL  694.7 288.3 nm  0.547 s
Step   805: OL 1058.1  463.6  OA  678.7 272.1 CL  678.7 272.1 nm  0.077 s
Step   819: OL 1040.2  448.0  OA  664.9 256.5 CL  664.9 256.5 nm  0.076 s
Step   833: OL 1019.6  432.7  OA  652.3 240.5 CL  652.3 240.5 nm  0.080 s
Step   847: OL  997.8  418.2  OA  641.2 224.5 CL  641.2 224.5 nm  0.073 s
Step   861: OL  975.9  404.8  OA  634.8 212.2 CL  634.8 212.2 nm  0.080 s
Step   875: OL  955.1  393.0  OA  631.0 201.9 CL  631.0 201.9 nm  0.075 s
Step   889: OL  935.9  382.8  OA  630.4 194.6 CL  630.4 194.6 nm  0.074 s
Step   902: OL  917.7  374.4  OA  629.3 189.3 CL  629.3 189.3 nm  0.082 s
Step   916: OL  897.5  367.0  OA  624.4 186.8 CL  624.4 186.8 nm  0.072 s
Step   930: OL  877.8  360.3  OA  618.1 185.4 CL  618.1 185.4 nm  0.073 s
Step   944: OL  858.7  353.6  OA  610.6 185.2 CL  610.6 185.2 nm  0.075 s
Step   958: OL  840.8  346.6  OA  604.9 184.4 CL  604.9 184.4 nm  0.074 s
Step   971: OL  826.5  339.3  OA  599.7 183.1 CL  599.7 183.1 nm  0.081 s
Step   985: OL  813.3  330.6  OA  595.8 182.1 CL  595.8 182.1 nm  0.074 s
Step   999: OL  801.3  320.8  OA  594.3 178.2 CL  594.3 178.2 nm  0.074 s
Step  1013: OL  790.1  310.2  OA  591.0 174.5 CL  591.0 174.5 nm  0.077 s
Step  1023 updated high order loop gain: 0.427
Step  1026: OL  781.0  300.1  OA  587.0 171.0 CL  587.0 171.0 nm  0.073 s
Step  1040: OL  772.2  288.6  OA  583.5 165.5 CL  583.5 165.5 nm  0.085 s
Step  1054: OL  763.4  276.1  OA  578.0 159.7 CL  578.0 159.7 nm  0.074 s
Step  1068: OL  754.7  262.0  OA  573.9 152.0 CL  573.9 152.0 nm  0.074 s
Step  1081: OL  748.4  247.3  OA  570.9 140.5 CL  570.9 140.5 nm  0.083 s
Step  1095: OL  743.7  231.1  OA  568.7 126.5 CL  568.7 126.5 nm  0.076 s
Step  1108: OL  740.9  217.2  OA  567.3 113.5 CL  567.3 113.5 nm  0.074 s
Step  1122: OL  739.0  203.7  OA  568.3 100.2 CL  568.3 100.2 nm  0.072 s
Step  1136: OL  737.9  192.5  OA  570.3  88.8 CL  570.3  88.8 nm  0.073 s
Step  1150: OL  737.2  183.4  OA  572.2  80.4 CL  572.2  80.4 nm  0.080 s
Step  1164: OL  736.6  176.4  OA  576.6  74.9 CL  576.6  74.9 nm  0.075 s
Step  1177: OL  736.5  172.1  OA  581.8  72.1 CL  581.8  72.1 nm  0.072 s
Step  1190: OL  738.0  169.0  OA  588.2  69.7 CL  588.2  69.7 nm  0.081 s
Step  1204: OL  740.7  166.2  OA  598.2  67.5 CL  598.2  67.5 nm  0.074 s
Step  1218: OL  743.7  164.1  OA  608.2  66.2 CL  608.2  66.2 nm  0.076 s
Step  1232: OL  746.9  163.5  OA  618.2  66.4 CL  618.2  66.4 nm  0.075 s
Step  1246: OL  749.4  165.1  OA  625.7  70.5 CL  625.7  70.5 nm  0.074 s
Step  1259: OL  752.5  168.9  OA  631.8  75.4 CL  631.8  75.4 nm  0.079 s
Step  1273: OL  756.5  175.2  OA  637.9  81.4 CL  637.9  81.4 nm  0.076 s
Step  1279 updated high order loop gain: 0.427
Step  1287: OL  761.8  183.1  OA  642.2  88.0 CL  642.2  88.0 nm  0.083 s
Step  1300: OL  767.2  191.6  OA  645.8  93.4 CL  645.8  93.4 nm  0.074 s
Step  1314: OL  772.3  201.9  OA  644.9  99.1 CL  644.9  99.1 nm  0.073 s
Step  1328: OL  777.1  213.5  OA  642.5 104.6 CL  642.5 104.6 nm  0.077 s
Step  1342: OL  782.7  226.0  OA  638.9 111.6 CL  638.9 111.6 nm  0.072 s
Step  1355: OL  789.4  237.9  OA  637.2 115.6 CL  637.2 115.6 nm  0.084 s
Step  1369: OL  797.8  249.1  OA  639.2 118.3 CL  639.2 118.3 nm  0.071 s
Step  1383: OL  806.7  258.1  OA  641.3 119.4 CL  641.3 119.4 nm  0.074 s
Step  1396: OL  815.8  264.7  OA  647.0 118.2 CL  647.0 118.2 nm  0.082 s
Step  1410: OL  826.8  269.9  OA  655.0 116.1 CL  655.0 116.1 nm  0.074 s
Step  1423: OL  837.7  273.4  OA  661.1 113.3 CL  661.1 113.3 nm  0.071 s
Step  1437: OL  849.0  276.5  OA  665.8 110.9 CL  665.8 110.9 nm  0.076 s
Step  1451: OL  859.4  278.8  OA  670.3 108.9 CL  670.3 108.9 nm  0.073 s
Step  1465: OL  868.5  279.7  OA  669.7 106.2 CL  669.7 106.2 nm  0.080 s
Step  1479: OL  874.4  278.7  OA  669.1 103.6 CL  669.1 103.6 nm  0.078 s
Step  1493: OL  876.4  275.6  OA  666.5 105.0 CL  666.5 105.0 nm  0.077 s
Step  1507: OL  875.1  270.5  OA  658.0 105.5 CL  658.0 105.5 nm  0.072 s
Step  1521: OL  871.4  264.0  OA  647.6 105.7 CL  647.6 105.7 nm  0.077 s
Step  1535: OL  865.7  256.2  OA  641.1 105.5 CL  641.1 105.5 nm  0.074 s
Step  1535 updated high order loop gain: 0.428
Step  1548: OL  859.5  247.8  OA  636.0 103.9 CL  636.0 103.9 nm  0.075 s
Step  1561: OL  853.4  239.2  OA  632.8 101.8 CL  632.8 101.8 nm  0.082 s
Step  1575: OL  847.0  230.9  OA  630.9 102.4 CL  630.9 102.4 nm  0.072 s
Step  1589: OL  840.2  224.1  OA  629.4 104.7 CL  629.4 104.7 nm  0.072 s
Step 1599: Output PSF
Step  1599: OL  835.1  220.0  OA  630.4 108.1 CL  630.4 108.1 nm  1.445 s
Mean: 685.97 290.76 621.30  nm.

*** Simulation Finished at 2025/02/17 15:13:09 in nid001972. ***

