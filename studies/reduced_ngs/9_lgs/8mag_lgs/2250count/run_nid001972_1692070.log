Warning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
/global/cfs/cdirs/ulens/vismcao/maos -o studies/reduced_ngs/9_lgs/8mag_lgs/2250count -c master_files/reduced_ngs/9_lgs/8mag_lgs/kola_2250act.conf -O 
Output folder is 'studies/reduced_ngs/9_lgs/8mag_lgs/2250count'.
SRC: /global/homes/b/bpeck/code/maos v2.9 4c88b7c2 2024-11-13 16:45:33 -0800
BUILT: /global/homes/b/bpeck/code/maos/optim by GCC (v12) on 2024/11/18 09:40:03 CPU(F64,+O3) with CUDA(v122,F32)
Launched at 2025/02/17 14:54:40 in nid001972 with PID 1692070.
The web based job monitor can be accessed at http://localhost:10300
Main config file is /global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_2250act.conf
Warning(path.c:48): Path not found: path=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; abspath=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; Ignored.
Warning(path.c:48): Path not found: path=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; abspath=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; Ignored.
Warning(readcfg.c:399): sim.apfsm has been renamed to powfs.apfsm.
Warning(readcfg.c:399): sim.epfsm has been renamed to powfs.epfsm.
Warning(readcfg.c:399): sim.alfsm has been renamed to powfs.alfsm.
Warning(readcfg.c:399): sim.commonfsm has been renamed to powfs.commonfsm.
Warning(readcfg.c:399): sim.idealfsm has been renamed to powfs.idealfsm.
Warning(readcfg.c:399): sim.zetafsm has been renamed to powfs.zetafsm.
Warning(readcfg.c:399): sim.f0fsm has been renamed to powfs.f0fsm.
Warning(readcfg.c:399): tsurf has been renamed to ncpa.tsurf.
loaded 132 (132 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_sim.conf'
loaded  19 ( 19 new) records from '/global/cfs/cdirs/ulens/vismcao/./dm_none.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_ASM.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_DM2.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_DM3.conf'
loaded   0 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_dm_multiple.conf'
loaded   7 (  5 new) records from '/global/cfs/cdirs/ulens/vismcao/./atm_mk13n50p_ground_detail.conf'
loaded  76 ( 69 new) records from '/global/homes/b/bpeck/code/maos/config/maos/powfs_common.conf'
loaded  44 ( 38 new) records from '/global/cfs/cdirs/ulens/vismcao/./powfs_none.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_lgs.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_ttf_strap.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_twfs_lbwfs.conf'
loaded   0 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_wfs_lgs_strap_lbwfs.conf'
loaded  71 ( 71 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_recon.conf'
Warning(readcfg.c:399): dbg.na_smooth has been renamed to powfs0_llt.na_smooth.
Warning(readcfg.c:399): dbg.na_interp has been renamed to powfs0_llt.na_interp.
Warning(readcfg.c:399): dbg.na_thres has been renamed to powfs0_llt.na_thres.
Warning(readcfg.c:399): dbg.na_fit_maxit has been renamed to powfs0_llt.na_fit_maxit.
Warning(readcfg.c:399): dbg.na_fit_svdthres has been renamed to powfs0_llt.na_fit_svdthres.
Warning(readcfg.c:399): dbg.na_fit_dh has been renamed to powfs0_llt.na_fit_dh.
Warning(readcfg.c:399): dbg.ncpa_preload has been renamed to ncpa.preload.
Warning(readcfg.c:399): dbg.ncpa_rmsci has been renamed to ncpa.rmsci.
Warning(readcfg.c:399): dbg.draw_opdmax has been renamed to plot.opdmax.
Warning(readcfg.c:399): dbg.draw_gmax has been renamed to plot.gmax.
loaded  95 ( 93 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_dbg.conf'
loaded   4 (  4 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_fit_mcao.conf'
Warning(readcfg.c:399): surf has been renamed to ncpa.surf.
loaded  39 (  7 new) records from '/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_2250act.conf'
loaded   0 (  0 new) records from 'command line'
loaded  24 ( 18 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_llt_CL.conf'
Adjust LGS range by telescope altitude 4145m.
Zenith angle is 30 degree.
    Scaling turbulence height and LGS hs by sec(za).
    Scaling r0 by cos(za)^(3/5).
    Scaling wind speed and LGS signal level by cos(za).
powfs0: Adjusting dx from 0.0078125 to 0.00792308. 
powfs0.llt.fsm: f0=0 Hz, LPF ep=0
powfs0.epfsm is set to 0.517618 (auto)
powfs2: Adjusting dx from 0.03125 to 0.0312778. 
powfs2 is TWFS for powfs0
sim.ephi is set to 0.427717 (auto)
sim.eplo is set to 0.427717 (auto)
Warning(parms.c:2296): Layer 1 at 17.3205m is very close to layer 0 at 0m (OK).
Warning(parms.c:2296): Layer 2 at 34.641m is very close to layer 1 at 17.3205m (OK).
Warning(parms.c:2296): Layer 3 at 51.9615m is very close to layer 2 at 34.641m (OK).
dm 0: stroke=30 um is provided in micron.
dm 0: assume ia stroke=2 um is provided in micron.
dm 1: stroke=7 um is provided in micron.
dm 1: assume ia stroke=2 um is provided in micron.
dm 2: stroke=7 um is provided in micron.
dm 2: assume ia stroke=2 um is provided in micron.
Focus blending is not implemented yet for integrated tomography
parms->sim.mffocus is reset to 0
There are 1 valid simulation seeds:  1
Output PSF for 1 directions
Used 449 of 456 supplied keys
Warning(readcfg.c:158): key "dbg.pwfs_flate" is not recognized, value is 0
Warning(readcfg.c:158): key "dbg.pwfs_flatv" is not recognized, value is 0
Warning(readcfg.c:158): key "dbg.pwfs_psx" is not recognized, value is [0 0 0 0]
Warning(readcfg.c:158): key "dbg.pwfs_psy" is not recognized, value is [0 0 0 0]
Warning(readcfg.c:158): key "dbg.pwfs_pupelong" is not recognized, value is 0
Warning(readcfg.c:158): key "dbg.pwfs_raw" is not recognized, value is 0
Warning(readcfg.c:158): key "dbg.pwfs_side" is not recognized, value is 4
[00;00mAperture[00;00m is 11 m with sampling 1/128 m
[00;00mTurbulence at 30 degree zenith angle:[00;00m r0=0.128424m, L0=30m, 14 layers.
    Greenwood freq is 25.1Hz, anisoplanatic angle is 1.58 as
    Sampled 8192x8192 at 1/128m. wind dir is randomized.
    layer 0: ht=      0 m, wt= 0.302, ws=  4.8 m/s
    layer 1: ht=     17 m, wt= 0.154, ws=  5.0 m/s
    layer 2: ht=     35 m, wt= 0.041, ws=  5.4 m/s
    layer 3: ht=     52 m, wt= 0.002, ws=  6.6 m/s
    layer 4: ht=    139 m, wt= 0.021, ws=  6.1 m/s
    layer 5: ht=    231 m, wt= 0.010, ws=  6.1 m/s
    layer 6: ht=    323 m, wt= 0.008, ws=  6.1 m/s
    layer 7: ht=    416 m, wt= 0.005, ws=  6.1 m/s
    layer 8: ht=    508 m, wt= 0.001, ws=  6.1 m/s
    layer 9: ht=    932 m, wt= 0.107, ws=  5.6 m/s
    layer 10: ht=   5022 m, wt= 0.144, ws= 11.1 m/s
    layer 11: ht=   9238 m, wt= 0.093, ws= 19.1 m/s
    layer 12: ht=  13856 m, wt= 0.075, ws=  8.2 m/s
    layer 13: ht=  22518 m, wt= 0.036, ws=  4.8 m/s
[00;00mReconstruction[00;00m: r0=0.128424m L0=30m. 14 layers. use cone coordinate.
    layer 0: ht=      0 m, wt= 0.302
    layer 1: ht=     17 m, wt= 0.154
    layer 2: ht=     35 m, wt= 0.041
    layer 3: ht=     52 m, wt= 0.002
    layer 4: ht=    139 m, wt= 0.021
    layer 5: ht=    231 m, wt= 0.010
    layer 6: ht=    323 m, wt= 0.008
    layer 7: ht=    416 m, wt= 0.005
    layer 8: ht=    508 m, wt= 0.001
    layer 9: ht=    932 m, wt= 0.107
    layer 10: ht=   5022 m, wt= 0.144
    layer 11: ht=   9238 m, wt= 0.093
    layer 12: ht=  13856 m, wt= 0.075
    layer 13: ht=  22518 m, wt= 0.036
[00;00mThere are 3 powfs[00;00m
  powfs0: Order 54, LGS at 99.1 km. Sampling 1/126.214 m. Thres 30%. [00;00mT/T is removed in right hand side in tomography.[00;00m
    CCD image is 25x25 @ 500x500 mas, blur 27% (sigma), 1500Hz, wvl: [ 5.89e-07]
    Gtilt in reconstruction. Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
  powfs1: Order  2, NGS at inf km. Sampling 1/16 m. Thres 30%. 
    Ztilt in reconstruction. Geomtric optics start at 2 with ztilt [00;00m(noisy)[00;00m
  powfs2: Order 20, NGS at inf km. Sampling 1/31.9716 m. Thres 50%. 
    CCD image is 4x4 @ 1500x1500 mas, blur 0% (sigma), 0.015Hz, wvl: [ 7.2e-07]
    Gtilt in reconstruction. Geomtric optics start at 50 with gtilt Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
[00;00mThere are 13 wfs[00;00m
    wfs 0: type 0, at (  30.00,    0.00) arcsec,  99 km, siglev is 50.8825 bkgrnd is 0.1
    wfs 1: type 0, at (  22.98,   19.28) arcsec,  99 km, siglev is 50.8825 bkgrnd is 0.1
    wfs 2: type 0, at (   5.21,   29.54) arcsec,  99 km, siglev is 50.8825 bkgrnd is 0.1
    wfs 3: type 0, at ( -15.00,   25.98) arcsec,  99 km, siglev is 50.8825 bkgrnd is 0.1
    wfs 4: type 0, at ( -28.19,   10.26) arcsec,  99 km, siglev is 50.8825 bkgrnd is 0.1
    wfs 5: type 0, at ( -28.19,  -10.26) arcsec,  99 km, siglev is 50.8825 bkgrnd is 0.1
    wfs 6: type 0, at ( -15.00,  -25.98) arcsec,  99 km, siglev is 50.8825 bkgrnd is 0.1
    wfs 7: type 0, at (   5.21,  -29.54) arcsec,  99 km, siglev is 50.8825 bkgrnd is 0.1
    wfs 8: type 0, at (  22.98,  -19.28) arcsec,  99 km, siglev is 50.8825 bkgrnd is 0.1
    wfs 9: type 1, at (   5.00,    8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 10: type 1, at ( -10.00,    0.00) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 11: type 1, at (   5.00,   -8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 12: type 2, at (   0.00,    0.00) arcsec, inf km, siglev is 4.1558e+06 bkgrnd is 0.001
[00;00mThere are 3 DMs[00;00m
  DM 0 at -0.1km, actuator pitch 0.206m, offset   0, with 30.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 1 at    6km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 2 at   10km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
[00;00mTomography[00;00m is using CG, with [00;00mFourer Domain[00;00m preconditioner, [00;00m12[00;00m iterations, integrated tomo.
[00;00mDM Fitting [00;00mis using CG, with [00;00mNo[00;00m preconditioner, [00;00m10[00;00m iterations
[00;00mThere are 9 fit directions[00;00m
    Fit 0: weight is 0.444, at (   0.00,    0.00) arcsec
    Fit 1: weight is 0.111, at (  15.00,    0.00) arcsec
    Fit 2: weight is 0.111, at (   0.00,   15.00) arcsec
    Fit 3: weight is 0.111, at ( -15.00,    0.00) arcsec
    Fit 4: weight is 0.111, at (   0.00,  -15.00) arcsec
    Fit 5: weight is 0.028, at (  15.00,   15.00) arcsec
    Fit 6: weight is 0.028, at ( -15.00,   15.00) arcsec
    Fit 7: weight is 0.028, at ( -15.00,  -15.00) arcsec
    Fit 8: weight is 0.028, at (  15.00,  -15.00) arcsec
[00;00mThere are 1 evaluation directions[00;00m at sampling 1/128 m.
    Evl 0: weight is 1.000, at (   0.00,    0.00) arcsec
[00;00mSimulation[00;00m start at step 0, end at step 1600, with time step 1/1500s, [00;00mclose loop[00;00m.
After setup_parms:	120.5 MiB.
Warning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
CUDA: minimum memory requirement is 0.3GB
GPU 0 is NVIDIA A100-SXM4-40GB with arch 8.0, 38.9GB free, 39.3GB total device memory.
Using GPU 0
Use 1 GPUs for WFS Tomo Fit Evl

*** Preparation started at 2025/02/17 14:54:40 in nid001972. ***

Using OpenMP version 201511 with 128 threads
Reading aperture amplitude map from KECK.fits
Warning(accphi.c:477): 108454 points not covered by input screen
Warning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
 ->maos.c:447->setup.c:148->aper.c:74->utils.c:478->accphi.c:478
iwvl 0: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 1: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 2: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 3: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 4: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 5: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 6: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 7: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 8: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
After setup_aper:	344.8 MiB.

[00;00mSetting up powfs 0 geom[00;00m

There are 26 points in each subaperture of 0.206m.
There are 1760 valid subaperture.

[00;00mSetting up powfs 1 geom[00;00m

There are 88 points in each subaperture of 5.5m.
There are 4 valid subaperture.

[00;00mSetting up powfs 2 geom[00;00m

There are 18 points in each subaperture of 0.563m.
There are 236 valid subaperture.
After setup_powfs_init:	416.2 MiB.

[00;00mSetting up reconstructor geometry.[00;00m

PLOC is 111x111, with sampling of 0.10m (square)
    DM 0: grid is 57 x 57
    DM 1: grid is 75 x 75
    DM 2: grid is 80 x 79
FLOC is 111x111, with sampling of 0.10m (not square)
Tomography grid is square:
    layer 0: xloc grid is 192 x 192, sampling is 0.103 m, 36864 points
    layer 1: xloc grid is 192 x 192, sampling is 0.103 m, 36864 points
    layer 2: xloc grid is 192 x 192, sampling is 0.103 m, 36864 points
    layer 3: xloc grid is 192 x 192, sampling is 0.103 m, 36864 points
    layer 4: xloc grid is 192 x 192, sampling is 0.103 m, 36864 points
    layer 5: xloc grid is 192 x 192, sampling is 0.103 m, 36864 points
    layer 6: xloc grid is 192 x 192, sampling is 0.103 m, 36864 points
    layer 7: xloc grid is 192 x 192, sampling is 0.103 m, 36864 points
    layer 8: xloc grid is 192 x 192, sampling is 0.102 m, 36864 points
    layer 9: xloc grid is 192 x 192, sampling is 0.102 m, 36864 points
    layer 10: xloc grid is 192 x 192, sampling is 0.098 m, 36864 points
    layer 11: xloc grid is 192 x 192, sampling is 0.093 m, 36864 points
    layer 12: xloc grid is 192 x 192, sampling is 0.089 m, 36864 points
Warning(map.c:195): ninx=192 is too small. need 193
Warning(map.c:200): niny=192 is too small. need 193
    layer 13: xloc grid is 192 x 192, sampling is 0.080 m, 36864 points

[00;00mSetting up powfs 0 PO WFS[00;00m

OTF dimension is 54x54 (calculated)
Uplink FWHM (illt 0, iwvl 0) is 0.577752"
Downlink FWHM (illt 0, iwvl 0) is 0"
Generating matched filter for powfs 0
sa index   location       noise equivalent angle
     878: (  4.9,  -0.2) m, (5000.00, 5000.00) mas
     872: (  3.7,  -0.2) m, (5000.00, 5000.00) mas
     867: (  2.7,  -0.2) m, (5000.00, 5000.00) mas
     862: (  1.6,  -0.2) m, (5000.00, 5000.00) mas
     860: (  1.2,  -0.2) m, (5000.00, 5000.00) mas
     609: ( -0.6,  -1.4) m, (5000.00, 5000.00) mas
     858: ( -1.6,  -0.2) m, (5000.00, 5000.00) mas
     852: ( -2.9,  -0.2) m, (5000.00, 5000.00) mas
     847: ( -3.9,  -0.2) m, (5000.00, 5000.00) mas
     841: ( -5.1,  -0.2) m, (5000.00, 5000.00) mas
     840: ( -5.4,  -0.2) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    1499: (  3.5,   2.9) m, (5000.00, 5000.00) mas
    1298: (  2.3,   1.9) m, (5000.00, 5000.00) mas
    1110: (  1.2,   1.0) m, (5000.00, 5000.00) mas
    1067: (  1.0,   0.8) m, (5000.00, 5000.00) mas
     614: (  0.4,  -1.4) m, (5000.00, 5000.00) mas
     694: ( -1.2,  -1.0) m, (5000.00, 5000.00) mas
     651: ( -1.4,  -1.2) m, (5000.00, 5000.00) mas
     463: ( -2.5,  -2.1) m, (5000.00, 5000.00) mas
     262: ( -3.7,  -3.1) m, (5000.00, 5000.00) mas
      67: ( -3.1,  -4.3) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    1683: (  0.6,   4.1) m, (5000.00, 5000.00) mas
    1484: (  0.4,   2.9) m, (5000.00, 5000.00) mas
    1243: (  0.2,   1.6) m, (5000.00, 5000.00) mas
    1151: (  0.2,   1.2) m, (5000.00, 5000.00) mas
     817: ( -1.4,  -0.4) m, (5000.00, 5000.00) mas
     518: ( -0.4,  -1.9) m, (5000.00, 5000.00) mas
     315: ( -0.6,  -2.9) m, (5000.00, 5000.00) mas
     277: ( -0.6,  -3.1) m, (5000.00, 5000.00) mas
      78: ( -0.8,  -4.3) m, (5000.00, 5000.00) mas
       1: ( -2.5,  -4.9) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    1697: ( -2.7,   4.3) m, (5000.00, 5000.00) mas
    1546: ( -2.1,   3.3) m, (5000.00, 5000.00) mas
    1361: ( -1.4,   2.3) m, (5000.00, 5000.00) mas
    1281: ( -1.2,   1.9) m, (5000.00, 5000.00) mas
    1146: ( -0.8,   1.2) m, (5000.00, 5000.00) mas
     944: (  1.2,   0.2) m, (5000.00, 5000.00) mas
     615: (  0.6,  -1.4) m, (5000.00, 5000.00) mas
     480: (  1.0,  -2.1) m, (5000.00, 5000.00) mas
     215: (  1.9,  -3.5) m, (5000.00, 5000.00) mas
     152: (  2.1,  -3.9) m, (5000.00, 5000.00) mas
      64: (  2.5,  -4.5) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    1175: ( -4.3,   1.4) m, (5000.00, 5000.00) mas
    1057: ( -2.7,   0.8) m, (5000.00, 5000.00) mas
    1022: ( -2.1,   0.6) m, (5000.00, 5000.00) mas
     984: ( -1.4,   0.4) m, (5000.00, 5000.00) mas
    1107: (  0.6,   1.0) m, (5000.00, 5000.00) mas
     777: (  1.2,  -0.6) m, (5000.00, 5000.00) mas
     704: (  2.5,  -1.0) m, (5000.00, 5000.00) mas
     669: (  3.1,  -1.2) m, (5000.00, 5000.00) mas
     586: (  4.1,  -1.6) m, (5000.00, 5000.00) mas
     837: (  5.1,  -0.4) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
     545: ( -4.3,  -1.6) m, (5000.00, 5000.00) mas
     687: ( -2.7,  -1.0) m, (5000.00, 5000.00) mas
     730: ( -2.1,  -0.8) m, (5000.00, 5000.00) mas
     774: ( -1.4,  -0.6) m, (5000.00, 5000.00) mas
    1149: ( -0.2,   1.2) m, (5000.00, 5000.00) mas
     987: (  1.2,   0.4) m, (5000.00, 5000.00) mas
    1074: (  2.5,   0.8) m, (5000.00, 5000.00) mas
    1119: (  3.1,   1.0) m, (5000.00, 5000.00) mas
    1216: (  4.1,   1.4) m, (5000.00, 5000.00) mas
     963: (  5.1,   0.2) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
      39: ( -2.7,  -4.5) m, (5000.00, 5000.00) mas
     196: ( -2.1,  -3.5) m, (5000.00, 5000.00) mas
     387: ( -1.4,  -2.5) m, (5000.00, 5000.00) mas
     469: ( -1.2,  -2.1) m, (5000.00, 5000.00) mas
     608: ( -0.8,  -1.4) m, (5000.00, 5000.00) mas
     818: (  1.2,  -0.4) m, (5000.00, 5000.00) mas
    1153: (  0.6,   1.2) m, (5000.00, 5000.00) mas
    1292: (  1.0,   1.9) m, (5000.00, 5000.00) mas
    1565: (  1.9,   3.3) m, (5000.00, 5000.00) mas
    1630: (  2.1,   3.7) m, (5000.00, 5000.00) mas
    1722: (  2.5,   4.3) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
      85: (  0.6,  -4.3) m, (5000.00, 5000.00) mas
     282: (  0.4,  -3.1) m, (5000.00, 5000.00) mas
     521: (  0.2,  -1.9) m, (5000.00, 5000.00) mas
     613: (  0.2,  -1.4) m, (5000.00, 5000.00) mas
     943: ( -1.4,   0.2) m, (5000.00, 5000.00) mas
    1240: ( -0.4,   1.6) m, (5000.00, 5000.00) mas
    1441: ( -0.6,   2.7) m, (5000.00, 5000.00) mas
    1479: ( -0.6,   2.9) m, (5000.00, 5000.00) mas
    1676: ( -0.8,   4.1) m, (5000.00, 5000.00) mas
    1726: ( -2.7,   4.5) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
     297: (  3.5,  -3.1) m, (5000.00, 5000.00) mas
     486: (  2.3,  -2.1) m, (5000.00, 5000.00) mas
     660: (  1.2,  -1.2) m, (5000.00, 5000.00) mas
     697: (  1.0,  -1.0) m, (5000.00, 5000.00) mas
    1152: (  0.4,   1.2) m, (5000.00, 5000.00) mas
    1064: ( -1.2,   0.8) m, (5000.00, 5000.00) mas
    1101: ( -1.4,   1.0) m, (5000.00, 5000.00) mas
    1275: ( -2.5,   1.9) m, (5000.00, 5000.00) mas
    1464: ( -3.7,   2.9) m, (5000.00, 5000.00) mas
    1665: ( -3.1,   4.1) m, (5000.00, 5000.00) mas

[00;00mSetting up powfs 2 PO WFS[00;00m

OTF dimension is 48x48 (calculated)
Generating matched filter for powfs 2
Use sanea to derive neasim
Use sanea to derive neasim

[00;00mSetting up reconstructor[00;00m

Recon NEA: cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) geom(0.31) geom(0.31) geom(0.31) mf(0.14)  mas
Setup or update control matrix parameters.
RRtwfs svd threshold is 1e-10
Replacing HA by HA*fit->actextrap
Adding piston cr to fit matrix
Adding TT cr on upper DMs to fit matrix.
Before assembling fit matrix:	3730.6 MiB.
Building fit->FR
Building fit->FL
Adding tikhonov constraint of 1.0e-07 to FLM
The maximum eigen value is estimated to be around 3.2e-04
DM Fit number of Low rank terms: 16 in LHS
After assemble fit matrix:	4917.4 MiB.
After setup_recon:	4917.4 MiB.
GPU 0: mem used 2052 MB (wfs init)
GPU 0: mem used 2712 MB (recon init)
GPU 0: mem used 2744 MB (perf init)

*** Simulation started at 2025/02/17 14:55:24 in nid001972. ***

Running seed 1
GPU 0: mem used 2744 MB (wfs seeding)
Wind dir: 267.3 261.7 167.0 130.5 300.7  32.3 119.8 139.0 150.8 277.7 203.0 133.1  45.9 265.1 deg
Using /global/homes/b/bpeck/.aos/cache/atm/vonkarman_14_8192x8192_0.0078125_1115374592d.bin
After genatm:	4841.5 MiB.
Step     #  Open Loop  PR TT  On axis  PR TT  Field RMS PR TT     Timing 
Step     0: OL  884.6  248.3  OA  884.6 248.3 CL  884.6 248.3 nm  0.095 s
Step    20: OL  915.3  255.8  OA  719.6 244.8 CL  719.6 244.8 nm  0.055 s
Step    38: OL  942.9  260.3  OA  705.5 242.2 CL  705.5 242.2 nm  0.066 s
Step    56: OL  969.7  261.2  OA  687.5 235.8 CL  687.5 235.8 nm  0.056 s
Step    73: OL  995.6  259.7  OA  672.2 230.2 CL  672.2 230.2 nm  0.056 s
Step    90: OL 1022.6  258.2  OA  659.9 224.2 CL  659.9 224.2 nm  0.066 s
Step   108: OL 1051.3  257.9  OA  650.1 220.9 CL  650.1 220.9 nm  0.055 s
Step   126: OL 1079.4  259.8  OA  646.0 217.8 CL  646.0 217.8 nm  0.059 s
Step   144: OL 1105.2  265.3  OA  643.8 216.8 CL  643.8 216.8 nm  0.057 s
Step   162: OL 1127.5  273.7  OA  644.4 217.5 CL  644.4 217.5 nm  0.058 s
Step   179: OL 1144.7  283.9  OA  648.1 223.2 CL  648.1 223.2 nm  0.067 s
Step   196: OL 1157.4  294.9  OA  652.7 230.3 CL  652.7 230.3 nm  0.057 s
Step   214: OL 1167.0  306.3  OA  661.7 239.3 CL  661.7 239.3 nm  0.054 s
Step   232: OL 1172.3  318.0  OA  673.0 252.5 CL  673.0 252.5 nm  0.108 s
Step   250: OL 1172.7  330.5  OA  681.6 267.4 CL  681.6 267.4 nm  0.055 s
Step   255 updated high order loop gain: 0.423
Step   268: OL 1165.7  343.4  OA  691.4 283.3 CL  691.4 283.3 nm  0.060 s
Step   285: OL 1152.7  355.9  OA  696.7 299.1 CL  696.7 299.1 nm  0.055 s
Step   303: OL 1135.3  371.3  OA  699.4 315.6 CL  699.4 315.6 nm  0.056 s
Step   320: OL 1115.3  387.1  OA  703.2 331.4 CL  703.2 331.4 nm  0.069 s
Step   337: OL 1093.0  405.4  OA  706.5 346.8 CL  706.5 346.8 nm  0.056 s
Step   355: OL 1069.2  428.0  OA  711.7 368.3 CL  711.7 368.3 nm  0.057 s
Step   372: OL 1047.7  451.8  OA  721.9 391.2 CL  721.9 391.2 nm  0.066 s
Step   390: OL 1026.2  477.8  OA  732.1 412.1 CL  732.1 412.1 nm  0.058 s
Step   408: OL 1005.1  503.5  OA  742.7 432.9 CL  742.7 432.9 nm  0.057 s
Step   425: OL  984.4  526.5  OA  749.0 450.8 CL  749.0 450.8 nm  0.067 s
Step   443: OL  963.4  550.2  OA  754.2 468.6 CL  754.2 468.6 nm  0.055 s
Step   461: OL  945.8  573.7  OA  759.0 485.9 CL  759.0 485.9 nm  0.055 s
Step   478: OL  935.5  595.5  OA  768.8 501.8 CL  768.8 501.8 nm  0.072 s
Step   496: OL  932.5  617.6  OA  784.7 517.8 CL  784.7 517.8 nm  0.055 s
Step   511 updated high order loop gain: 0.426
Step   514: OL  934.3  637.3  OA  800.8 532.5 CL  800.8 532.5 nm  0.061 s
Step   531: OL  939.6  652.2  OA  817.0 543.4 CL  817.0 543.4 nm  0.055 s
Step   549: OL  949.3  662.8  OA  832.8 548.2 CL  832.8 548.2 nm  0.058 s
Step   567: OL  963.0  668.7  OA  844.3 549.4 CL  844.3 549.4 nm  0.068 s
Step   584: OL  978.9  670.8  OA  852.0 545.8 CL  852.0 545.8 nm  0.054 s
Step   602: OL  998.6  668.5  OA  859.9 537.5 CL  859.9 537.5 nm  0.056 s
Step   619: OL 1018.2  661.5  OA  861.4 525.3 CL  861.4 525.3 nm  0.064 s
Step   637: OL 1038.4  649.7  OA  857.5 509.4 CL  857.5 509.4 nm  0.057 s
Step   654: OL 1055.5  635.1  OA  845.7 491.6 CL  845.7 491.6 nm  0.055 s
Step   671: OL 1070.4  618.1  OA  832.7 473.6 CL  832.7 473.6 nm  0.071 s
Step   688: OL 1083.9  600.4  OA  817.8 452.7 CL  817.8 452.7 nm  0.055 s
Step   706: OL 1095.2  580.1  OA  801.0 430.2 CL  801.0 430.2 nm  0.056 s
Step   723: OL 1101.1  559.2  OA  781.2 405.2 CL  781.2 405.2 nm  0.066 s
Step   740: OL 1101.9  538.3  OA  761.8 382.1 CL  761.8 382.1 nm  0.085 s
Step   758: OL 1097.2  516.6  OA  737.6 359.9 CL  737.6 359.9 nm  0.056 s
Step   767 updated high order loop gain: 0.427
Step   775: OL 1087.8  497.0  OA  713.4 340.6 CL  713.4 340.6 nm  0.069 s
Step   792: OL 1073.0  478.0  OA  691.8 325.3 CL  691.8 325.3 nm  0.055 s
Step   810: OL 1052.7  457.9  OA  670.4 309.1 CL  670.4 309.1 nm  0.053 s
Step   826: OL 1030.9  440.2  OA  655.0 291.4 CL  655.0 291.4 nm  0.066 s
Step   843: OL 1004.9  422.2  OA  641.7 274.9 CL  641.7 274.9 nm  0.057 s
Step   860: OL  978.1  405.6  OA  630.3 258.4 CL  630.3 258.4 nm  0.057 s
Step   878: OL  951.4  390.6  OA  624.8 244.5 CL  624.8 244.5 nm  0.066 s
Step   896: OL  926.2  378.0  OA  622.3 232.2 CL  622.3 232.2 nm  0.054 s
Step   914: OL  899.9  367.9  OA  617.9 222.3 CL  617.9 222.3 nm  0.055 s
Step   931: OL  875.3  359.7  OA  612.5 215.6 CL  612.5 215.6 nm  0.067 s
Step   949: OL  850.4  351.0  OA  606.9 210.1 CL  606.9 210.1 nm  0.055 s
Step   967: OL  828.4  341.5  OA  600.6 204.0 CL  600.6 204.0 nm  0.066 s
Step   985: OL  810.5  330.5  OA  597.5 196.6 CL  597.5 196.6 nm  0.058 s
Step  1003: OL  794.8  317.7  OA  595.8 188.3 CL  595.8 188.3 nm  0.056 s
Step  1021: OL  781.0  304.0  OA  590.4 179.1 CL  590.4 179.1 nm  0.067 s
Step  1023 updated high order loop gain: 0.427
Step  1038: OL  770.0  290.2  OA  585.0 171.4 CL  585.0 171.4 nm  0.057 s
Step  1056: OL  758.8  274.2  OA  575.6 161.3 CL  575.6 161.3 nm  0.057 s
Step  1074: OL  748.6  255.3  OA  568.8 148.6 CL  568.8 148.6 nm  0.058 s
Step  1090: OL  742.5  236.7  OA  562.3 133.8 CL  562.3 133.8 nm  0.055 s
Step  1108: OL  738.8  217.1  OA  556.7 114.2 CL  556.7 114.2 nm  0.055 s
Step  1125: OL  737.2  201.0  OA  553.3  97.0 CL  553.3  97.0 nm  0.064 s
Step  1143: OL  736.5  187.6  OA  551.6  82.1 CL  551.6  82.1 nm  0.058 s
Step  1160: OL  736.2  178.1  OA  551.9  72.2 CL  551.9  72.2 nm  0.056 s
Step  1177: OL  736.2  172.1  OA  557.3  65.5 CL  557.3  65.5 nm  0.070 s
Step  1193: OL  738.5  168.4  OA  565.5  60.0 CL  565.5  60.0 nm  0.058 s
Step  1210: OL  742.0  165.2  OA  579.9  55.1 CL  579.9  55.1 nm  0.064 s
Step  1227: OL  745.9  163.5  OA  594.7  54.3 CL  594.7  54.3 nm  0.057 s
Step  1245: OL  749.2  164.9  OA  606.0  58.3 CL  606.0  58.3 nm  0.096 s
Step  1263: OL  753.6  170.5  OA  615.8  67.1 CL  615.8  67.1 nm  0.066 s
Step  1279 updated high order loop gain: 0.427
Step  1281: OL  759.3  179.6  OA  622.3  76.9 CL  622.3  76.9 nm  0.057 s
Step  1299: OL  767.0  190.9  OA  629.9  86.7 CL  629.9  86.7 nm  0.063 s
Step  1317: OL  773.9  204.3  OA  630.0  96.4 CL  630.0  96.4 nm  0.054 s
Step  1333: OL  779.9  217.8  OA  628.4 107.5 CL  628.4 107.5 nm  0.058 s
Step  1351: OL  788.7  234.3  OA  621.6 115.0 CL  621.6 115.0 nm  0.054 s
Step  1365: OL  797.4  246.1  OA  622.1 119.5 CL  622.1 119.5 nm  0.064 s
Step  1383: OL  809.3  258.1  OA  623.3 122.9 CL  623.3 122.9 nm  0.056 s
Step  1400: OL  821.9  266.3  OA  628.2 120.8 CL  628.2 120.8 nm  0.064 s
Step  1418: OL  836.9  272.1  OA  634.9 120.6 CL  634.9 120.6 nm  0.054 s
Step  1436: OL  852.1  276.2  OA  640.2 116.8 CL  640.2 116.8 nm  0.055 s
Step  1453: OL  865.0  279.0  OA  643.1 113.8 CL  643.1 113.8 nm  0.065 s
Step  1470: OL  875.5  279.5  OA  640.5 110.8 CL  640.5 110.8 nm  0.055 s
Step  1488: OL  880.5  276.8  OA  637.8 107.3 CL  637.8 107.3 nm  0.059 s
Step  1506: OL  879.3  270.8  OA  626.0 106.5 CL  626.0 106.5 nm  0.063 s
Step  1524: OL  874.0  262.4  OA  614.3 105.4 CL  614.3 105.4 nm  0.054 s
Step  1535 updated high order loop gain: 0.428
Step  1541: OL  865.9  252.3  OA  604.3 102.2 CL  604.3 102.2 nm  0.055 s
Step  1558: OL  857.1  241.1  OA  597.8  95.2 CL  597.8  95.2 nm  0.066 s
Step  1576: OL  848.1  230.3  OA  594.6  91.9 CL  594.6  91.9 nm  0.053 s
Step  1593: OL  839.2  222.4  OA  589.4  91.4 CL  589.4  91.4 nm  0.055 s
Step 1599: Output PSF
Step  1599: OL  835.9  219.9  OA  589.5  92.1 CL  589.5  92.1 nm  1.966 s
Mean: 679.09 307.45 605.51  nm.

*** Simulation Finished at 2025/02/17 14:57:07 in nid001972. ***

