Warning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
/global/cfs/cdirs/ulens/vismcao/maos -o studies/reduced_ngs/9_lgs/8mag_lgs/4750count -c master_files/reduced_ngs/9_lgs/8mag_lgs/kola_4750act.conf -O 
Output folder is 'studies/reduced_ngs/9_lgs/8mag_lgs/4750count'.
SRC: /global/homes/b/bpeck/code/maos v2.9 4c88b7c2 2024-11-13 16:45:33 -0800
BUILT: /global/homes/b/bpeck/code/maos/optim by GCC (v12) on 2024/11/18 09:40:03 CPU(F64,+O3) with CUDA(v122,F32)
Launched at 2025/02/17 15:30:26 in nid001972 with PID 1700244.
The web based job monitor can be accessed at http://localhost:10300
Main config file is /global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_4750act.conf
Warning(path.c:48): Path not found: path=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; abspath=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; Ignored.
Warning(path.c:48): Path not found: path=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; abspath=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; Ignored.
Warning(readcfg.c:399): sim.apfsm has been renamed to powfs.apfsm.
Warning(readcfg.c:399): sim.epfsm has been renamed to powfs.epfsm.
Warning(readcfg.c:399): sim.alfsm has been renamed to powfs.alfsm.
Warning(readcfg.c:399): sim.commonfsm has been renamed to powfs.commonfsm.
Warning(readcfg.c:399): sim.idealfsm has been renamed to powfs.idealfsm.
Warning(readcfg.c:399): sim.zetafsm has been renamed to powfs.zetafsm.
Warning(readcfg.c:399): sim.f0fsm has been renamed to powfs.f0fsm.
Warning(readcfg.c:399): tsurf has been renamed to ncpa.tsurf.
loaded 132 (132 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_sim.conf'
loaded  19 ( 19 new) records from '/global/cfs/cdirs/ulens/vismcao/./dm_none.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_ASM.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_DM2.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_DM3.conf'
loaded   0 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_dm_multiple.conf'
loaded   7 (  5 new) records from '/global/cfs/cdirs/ulens/vismcao/./atm_mk13n50p_ground_detail.conf'
loaded  76 ( 69 new) records from '/global/homes/b/bpeck/code/maos/config/maos/powfs_common.conf'
loaded  44 ( 38 new) records from '/global/cfs/cdirs/ulens/vismcao/./powfs_none.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_lgs.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_ttf_strap.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_twfs_lbwfs.conf'
loaded   0 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_wfs_lgs_strap_lbwfs.conf'
loaded  71 ( 71 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_recon.conf'
Warning(readcfg.c:399): dbg.na_smooth has been renamed to powfs0_llt.na_smooth.
Warning(readcfg.c:399): dbg.na_interp has been renamed to powfs0_llt.na_interp.
Warning(readcfg.c:399): dbg.na_thres has been renamed to powfs0_llt.na_thres.
Warning(readcfg.c:399): dbg.na_fit_maxit has been renamed to powfs0_llt.na_fit_maxit.
Warning(readcfg.c:399): dbg.na_fit_svdthres has been renamed to powfs0_llt.na_fit_svdthres.
Warning(readcfg.c:399): dbg.na_fit_dh has been renamed to powfs0_llt.na_fit_dh.
Warning(readcfg.c:399): dbg.ncpa_preload has been renamed to ncpa.preload.
Warning(readcfg.c:399): dbg.ncpa_rmsci has been renamed to ncpa.rmsci.
Warning(readcfg.c:399): dbg.draw_opdmax has been renamed to plot.opdmax.
Warning(readcfg.c:399): dbg.draw_gmax has been renamed to plot.gmax.
loaded  95 ( 93 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_dbg.conf'
loaded   4 (  4 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_fit_mcao.conf'
Warning(readcfg.c:399): surf has been renamed to ncpa.surf.
loaded  39 (  7 new) records from '/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_4750act.conf'
loaded   0 (  0 new) records from 'command line'
loaded  24 ( 18 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_llt_CL.conf'
Adjust LGS range by telescope altitude 4145m.
Zenith angle is 30 degree.
    Scaling turbulence height and LGS hs by sec(za).
    Scaling r0 by cos(za)^(3/5).
    Scaling wind speed and LGS signal level by cos(za).
powfs0: Adjusting dx from 0.0078125 to 0.00783333. 
powfs0.llt.fsm: f0=0 Hz, LPF ep=0
powfs0.epfsm is set to 0.517618 (auto)
powfs2: Adjusting dx from 0.03125 to 0.0312778. 
powfs2 is TWFS for powfs0
sim.ephi is set to 0.427717 (auto)
sim.eplo is set to 0.427717 (auto)
Warning(parms.c:2296): Layer 1 at 17.3205m is very close to layer 0 at 0m (OK).
Warning(parms.c:2296): Layer 2 at 34.641m is very close to layer 1 at 17.3205m (OK).
Warning(parms.c:2296): Layer 3 at 51.9615m is very close to layer 2 at 34.641m (OK).
dm 0: stroke=30 um is provided in micron.
dm 0: assume ia stroke=2 um is provided in micron.
dm 1: stroke=7 um is provided in micron.
dm 1: assume ia stroke=2 um is provided in micron.
dm 2: stroke=7 um is provided in micron.
dm 2: assume ia stroke=2 um is provided in micron.
Focus blending is not implemented yet for integrated tomography
parms->sim.mffocus is reset to 0
There are 1 valid simulation seeds:  1
Output PSF for 1 directions
Used 449 of 456 supplied keys
Warning(readcfg.c:158): key "dbg.pwfs_flate" is not recognized, value is 0
Warning(readcfg.c:158): key "dbg.pwfs_flatv" is not recognized, value is 0
Warning(readcfg.c:158): key "dbg.pwfs_psx" is not recognized, value is [0 0 0 0]
Warning(readcfg.c:158): key "dbg.pwfs_psy" is not recognized, value is [0 0 0 0]
Warning(readcfg.c:158): key "dbg.pwfs_pupelong" is not recognized, value is 0
Warning(readcfg.c:158): key "dbg.pwfs_raw" is not recognized, value is 0
Warning(readcfg.c:158): key "dbg.pwfs_side" is not recognized, value is 4
[00;00mAperture[00;00m is 11 m with sampling 1/128 m
[00;00mTurbulence at 30 degree zenith angle:[00;00m r0=0.128424m, L0=30m, 14 layers.
    Greenwood freq is 25.1Hz, anisoplanatic angle is 1.58 as
    Sampled 8192x8192 at 1/128m. wind dir is randomized.
    layer 0: ht=      0 m, wt= 0.302, ws=  4.8 m/s
    layer 1: ht=     17 m, wt= 0.154, ws=  5.0 m/s
    layer 2: ht=     35 m, wt= 0.041, ws=  5.4 m/s
    layer 3: ht=     52 m, wt= 0.002, ws=  6.6 m/s
    layer 4: ht=    139 m, wt= 0.021, ws=  6.1 m/s
    layer 5: ht=    231 m, wt= 0.010, ws=  6.1 m/s
    layer 6: ht=    323 m, wt= 0.008, ws=  6.1 m/s
    layer 7: ht=    416 m, wt= 0.005, ws=  6.1 m/s
    layer 8: ht=    508 m, wt= 0.001, ws=  6.1 m/s
    layer 9: ht=    932 m, wt= 0.107, ws=  5.6 m/s
    layer 10: ht=   5022 m, wt= 0.144, ws= 11.1 m/s
    layer 11: ht=   9238 m, wt= 0.093, ws= 19.1 m/s
    layer 12: ht=  13856 m, wt= 0.075, ws=  8.2 m/s
    layer 13: ht=  22518 m, wt= 0.036, ws=  4.8 m/s
[00;00mReconstruction[00;00m: r0=0.128424m L0=30m. 14 layers. use cone coordinate.
    layer 0: ht=      0 m, wt= 0.302
    layer 1: ht=     17 m, wt= 0.154
    layer 2: ht=     35 m, wt= 0.041
    layer 3: ht=     52 m, wt= 0.002
    layer 4: ht=    139 m, wt= 0.021
    layer 5: ht=    231 m, wt= 0.010
    layer 6: ht=    323 m, wt= 0.008
    layer 7: ht=    416 m, wt= 0.005
    layer 8: ht=    508 m, wt= 0.001
    layer 9: ht=    932 m, wt= 0.107
    layer 10: ht=   5022 m, wt= 0.144
    layer 11: ht=   9238 m, wt= 0.093
    layer 12: ht=  13856 m, wt= 0.075
    layer 13: ht=  22518 m, wt= 0.036
[00;00mThere are 3 powfs[00;00m
  powfs0: Order 79, LGS at 99.1 km. Sampling 1/127.66 m. Thres 30%. [00;00mT/T is removed in right hand side in tomography.[00;00m
    CCD image is 25x25 @ 500x500 mas, blur 27% (sigma), 1500Hz, wvl: [ 5.89e-07]
    Gtilt in reconstruction. Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
  powfs1: Order  2, NGS at inf km. Sampling 1/16 m. Thres 30%. 
    Ztilt in reconstruction. Geomtric optics start at 2 with ztilt [00;00m(noisy)[00;00m
  powfs2: Order 20, NGS at inf km. Sampling 1/31.9716 m. Thres 50%. 
    CCD image is 4x4 @ 1500x1500 mas, blur 0% (sigma), 0.015Hz, wvl: [ 7.2e-07]
    Gtilt in reconstruction. Geomtric optics start at 50 with gtilt Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
[00;00mThere are 13 wfs[00;00m
    wfs 0: type 0, at (  30.00,    0.00) arcsec,  99 km, siglev is 23.8382 bkgrnd is 0.1
    wfs 1: type 0, at (  22.98,   19.28) arcsec,  99 km, siglev is 23.8382 bkgrnd is 0.1
    wfs 2: type 0, at (   5.21,   29.54) arcsec,  99 km, siglev is 23.8382 bkgrnd is 0.1
    wfs 3: type 0, at ( -15.00,   25.98) arcsec,  99 km, siglev is 23.8382 bkgrnd is 0.1
    wfs 4: type 0, at ( -28.19,   10.26) arcsec,  99 km, siglev is 23.8382 bkgrnd is 0.1
    wfs 5: type 0, at ( -28.19,  -10.26) arcsec,  99 km, siglev is 23.8382 bkgrnd is 0.1
    wfs 6: type 0, at ( -15.00,  -25.98) arcsec,  99 km, siglev is 23.8382 bkgrnd is 0.1
    wfs 7: type 0, at (   5.21,  -29.54) arcsec,  99 km, siglev is 23.8382 bkgrnd is 0.1
    wfs 8: type 0, at (  22.98,  -19.28) arcsec,  99 km, siglev is 23.8382 bkgrnd is 0.1
    wfs 9: type 1, at (   5.00,    8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 10: type 1, at ( -10.00,    0.00) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 11: type 1, at (   5.00,   -8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 12: type 2, at (   0.00,    0.00) arcsec, inf km, siglev is 4.1558e+06 bkgrnd is 0.001
[00;00mThere are 3 DMs[00;00m
  DM 0 at -0.1km, actuator pitch 0.141m, offset   0, with 30.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 1 at    6km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 2 at   10km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
[00;00mTomography[00;00m is using CG, with [00;00mFourer Domain[00;00m preconditioner, [00;00m12[00;00m iterations, integrated tomo.
[00;00mDM Fitting [00;00mis using CG, with [00;00mNo[00;00m preconditioner, [00;00m10[00;00m iterations
[00;00mThere are 9 fit directions[00;00m
    Fit 0: weight is 0.444, at (   0.00,    0.00) arcsec
    Fit 1: weight is 0.111, at (  15.00,    0.00) arcsec
    Fit 2: weight is 0.111, at (   0.00,   15.00) arcsec
    Fit 3: weight is 0.111, at ( -15.00,    0.00) arcsec
    Fit 4: weight is 0.111, at (   0.00,  -15.00) arcsec
    Fit 5: weight is 0.028, at (  15.00,   15.00) arcsec
    Fit 6: weight is 0.028, at ( -15.00,   15.00) arcsec
    Fit 7: weight is 0.028, at ( -15.00,  -15.00) arcsec
    Fit 8: weight is 0.028, at (  15.00,  -15.00) arcsec
[00;00mThere are 1 evaluation directions[00;00m at sampling 1/128 m.
    Evl 0: weight is 1.000, at (   0.00,    0.00) arcsec
[00;00mSimulation[00;00m start at step 0, end at step 1600, with time step 1/1500s, [00;00mclose loop[00;00m.
After setup_parms:	120.5 MiB.
Warning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
CUDA: minimum memory requirement is 0.3GB
GPU 0 is NVIDIA A100-SXM4-40GB with arch 8.0, 38.9GB free, 39.3GB total device memory.
Using GPU 0
Use 1 GPUs for WFS Tomo Fit Evl

*** Preparation started at 2025/02/17 15:30:26 in nid001972. ***

Using OpenMP version 201511 with 128 threads
Reading aperture amplitude map from KECK.fits
Warning(accphi.c:477): 108691 points not covered by input screen
Warning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
 ->maos.c:447->setup.c:148->aper.c:74->utils.c:478->accphi.c:478
iwvl 0: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 1: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 2: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 3: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 4: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 5: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 6: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 7: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 8: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
After setup_aper:	343.0 MiB.

[00;00mSetting up powfs 0 geom[00;00m

There are 18 points in each subaperture of 0.141m.
There are 3737 valid subaperture.

[00;00mSetting up powfs 1 geom[00;00m

There are 88 points in each subaperture of 5.5m.
There are 4 valid subaperture.

[00;00mSetting up powfs 2 geom[00;00m

There are 18 points in each subaperture of 0.563m.
There are 236 valid subaperture.
After setup_powfs_init:	439.8 MiB.

[00;00mSetting up reconstructor geometry.[00;00m

PLOC is 161x161, with sampling of 0.07m (square)
    DM 0: grid is 82 x 82
    DM 1: grid is 75 x 75
    DM 2: grid is 80 x 79
FLOC is 161x161, with sampling of 0.07m (not square)
Tomography grid is square:
    layer 0: xloc grid is 280 x 280, sampling is 0.070 m, 78400 points
    layer 1: xloc grid is 280 x 280, sampling is 0.070 m, 78400 points
    layer 2: xloc grid is 280 x 280, sampling is 0.070 m, 78400 points
    layer 3: xloc grid is 280 x 280, sampling is 0.070 m, 78400 points
    layer 4: xloc grid is 280 x 280, sampling is 0.070 m, 78400 points
    layer 5: xloc grid is 280 x 280, sampling is 0.070 m, 78400 points
    layer 6: xloc grid is 280 x 280, sampling is 0.070 m, 78400 points
    layer 7: xloc grid is 280 x 280, sampling is 0.070 m, 78400 points
    layer 8: xloc grid is 280 x 280, sampling is 0.070 m, 78400 points
    layer 9: xloc grid is 280 x 280, sampling is 0.070 m, 78400 points
    layer 10: xloc grid is 280 x 280, sampling is 0.067 m, 78400 points
    layer 11: xloc grid is 280 x 280, sampling is 0.064 m, 78400 points
    layer 12: xloc grid is 280 x 280, sampling is 0.061 m, 78400 points
Warning(map.c:195): ninx=280 is too small. need 281
Warning(map.c:200): niny=280 is too small. need 281
    layer 13: xloc grid is 280 x 280, sampling is 0.054 m, 78400 points

[00;00mSetting up powfs 0 PO WFS[00;00m

OTF dimension is 36x36 (calculated)
Uplink FWHM (illt 0, iwvl 0) is 0.580741"
Downlink FWHM (illt 0, iwvl 0) is 0"
Generating matched filter for powfs 0
sa index   location       noise equivalent angle
    1838: (  4.9,  -0.2) m, (5000.00, 5000.00) mas
    1830: (  3.7,  -0.2) m, (5000.00, 5000.00) mas
    1822: (  2.6,  -0.2) m, (5000.00, 5000.00) mas
    1815: (  1.6,  -0.2) m, (5000.00, 5000.00) mas
    1813: (  1.3,  -0.2) m, (5000.00, 5000.00) mas
    1334: ( -0.5,  -1.3) m, (5000.00, 5000.00) mas
    1808: ( -1.8,  -0.2) m, (5000.00, 5000.00) mas
    1800: ( -2.9,  -0.2) m, (5000.00, 5000.00) mas
    1792: ( -4.0,  -0.2) m, (5000.00, 5000.00) mas
    1785: ( -5.0,  -0.2) m, (5000.00, 5000.00) mas
    1782: ( -5.4,  -0.2) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    3217: (  3.7,   3.0) m, (5000.00, 5000.00) mas
    3104: (  3.3,   2.7) m, (5000.00, 5000.00) mas
    2820: (  2.5,   2.0) m, (5000.00, 5000.00) mas
    2487: (  1.6,   1.3) m, (5000.00, 5000.00) mas
    2230: (  0.9,   0.8) m, (5000.00, 5000.00) mas
    1340: (  0.4,  -1.3) m, (5000.00, 5000.00) mas
    1456: ( -1.2,  -1.1) m, (5000.00, 5000.00) mas
    1258: ( -1.8,  -1.5) m, (5000.00, 5000.00) mas
     925: ( -2.6,  -2.2) m, (5000.00, 5000.00) mas
     640: ( -3.5,  -2.9) m, (5000.00, 5000.00) mas
     150: ( -3.0,  -4.3) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    3726: (  0.8,   4.7) m, (5000.00, 5000.00) mas
    3531: (  0.6,   4.0) m, (5000.00, 5000.00) mas
    3248: (  0.5,   3.2) m, (5000.00, 5000.00) mas
    2918: (  0.4,   2.3) m, (5000.00, 5000.00) mas
    2477: (  0.2,   1.3) m, (5000.00, 5000.00) mas
    1749: ( -1.5,  -0.4) m, (5000.00, 5000.00) mas
    1134: ( -0.4,  -1.8) m, (5000.00, 5000.00) mas
     826: ( -0.5,  -2.5) m, (5000.00, 5000.00) mas
     495: ( -0.6,  -3.3) m, (5000.00, 5000.00) mas
     211: ( -0.8,  -4.2) m, (5000.00, 5000.00) mas
      11: ( -2.3,  -4.9) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    3685: ( -2.7,   4.6) m, (5000.00, 5000.00) mas
    3376: ( -2.2,   3.6) m, (5000.00, 5000.00) mas
    3123: ( -1.8,   2.9) m, (5000.00, 5000.00) mas
    2733: ( -1.2,   1.9) m, (5000.00, 5000.00) mas
    2403: ( -0.8,   1.2) m, (5000.00, 5000.00) mas
    1995: (  1.2,   0.2) m, (5000.00, 5000.00) mas
    1342: (  0.6,  -1.3) m, (5000.00, 5000.00) mas
    1012: (  1.1,  -2.0) m, (5000.00, 5000.00) mas
     621: (  1.6,  -3.0) m, (5000.00, 5000.00) mas
     366: (  2.0,  -3.7) m, (5000.00, 5000.00) mas
      57: (  2.6,  -4.7) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    2644: ( -4.6,   1.8) m, (5000.00, 5000.00) mas
    2447: ( -4.0,   1.3) m, (5000.00, 5000.00) mas
    2326: ( -3.2,   1.1) m, (5000.00, 5000.00) mas
    2111: ( -1.6,   0.5) m, (5000.00, 5000.00) mas
    2054: ( -1.3,   0.4) m, (5000.00, 5000.00) mas
    2287: (  0.8,   0.9) m, (5000.00, 5000.00) mas
    1633: (  1.5,  -0.6) m, (5000.00, 5000.00) mas
    1578: (  1.9,  -0.8) m, (5000.00, 5000.00) mas
    1362: (  3.5,  -1.3) m, (5000.00, 5000.00) mas
    1298: (  3.9,  -1.5) m, (5000.00, 5000.00) mas
    1718: (  5.1,  -0.5) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    1037: ( -4.6,  -1.9) m, (5000.00, 5000.00) mas
    1242: ( -4.0,  -1.5) m, (5000.00, 5000.00) mas
    1382: ( -3.2,  -1.2) m, (5000.00, 5000.00) mas
    1626: ( -1.6,  -0.6) m, (5000.00, 5000.00) mas
    1689: ( -1.3,  -0.5) m, (5000.00, 5000.00) mas
    1459: (  0.8,  -1.1) m, (5000.00, 5000.00) mas
    2118: (  1.5,   0.5) m, (5000.00, 5000.00) mas
    2180: (  1.9,   0.6) m, (5000.00, 5000.00) mas
    2433: (  3.5,   1.2) m, (5000.00, 5000.00) mas
    2503: (  3.9,   1.3) m, (5000.00, 5000.00) mas
    2083: (  5.1,   0.4) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
      28: ( -2.7,  -4.7) m, (5000.00, 5000.00) mas
     336: ( -2.2,  -3.7) m, (5000.00, 5000.00) mas
     597: ( -1.8,  -3.0) m, (5000.00, 5000.00) mas
     996: ( -1.2,  -2.0) m, (5000.00, 5000.00) mas
    1332: ( -0.8,  -1.3) m, (5000.00, 5000.00) mas
    2285: ( -0.9,   0.9) m, (5000.00, 5000.00) mas
    2413: (  0.6,   1.2) m, (5000.00, 5000.00) mas
    2749: (  1.1,   1.9) m, (5000.00, 5000.00) mas
    3147: (  1.6,   2.9) m, (5000.00, 5000.00) mas
    3406: (  2.0,   3.6) m, (5000.00, 5000.00) mas
    3714: (  2.6,   4.6) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
      20: (  0.8,  -4.9) m, (5000.00, 5000.00) mas
     221: (  0.6,  -4.2) m, (5000.00, 5000.00) mas
     503: (  0.5,  -3.3) m, (5000.00, 5000.00) mas
     832: (  0.4,  -2.5) m, (5000.00, 5000.00) mas
    1272: (  0.2,  -1.5) m, (5000.00, 5000.00) mas
    1993: ( -1.5,   0.2) m, (5000.00, 5000.00) mas
    2607: ( -0.4,   1.6) m, (5000.00, 5000.00) mas
    2912: ( -0.5,   2.3) m, (5000.00, 5000.00) mas
    3240: ( -0.6,   3.2) m, (5000.00, 5000.00) mas
    3521: ( -0.8,   4.0) m, (5000.00, 5000.00) mas
    3718: ( -2.3,   4.7) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
     581: (  3.7,  -3.2) m, (5000.00, 5000.00) mas
     688: (  3.3,  -2.9) m, (5000.00, 5000.00) mas
     961: (  2.5,  -2.2) m, (5000.00, 5000.00) mas
    1282: (  1.6,  -1.5) m, (5000.00, 5000.00) mas
    1515: (  0.9,  -0.9) m, (5000.00, 5000.00) mas
    2411: (  0.4,   1.2) m, (5000.00, 5000.00) mas
    2229: ( -1.1,   0.8) m, (5000.00, 5000.00) mas
    2463: ( -1.8,   1.3) m, (5000.00, 5000.00) mas
    2784: ( -2.6,   2.0) m, (5000.00, 5000.00) mas
    3056: ( -3.5,   2.7) m, (5000.00, 5000.00) mas
    3550: ( -3.0,   4.2) m, (5000.00, 5000.00) mas

[00;00mSetting up powfs 2 PO WFS[00;00m

OTF dimension is 48x48 (calculated)
Generating matched filter for powfs 2
Use sanea to derive neasim
Use sanea to derive neasim

[00;00mSetting up reconstructor[00;00m

Recon NEA: cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) geom(0.31) geom(0.31) geom(0.31) mf(0.14)  mas
Setup or update control matrix parameters.
RRtwfs svd threshold is 1e-10
Replacing HA by HA*fit->actextrap
Adding piston cr to fit matrix
Adding TT cr on upper DMs to fit matrix.
Before assembling fit matrix:	5566.0 MiB.
Building fit->FR
Building fit->FL
Adding tikhonov constraint of 1.0e-07 to FLM
The maximum eigen value is estimated to be around 2.6e-04
DM Fit number of Low rank terms: 16 in LHS
After assemble fit matrix:	7634.5 MiB.
After setup_recon:	7634.5 MiB.
GPU 0: mem used 1596 MB (wfs init)
GPU 0: mem used 2856 MB (recon init)
GPU 0: mem used 2886 MB (perf init)

*** Simulation started at 2025/02/17 15:32:09 in nid001972. ***

Running seed 1
GPU 0: mem used 2888 MB (wfs seeding)
Wind dir: 267.3 261.7 167.0 130.5 300.7  32.3 119.8 139.0 150.8 277.7 203.0 133.1  45.9 265.1 deg
Using /global/homes/b/bpeck/.aos/cache/atm/vonkarman_14_8192x8192_0.0078125_1115374592d.bin
After genatm:	7416.7 MiB.
Step     #  Open Loop  PR TT  On axis  PR TT  Field RMS PR TT     Timing 
Step     0: OL  884.6  248.3  OA  884.6 248.3 CL  884.6 248.3 nm  0.106 s
Step    10: OL  899.9  252.3  OA  756.9 231.3 CL  756.9 231.3 nm  0.079 s
Step    23: OL  919.9  256.8  OA  749.3 227.6 CL  749.3 227.6 nm  0.087 s
Step    34: OL  936.8  259.7  OA  746.7 225.1 CL  746.7 225.1 nm  0.120 s
Step    46: OL  954.8  261.2  OA  742.7 221.9 CL  742.7 221.9 nm  0.094 s
Step    58: OL  972.7  261.1  OA  735.4 217.6 CL  735.4 217.6 nm  0.088 s
Step    70: OL  991.1  260.0  OA  728.2 211.9 CL  728.2 211.9 nm  0.087 s
Step    82: OL 1009.9  258.8  OA  723.0 206.3 CL  723.0 206.3 nm  0.090 s
Step    94: OL 1029.2  258.0  OA  721.3 203.4 CL  721.3 203.4 nm  0.089 s
Step   106: OL 1048.5  257.8  OA  721.0 199.0 CL  721.0 199.0 nm  0.087 s
Step   118: OL 1067.7  258.7  OA  723.9 194.5 CL  723.9 194.5 nm  0.089 s
Step   130: OL 1086.0  260.7  OA  725.9 189.0 CL  725.9 189.0 nm  0.091 s
Step   142: OL 1103.4  264.6  OA  731.5 185.0 CL  731.5 185.0 nm  0.085 s
Step   154: OL 1119.2  269.7  OA  736.8 181.5 CL  736.8 181.5 nm  0.088 s
Step   166: OL 1133.4  276.1  OA  740.1 178.8 CL  740.1 178.8 nm  0.096 s
Step   178: OL 1145.7  283.3  OA  743.1 177.7 CL  743.1 177.7 nm  0.089 s
Step   189: OL 1155.1  290.4  OA  743.6 178.6 CL  743.6 178.6 nm  0.090 s
Step   201: OL 1163.4  298.2  OA  744.8 180.2 CL  744.8 180.2 nm  0.088 s
Step   212: OL 1169.7  305.2  OA  747.3 183.1 CL  747.3 183.1 nm  0.089 s
Step   224: OL 1174.9  313.0  OA  750.5 188.2 CL  750.5 188.2 nm  0.088 s
Step   236: OL 1178.2  320.9  OA  754.7 193.9 CL  754.7 193.9 nm  0.091 s
Step   248: OL 1179.4  329.2  OA  754.6 199.9 CL  754.6 199.9 nm  0.087 s
Step   255 updated high order loop gain: 0.425
Step   260: OL 1177.3  337.8  OA  757.0 209.2 CL  757.0 209.2 nm  0.088 s
Step   272: OL 1171.9  346.5  OA  755.5 218.5 CL  755.5 218.5 nm  0.088 s
Step   284: OL 1163.7  355.4  OA  753.7 228.1 CL  753.7 228.1 nm  0.095 s
Step   296: OL 1153.9  365.4  OA  750.7 240.4 CL  750.7 240.4 nm  0.089 s
Step   308: OL 1142.8  376.1  OA  748.0 252.2 CL  748.0 252.2 nm  0.089 s
Step   320: OL 1129.6  387.5  OA  744.1 263.9 CL  744.1 263.9 nm  0.085 s
Step   332: OL 1115.2  400.0  OA  741.2 277.4 CL  741.2 277.4 nm  0.098 s
Step   343: OL 1101.7  412.9  OA  738.8 290.1 CL  738.8 290.1 nm  0.088 s
Step   355: OL 1086.7  428.3  OA  738.3 306.3 CL  738.3 306.3 nm  0.091 s
Step   367: OL 1072.0  445.0  OA  740.9 323.7 CL  740.9 323.7 nm  0.126 s
Step   379: OL 1057.8  462.2  OA  743.0 339.9 CL  743.0 339.9 nm  0.087 s
Step   391: OL 1043.9  479.6  OA  745.6 356.9 CL  745.6 356.9 nm  0.092 s
Step   403: OL 1029.8  496.7  OA  749.1 373.1 CL  749.1 373.1 nm  0.088 s
Step   415: OL 1015.2  513.5  OA  751.4 389.6 CL  751.4 389.6 nm  0.096 s
Step   427: OL 1000.2  529.4  OA  753.8 405.2 CL  753.8 405.2 nm  0.088 s
Step   439: OL  985.6  545.3  OA  753.2 420.5 CL  753.2 420.5 nm  0.089 s
Step   450: OL  973.0  559.5  OA  752.4 433.5 CL  752.4 433.5 nm  0.089 s
Step   462: OL  961.5  575.3  OA  752.1 447.6 CL  752.1 447.6 nm  0.089 s
Step   474: OL  952.8  590.7  OA  755.8 462.2 CL  755.8 462.2 nm  0.100 s
Step   486: OL  947.7  605.8  OA  762.6 476.5 CL  762.6 476.5 nm  0.088 s
Step   497: OL  945.9  619.0  OA  770.7 488.5 CL  770.7 488.5 nm  0.093 s
Step   509: OL  945.5  632.4  OA  780.3 500.8 CL  780.3 500.8 nm  0.092 s
Step   511 updated high order loop gain: 0.426
Step   521: OL  947.0  644.3  OA  790.3 512.1 CL  790.3 512.1 nm  0.088 s
Step   533: OL  950.1  653.9  OA  799.8 520.1 CL  799.8 520.1 nm  0.089 s
Step   544: OL  954.7  660.6  OA  807.3 524.6 CL  807.3 524.6 nm  0.087 s
Step   556: OL  961.7  665.8  OA  815.8 527.6 CL  815.8 527.6 nm  0.096 s
Step   568: OL  970.4  669.1  OA  823.4 529.2 CL  823.4 529.2 nm  0.087 s
Step   580: OL  980.5  670.8  OA  827.4 528.3 CL  827.4 528.3 nm  0.095 s
Step   592: OL  992.2  670.7  OA  832.1 526.3 CL  832.1 526.3 nm  0.088 s
Step   604: OL 1004.8  668.1  OA  835.8 521.5 CL  835.8 521.5 nm  0.088 s
Step   616: OL 1018.0  663.3  OA  837.0 514.3 CL  837.0 514.3 nm  0.093 s
Step   628: OL 1031.2  656.4  OA  834.7 506.6 CL  834.7 506.6 nm  0.090 s
Step   640: OL 1043.9  647.5  OA  830.2 496.2 CL  830.2 496.2 nm  0.088 s
Step   651: OL 1054.5  638.0  OA  822.0 484.8 CL  822.0 484.8 nm  0.090 s
Step   663: OL 1065.0  626.5  OA  813.5 473.6 CL  813.5 473.6 nm  0.097 s
Step   674: OL 1073.8  615.1  OA  803.3 461.1 CL  803.3 461.1 nm  0.087 s
Step   686: OL 1083.0  602.6  OA  792.3 446.0 CL  792.3 446.0 nm  0.088 s
Step   698: OL 1091.0  589.5  OA  781.8 430.1 CL  781.8 430.1 nm  0.087 s
Step   709: OL 1096.6  576.6  OA  773.5 416.3 CL  773.5 416.3 nm  0.087 s
Step   721: OL 1100.5  561.8  OA  761.7 398.0 CL  761.7 398.0 nm  0.089 s
Step   733: OL 1101.8  547.0  OA  751.5 380.4 CL  751.5 380.4 nm  0.093 s
Step   745: OL 1100.5  532.2  OA  740.4 362.8 CL  740.4 362.8 nm  0.087 s
Step   757: OL 1096.8  517.8  OA  728.9 346.9 CL  728.9 346.9 nm  0.092 s
Step   767 updated high order loop gain: 0.427
Step   769: OL 1090.8  503.9  OA  718.2 333.1 CL  718.2 333.1 nm  0.087 s
Step   780: OL 1083.2  491.5  OA  707.6 320.4 CL  707.6 320.4 nm  0.087 s
Step   791: OL 1073.2  479.2  OA  697.5 307.9 CL  697.5 307.9 nm  0.096 s
Step   803: OL 1060.1  465.8  OA  685.4 294.1 CL  685.4 294.1 nm  0.087 s
Step   815: OL 1045.4  452.5  OA  676.4 280.0 CL  676.4 280.0 nm  0.087 s
Step   826: OL 1030.0  440.3  OA  668.0 266.3 CL  668.0 266.3 nm  0.089 s
Step   838: OL 1011.8  427.4  OA  659.1 252.7 CL  659.1 252.7 nm  0.087 s
Step   850: OL  992.9  415.2  OA  652.2 238.8 CL  652.2 238.8 nm  0.089 s
Step   862: OL  974.2  403.9  OA  646.7 226.9 CL  646.7 226.9 nm  0.090 s
Step   874: OL  956.5  393.8  OA  642.4 216.6 CL  642.4 216.6 nm  0.087 s
Step   885: OL  941.4  385.6  OA  639.9 208.8 CL  639.9 208.8 nm  0.087 s
Step   896: OL  926.2  378.2  OA  637.1 202.1 CL  637.1 202.1 nm  0.093 s
Step   908: OL  909.1  371.1  OA  631.8 196.5 CL  631.8 196.5 nm  0.086 s
Step   920: OL  891.9  365.1  OA  624.6 192.4 CL  624.6 192.4 nm  0.096 s
Step   932: OL  875.1  359.3  OA  616.4 188.8 CL  616.4 188.8 nm  0.089 s
Step   944: OL  858.9  353.6  OA  608.2 186.3 CL  608.2 186.3 nm  0.088 s
Step   956: OL  843.5  347.6  OA  600.8 183.1 CL  600.8 183.1 nm  0.086 s
Step   968: OL  830.0  341.1  OA  595.3 181.0 CL  595.3 181.0 nm  0.090 s
Step   980: OL  818.3  333.8  OA  590.6 177.4 CL  590.6 177.4 nm  0.088 s
Step   992: OL  807.9  325.8  OA  588.7 174.4 CL  588.7 174.4 nm  0.089 s
Step  1003: OL  798.7  317.8  OA  585.7 170.2 CL  585.7 170.2 nm  0.087 s
Step  1015: OL  789.6  308.7  OA  581.9 165.2 CL  581.9 165.2 nm  0.088 s
Step  1023 updated high order loop gain: 0.427
Step  1026: OL  782.2  300.2  OA  577.8 161.9 CL  577.8 161.9 nm  0.095 s
Step  1037: OL  775.4  291.2  OA  574.9 157.7 CL  574.9 157.7 nm  0.088 s
Step  1049: OL  768.3  280.7  OA  570.8 152.1 CL  570.8 152.1 nm  0.088 s
Step  1061: OL  760.8  269.4  OA  567.6 145.6 CL  567.6 145.6 nm  0.086 s
Step  1073: OL  754.1  256.6  OA  563.1 138.2 CL  563.1 138.2 nm  0.095 s
Step  1085: OL  749.0  242.6  OA  562.3 128.1 CL  562.3 128.1 nm  0.088 s
Step  1097: OL  745.5  228.9  OA  560.0 118.4 CL  560.0 118.4 nm  0.096 s
Step  1109: OL  743.2  216.2  OA  560.3 108.5 CL  560.3 108.5 nm  0.087 s
Step  1121: OL  741.6  204.6  OA  562.4 100.0 CL  562.4 100.0 nm  0.097 s
Step  1133: OL  740.6  194.8  OA  565.2  93.7 CL  565.2  93.7 nm  0.090 s
Step  1145: OL  739.9  186.4  OA  567.7  88.6 CL  567.7  88.6 nm  0.087 s
Step  1157: OL  739.3  179.6  OA  571.7  85.9 CL  571.7  85.9 nm  0.087 s
Step  1169: OL  738.6  174.7  OA  574.7  84.3 CL  574.7  84.3 nm  0.087 s
Step  1181: OL  738.9  171.2  OA  578.5  83.6 CL  578.5  83.6 nm  0.089 s
Step  1193: OL  740.4  168.5  OA  585.6  83.0 CL  585.6  83.0 nm  0.087 s
Step  1205: OL  742.4  166.1  OA  594.1  82.2 CL  594.1  82.2 nm  0.092 s
Step  1216: OL  744.5  164.4  OA  600.4  82.0 CL  600.4  82.0 nm  0.087 s
Step  1227: OL  746.8  163.5  OA  607.5  81.9 CL  607.5  81.9 nm  0.088 s
Step  1239: OL  748.8  164.1  OA  612.1  83.1 CL  612.1  83.1 nm  0.088 s
Step  1251: OL  750.7  166.4  OA  619.1  86.6 CL  619.1  86.6 nm  0.088 s
Step  1263: OL  753.5  170.6  OA  624.2  90.9 CL  624.2  90.9 nm  0.097 s
Step  1275: OL  756.7  176.3  OA  628.9  95.4 CL  628.9  95.4 nm  0.093 s
Step  1279 updated high order loop gain: 0.428
Step  1287: OL  761.1  183.2  OA  633.2 100.6 CL  633.2 100.6 nm  0.094 s
Step  1299: OL  765.9  191.0  OA  636.7 105.5 CL  636.7 105.5 nm  0.089 s
Step  1311: OL  770.2  199.7  OA  638.3 111.0 CL  638.3 111.0 nm  0.092 s
Step  1322: OL  773.8  208.4  OA  634.3 115.8 CL  634.3 115.8 nm  0.087 s
Step  1334: OL  778.1  218.8  OA  635.0 121.9 CL  635.0 121.9 nm  0.087 s
Step  1341: OL  781.1  225.2  OA  632.4 124.4 CL  632.4 124.4 nm  0.088 s
Step  1353: OL  787.0  236.1  OA  629.8 129.1 CL  629.8 129.1 nm  0.086 s
Step  1364: OL  793.6  245.4  OA  633.0 132.7 CL  633.0 132.7 nm  0.087 s
Step  1376: OL  801.1  253.9  OA  633.0 133.6 CL  633.0 133.6 nm  0.090 s
Step  1388: OL  809.1  260.9  OA  636.5 135.3 CL  636.5 135.3 nm  0.087 s
Step  1400: OL  818.2  266.4  OA  644.1 134.8 CL  644.1 134.8 nm  0.086 s
Step  1412: OL  827.9  270.5  OA  649.9 134.7 CL  649.9 134.7 nm  0.087 s
Step  1424: OL  838.2  273.7  OA  656.0 133.4 CL  656.0 133.4 nm  0.088 s
Step  1436: OL  848.1  276.3  OA  661.0 132.4 CL  661.0 132.4 nm  0.088 s
Step  1447: OL  856.7  278.3  OA  664.9 131.4 CL  664.9 131.4 nm  0.096 s
Step  1459: OL  865.3  279.6  OA  664.9 129.1 CL  664.9 129.1 nm  0.086 s
Step  1471: OL  872.2  279.5  OA  668.2 128.4 CL  668.2 128.4 nm  0.091 s
Step  1482: OL  876.0  278.2  OA  669.4 127.5 CL  669.4 127.5 nm  0.087 s
Step  1494: OL  877.4  275.3  OA  667.3 126.7 CL  667.3 126.7 nm  0.096 s
Step  1506: OL  876.4  270.9  OA  662.5 126.2 CL  662.5 126.2 nm  0.087 s
Step  1518: OL  873.6  265.5  OA  658.0 125.5 CL  658.0 125.5 nm  0.086 s
Step  1530: OL  869.3  259.1  OA  651.7 124.7 CL  651.7 124.7 nm  0.088 s
Step  1535 updated high order loop gain: 0.428
Step  1539: OL  865.2  253.6  OA  647.2 124.7 CL  647.2 124.7 nm  0.086 s
Step  1551: OL  859.4  245.8  OA  646.2 121.7 CL  646.2 121.7 nm  0.090 s
Step  1563: OL  853.7  237.9  OA  644.7 119.8 CL  644.7 119.8 nm  0.089 s
Step  1575: OL  848.0  230.8  OA  643.8 119.4 CL  643.8 119.4 nm  0.087 s
Step  1587: OL  842.1  224.9  OA  642.1 120.4 CL  642.1 120.4 nm  0.089 s
Step 1599: Output PSF
Step  1599: OL  835.8  219.9  OA  642.8 123.6 CL  642.8 123.6 nm  1.280 s
Mean: 683.06 291.16 617.90  nm.

*** Simulation Finished at 2025/02/17 15:34:42 in nid001972. ***

