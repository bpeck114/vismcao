Warning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid003517/scheduler) failed: Invalid argument. 
/global/u2/b/bpeck/work/vismcao/maos -o studies/reduced_ngs/8_lgs/8mag_lgs/3000count -c master_files/reduced_ngs/8_lgs/8mag_lgs/kola_3000act.conf -O 
Output folder is 'studies/reduced_ngs/8_lgs/8mag_lgs/3000count'.
SRC: /global/homes/b/bpeck/code/maos v2.9 4c88b7c2 2024-11-13 16:45:33 -0800
BUILT: /global/homes/b/bpeck/code/maos/optim by GCC (v12) on 2024/11/18 09:40:03 CPU(F64,+O3) with CUDA(v122,F32)
Launched at 2025/02/11 18:46:34 in nid003517 with PID 1946414.
The web based job monitor can be accessed at http://localhost:10300
Main config file is /global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/8_lgs/8mag_lgs/kola_3000act.conf
Warning(path.c:48): Path not found: path=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/8_lgs/8mag_lgs/bin; abspath=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/8_lgs/8mag_lgs/bin; Ignored.
Warning(path.c:48): Path not found: path=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/8_lgs/8mag_lgs/atm; abspath=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/8_lgs/8mag_lgs/atm; Ignored.
Warning(readcfg.c:399): sim.apfsm has been renamed to powfs.apfsm.
Warning(readcfg.c:399): sim.epfsm has been renamed to powfs.epfsm.
Warning(readcfg.c:399): sim.alfsm has been renamed to powfs.alfsm.
Warning(readcfg.c:399): sim.commonfsm has been renamed to powfs.commonfsm.
Warning(readcfg.c:399): sim.idealfsm has been renamed to powfs.idealfsm.
Warning(readcfg.c:399): sim.zetafsm has been renamed to powfs.zetafsm.
Warning(readcfg.c:399): sim.f0fsm has been renamed to powfs.f0fsm.
Warning(readcfg.c:399): tsurf has been renamed to ncpa.tsurf.
loaded 132 (132 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_sim.conf'
loaded  19 ( 19 new) records from '/global/u2/b/bpeck/work/vismcao/./dm_none.conf'
loaded  19 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_ASM.conf'
loaded  19 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_DM2.conf'
loaded  19 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_DM3.conf'
loaded   0 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_dm_multiple.conf'
loaded   7 (  5 new) records from '/global/u2/b/bpeck/work/vismcao/./atm_mk13n50p_ground_detail.conf'
loaded  76 ( 69 new) records from '/global/homes/b/bpeck/code/maos/config/maos/powfs_common.conf'
loaded  44 ( 38 new) records from '/global/u2/b/bpeck/work/vismcao/./powfs_none.conf'
loaded  44 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_shwfs_lgs.conf'
loaded  44 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_shwfs_ttf_strap.conf'
loaded  44 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_shwfs_twfs_lbwfs.conf'
loaded   0 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_wfs_lgs_strap_lbwfs.conf'
loaded  71 ( 71 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_recon.conf'
Warning(readcfg.c:399): dbg.na_smooth has been renamed to powfs0_llt.na_smooth.
Warning(readcfg.c:399): dbg.na_interp has been renamed to powfs0_llt.na_interp.
Warning(readcfg.c:399): dbg.na_thres has been renamed to powfs0_llt.na_thres.
Warning(readcfg.c:399): dbg.na_fit_maxit has been renamed to powfs0_llt.na_fit_maxit.
Warning(readcfg.c:399): dbg.na_fit_svdthres has been renamed to powfs0_llt.na_fit_svdthres.
Warning(readcfg.c:399): dbg.na_fit_dh has been renamed to powfs0_llt.na_fit_dh.
Warning(readcfg.c:399): dbg.ncpa_preload has been renamed to ncpa.preload.
Warning(readcfg.c:399): dbg.ncpa_rmsci has been renamed to ncpa.rmsci.
Warning(readcfg.c:399): dbg.draw_opdmax has been renamed to plot.opdmax.
Warning(readcfg.c:399): dbg.draw_gmax has been renamed to plot.gmax.
loaded  95 ( 93 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_dbg.conf'
loaded   4 (  4 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_fit_mcao.conf'
Warning(readcfg.c:399): surf has been renamed to ncpa.surf.
loaded  39 (  7 new) records from '/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/8_lgs/8mag_lgs/kola_3000act.conf'
loaded   0 (  0 new) records from 'command line'
loaded  24 ( 18 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_llt_CL.conf'
Adjust LGS range by telescope altitude 4145m.
Zenith angle is 30 degree.
    Scaling turbulence height and LGS hs by sec(za).
    Scaling r0 by cos(za)^(3/5).
    Scaling wind speed and LGS signal level by cos(za).
powfs0: Adjusting dx from 0.0078125 to 0.00809091. 
powfs0.llt.fsm: f0=0 Hz, LPF ep=0
powfs0.epfsm is set to 0.517618 (auto)
powfs2: Adjusting dx from 0.03125 to 0.0312778. 
powfs2 is TWFS for powfs0
sim.ephi is set to 0.427717 (auto)
sim.eplo is set to 0.427717 (auto)
Warning(parms.c:2296): Layer 1 at 17.3205m is very close to layer 0 at 0m (OK).
Warning(parms.c:2296): Layer 2 at 34.641m is very close to layer 1 at 17.3205m (OK).
Warning(parms.c:2296): Layer 3 at 51.9615m is very close to layer 2 at 34.641m (OK).
dm 0: stroke=30 um is provided in micron.
dm 0: assume ia stroke=2 um is provided in micron.
dm 1: stroke=7 um is provided in micron.
dm 1: assume ia stroke=2 um is provided in micron.
dm 2: stroke=7 um is provided in micron.
dm 2: assume ia stroke=2 um is provided in micron.
Focus blending is not implemented yet for integrated tomography
parms->sim.mffocus is reset to 0
There are 1 valid simulation seeds:  1
Output PSF for 1 directions
Used 449 of 456 supplied keys
Warning(readcfg.c:158): key "dbg.pwfs_flate" is not recognized, value is 0
Warning(readcfg.c:158): key "dbg.pwfs_flatv" is not recognized, value is 0
Warning(readcfg.c:158): key "dbg.pwfs_psx" is not recognized, value is [0 0 0 0]
Warning(readcfg.c:158): key "dbg.pwfs_psy" is not recognized, value is [0 0 0 0]
Warning(readcfg.c:158): key "dbg.pwfs_pupelong" is not recognized, value is 0
Warning(readcfg.c:158): key "dbg.pwfs_raw" is not recognized, value is 0
Warning(readcfg.c:158): key "dbg.pwfs_side" is not recognized, value is 4
[00;00mAperture[00;00m is 11 m with sampling 1/128 m
[00;00mTurbulence at 30 degree zenith angle:[00;00m r0=0.128424m, L0=30m, 14 layers.
    Greenwood freq is 25.1Hz, anisoplanatic angle is 1.58 as
    Sampled 8192x8192 at 1/128m. wind dir is randomized.
    layer 0: ht=      0 m, wt= 0.302, ws=  4.8 m/s
    layer 1: ht=     17 m, wt= 0.154, ws=  5.0 m/s
    layer 2: ht=     35 m, wt= 0.041, ws=  5.4 m/s
    layer 3: ht=     52 m, wt= 0.002, ws=  6.6 m/s
    layer 4: ht=    139 m, wt= 0.021, ws=  6.1 m/s
    layer 5: ht=    231 m, wt= 0.010, ws=  6.1 m/s
    layer 6: ht=    323 m, wt= 0.008, ws=  6.1 m/s
    layer 7: ht=    416 m, wt= 0.005, ws=  6.1 m/s
    layer 8: ht=    508 m, wt= 0.001, ws=  6.1 m/s
    layer 9: ht=    932 m, wt= 0.107, ws=  5.6 m/s
    layer 10: ht=   5022 m, wt= 0.144, ws= 11.1 m/s
    layer 11: ht=   9238 m, wt= 0.093, ws= 19.1 m/s
    layer 12: ht=  13856 m, wt= 0.075, ws=  8.2 m/s
    layer 13: ht=  22518 m, wt= 0.036, ws=  4.8 m/s
[00;00mReconstruction[00;00m: r0=0.128424m L0=30m. 14 layers. use cone coordinate.
    layer 0: ht=      0 m, wt= 0.302
    layer 1: ht=     17 m, wt= 0.154
    layer 2: ht=     35 m, wt= 0.041
    layer 3: ht=     52 m, wt= 0.002
    layer 4: ht=    139 m, wt= 0.021
    layer 5: ht=    231 m, wt= 0.010
    layer 6: ht=    323 m, wt= 0.008
    layer 7: ht=    416 m, wt= 0.005
    layer 8: ht=    508 m, wt= 0.001
    layer 9: ht=    932 m, wt= 0.107
    layer 10: ht=   5022 m, wt= 0.144
    layer 11: ht=   9238 m, wt= 0.093
    layer 12: ht=  13856 m, wt= 0.075
    layer 13: ht=  22518 m, wt= 0.036
[00;00mThere are 3 powfs[00;00m
  powfs0: Order 62, LGS at 99.1 km. Sampling 1/123.596 m. Thres 30%. [00;00mT/T is removed in right hand side in tomography.[00;00m
    CCD image is 25x25 @ 500x500 mas, blur 27% (sigma), 1500Hz, wvl: [ 5.89e-07]
    Gtilt in reconstruction. Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
  powfs1: Order  2, NGS at inf km. Sampling 1/16 m. Thres 30%. 
    Ztilt in reconstruction. Geomtric optics start at 2 with ztilt [00;00m(noisy)[00;00m
  powfs2: Order 20, NGS at inf km. Sampling 1/31.9716 m. Thres 50%. 
    CCD image is 4x4 @ 1500x1500 mas, blur 0% (sigma), 0.015Hz, wvl: [ 7.2e-07]
    Gtilt in reconstruction. Geomtric optics start at 50 with gtilt Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
[00;00mThere are 12 wfs[00;00m
    wfs 0: type 0, at (  30.00,    0.00) arcsec,  99 km, siglev is 37.9899 bkgrnd is 0.1
    wfs 1: type 0, at (  21.21,   21.21) arcsec,  99 km, siglev is 37.9899 bkgrnd is 0.1
    wfs 2: type 0, at (   0.00,   30.00) arcsec,  99 km, siglev is 37.9899 bkgrnd is 0.1
    wfs 3: type 0, at ( -21.21,   21.21) arcsec,  99 km, siglev is 37.9899 bkgrnd is 0.1
    wfs 4: type 0, at ( -30.00,    0.00) arcsec,  99 km, siglev is 37.9899 bkgrnd is 0.1
    wfs 5: type 0, at ( -21.21,  -21.21) arcsec,  99 km, siglev is 37.9899 bkgrnd is 0.1
    wfs 6: type 0, at (   0.00,  -30.00) arcsec,  99 km, siglev is 37.9899 bkgrnd is 0.1
    wfs 7: type 0, at (  21.21,  -21.21) arcsec,  99 km, siglev is 37.9899 bkgrnd is 0.1
    wfs 8: type 1, at (   5.00,    8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 9: type 1, at ( -10.00,    0.00) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 10: type 1, at (   5.00,   -8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 11: type 2, at (   0.00,    0.00) arcsec, inf km, siglev is 4.1558e+06 bkgrnd is 0.001
[00;00mThere are 3 DMs[00;00m
  DM 0 at -0.1km, actuator pitch 0.178m, offset   0, with 30.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 1 at    6km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 2 at   10km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
[00;00mTomography[00;00m is using CG, with [00;00mFourer Domain[00;00m preconditioner, [00;00m12[00;00m iterations, integrated tomo.
[00;00mDM Fitting [00;00mis using CG, with [00;00mNo[00;00m preconditioner, [00;00m10[00;00m iterations
[00;00mThere are 9 fit directions[00;00m
    Fit 0: weight is 0.444, at (   0.00,    0.00) arcsec
    Fit 1: weight is 0.111, at (  15.00,    0.00) arcsec
    Fit 2: weight is 0.111, at (   0.00,   15.00) arcsec
    Fit 3: weight is 0.111, at ( -15.00,    0.00) arcsec
    Fit 4: weight is 0.111, at (   0.00,  -15.00) arcsec
    Fit 5: weight is 0.028, at (  15.00,   15.00) arcsec
    Fit 6: weight is 0.028, at ( -15.00,   15.00) arcsec
    Fit 7: weight is 0.028, at ( -15.00,  -15.00) arcsec
    Fit 8: weight is 0.028, at (  15.00,  -15.00) arcsec
[00;00mThere are 1 evaluation directions[00;00m at sampling 1/128 m.
    Evl 0: weight is 1.000, at (   0.00,    0.00) arcsec
[00;00mSimulation[00;00m start at step 0, end at step 1600, with time step 1/1500s, [00;00mclose loop[00;00m.
After setup_parms:	120.5 MiB.
Warning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid003517/scheduler) failed: Invalid argument. 
CUDA: minimum memory requirement is 0.3GB
GPU 0 is NVIDIA A100-SXM4-40GB with arch 8.0, 38.9GB free, 39.3GB total device memory.
Using GPU 0
Use 1 GPUs for WFS Tomo Fit Evl

*** Preparation started at 2025/02/11 18:46:35 in nid003517. ***

Using OpenMP version 201511 with 128 threads
Reading aperture amplitude map from KECK.fits
Warning(accphi.c:477): 108403 points not covered by input screen
Warning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid003517/scheduler) failed: Invalid argument. 
 ->maos.c:447->setup.c:148->aper.c:74->utils.c:478->accphi.c:478
iwvl 0: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 1: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 2: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 3: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 4: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 5: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 6: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 7: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 8: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
After setup_aper:	344.7 MiB.

[00;00mSetting up powfs 0 geom[00;00m

There are 22 points in each subaperture of 0.178m.
There are 2360 valid subaperture.

[00;00mSetting up powfs 1 geom[00;00m

There are 88 points in each subaperture of 5.5m.
There are 4 valid subaperture.

[00;00mSetting up powfs 2 geom[00;00m

There are 18 points in each subaperture of 0.563m.
There are 236 valid subaperture.
After setup_powfs_init:	416.7 MiB.

[00;00mSetting up reconstructor geometry.[00;00m

PLOC is 127x127, with sampling of 0.09m (square)
    DM 0: grid is 67 x 67
    DM 1: grid is 75 x 75
    DM 2: grid is 81 x 81
FLOC is 127x127, with sampling of 0.09m (not square)
Tomography grid is square:
    layer 0: xloc grid is 224 x 224, sampling is 0.089 m, 50176 points
    layer 1: xloc grid is 224 x 224, sampling is 0.089 m, 50176 points
    layer 2: xloc grid is 224 x 224, sampling is 0.089 m, 50176 points
    layer 3: xloc grid is 224 x 224, sampling is 0.089 m, 50176 points
    layer 4: xloc grid is 224 x 224, sampling is 0.089 m, 50176 points
    layer 5: xloc grid is 224 x 224, sampling is 0.089 m, 50176 points
    layer 6: xloc grid is 224 x 224, sampling is 0.089 m, 50176 points
    layer 7: xloc grid is 224 x 224, sampling is 0.089 m, 50176 points
    layer 8: xloc grid is 224 x 224, sampling is 0.089 m, 50176 points
    layer 9: xloc grid is 224 x 224, sampling is 0.088 m, 50176 points
    layer 10: xloc grid is 224 x 224, sampling is 0.084 m, 50176 points
    layer 11: xloc grid is 224 x 224, sampling is 0.081 m, 50176 points
    layer 12: xloc grid is 224 x 224, sampling is 0.077 m, 50176 points
    layer 13: xloc grid is 224 x 224, sampling is 0.069 m, 50176 points

[00;00mSetting up powfs 0 PO WFS[00;00m

OTF dimension is 48x48 (calculated)
Uplink FWHM (illt 0, iwvl 0) is 0.577526"
Downlink FWHM (illt 0, iwvl 0) is 1.12996"
Generating matched filter for powfs 0
sa index   location       noise equivalent angle
    1178: (  4.8,  -0.2) m, (113.97, 110.64) mas
    1172: (  3.7,  -0.2) m, (120.83, 111.85) mas
    1166: (  2.7,  -0.2) m, (132.43, 113.30) mas
    1160: (  1.6,  -0.2) m, (148.74, 114.57) mas
    1158: (  1.2,  -0.2) m, (154.62, 114.94) mas
     821: ( -0.5,  -1.4) m, (181.16, 119.19) mas
    1155: ( -1.8,  -0.2) m, (194.50, 117.62) mas
    1149: ( -2.8,  -0.2) m, (208.51, 118.57) mas
    1143: ( -3.9,  -0.2) m, (224.72, 119.54) mas
    1137: ( -5.0,  -0.2) m, (242.51, 120.51) mas
    1135: ( -5.3,  -0.2) m, (248.25, 120.83) mas
sa index   location       noise equivalent angle
    1943: (  2.7,   2.7) m, (116.61, 116.61) mas
    1760: (  2.0,   2.0) m, (129.47, 130.38) mas
    1494: (  1.1,   1.1) m, (132.90, 132.90) mas
    1444: (  0.9,   0.9) m, (135.00, 135.00) mas
     876: (  0.5,  -1.2) m, (149.36, 176.26) mas
     870: ( -1.2,  -1.2) m, (162.74, 162.74) mas
     654: ( -2.0,  -2.0) m, (174.11, 173.93) mas
     419: ( -2.8,  -2.8) m, (184.06, 184.06) mas
     285: ( -3.4,  -3.4) m, (191.08, 191.08) mas
     102: ( -3.0,  -4.3) m, (186.35, 202.56) mas
sa index   location       noise equivalent angle
    2172: (  0.0,   3.7) m, (114.30, 123.21) mas
    1928: (  0.0,   2.7) m, (115.80, 135.09) mas
    1647: (  0.0,   1.6) m, (117.11, 151.84) mas
    1541: (  0.0,   1.2) m, (117.49, 157.89) mas
    1059: ( -1.4,  -0.5) m, (119.19, 181.16) mas
     718: (  0.0,  -1.8) m, (120.26, 198.74) mas
     435: (  0.0,  -2.8) m, (121.26, 213.07) mas
     191: (  0.0,  -3.9) m, (122.26, 229.68) mas
      83: (  0.0,  -4.5) m, (122.76, 238.50) mas
sa index   location       noise equivalent angle
    1912: ( -2.8,   2.7) m, (116.61, 116.61) mas
    1737: ( -2.1,   2.0) m, (129.84, 130.94) mas
    1688: ( -2.0,   1.8) m, (126.40, 126.24) mas
    1441: ( -1.1,   0.9) m, (135.00, 135.00) mas
     872: ( -0.9,  -1.2) m, (137.38, 164.67) mas
     879: (  1.1,  -1.2) m, (162.74, 162.74) mas
     675: (  1.8,  -2.0) m, (173.42, 173.38) mas
     450: (  2.7,  -2.8) m, (184.06, 184.06) mas
     322: (  3.2,  -3.4) m, (191.08, 191.08) mas
     135: (  2.8,  -4.3) m, (186.35, 202.56) mas
sa index   location       noise equivalent angle
    1137: ( -5.0,  -0.2) m, (113.97, 110.64) mas
    1143: ( -3.9,  -0.2) m, (120.83, 111.85) mas
    1149: ( -2.8,  -0.2) m, (132.43, 113.30) mas
    1155: ( -1.8,  -0.2) m, (148.74, 114.57) mas
    1157: ( -1.4,  -0.2) m, (154.62, 114.94) mas
     826: (  0.4,  -1.4) m, (181.16, 119.19) mas
    1160: (  1.6,  -0.2) m, (194.50, 117.62) mas
    1166: (  2.7,  -0.2) m, (208.51, 118.57) mas
    1172: (  3.7,  -0.2) m, (224.72, 119.54) mas
    1178: (  4.8,  -0.2) m, (242.50, 120.51) mas
    1180: (  5.2,  -0.2) m, (248.24, 120.83) mas
sa index   location       noise equivalent angle
     285: ( -3.4,  -3.4) m, (113.26, 113.26) mas
     464: ( -2.7,  -2.7) m, (118.30, 118.30) mas
     654: ( -2.0,  -2.0) m, (125.86, 125.76) mas
     920: ( -1.1,  -1.1) m, (135.00, 135.00) mas
    1488: ( -0.7,   1.1) m, (147.11, 173.64) mas
    1444: (  0.9,   0.9) m, (160.25, 160.25) mas
    1548: (  1.2,   1.2) m, (165.26, 165.26) mas
    1760: (  2.0,   2.0) m, (184.58, 185.49) mas
    1988: (  2.8,   2.8) m, (186.13, 186.13) mas
    2260: (  2.8,   4.1) m, (186.35, 202.55) mas
sa index   location       noise equivalent angle
     191: (  0.0,  -3.9) m, (114.30, 123.21) mas
     435: (  0.0,  -2.8) m, (115.80, 135.09) mas
     718: (  0.0,  -1.8) m, (117.11, 151.84) mas
     824: (  0.0,  -1.4) m, (117.49, 157.89) mas
    1301: ( -1.4,   0.4) m, (119.19, 181.16) mas
    1647: (  0.0,   1.6) m, (120.26, 198.74) mas
    1928: (  0.0,   2.7) m, (121.26, 213.06) mas
    2172: (  0.0,   3.7) m, (122.26, 229.68) mas
    2280: (  0.0,   4.3) m, (122.76, 238.49) mas
sa index   location       noise equivalent angle
     364: (  3.0,  -3.2) m, (114.49, 114.49) mas
     493: (  2.5,  -2.7) m, (118.30, 118.30) mas
     675: (  1.8,  -2.0) m, (125.48, 125.47) mas
     923: (  0.9,  -1.1) m, (135.00, 135.00) mas
    1491: (  0.5,   1.1) m, (145.22, 171.38) mas
    1441: ( -1.1,   0.9) m, (160.25, 160.25) mas
    1533: ( -1.4,   1.2) m, (165.26, 165.26) mas
    1737: ( -2.1,   2.0) m, (185.07, 186.14) mas
    1955: ( -3.0,   2.8) m, (186.13, 186.13) mas
    2227: ( -3.0,   4.1) m, (186.35, 202.55) mas

[00;00mSetting up powfs 2 PO WFS[00;00m

OTF dimension is 48x48 (calculated)
Generating matched filter for powfs 2
Use sanea to derive neasim
Use sanea to derive neasim

[00;00mSetting up reconstructor[00;00m

Recon NEA: cmf(156.09) cmf(156.72) cmf(156.14) cmf(156.72) cmf(156.08) cmf(156.67) cmf(156.07) cmf(156.66) geom(0.31) geom(0.31) geom(0.31) mf(0.14)  mas
Setup or update control matrix parameters.
RRtwfs svd threshold is 1e-10
Replacing HA by HA*fit->actextrap
Adding piston cr to fit matrix
Adding TT cr on upper DMs to fit matrix.
Before assembling fit matrix:	4108.4 MiB.
Building fit->FR
Building fit->FL
Adding tikhonov constraint of 1.0e-07 to FLM
The maximum eigen value is estimated to be around 3.0e-04
DM Fit number of Low rank terms: 16 in LHS
After assemble fit matrix:	5517.9 MiB.
After setup_recon:	5517.9 MiB.
GPU 0: mem used 1848 MB (wfs init)
GPU 0: mem used 2694 MB (recon init)
GPU 0: mem used 2724 MB (perf init)

*** Simulation started at 2025/02/11 18:47:31 in nid003517. ***

Running seed 1
GPU 0: mem used 2726 MB (wfs seeding)
Wind dir: 267.3 261.7 167.0 130.5 300.7  32.3 119.8 139.0 150.8 277.7 203.0 133.1  45.9 265.1 deg
Using /global/homes/b/bpeck/.aos/cache/atm/vonkarman_14_8192x8192_0.0078125_1115374592d.bin
After genatm:	5366.2 MiB.
Step     #  Open Loop  PR TT  On axis  PR TT  Field RMS PR TT     Timing 
Step     0: OL  884.6  248.3  OA  884.6 248.3 CL  884.6 248.3 nm  0.876 s
Step    19: OL  914.2  255.5  OA  117.5  17.0 CL  117.5  17.0 nm  0.050 s
Step    36: OL  940.7  259.9  OA  117.6   9.0 CL  117.6   9.0 nm  0.060 s
Step    53: OL  966.0  261.1  OA  116.1  10.4 CL  116.1  10.4 nm  0.060 s
Step    70: OL  991.3  259.8  OA  120.9  16.5 CL  120.9  16.5 nm  0.060 s
Step    87: OL 1017.3  258.2  OA  120.1  18.9 CL  120.1  18.9 nm  0.060 s
Step   104: OL 1043.3  257.4  OA  118.5  19.5 CL  118.5  19.5 nm  0.062 s
Step   120: OL 1067.7  258.5  OA  117.5  14.5 CL  117.5  14.5 nm  0.068 s
Step   136: OL 1090.4  262.0  OA  117.5   7.6 CL  117.5   7.6 nm  0.059 s
Step   152: OL 1111.0  268.2  OA  120.1  21.9 CL  120.1  21.9 nm  0.087 s
Step   168: OL 1128.4  276.7  OA  118.7  23.5 CL  118.7  23.5 nm  0.061 s
Step   185: OL 1143.0  287.2  OA  121.7  23.1 CL  121.7  23.1 nm  0.061 s
Step   202: OL 1152.9  298.2  OA  116.7  14.7 CL  116.7  14.7 nm  0.059 s
Step   218: OL 1159.2  308.4  OA  113.2  25.5 CL  113.2  25.5 nm  0.063 s
Step   234: OL 1161.8  318.8  OA  115.5  19.2 CL  115.5  19.2 nm  0.065 s
Step   251: OL 1159.9  330.6  OA  117.1  11.7 CL  117.1  11.7 nm  0.059 s
Step   255 updated high order loop gain: 0.368
Step   268: OL 1151.3  342.8  OA  119.8  30.1 CL  119.8  30.1 nm  0.066 s
Step   285: OL 1136.9  355.4  OA  113.3  17.8 CL  113.3  17.8 nm  0.058 s
Step   301: OL 1120.4  369.0  OA  113.5  16.0 CL  113.5  16.0 nm  0.067 s
Step   318: OL 1100.1  384.7  OA  117.8  27.7 CL  117.8  27.7 nm  0.059 s
Step   334: OL 1079.0  401.5  OA  115.4  24.9 CL  115.4  24.9 nm  0.067 s
Step   351: OL 1056.5  422.2  OA  111.3  16.5 CL  111.3  16.5 nm  0.060 s
Step   365: OL 1038.8  441.4  OA  112.5  17.8 CL  112.5  17.8 nm  0.060 s
Step   381: OL 1019.8  464.3  OA  117.5  11.3 CL  117.5  11.3 nm  0.062 s
Step   398: OL 1000.8  488.9  OA  113.1   7.6 CL  113.1   7.6 nm  0.060 s
Step   414: OL  982.7  511.4  OA  116.5  13.9 CL  116.5  13.9 nm  0.061 s
Step   430: OL  964.2  532.8  OA  112.1  19.0 CL  112.1  19.0 nm  0.061 s
Step   447: OL  945.9  555.0  OA  119.6  28.7 CL  119.6  28.7 nm  0.069 s
Step   462: OL  933.2  574.7  OA  116.8  20.6 CL  116.8  20.6 nm  0.062 s
Step   479: OL  924.7  596.5  OA  114.7   6.4 CL  114.7   6.4 nm  0.068 s
Step   495: OL  923.2  616.2  OA  113.0   8.8 CL  113.0   8.8 nm  0.059 s
Step   511 updated high order loop gain: 0.362
Step   512: OL  925.8  635.0  OA  113.9  19.1 CL  113.9  19.1 nm  0.068 s
Step   529: OL  931.9  650.5  OA  113.3   8.8 CL  113.3   8.8 nm  0.060 s
Step   546: OL  941.5  661.1  OA  114.5  13.7 CL  114.5  13.7 nm  0.060 s
Step   563: OL  955.1  667.5  OA  114.1  11.9 CL  114.1  11.9 nm  0.061 s
Step   580: OL  971.3  670.3  OA  115.4  10.2 CL  115.4  10.2 nm  0.068 s
Step   594: OL  986.9  670.0  OA  113.2   9.8 CL  113.2   9.8 nm  0.058 s
Step   610: OL 1005.7  665.5  OA  115.5   9.2 CL  115.5   9.2 nm  0.059 s
Step   627: OL 1026.0  656.6  OA  112.4   5.4 CL  112.4   5.4 nm  0.060 s
Step   643: OL 1044.0  644.6  OA  114.4   3.3 CL  114.4   3.3 nm  0.060 s
Step   660: OL 1061.0  629.0  OA  113.0   7.5 CL  113.0   7.5 nm  0.061 s
Step   677: OL 1076.3  611.5  OA  117.0   9.7 CL  117.0   9.7 nm  0.061 s
Step   693: OL 1089.5  594.7  OA  116.8   5.5 CL  116.8   5.5 nm  0.073 s
Step   710: OL 1100.2  574.9  OA  120.3  11.4 CL  120.3  11.4 nm  0.062 s
Step   727: OL 1106.2  553.9  OA  117.7  18.2 CL  117.7  18.2 nm  0.065 s
Step   744: OL 1106.9  532.9  OA  115.4   7.2 CL  115.4   7.2 nm  0.060 s
Step   761: OL 1102.8  512.6  OA  118.9   8.2 CL  118.9   8.2 nm  0.060 s
Step   767 updated high order loop gain: 0.359
Step   778: OL 1093.5  493.2  OA  122.1  15.1 CL  122.1  15.1 nm  0.061 s
Step   795: OL 1078.6  474.2  OA  116.4   3.9 CL  116.4   3.9 nm  0.060 s
Step   811: OL 1060.9  456.3  OA  118.5  10.5 CL  118.5  10.5 nm  0.061 s
Step   828: OL 1038.1  437.5  OA  119.1  20.9 CL  119.1  20.9 nm  0.066 s
Step   843: OL 1015.3  421.6  OA  118.2  26.8 CL  118.2  26.8 nm  0.060 s
Step   859: OL  989.9  406.0  OA  116.1  11.6 CL  116.1  11.6 nm  0.072 s
Step   876: OL  963.6  391.5  OA  112.7  11.2 CL  112.7  11.2 nm  0.061 s
Step   893: OL  938.3  379.4  OA  114.1  15.5 CL  114.1  15.5 nm  0.069 s
Step   910: OL  911.4  369.3  OA  110.4   5.9 CL  110.4   5.9 nm  0.058 s
Step   927: OL  884.0  361.0  OA  108.9  10.7 CL  108.9  10.7 nm  0.067 s
Step   943: OL  858.9  353.5  OA  113.3   3.4 CL  113.3   3.4 nm  0.061 s
Step   960: OL  833.9  344.9  OA  114.2  13.4 CL  114.2  13.4 nm  0.076 s
Step   976: OL  814.0  335.7  OA  117.5  25.9 CL  117.5  25.9 nm  0.060 s
Step   993: OL  796.1  324.6  OA  114.0   9.8 CL  114.0   9.8 nm  0.066 s
Step  1010: OL  780.1  312.0  OA  116.0  11.5 CL  116.0  11.5 nm  0.059 s
Step  1023 updated high order loop gain: 0.352
Step  1026: OL  767.6  299.7  OA  116.5   9.6 CL  116.5   9.6 nm  0.059 s
Step  1043: OL  756.8  285.7  OA  113.3  18.6 CL  113.3  18.6 nm  0.062 s
Step  1060: OL  746.6  270.0  OA  115.8  18.9 CL  115.8  18.9 nm  0.071 s
Step  1076: OL  738.9  252.8  OA  120.3  26.9 CL  120.3  26.9 nm  0.061 s
Step  1093: OL  734.3  233.1  OA  115.3  15.2 CL  115.3  15.2 nm  0.061 s
Step  1109: OL  732.5  216.0  OA  113.1  12.5 CL  113.1  12.5 nm  0.060 s
Step  1126: OL  732.4  200.1  OA  110.0  21.0 CL  110.0  21.0 nm  0.059 s
Step  1142: OL  733.0  188.2  OA  110.1  26.0 CL  110.1  26.0 nm  0.059 s
Step  1159: OL  733.8  178.5  OA  107.8  10.7 CL  107.8  10.7 nm  0.061 s
Step  1176: OL  734.8  172.3  OA  108.8   9.4 CL  108.8   9.4 nm  0.061 s
Step  1193: OL  738.0  168.4  OA  111.3  19.8 CL  111.3  19.8 nm  0.060 s
Step  1210: OL  742.1  165.2  OA  113.6  16.3 CL  113.6  16.3 nm  0.059 s
Step  1227: OL  746.3  163.5  OA  108.7   9.5 CL  108.7   9.5 nm  0.061 s
Step  1243: OL  749.2  164.6  OA  111.7  28.9 CL  111.7  28.9 nm  0.064 s
Step  1259: OL  752.5  169.0  OA  109.6  21.1 CL  109.6  21.1 nm  0.060 s
Step  1276: OL  757.0  176.8  OA  109.5  17.4 CL  109.5  17.4 nm  0.067 s
Step  1279 updated high order loop gain: 0.349
Step  1287: OL  761.1  183.2  OA  112.4  13.6 CL  112.4  13.6 nm  0.059 s
Step  1304: OL  768.0  194.5  OA  114.8  26.2 CL  114.8  26.2 nm  0.068 s
Step  1321: OL  774.6  207.6  OA  112.1  20.1 CL  112.1  20.1 nm  0.060 s
Step  1337: OL  781.7  221.4  OA  112.0  21.5 CL  112.0  21.5 nm  0.061 s
Step  1354: OL  791.6  236.9  OA  108.2  25.7 CL  108.2  25.7 nm  0.060 s
Step  1371: OL  804.0  250.4  OA  113.7  28.0 CL  113.7  28.0 nm  0.061 s
Step  1388: OL  817.7  260.7  OA  109.6  15.7 CL  109.6  15.7 nm  0.061 s
Step  1405: OL  833.6  268.1  OA  114.5  27.5 CL  114.5  27.5 nm  0.062 s
Step  1420: OL  848.8  272.5  OA  113.2  30.8 CL  113.2  30.8 nm  0.058 s
Step  1436: OL  865.3  276.0  OA  111.2  20.2 CL  111.2  20.2 nm  0.061 s
Step  1452: OL  880.3  278.6  OA  109.8  25.5 CL  109.8  25.5 nm  0.067 s
Step  1469: OL  893.8  279.3  OA  113.0  12.9 CL  113.0  12.9 nm  0.059 s
Step  1486: OL  901.8  276.9  OA  111.6  21.8 CL  111.6  21.8 nm  0.068 s
Step  1503: OL  903.9  271.6  OA  108.1   5.2 CL  108.1   5.2 nm  0.060 s
Step  1519: OL  902.0  264.4  OA  109.3   8.2 CL  109.3   8.2 nm  0.066 s
Step  1535: OL  896.2  255.5  OA  111.4  17.8 CL  111.4  17.8 nm  0.063 s
Step  1535 updated high order loop gain: 0.348
Step  1551: OL  887.6  245.2  OA  109.9  12.4 CL  109.9  12.4 nm  0.060 s
Step  1568: OL  877.9  234.2  OA  109.6   6.7 CL  109.6   6.7 nm  0.061 s
Step  1585: OL  867.2  225.1  OA  115.7   7.9 CL  115.7   7.9 nm  0.061 s
Step 1599: Output PSF
Step  1599: OL  857.4  219.2  OA  114.0   7.7 CL  114.0   7.7 nm  1.341 s
Mean: 113.65 16.07 112.51  nm.

*** Simulation Finished at 2025/02/11 18:49:25 in nid003517. ***

