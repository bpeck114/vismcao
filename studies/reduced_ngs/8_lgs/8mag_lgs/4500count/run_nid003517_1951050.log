Warning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid003517/scheduler) failed: Invalid argument. 
/global/u2/b/bpeck/work/vismcao/maos -o studies/reduced_ngs/8_lgs/8mag_lgs/4500count -c master_files/reduced_ngs/8_lgs/8mag_lgs/kola_4500act.conf -O 
Output folder is 'studies/reduced_ngs/8_lgs/8mag_lgs/4500count'.
SRC: /global/homes/b/bpeck/code/maos v2.9 4c88b7c2 2024-11-13 16:45:33 -0800
BUILT: /global/homes/b/bpeck/code/maos/optim by GCC (v12) on 2024/11/18 09:40:03 CPU(F64,+O3) with CUDA(v122,F32)
Launched at 2025/02/11 19:06:37 in nid003517 with PID 1951050.
The web based job monitor can be accessed at http://localhost:10300
Main config file is /global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/8_lgs/8mag_lgs/kola_4500act.conf
Warning(path.c:48): Path not found: path=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/8_lgs/8mag_lgs/bin; abspath=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/8_lgs/8mag_lgs/bin; Ignored.
Warning(path.c:48): Path not found: path=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/8_lgs/8mag_lgs/atm; abspath=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/8_lgs/8mag_lgs/atm; Ignored.
Warning(readcfg.c:399): sim.apfsm has been renamed to powfs.apfsm.
Warning(readcfg.c:399): sim.epfsm has been renamed to powfs.epfsm.
Warning(readcfg.c:399): sim.alfsm has been renamed to powfs.alfsm.
Warning(readcfg.c:399): sim.commonfsm has been renamed to powfs.commonfsm.
Warning(readcfg.c:399): sim.idealfsm has been renamed to powfs.idealfsm.
Warning(readcfg.c:399): sim.zetafsm has been renamed to powfs.zetafsm.
Warning(readcfg.c:399): sim.f0fsm has been renamed to powfs.f0fsm.
Warning(readcfg.c:399): tsurf has been renamed to ncpa.tsurf.
loaded 132 (132 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_sim.conf'
loaded  19 ( 19 new) records from '/global/u2/b/bpeck/work/vismcao/./dm_none.conf'
loaded  19 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_ASM.conf'
loaded  19 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_DM2.conf'
loaded  19 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_DM3.conf'
loaded   0 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_dm_multiple.conf'
loaded   7 (  5 new) records from '/global/u2/b/bpeck/work/vismcao/./atm_mk13n50p_ground_detail.conf'
loaded  76 ( 69 new) records from '/global/homes/b/bpeck/code/maos/config/maos/powfs_common.conf'
loaded  44 ( 38 new) records from '/global/u2/b/bpeck/work/vismcao/./powfs_none.conf'
loaded  44 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_shwfs_lgs.conf'
loaded  44 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_shwfs_ttf_strap.conf'
loaded  44 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_shwfs_twfs_lbwfs.conf'
loaded   0 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_wfs_lgs_strap_lbwfs.conf'
loaded  71 ( 71 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_recon.conf'
Warning(readcfg.c:399): dbg.na_smooth has been renamed to powfs0_llt.na_smooth.
Warning(readcfg.c:399): dbg.na_interp has been renamed to powfs0_llt.na_interp.
Warning(readcfg.c:399): dbg.na_thres has been renamed to powfs0_llt.na_thres.
Warning(readcfg.c:399): dbg.na_fit_maxit has been renamed to powfs0_llt.na_fit_maxit.
Warning(readcfg.c:399): dbg.na_fit_svdthres has been renamed to powfs0_llt.na_fit_svdthres.
Warning(readcfg.c:399): dbg.na_fit_dh has been renamed to powfs0_llt.na_fit_dh.
Warning(readcfg.c:399): dbg.ncpa_preload has been renamed to ncpa.preload.
Warning(readcfg.c:399): dbg.ncpa_rmsci has been renamed to ncpa.rmsci.
Warning(readcfg.c:399): dbg.draw_opdmax has been renamed to plot.opdmax.
Warning(readcfg.c:399): dbg.draw_gmax has been renamed to plot.gmax.
loaded  95 ( 93 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_dbg.conf'
loaded   4 (  4 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_fit_mcao.conf'
Warning(readcfg.c:399): surf has been renamed to ncpa.surf.
loaded  39 (  7 new) records from '/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/8_lgs/8mag_lgs/kola_4500act.conf'
loaded   0 (  0 new) records from 'command line'
loaded  24 ( 18 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_llt_CL.conf'
Adjust LGS range by telescope altitude 4145m.
Zenith angle is 30 degree.
    Scaling turbulence height and LGS hs by sec(za).
    Scaling r0 by cos(za)^(3/5).
    Scaling wind speed and LGS signal level by cos(za).
powfs0: Adjusting dx from 0.0078125 to 0.00805556. 
powfs0.llt.fsm: f0=0 Hz, LPF ep=0
powfs0.epfsm is set to 0.517618 (auto)
powfs2: Adjusting dx from 0.03125 to 0.0312778. 
powfs2 is TWFS for powfs0
sim.ephi is set to 0.427717 (auto)
sim.eplo is set to 0.427717 (auto)
Warning(parms.c:2296): Layer 1 at 17.3205m is very close to layer 0 at 0m (OK).
Warning(parms.c:2296): Layer 2 at 34.641m is very close to layer 1 at 17.3205m (OK).
Warning(parms.c:2296): Layer 3 at 51.9615m is very close to layer 2 at 34.641m (OK).
dm 0: stroke=30 um is provided in micron.
dm 0: assume ia stroke=2 um is provided in micron.
dm 1: stroke=7 um is provided in micron.
dm 1: assume ia stroke=2 um is provided in micron.
dm 2: stroke=7 um is provided in micron.
dm 2: assume ia stroke=2 um is provided in micron.
Focus blending is not implemented yet for integrated tomography
parms->sim.mffocus is reset to 0
There are 1 valid simulation seeds:  1
Output PSF for 1 directions
Used 449 of 456 supplied keys
Warning(readcfg.c:158): key "dbg.pwfs_flate" is not recognized, value is 0
Warning(readcfg.c:158): key "dbg.pwfs_flatv" is not recognized, value is 0
Warning(readcfg.c:158): key "dbg.pwfs_psx" is not recognized, value is [0 0 0 0]
Warning(readcfg.c:158): key "dbg.pwfs_psy" is not recognized, value is [0 0 0 0]
Warning(readcfg.c:158): key "dbg.pwfs_pupelong" is not recognized, value is 0
Warning(readcfg.c:158): key "dbg.pwfs_raw" is not recognized, value is 0
Warning(readcfg.c:158): key "dbg.pwfs_side" is not recognized, value is 4
[00;00mAperture[00;00m is 11 m with sampling 1/128 m
[00;00mTurbulence at 30 degree zenith angle:[00;00m r0=0.128424m, L0=30m, 14 layers.
    Greenwood freq is 25.1Hz, anisoplanatic angle is 1.58 as
    Sampled 8192x8192 at 1/128m. wind dir is randomized.
    layer 0: ht=      0 m, wt= 0.302, ws=  4.8 m/s
    layer 1: ht=     17 m, wt= 0.154, ws=  5.0 m/s
    layer 2: ht=     35 m, wt= 0.041, ws=  5.4 m/s
    layer 3: ht=     52 m, wt= 0.002, ws=  6.6 m/s
    layer 4: ht=    139 m, wt= 0.021, ws=  6.1 m/s
    layer 5: ht=    231 m, wt= 0.010, ws=  6.1 m/s
    layer 6: ht=    323 m, wt= 0.008, ws=  6.1 m/s
    layer 7: ht=    416 m, wt= 0.005, ws=  6.1 m/s
    layer 8: ht=    508 m, wt= 0.001, ws=  6.1 m/s
    layer 9: ht=    932 m, wt= 0.107, ws=  5.6 m/s
    layer 10: ht=   5022 m, wt= 0.144, ws= 11.1 m/s
    layer 11: ht=   9238 m, wt= 0.093, ws= 19.1 m/s
    layer 12: ht=  13856 m, wt= 0.075, ws=  8.2 m/s
    layer 13: ht=  22518 m, wt= 0.036, ws=  4.8 m/s
[00;00mReconstruction[00;00m: r0=0.128424m L0=30m. 14 layers. use cone coordinate.
    layer 0: ht=      0 m, wt= 0.302
    layer 1: ht=     17 m, wt= 0.154
    layer 2: ht=     35 m, wt= 0.041
    layer 3: ht=     52 m, wt= 0.002
    layer 4: ht=    139 m, wt= 0.021
    layer 5: ht=    231 m, wt= 0.010
    layer 6: ht=    323 m, wt= 0.008
    layer 7: ht=    416 m, wt= 0.005
    layer 8: ht=    508 m, wt= 0.001
    layer 9: ht=    932 m, wt= 0.107
    layer 10: ht=   5022 m, wt= 0.144
    layer 11: ht=   9238 m, wt= 0.093
    layer 12: ht=  13856 m, wt= 0.075
    layer 13: ht=  22518 m, wt= 0.036
[00;00mThere are 3 powfs[00;00m
  powfs0: Order 76, LGS at 99.1 km. Sampling 1/124.138 m. Thres 30%. [00;00mT/T is removed in right hand side in tomography.[00;00m
    CCD image is 25x25 @ 500x500 mas, blur 27% (sigma), 1500Hz, wvl: [ 5.89e-07]
    Gtilt in reconstruction. Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
  powfs1: Order  2, NGS at inf km. Sampling 1/16 m. Thres 30%. 
    Ztilt in reconstruction. Geomtric optics start at 2 with ztilt [00;00m(noisy)[00;00m
  powfs2: Order 20, NGS at inf km. Sampling 1/31.9716 m. Thres 50%. 
    CCD image is 4x4 @ 1500x1500 mas, blur 0% (sigma), 0.015Hz, wvl: [ 7.2e-07]
    Gtilt in reconstruction. Geomtric optics start at 50 with gtilt Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
[00;00mThere are 12 wfs[00;00m
    wfs 0: type 0, at (  30.00,    0.00) arcsec,  99 km, siglev is 25.21 bkgrnd is 0.1
    wfs 1: type 0, at (  21.21,   21.21) arcsec,  99 km, siglev is 25.21 bkgrnd is 0.1
    wfs 2: type 0, at (   0.00,   30.00) arcsec,  99 km, siglev is 25.21 bkgrnd is 0.1
    wfs 3: type 0, at ( -21.21,   21.21) arcsec,  99 km, siglev is 25.21 bkgrnd is 0.1
    wfs 4: type 0, at ( -30.00,    0.00) arcsec,  99 km, siglev is 25.21 bkgrnd is 0.1
    wfs 5: type 0, at ( -21.21,  -21.21) arcsec,  99 km, siglev is 25.21 bkgrnd is 0.1
    wfs 6: type 0, at (   0.00,  -30.00) arcsec,  99 km, siglev is 25.21 bkgrnd is 0.1
    wfs 7: type 0, at (  21.21,  -21.21) arcsec,  99 km, siglev is 25.21 bkgrnd is 0.1
    wfs 8: type 1, at (   5.00,    8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 9: type 1, at ( -10.00,    0.00) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 10: type 1, at (   5.00,   -8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 11: type 2, at (   0.00,    0.00) arcsec, inf km, siglev is 4.1558e+06 bkgrnd is 0.001
[00;00mThere are 3 DMs[00;00m
  DM 0 at -0.1km, actuator pitch 0.145m, offset   0, with 30.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 1 at    6km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 2 at   10km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
[00;00mTomography[00;00m is using CG, with [00;00mFourer Domain[00;00m preconditioner, [00;00m12[00;00m iterations, integrated tomo.
[00;00mDM Fitting [00;00mis using CG, with [00;00mNo[00;00m preconditioner, [00;00m10[00;00m iterations
[00;00mThere are 9 fit directions[00;00m
    Fit 0: weight is 0.444, at (   0.00,    0.00) arcsec
    Fit 1: weight is 0.111, at (  15.00,    0.00) arcsec
    Fit 2: weight is 0.111, at (   0.00,   15.00) arcsec
    Fit 3: weight is 0.111, at ( -15.00,    0.00) arcsec
    Fit 4: weight is 0.111, at (   0.00,  -15.00) arcsec
    Fit 5: weight is 0.028, at (  15.00,   15.00) arcsec
    Fit 6: weight is 0.028, at ( -15.00,   15.00) arcsec
    Fit 7: weight is 0.028, at ( -15.00,  -15.00) arcsec
    Fit 8: weight is 0.028, at (  15.00,  -15.00) arcsec
[00;00mThere are 1 evaluation directions[00;00m at sampling 1/128 m.
    Evl 0: weight is 1.000, at (   0.00,    0.00) arcsec
[00;00mSimulation[00;00m start at step 0, end at step 1600, with time step 1/1500s, [00;00mclose loop[00;00m.
After setup_parms:	120.5 MiB.
Warning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid003517/scheduler) failed: Invalid argument. 
CUDA: minimum memory requirement is 0.3GB
GPU 0 is NVIDIA A100-SXM4-40GB with arch 8.0, 38.9GB free, 39.3GB total device memory.
Using GPU 0
Use 1 GPUs for WFS Tomo Fit Evl

*** Preparation started at 2025/02/11 19:06:37 in nid003517. ***

Using OpenMP version 201511 with 128 threads
Reading aperture amplitude map from KECK.fits
Warning(accphi.c:477): 108390 points not covered by input screen
Warning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid003517/scheduler) failed: Invalid argument. 
 ->maos.c:447->setup.c:148->aper.c:74->utils.c:478->accphi.c:478
iwvl 0: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 1: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 2: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 3: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 4: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 5: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 6: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 7: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 8: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
After setup_aper:	344.7 MiB.

[00;00mSetting up powfs 0 geom[00;00m

There are 18 points in each subaperture of 0.145m.
There are 3550 valid subaperture.

[00;00mSetting up powfs 1 geom[00;00m

There are 88 points in each subaperture of 5.5m.
There are 4 valid subaperture.

[00;00mSetting up powfs 2 geom[00;00m

There are 18 points in each subaperture of 0.563m.
There are 236 valid subaperture.
After setup_powfs_init:	420.3 MiB.

[00;00mSetting up reconstructor geometry.[00;00m

PLOC is 155x155, with sampling of 0.07m (square)
    DM 0: grid is 81 x 81
    DM 1: grid is 75 x 75
    DM 2: grid is 81 x 81
FLOC is 155x155, with sampling of 0.07m (not square)
Tomography grid is square:
    layer 0: xloc grid is 280 x 280, sampling is 0.072 m, 78400 points
    layer 1: xloc grid is 280 x 280, sampling is 0.072 m, 78400 points
    layer 2: xloc grid is 280 x 280, sampling is 0.072 m, 78400 points
    layer 3: xloc grid is 280 x 280, sampling is 0.072 m, 78400 points
    layer 4: xloc grid is 280 x 280, sampling is 0.072 m, 78400 points
    layer 5: xloc grid is 280 x 280, sampling is 0.072 m, 78400 points
    layer 6: xloc grid is 280 x 280, sampling is 0.072 m, 78400 points
    layer 7: xloc grid is 280 x 280, sampling is 0.072 m, 78400 points
    layer 8: xloc grid is 280 x 280, sampling is 0.072 m, 78400 points
    layer 9: xloc grid is 280 x 280, sampling is 0.072 m, 78400 points
    layer 10: xloc grid is 280 x 280, sampling is 0.069 m, 78400 points
    layer 11: xloc grid is 280 x 280, sampling is 0.066 m, 78400 points
    layer 12: xloc grid is 280 x 280, sampling is 0.062 m, 78400 points
    layer 13: xloc grid is 280 x 280, sampling is 0.056 m, 78400 points

[00;00mSetting up powfs 0 PO WFS[00;00m

OTF dimension is 36x36 (calculated)
Uplink FWHM (illt 0, iwvl 0) is 0.578619"
Downlink FWHM (illt 0, iwvl 0) is 1.36259"
Generating matched filter for powfs 0
sa index   location       noise equivalent angle
    1772: (  4.8,  -0.1) m, (163.86, 156.99) mas
    1765: (  3.8,  -0.1) m, (174.59, 158.80) mas
    1757: (  2.6,  -0.1) m, (189.93, 161.43) mas
    1750: (  1.6,  -0.1) m, (204.26, 163.92) mas
    1748: (  1.3,  -0.1) m, (208.45, 164.66) mas
    1277: ( -0.6,  -1.3) m, (237.64, 173.38) mas
    1743: ( -1.7,  -0.1) m, (254.73, 172.33) mas
    1735: ( -2.9,  -0.1) m, (274.80, 175.12) mas
    1728: ( -3.9,  -0.1) m, (294.01, 177.49) mas
    1720: ( -5.1,  -0.1) m, (318.65, 180.12) mas
    1718: ( -5.4,  -0.1) m, (324.60, 180.70) mas
sa index   location       noise equivalent angle
    2892: (  2.6,   2.6) m, (167.42, 167.42) mas
    2609: (  1.9,   1.9) m, (181.72, 180.02) mas
    2282: (  1.2,   1.2) m, (185.58, 185.58) mas
    2158: (  0.9,   0.9) m, (189.79, 189.79) mas
    1284: (  0.4,  -1.3) m, (198.69, 222.79) mas
    1338: ( -1.2,  -1.2) m, (222.13, 222.13) mas
     944: ( -2.0,  -2.0) m, (243.48, 242.62) mas
     661: ( -2.8,  -2.8) m, (250.78, 250.78) mas
     442: ( -3.3,  -3.3) m, (261.81, 261.81) mas
     170: ( -3.0,  -4.2) m, (257.29, 277.83) mas
sa index   location       noise equivalent angle
    3274: (  0.0,   3.8) m, (164.10, 179.29) mas
    2874: (  0.0,   2.6) m, (166.87, 195.15) mas
    2469: (  0.0,   1.6) m, (169.50, 209.95) mas
    2339: (  0.0,   1.3) m, (170.28, 214.28) mas
    1567: ( -1.3,  -0.6) m, (173.38, 237.64) mas
    1086: (  0.0,  -1.7) m, (178.41, 261.89) mas
     626: (  0.0,  -2.9) m, (181.37, 282.52) mas
     279: (  0.0,  -3.9) m, (183.89, 302.30) mas
     103: (  0.0,  -4.5) m, (185.19, 313.24) mas
       1: ( -2.5,  -4.9) m, (193.74, 328.46) mas
sa index   location       noise equivalent angle
    2855: ( -2.8,   2.6) m, (167.42, 167.42) mas
    2582: ( -2.0,   1.9) m, (183.15, 181.50) mas
    2265: ( -1.3,   1.2) m, (185.58, 185.58) mas
    2155: ( -1.0,   0.9) m, (190.30, 190.30) mas
    1986: (  1.2,   0.4) m, (222.50, 198.39) mas
    1399: (  0.9,  -1.0) m, (220.29, 220.29) mas
     971: (  1.9,  -2.0) m, (241.83, 241.01) mas
     751: (  2.5,  -2.6) m, (248.07, 248.07) mas
     539: (  3.0,  -3.2) m, (258.35, 258.35) mas
     211: (  2.9,  -4.2) m, (257.29, 277.83) mas
sa index   location       noise equivalent angle
    1721: ( -4.9,  -0.1) m, (163.86, 156.99) mas
    1728: ( -3.9,  -0.1) m, (174.59, 158.80) mas
    1736: ( -2.8,  -0.1) m, (189.93, 161.43) mas
    1743: ( -1.7,  -0.1) m, (204.26, 163.92) mas
    1745: ( -1.4,  -0.1) m, (208.45, 164.66) mas
    1284: (  0.4,  -1.3) m, (237.43, 173.03) mas
    1750: (  1.6,  -0.1) m, (254.73, 172.33) mas
    1758: (  2.8,  -0.1) m, (274.80, 175.12) mas
    1765: (  3.8,  -0.1) m, (294.01, 177.49) mas
    1773: (  4.9,  -0.1) m, (318.65, 180.12) mas
    1775: (  5.2,  -0.1) m, (324.60, 180.70) mas
sa index   location       noise equivalent angle
     442: ( -3.3,  -3.3) m, (161.48, 161.48) mas
     716: ( -2.6,  -2.6) m, (168.62, 168.62) mas
    1008: ( -1.9,  -1.9) m, (177.78, 177.78) mas
    1338: ( -1.2,  -1.2) m, (187.73, 187.73) mas
    1568: (  1.2,  -0.6) m, (222.50, 198.39) mas
    2158: (  0.9,   0.9) m, (219.67, 219.67) mas
    2282: (  1.2,   1.2) m, (224.59, 224.59) mas
    2670: (  2.0,   2.0) m, (258.88, 262.50) mas
    2947: (  2.8,   2.8) m, (253.33, 253.33) mas
    3382: (  2.9,   4.1) m, (257.29, 277.83) mas
sa index   location       noise equivalent angle
     279: (  0.0,  -3.9) m, (164.10, 179.29) mas
     680: (  0.0,  -2.8) m, (166.87, 195.15) mas
    1086: (  0.0,  -1.7) m, (169.50, 209.95) mas
    1216: (  0.0,  -1.4) m, (170.28, 214.28) mas
    1985: ( -1.3,   0.4) m, (173.03, 237.43) mas
    2469: (  0.0,   1.6) m, (178.41, 261.89) mas
    2928: (  0.0,   2.8) m, (181.37, 282.52) mas
    3274: (  0.0,   3.8) m, (183.89, 302.30) mas
    3450: (  0.0,   4.3) m, (185.19, 313.24) mas
    3548: (  2.3,   4.8) m, (203.85, 343.20) mas
sa index   location       noise equivalent angle
     645: (  2.8,  -2.9) m, (165.87, 165.87) mas
     751: (  2.5,  -2.6) m, (168.62, 168.62) mas
    1033: (  1.7,  -1.9) m, (177.78, 177.78) mas
    1345: (  1.0,  -1.2) m, (187.73, 187.73) mas
    1567: ( -1.3,  -0.6) m, (223.15, 198.99) mas
    2155: ( -1.0,   0.9) m, (220.29, 220.29) mas
    2265: ( -1.3,   1.2) m, (224.59, 224.59) mas
    2641: ( -2.2,   2.0) m, (258.81, 262.94) mas
    2908: ( -2.9,   2.8) m, (253.33, 253.33) mas
    3341: ( -3.0,   4.1) m, (257.29, 277.83) mas

[00;00mSetting up powfs 2 PO WFS[00;00m

OTF dimension is 48x48 (calculated)
Generating matched filter for powfs 2
Use sanea to derive neasim
Use sanea to derive neasim

[00;00mSetting up reconstructor[00;00m

Recon NEA: cmf(212.87) cmf(214.58) cmf(212.83) cmf(214.33) cmf(212.53) cmf(214.27) cmf(212.75) cmf(214.53) geom(0.31) geom(0.31) geom(0.31) mf(0.14)  mas
Setup or update control matrix parameters.
RRtwfs svd threshold is 1e-10
Replacing HA by HA*fit->actextrap
Adding piston cr to fit matrix
Adding TT cr on upper DMs to fit matrix.
Before assembling fit matrix:	5020.7 MiB.
Building fit->FR
Building fit->FL
Adding tikhonov constraint of 1.0e-07 to FLM
The maximum eigen value is estimated to be around 2.7e-04
DM Fit number of Low rank terms: 16 in LHS
After assemble fit matrix:	6949.1 MiB.
After setup_recon:	6949.1 MiB.
GPU 0: mem used 1608 MB (wfs init)
GPU 0: mem used 2824 MB (recon init)
GPU 0: mem used 2854 MB (perf init)

*** Simulation started at 2025/02/11 19:08:20 in nid003517. ***

Running seed 1
GPU 0: mem used 2854 MB (wfs seeding)
Wind dir: 267.3 261.7 167.0 130.5 300.7  32.3 119.8 139.0 150.8 277.7 203.0 133.1  45.9 265.1 deg
Using /global/homes/b/bpeck/.aos/cache/atm/vonkarman_14_8192x8192_0.0078125_1115374592d.bin
After genatm:	6858.7 MiB.
Step     #  Open Loop  PR TT  On axis  PR TT  Field RMS PR TT     Timing 
Step     0: OL  884.6  248.3  OA  884.6 248.3 CL  884.6 248.3 nm  0.116 s
Step    14: OL  906.3  253.7  OA  149.2  76.9 CL  149.2  76.9 nm  0.068 s
Step    28: OL  928.4  258.2  OA  121.2  13.2 CL  121.2  13.2 nm  0.078 s
Step    41: OL  948.3  260.6  OA  121.3  22.9 CL  121.3  22.9 nm  0.078 s
Step    54: OL  967.5  261.1  OA  116.4   9.3 CL  116.4   9.3 nm  0.076 s
Step    67: OL  986.9  260.1  OA  120.7  28.4 CL  120.7  28.4 nm  0.079 s
Step    80: OL 1006.6  258.7  OA  120.2  12.5 CL  120.2  12.5 nm  0.077 s
Step    93: OL 1026.6  257.8  OA  123.9  29.6 CL  123.9  29.6 nm  0.078 s
Step   106: OL 1046.4  257.5  OA  119.5  17.3 CL  119.5  17.3 nm  0.079 s
Step   119: OL 1066.2  258.4  OA  111.7   2.8 CL  111.7   2.8 nm  0.077 s
Step   132: OL 1084.8  260.8  OA  116.6  27.4 CL  116.6  27.4 nm  0.080 s
Step   145: OL 1102.3  265.2  OA  119.9   7.6 CL  119.9   7.6 nm  0.076 s
Step   158: OL 1117.8  271.1  OA  119.3  15.5 CL  119.3  15.5 nm  0.079 s
Step   171: OL 1131.2  278.4  OA  125.5  22.2 CL  125.5  22.2 nm  0.082 s
Step   184: OL 1142.1  286.5  OA  118.6   7.7 CL  118.6   7.7 nm  0.077 s
Step   197: OL 1150.2  295.0  OA  121.0  31.6 CL  121.0  31.6 nm  0.087 s
Step   210: OL 1156.4  303.2  OA  121.9  37.6 CL  121.9  37.6 nm  0.080 s
Step   223: OL 1160.3  311.6  OA  113.3   3.2 CL  113.3   3.2 nm  0.085 s
Step   236: OL 1161.8  320.1  OA  116.4  26.9 CL  116.4  26.9 nm  0.078 s
Step   249: OL 1160.4  329.2  OA  115.4  31.3 CL  115.4  31.3 nm  0.083 s
Step   255 updated high order loop gain: 0.353
Step   262: OL 1155.1  338.5  OA  120.4  34.7 CL  120.4  34.7 nm  0.078 s
Step   275: OL 1146.0  347.9  OA  111.5  20.0 CL  111.5  20.0 nm  0.085 s
Step   288: OL 1134.0  357.8  OA  113.0  13.9 CL  113.0  13.9 nm  0.078 s
Step   301: OL 1120.5  369.0  OA  119.9  40.3 CL  119.9  40.3 nm  0.085 s
Step   314: OL 1105.5  380.9  OA  123.9  42.9 CL  123.9  42.9 nm  0.079 s
Step   327: OL 1088.8  393.8  OA  118.0  26.0 CL  118.0  26.0 nm  0.078 s
Step   340: OL 1071.6  408.5  OA  113.9  24.8 CL  113.9  24.8 nm  0.077 s
Step   353: OL 1054.6  424.9  OA  119.8  28.2 CL  119.8  28.2 nm  0.082 s
Step   366: OL 1038.3  442.8  OA  114.3  28.0 CL  114.3  28.0 nm  0.079 s
Step   379: OL 1022.9  461.4  OA  117.0  22.9 CL  117.0  22.9 nm  0.080 s
Step   392: OL 1008.4  480.3  OA  119.5  28.3 CL  119.5  28.3 nm  0.075 s
Step   405: OL  994.0  498.9  OA  109.9  12.5 CL  109.9  12.5 nm  0.079 s
Step   418: OL  978.9  516.8  OA  113.9  24.1 CL  113.9  24.1 nm  0.084 s
Step   431: OL  963.7  534.1  OA  115.3  31.3 CL  115.3  31.3 nm  0.078 s
Step   444: OL  949.4  551.2  OA  114.7  18.8 CL  114.7  18.8 nm  0.096 s
Step   457: OL  937.2  568.1  OA  118.6  15.9 CL  118.6  15.9 nm  0.080 s
Step   470: OL  928.4  585.1  OA  117.4  13.9 CL  117.4  13.9 nm  0.087 s
Step   483: OL  923.9  601.6  OA  118.3  16.3 CL  118.3  16.3 nm  0.079 s
Step   496: OL  923.5  617.3  OA  120.3   8.6 CL  120.3   8.6 nm  0.079 s
Step   509: OL  925.4  631.9  OA  120.4   6.8 CL  120.4   6.8 nm  0.078 s
Step   511 updated high order loop gain: 0.303
Step   522: OL  929.5  644.7  OA  116.0   3.5 CL  116.0   3.5 nm  0.078 s
Step   535: OL  935.3  654.8  OA  116.6  10.6 CL  116.6  10.6 nm  0.078 s
Step   548: OL  943.3  662.1  OA  118.3   7.5 CL  118.3   7.5 nm  0.078 s
Step   561: OL  953.6  667.0  OA  113.9  11.8 CL  113.9  11.8 nm  0.077 s
Step   574: OL  965.5  669.7  OA  112.2   6.8 CL  112.2   6.8 nm  0.079 s
Step   587: OL  979.1  670.6  OA  117.5  12.2 CL  117.5  12.2 nm  0.079 s
Step   600: OL  994.0  668.9  OA  111.2   5.6 CL  111.2   5.6 nm  0.079 s
Step   613: OL 1009.3  664.3  OA  115.2   5.2 CL  115.2   5.2 nm  0.079 s
Step   626: OL 1024.8  657.3  OA  110.7   4.5 CL  110.7   4.5 nm  0.080 s
Step   639: OL 1039.6  647.9  OA  110.2   5.9 CL  110.2   5.9 nm  0.079 s
Step   651: OL 1052.2  637.6  OA  114.1  21.9 CL  114.1  21.9 nm  0.077 s
Step   664: OL 1064.7  625.1  OA  113.3  17.5 CL  113.3  17.5 nm  0.084 s
Step   677: OL 1076.2  611.5  OA  113.8  20.8 CL  113.8  20.8 nm  0.087 s
Step   690: OL 1087.0  597.9  OA  113.5  23.7 CL  113.5  23.7 nm  0.085 s
Step   703: OL 1096.2  583.3  OA  111.8   8.2 CL  111.8   8.2 nm  0.077 s
Step   716: OL 1102.7  567.6  OA  117.0  16.0 CL  117.0  16.0 nm  0.079 s
Step   729: OL 1106.3  551.4  OA  114.7  13.1 CL  114.7  13.1 nm  0.080 s
Step   742: OL 1106.8  535.4  OA  111.3  14.1 CL  111.3  14.1 nm  0.077 s
Step   755: OL 1104.4  519.7  OA  113.6   6.9 CL  113.6   6.9 nm  0.077 s
Step   767 updated high order loop gain: 0.282
Step   768: OL 1099.0  504.5  OA  113.6  15.4 CL  113.6  15.4 nm  0.080 s
Step   781: OL 1090.8  489.8  OA  117.1   5.6 CL  117.1   5.6 nm  0.077 s
Step   794: OL 1079.1  475.3  OA  117.4  16.5 CL  117.4  16.5 nm  0.077 s
Step   807: OL 1065.1  460.8  OA  117.8   6.4 CL  117.8   6.4 nm  0.078 s
Step   820: OL 1048.8  446.3  OA  116.2  12.8 CL  116.2  12.8 nm  0.077 s
Step   833: OL 1029.9  432.1  OA  116.8   9.3 CL  116.8   9.3 nm  0.080 s
Step   846: OL 1009.8  418.6  OA  118.0  18.8 CL  118.0  18.8 nm  0.077 s
Step   858: OL  990.7  406.9  OA  116.4  13.0 CL  116.4  13.0 nm  0.084 s
Step   871: OL  970.3  395.5  OA  117.0  19.5 CL  117.0  19.5 nm  0.077 s
Step   884: OL  950.9  385.6  OA  116.8  19.0 CL  116.8  19.0 nm  0.087 s
Step   897: OL  931.3  376.9  OA  113.6   5.5 CL  113.6   5.5 nm  0.078 s
Step   910: OL  910.7  369.4  OA  109.0  11.5 CL  109.0  11.5 nm  0.084 s
Step   923: OL  889.7  363.0  OA  110.7   2.0 CL  110.7   2.0 nm  0.079 s
Step   936: OL  869.2  356.8  OA  110.3  10.2 CL  110.3  10.2 nm  0.083 s
Step   948: OL  851.0  351.1  OA  112.8  13.3 CL  112.8  13.3 nm  0.078 s
Step   961: OL  832.4  344.4  OA  112.7  12.5 CL  112.7  12.5 nm  0.079 s
Step   974: OL  816.3  337.0  OA  114.3  21.0 CL  114.3  21.0 nm  0.077 s
Step   987: OL  802.3  328.8  OA  110.6  12.2 CL  110.6  12.2 nm  0.079 s
Step  1000: OL  789.4  319.6  OA  110.9   7.8 CL  110.9   7.8 nm  0.085 s
Step  1013: OL  777.7  309.8  OA  115.6  16.1 CL  115.6  16.1 nm  0.077 s
Step  1023 updated high order loop gain: 0.273
Step  1025: OL  768.4  300.5  OA  116.3  12.9 CL  116.3  12.9 nm  0.076 s
Step  1038: OL  759.8  290.0  OA  112.2  15.1 CL  112.2  15.1 nm  0.075 s
Step  1051: OL  751.9  278.5  OA  111.1  13.9 CL  111.1  13.9 nm  0.085 s
Step  1064: OL  744.1  266.0  OA  111.5   9.8 CL  111.5   9.8 nm  0.078 s
Step  1077: OL  738.1  251.7  OA  115.4  15.0 CL  115.4  15.0 nm  0.078 s
Step  1090: OL  734.3  236.5  OA  116.5  19.7 CL  116.5  19.7 nm  0.078 s
Step  1103: OL  732.4  222.1  OA  114.3  14.8 CL  114.3  14.8 nm  0.078 s
Step  1116: OL  731.7  209.0  OA  114.5  24.5 CL  114.5  24.5 nm  0.076 s
Step  1129: OL  731.6  197.6  OA  110.3  30.7 CL  110.3  30.7 nm  0.078 s
Step  1142: OL  732.0  188.1  OA  106.0  19.3 CL  106.0  19.3 nm  0.080 s
Step  1155: OL  732.7  180.4  OA  106.6  20.3 CL  106.6  20.3 nm  0.078 s
Step  1168: OL  733.2  174.8  OA  106.2  12.1 CL  106.2  12.1 nm  0.078 s
Step  1181: OL  734.5  171.0  OA  107.1  16.1 CL  107.1  16.1 nm  0.077 s
Step  1194: OL  737.2  168.1  OA  105.3   3.6 CL  105.3   3.6 nm  0.081 s
Step  1207: OL  740.5  165.6  OA  108.0  15.8 CL  108.0  15.8 nm  0.078 s
Step  1220: OL  743.9  163.8  OA  107.1  18.3 CL  107.1  18.3 nm  0.079 s
Step  1233: OL  747.1  163.5  OA  107.1  18.6 CL  107.1  18.6 nm  0.077 s
Step  1246: OL  749.4  165.1  OA  108.5  26.1 CL  108.5  26.1 nm  0.086 s
Step  1259: OL  752.4  168.9  OA  107.9  14.1 CL  107.9  14.1 nm  0.077 s
Step  1272: OL  756.1  174.7  OA  108.3  19.1 CL  108.3  19.1 nm  0.086 s
Step  1279 updated high order loop gain: 0.263
Step  1285: OL  760.8  181.9  OA  109.1  21.7 CL  109.1  21.7 nm  0.078 s
Step  1298: OL  766.4  190.3  OA  111.9  27.7 CL  111.9  27.7 nm  0.078 s
Step  1311: OL  771.8  199.6  OA  112.0  11.1 CL  112.0  11.1 nm  0.076 s
Step  1323: OL  776.4  209.2  OA  111.8  28.4 CL  111.8  28.4 nm  0.087 s
Step  1336: OL  782.2  220.5  OA  111.7  27.3 CL  111.7  27.3 nm  0.078 s
Step  1349: OL  789.4  232.4  OA  111.0  20.6 CL  111.0  20.6 nm  0.080 s
Step  1362: OL  798.2  243.7  OA  114.8  29.2 CL  114.8  29.2 nm  0.077 s
Step  1375: OL  807.7  253.1  OA  108.6  30.0 CL  108.6  30.0 nm  0.079 s
Step  1388: OL  818.2  260.7  OA  105.9  14.5 CL  105.9  14.5 nm  0.078 s
Step  1399: OL  828.0  265.8  OA  111.2  17.8 CL  111.2  17.8 nm  0.078 s
Step  1412: OL  840.5  270.3  OA  117.1  32.0 CL  117.1  32.0 nm  0.078 s
Step  1425: OL  853.5  273.7  OA  108.9  21.1 CL  108.9  21.1 nm  0.078 s
Step  1438: OL  866.2  276.4  OA  108.1  20.8 CL  108.1  20.8 nm  0.077 s
Step  1451: OL  878.1  278.5  OA  107.5  13.3 CL  107.5  13.3 nm  0.075 s
Step  1464: OL  888.5  279.4  OA  107.9   3.2 CL  107.9   3.2 nm  0.084 s
Step  1477: OL  896.3  278.6  OA  106.4   6.7 CL  106.4   6.7 nm  0.079 s
Step  1490: OL  900.7  276.0  OA  107.4  12.0 CL  107.4  12.0 nm  0.084 s
Step  1503: OL  901.5  271.6  OA  110.7  13.5 CL  110.7  13.5 nm  0.077 s
Step  1516: OL  899.5  265.9  OA  106.4  12.4 CL  106.4  12.4 nm  0.080 s
Step  1529: OL  895.4  259.2  OA  103.2   3.9 CL  103.2   3.9 nm  0.078 s
Step  1535 updated high order loop gain: 0.261
Step  1542: OL  888.8  251.1  OA  106.3  12.7 CL  106.3  12.7 nm  0.088 s
Step  1555: OL  881.5  242.5  OA  105.1   8.6 CL  105.1   8.6 nm  0.076 s
Step  1568: OL  874.1  234.3  OA  103.5   5.0 CL  103.5   5.0 nm  0.085 s
Step  1581: OL  866.1  227.1  OA  108.4  10.4 CL  108.4  10.4 nm  0.077 s
Step  1594: OL  857.5  221.3  OA  109.1   6.9 CL  109.1   6.9 nm  0.087 s
Step 1599: Output PSF
Step  1599: OL  854.0  219.3  OA  108.1  10.7 CL  108.1  10.7 nm  1.411 s
Mean: 112.96 18.66 111.41  nm.

*** Simulation Finished at 2025/02/11 19:10:38 in nid003517. ***

