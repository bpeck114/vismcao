Warning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid003517/scheduler) failed: Invalid argument. 
/global/u2/b/bpeck/work/vismcao/maos -o studies/reduced_ngs/8_lgs/8mag_lgs/5500count -c master_files/reduced_ngs/8_lgs/8mag_lgs/kola_5500act.conf -O 
Output folder is 'studies/reduced_ngs/8_lgs/8mag_lgs/5500count'.
SRC: /global/homes/b/bpeck/code/maos v2.9 4c88b7c2 2024-11-13 16:45:33 -0800
BUILT: /global/homes/b/bpeck/code/maos/optim by GCC (v12) on 2024/11/18 09:40:03 CPU(F64,+O3) with CUDA(v122,F32)
Launched at 2025/02/11 19:23:23 in nid003517 with PID 1955562.
The web based job monitor can be accessed at http://localhost:10300
Main config file is /global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/8_lgs/8mag_lgs/kola_5500act.conf
Warning(path.c:48): Path not found: path=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/8_lgs/8mag_lgs/bin; abspath=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/8_lgs/8mag_lgs/bin; Ignored.
Warning(path.c:48): Path not found: path=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/8_lgs/8mag_lgs/atm; abspath=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/8_lgs/8mag_lgs/atm; Ignored.
Warning(readcfg.c:399): sim.apfsm has been renamed to powfs.apfsm.
Warning(readcfg.c:399): sim.epfsm has been renamed to powfs.epfsm.
Warning(readcfg.c:399): sim.alfsm has been renamed to powfs.alfsm.
Warning(readcfg.c:399): sim.commonfsm has been renamed to powfs.commonfsm.
Warning(readcfg.c:399): sim.idealfsm has been renamed to powfs.idealfsm.
Warning(readcfg.c:399): sim.zetafsm has been renamed to powfs.zetafsm.
Warning(readcfg.c:399): sim.f0fsm has been renamed to powfs.f0fsm.
Warning(readcfg.c:399): tsurf has been renamed to ncpa.tsurf.
loaded 132 (132 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_sim.conf'
loaded  19 ( 19 new) records from '/global/u2/b/bpeck/work/vismcao/./dm_none.conf'
loaded  19 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_ASM.conf'
loaded  19 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_DM2.conf'
loaded  19 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_DM3.conf'
loaded   0 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_dm_multiple.conf'
loaded   7 (  5 new) records from '/global/u2/b/bpeck/work/vismcao/./atm_mk13n50p_ground_detail.conf'
loaded  76 ( 69 new) records from '/global/homes/b/bpeck/code/maos/config/maos/powfs_common.conf'
loaded  44 ( 38 new) records from '/global/u2/b/bpeck/work/vismcao/./powfs_none.conf'
loaded  44 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_shwfs_lgs.conf'
loaded  44 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_shwfs_ttf_strap.conf'
loaded  44 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_shwfs_twfs_lbwfs.conf'
loaded   0 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_wfs_lgs_strap_lbwfs.conf'
loaded  71 ( 71 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_recon.conf'
Warning(readcfg.c:399): dbg.na_smooth has been renamed to powfs0_llt.na_smooth.
Warning(readcfg.c:399): dbg.na_interp has been renamed to powfs0_llt.na_interp.
Warning(readcfg.c:399): dbg.na_thres has been renamed to powfs0_llt.na_thres.
Warning(readcfg.c:399): dbg.na_fit_maxit has been renamed to powfs0_llt.na_fit_maxit.
Warning(readcfg.c:399): dbg.na_fit_svdthres has been renamed to powfs0_llt.na_fit_svdthres.
Warning(readcfg.c:399): dbg.na_fit_dh has been renamed to powfs0_llt.na_fit_dh.
Warning(readcfg.c:399): dbg.ncpa_preload has been renamed to ncpa.preload.
Warning(readcfg.c:399): dbg.ncpa_rmsci has been renamed to ncpa.rmsci.
Warning(readcfg.c:399): dbg.draw_opdmax has been renamed to plot.opdmax.
Warning(readcfg.c:399): dbg.draw_gmax has been renamed to plot.gmax.
loaded  95 ( 93 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_dbg.conf'
loaded   4 (  4 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_fit_mcao.conf'
Warning(readcfg.c:399): surf has been renamed to ncpa.surf.
loaded  39 (  7 new) records from '/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/8_lgs/8mag_lgs/kola_5500act.conf'
loaded   0 (  0 new) records from 'command line'
loaded  24 ( 18 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_llt_CL.conf'
Adjust LGS range by telescope altitude 4145m.
Zenith angle is 30 degree.
    Scaling turbulence height and LGS hs by sec(za).
    Scaling r0 by cos(za)^(3/5).
    Scaling wind speed and LGS signal level by cos(za).
powfs0: Adjusting dx from 0.0078125 to 0.0081875. 
powfs0.llt.fsm: f0=0 Hz, LPF ep=0
powfs0.epfsm is set to 0.517618 (auto)
powfs2: Adjusting dx from 0.03125 to 0.0312778. 
powfs2 is TWFS for powfs0
sim.ephi is set to 0.427717 (auto)
sim.eplo is set to 0.427717 (auto)
Warning(parms.c:2296): Layer 1 at 17.3205m is very close to layer 0 at 0m (OK).
Warning(parms.c:2296): Layer 2 at 34.641m is very close to layer 1 at 17.3205m (OK).
Warning(parms.c:2296): Layer 3 at 51.9615m is very close to layer 2 at 34.641m (OK).
dm 0: stroke=30 um is provided in micron.
dm 0: assume ia stroke=2 um is provided in micron.
dm 1: stroke=7 um is provided in micron.
dm 1: assume ia stroke=2 um is provided in micron.
dm 2: stroke=7 um is provided in micron.
dm 2: assume ia stroke=2 um is provided in micron.
Focus blending is not implemented yet for integrated tomography
parms->sim.mffocus is reset to 0
There are 1 valid simulation seeds:  1
Output PSF for 1 directions
Used 449 of 456 supplied keys
Warning(readcfg.c:158): key "dbg.pwfs_flate" is not recognized, value is 0
Warning(readcfg.c:158): key "dbg.pwfs_flatv" is not recognized, value is 0
Warning(readcfg.c:158): key "dbg.pwfs_psx" is not recognized, value is [0 0 0 0]
Warning(readcfg.c:158): key "dbg.pwfs_psy" is not recognized, value is [0 0 0 0]
Warning(readcfg.c:158): key "dbg.pwfs_pupelong" is not recognized, value is 0
Warning(readcfg.c:158): key "dbg.pwfs_raw" is not recognized, value is 0
Warning(readcfg.c:158): key "dbg.pwfs_side" is not recognized, value is 4
[00;00mAperture[00;00m is 11 m with sampling 1/128 m
[00;00mTurbulence at 30 degree zenith angle:[00;00m r0=0.128424m, L0=30m, 14 layers.
    Greenwood freq is 25.1Hz, anisoplanatic angle is 1.58 as
    Sampled 8192x8192 at 1/128m. wind dir is randomized.
    layer 0: ht=      0 m, wt= 0.302, ws=  4.8 m/s
    layer 1: ht=     17 m, wt= 0.154, ws=  5.0 m/s
    layer 2: ht=     35 m, wt= 0.041, ws=  5.4 m/s
    layer 3: ht=     52 m, wt= 0.002, ws=  6.6 m/s
    layer 4: ht=    139 m, wt= 0.021, ws=  6.1 m/s
    layer 5: ht=    231 m, wt= 0.010, ws=  6.1 m/s
    layer 6: ht=    323 m, wt= 0.008, ws=  6.1 m/s
    layer 7: ht=    416 m, wt= 0.005, ws=  6.1 m/s
    layer 8: ht=    508 m, wt= 0.001, ws=  6.1 m/s
    layer 9: ht=    932 m, wt= 0.107, ws=  5.6 m/s
    layer 10: ht=   5022 m, wt= 0.144, ws= 11.1 m/s
    layer 11: ht=   9238 m, wt= 0.093, ws= 19.1 m/s
    layer 12: ht=  13856 m, wt= 0.075, ws=  8.2 m/s
    layer 13: ht=  22518 m, wt= 0.036, ws=  4.8 m/s
[00;00mReconstruction[00;00m: r0=0.128424m L0=30m. 14 layers. use cone coordinate.
    layer 0: ht=      0 m, wt= 0.302
    layer 1: ht=     17 m, wt= 0.154
    layer 2: ht=     35 m, wt= 0.041
    layer 3: ht=     52 m, wt= 0.002
    layer 4: ht=    139 m, wt= 0.021
    layer 5: ht=    231 m, wt= 0.010
    layer 6: ht=    323 m, wt= 0.008
    layer 7: ht=    416 m, wt= 0.005
    layer 8: ht=    508 m, wt= 0.001
    layer 9: ht=    932 m, wt= 0.107
    layer 10: ht=   5022 m, wt= 0.144
    layer 11: ht=   9238 m, wt= 0.093
    layer 12: ht=  13856 m, wt= 0.075
    layer 13: ht=  22518 m, wt= 0.036
[00;00mThere are 3 powfs[00;00m
  powfs0: Order 84, LGS at 99.1 km. Sampling 1/122.137 m. Thres 30%. [00;00mT/T is removed in right hand side in tomography.[00;00m
    CCD image is 25x25 @ 500x500 mas, blur 27% (sigma), 1500Hz, wvl: [ 5.89e-07]
    Gtilt in reconstruction. Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
  powfs1: Order  2, NGS at inf km. Sampling 1/16 m. Thres 30%. 
    Ztilt in reconstruction. Geomtric optics start at 2 with ztilt [00;00m(noisy)[00;00m
  powfs2: Order 20, NGS at inf km. Sampling 1/31.9716 m. Thres 50%. 
    CCD image is 4x4 @ 1500x1500 mas, blur 0% (sigma), 0.015Hz, wvl: [ 7.2e-07]
    Gtilt in reconstruction. Geomtric optics start at 50 with gtilt Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
[00;00mThere are 12 wfs[00;00m
    wfs 0: type 0, at (  30.00,    0.00) arcsec,  99 km, siglev is 20.5768 bkgrnd is 0.1
    wfs 1: type 0, at (  21.21,   21.21) arcsec,  99 km, siglev is 20.5768 bkgrnd is 0.1
    wfs 2: type 0, at (   0.00,   30.00) arcsec,  99 km, siglev is 20.5768 bkgrnd is 0.1
    wfs 3: type 0, at ( -21.21,   21.21) arcsec,  99 km, siglev is 20.5768 bkgrnd is 0.1
    wfs 4: type 0, at ( -30.00,    0.00) arcsec,  99 km, siglev is 20.5768 bkgrnd is 0.1
    wfs 5: type 0, at ( -21.21,  -21.21) arcsec,  99 km, siglev is 20.5768 bkgrnd is 0.1
    wfs 6: type 0, at (   0.00,  -30.00) arcsec,  99 km, siglev is 20.5768 bkgrnd is 0.1
    wfs 7: type 0, at (  21.21,  -21.21) arcsec,  99 km, siglev is 20.5768 bkgrnd is 0.1
    wfs 8: type 1, at (   5.00,    8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 9: type 1, at ( -10.00,    0.00) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 10: type 1, at (   5.00,   -8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 11: type 2, at (   0.00,    0.00) arcsec, inf km, siglev is 4.1558e+06 bkgrnd is 0.001
[00;00mThere are 3 DMs[00;00m
  DM 0 at -0.1km, actuator pitch 0.131m, offset   0, with 30.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 1 at    6km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 2 at   10km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
[00;00mTomography[00;00m is using CG, with [00;00mFourer Domain[00;00m preconditioner, [00;00m12[00;00m iterations, integrated tomo.
[00;00mDM Fitting [00;00mis using CG, with [00;00mNo[00;00m preconditioner, [00;00m10[00;00m iterations
[00;00mThere are 9 fit directions[00;00m
    Fit 0: weight is 0.444, at (   0.00,    0.00) arcsec
    Fit 1: weight is 0.111, at (  15.00,    0.00) arcsec
    Fit 2: weight is 0.111, at (   0.00,   15.00) arcsec
    Fit 3: weight is 0.111, at ( -15.00,    0.00) arcsec
    Fit 4: weight is 0.111, at (   0.00,  -15.00) arcsec
    Fit 5: weight is 0.028, at (  15.00,   15.00) arcsec
    Fit 6: weight is 0.028, at ( -15.00,   15.00) arcsec
    Fit 7: weight is 0.028, at ( -15.00,  -15.00) arcsec
    Fit 8: weight is 0.028, at (  15.00,  -15.00) arcsec
[00;00mThere are 1 evaluation directions[00;00m at sampling 1/128 m.
    Evl 0: weight is 1.000, at (   0.00,    0.00) arcsec
[00;00mSimulation[00;00m start at step 0, end at step 1600, with time step 1/1500s, [00;00mclose loop[00;00m.
After setup_parms:	120.5 MiB.
Warning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid003517/scheduler) failed: Invalid argument. 
CUDA: minimum memory requirement is 0.3GB
GPU 0 is NVIDIA A100-SXM4-40GB with arch 8.0, 38.9GB free, 39.3GB total device memory.
Using GPU 0
Use 1 GPUs for WFS Tomo Fit Evl

*** Preparation started at 2025/02/11 19:23:24 in nid003517. ***

Using OpenMP version 201511 with 128 threads
Reading aperture amplitude map from KECK.fits
Warning(accphi.c:477): 108788 points not covered by input screen
Warning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid003517/scheduler) failed: Invalid argument. 
 ->maos.c:447->setup.c:148->aper.c:74->utils.c:478->accphi.c:478
iwvl 0: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 1: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 2: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 3: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 4: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 5: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 6: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 7: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 8: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
After setup_aper:	344.5 MiB.

[00;00mSetting up powfs 0 geom[00;00m

There are 16 points in each subaperture of 0.131m.
There are 4336 valid subaperture.

[00;00mSetting up powfs 1 geom[00;00m

There are 88 points in each subaperture of 5.5m.
There are 4 valid subaperture.

[00;00mSetting up powfs 2 geom[00;00m

There are 18 points in each subaperture of 0.563m.
There are 236 valid subaperture.
After setup_powfs_init:	417.9 MiB.

[00;00mSetting up reconstructor geometry.[00;00m

PLOC is 171x171, with sampling of 0.07m (square)
    DM 0: grid is 89 x 89
    DM 1: grid is 75 x 75
    DM 2: grid is 81 x 81
FLOC is 171x171, with sampling of 0.07m (not square)
Tomography grid is square:
    layer 0: xloc grid is 300 x 300, sampling is 0.066 m, 90000 points
    layer 1: xloc grid is 300 x 300, sampling is 0.065 m, 90000 points
    layer 2: xloc grid is 300 x 300, sampling is 0.065 m, 90000 points
    layer 3: xloc grid is 300 x 300, sampling is 0.065 m, 90000 points
    layer 4: xloc grid is 300 x 300, sampling is 0.065 m, 90000 points
    layer 5: xloc grid is 300 x 300, sampling is 0.065 m, 90000 points
    layer 6: xloc grid is 300 x 300, sampling is 0.065 m, 90000 points
    layer 7: xloc grid is 300 x 300, sampling is 0.065 m, 90000 points
    layer 8: xloc grid is 300 x 300, sampling is 0.065 m, 90000 points
    layer 9: xloc grid is 300 x 300, sampling is 0.065 m, 90000 points
    layer 10: xloc grid is 300 x 300, sampling is 0.062 m, 90000 points
    layer 11: xloc grid is 300 x 300, sampling is 0.059 m, 90000 points
    layer 12: xloc grid is 300 x 300, sampling is 0.056 m, 90000 points
Warning(map.c:195): ninx=300 is too small. need 301
Warning(map.c:200): niny=300 is too small. need 301
    layer 13: xloc grid is 300 x 300, sampling is 0.051 m, 90000 points

[00;00mSetting up powfs 0 PO WFS[00;00m

OTF dimension is 32x32 (calculated)
Uplink FWHM (illt 0, iwvl 0) is 0.579608"
Downlink FWHM (illt 0, iwvl 0) is 1.47508"
Generating matched filter for powfs 0
sa index   location       noise equivalent angle
    2166: (  4.8,  -0.1) m, (192.12, 183.27) mas
    2158: (  3.8,  -0.1) m, (205.66, 185.11) mas
    2149: (  2.6,  -0.1) m, (227.13, 187.99) mas
    2141: (  1.6,  -0.1) m, (247.80, 190.67) mas
    2139: (  1.3,  -0.1) m, (256.11, 191.70) mas
    1557: ( -0.5,  -1.3) m, (299.06, 201.89) mas
    2134: ( -1.7,  -0.1) m, (328.95, 200.58) mas
    2125: ( -2.9,  -0.1) m, (358.20, 204.10) mas
    2117: ( -3.9,  -0.1) m, (384.12, 207.21) mas
    2108: ( -5.1,  -0.1) m, (413.61, 210.64) mas
    2106: ( -5.4,  -0.1) m, (419.01, 211.33) mas
sa index   location       noise equivalent angle
    3533: (  2.6,   2.6) m, (196.35, 196.35) mas
    3154: (  1.8,   1.8) m, (208.35, 208.48) mas
    2790: (  1.2,   1.2) m, (218.38, 218.38) mas
    2652: (  0.9,   0.9) m, (223.79, 223.79) mas
    1565: (  0.5,  -1.3) m, (231.90, 267.50) mas
    1624: ( -1.2,  -1.2) m, (264.55, 264.55) mas
    1187: ( -2.0,  -2.0) m, (282.02, 282.03) mas
     808: ( -2.8,  -2.8) m, (299.45, 299.45) mas
     506: ( -3.4,  -3.4) m, (314.86, 314.86) mas
     213: ( -3.0,  -4.2) m, (306.10, 333.90) mas
sa index   location       noise equivalent angle
    4009: (  0.0,   3.8) m, (193.18, 212.05) mas
    3513: (  0.0,   2.6) m, (196.28, 234.37) mas
    2997: (  0.0,   1.6) m, (199.17, 255.89) mas
    2853: (  0.0,   1.3) m, (200.28, 264.53) mas
    1940: (  1.2,  -0.5) m, (201.26, 298.38) mas
    1345: (  0.0,  -1.7) m, (209.90, 340.39) mas
     769: (  0.0,  -2.9) m, (213.71, 370.81) mas
     332: (  0.0,  -3.9) m, (217.08, 397.73) mas
     140: (  0.0,  -4.5) m, (218.50, 408.28) mas
      30: (  2.5,  -4.8) m, (242.38, 436.65) mas
sa index   location       noise equivalent angle
    3492: ( -2.8,   2.6) m, (196.35, 196.35) mas
    3125: ( -2.0,   1.8) m, (209.17, 209.14) mas
    2771: ( -1.3,   1.2) m, (218.38, 218.38) mas
    2648: ( -1.0,   0.9) m, (223.79, 223.79) mas
    1556: ( -0.7,  -1.3) m, (231.90, 267.50) mas
    1633: (  1.0,  -1.2) m, (264.55, 264.55) mas
    1216: (  1.8,  -2.0) m, (281.64, 281.64) mas
     849: (  2.6,  -2.8) m, (299.45, 299.45) mas
     557: (  3.3,  -3.4) m, (314.86, 314.86) mas
     258: (  2.9,  -4.2) m, (306.10, 333.90) mas
sa index   location       noise equivalent angle
    2109: ( -5.0,  -0.1) m, (192.12, 183.27) mas
    2117: ( -3.9,  -0.1) m, (205.66, 185.11) mas
    2126: ( -2.8,  -0.1) m, (227.13, 187.99) mas
    2134: ( -1.7,  -0.1) m, (247.80, 190.67) mas
    2136: ( -1.4,  -0.1) m, (256.11, 191.70) mas
    1564: (  0.4,  -1.3) m, (298.40, 201.28) mas
    2141: (  1.6,  -0.1) m, (328.95, 200.58) mas
    2150: (  2.8,  -0.1) m, (358.20, 204.10) mas
    2158: (  3.8,  -0.1) m, (384.12, 207.21) mas
    2167: (  5.0,  -0.1) m, (413.61, 210.64) mas
    2169: (  5.2,  -0.1) m, (419.01, 211.33) mas
sa index   location       noise equivalent angle
     506: ( -3.4,  -3.4) m, (188.95, 188.95) mas
     869: ( -2.6,  -2.6) m, (198.55, 198.55) mas
    1259: ( -1.8,  -1.8) m, (210.36, 210.36) mas
    1624: ( -1.2,  -1.2) m, (221.29, 221.29) mas
    1876: (  1.2,  -0.7) m, (267.50, 231.90) mas
    2652: (  0.9,   0.9) m, (262.14, 262.14) mas
    2790: (  1.2,   1.2) m, (266.96, 266.96) mas
    3223: (  2.0,   2.0) m, (304.29, 305.74) mas
    3594: (  2.8,   2.8) m, (302.09, 302.09) mas
    4127: (  2.9,   4.1) m, (306.10, 333.90) mas
sa index   location       noise equivalent angle
     332: (  0.0,  -3.9) m, (193.18, 212.05) mas
     829: (  0.0,  -2.8) m, (196.28, 234.37) mas
    1345: (  0.0,  -1.7) m, (199.17, 255.89) mas
    1489: (  0.0,  -1.4) m, (200.28, 264.53) mas
    2402: (  1.2,   0.4) m, (201.26, 298.38) mas
    2997: (  0.0,   1.6) m, (209.90, 340.39) mas
    3573: (  0.0,   2.8) m, (213.71, 370.81) mas
    4009: (  0.0,   3.8) m, (217.08, 397.73) mas
    4201: (  0.0,   4.3) m, (218.50, 408.28) mas
sa index   location       noise equivalent angle
     557: (  3.3,  -3.4) m, (188.95, 188.95) mas
     908: (  2.5,  -2.6) m, (198.55, 198.55) mas
    1286: (  1.7,  -1.8) m, (210.36, 210.36) mas
    1633: (  1.0,  -1.2) m, (221.29, 221.29) mas
    1873: ( -1.3,  -0.7) m, (267.50, 231.90) mas
    2648: ( -1.0,   0.9) m, (262.14, 262.14) mas
    2771: ( -1.3,   1.2) m, (266.96, 266.96) mas
    3192: ( -2.1,   2.0) m, (306.19, 307.37) mas
    3551: ( -2.9,   2.8) m, (302.09, 302.09) mas
    4082: ( -3.0,   4.1) m, (306.10, 333.90) mas

[00;00mSetting up powfs 2 PO WFS[00;00m

OTF dimension is 48x48 (calculated)
Generating matched filter for powfs 2
Use sanea to derive neasim
Use sanea to derive neasim

[00;00mSetting up reconstructor[00;00m

Recon NEA: cmf(259.93) cmf(258.52) cmf(259.75) cmf(258.03) cmf(259.17) cmf(257.89) cmf(259.52) cmf(258.36) geom(0.31) geom(0.31) geom(0.31) mf(0.14)  mas
Setup or update control matrix parameters.
RRtwfs svd threshold is 1e-10
Replacing HA by HA*fit->actextrap
Adding piston cr to fit matrix
Adding TT cr on upper DMs to fit matrix.
Before assembling fit matrix:	5632.9 MiB.
Building fit->FR
Building fit->FL
Adding tikhonov constraint of 1.0e-07 to FLM
The maximum eigen value is estimated to be around 2.5e-04
DM Fit number of Low rank terms: 16 in LHS
After assemble fit matrix:	8123.3 MiB.
After setup_recon:	8123.3 MiB.
GPU 0: mem used 1608 MB (wfs init)
GPU 0: mem used 3038 MB (recon init)
GPU 0: mem used 3068 MB (perf init)

*** Simulation started at 2025/02/11 19:25:13 in nid003517. ***

Running seed 1
GPU 0: mem used 3070 MB (wfs seeding)
Wind dir: 267.3 261.7 167.0 130.5 300.7  32.3 119.8 139.0 150.8 277.7 203.0 133.1  45.9 265.1 deg
Using /global/homes/b/bpeck/.aos/cache/atm/vonkarman_14_8192x8192_0.0078125_1115374592d.bin
After genatm:	7824.7 MiB.
Step     #  Open Loop  PR TT  On axis  PR TT  Field RMS PR TT     Timing 
Step     0: OL  884.6  248.3  OA  884.6 248.3 CL  884.6 248.3 nm  0.146 s
Step    12: OL  903.1  253.0  OA  142.6  13.9 CL  142.6  13.9 nm  0.080 s
Step    24: OL  922.1  257.1  OA  127.1  16.1 CL  127.1  16.1 nm  0.089 s
Step    35: OL  939.2  259.7  OA  125.0  16.2 CL  125.0  16.2 nm  0.091 s
Step    46: OL  955.7  261.0  OA  127.9  30.9 CL  127.9  30.9 nm  0.093 s
Step    57: OL  971.9  261.0  OA  123.7  15.3 CL  123.7  15.3 nm  0.098 s
Step    68: OL  988.4  260.0  OA  134.4  29.5 CL  134.4  29.5 nm  0.091 s
Step    79: OL 1005.0  258.8  OA  139.5  39.6 CL  139.5  39.6 nm  0.103 s
Step    90: OL 1021.9  258.0  OA  135.8  28.2 CL  135.8  28.2 nm  0.087 s
Step   101: OL 1038.8  257.4  OA  129.9  38.9 CL  129.9  38.9 nm  0.098 s
Step   112: OL 1055.6  257.7  OA  130.8  18.5 CL  130.8  18.5 nm  0.090 s
Step   123: OL 1072.1  258.9  OA  121.4  17.8 CL  121.4  17.8 nm  0.090 s
Step   134: OL 1087.6  261.4  OA  124.3  15.0 CL  124.3  15.0 nm  0.092 s
Step   145: OL 1102.4  265.3  OA  127.0  28.1 CL  127.0  28.1 nm  0.091 s
Step   156: OL 1115.6  270.1  OA  128.3  23.2 CL  128.3  23.2 nm  0.089 s
Step   167: OL 1127.4  276.1  OA  127.3  32.5 CL  127.3  32.5 nm  0.095 s
Step   178: OL 1137.6  282.7  OA  130.3  21.2 CL  130.3  21.2 nm  0.087 s
Step   189: OL 1145.7  289.8  OA  125.0  40.8 CL  125.0  40.8 nm  0.093 s
Step   200: OL 1152.0  296.9  OA  115.9  26.1 CL  115.9  26.1 nm  0.094 s
Step   211: OL 1157.1  303.9  OA  129.1  44.1 CL  129.1  44.1 nm  0.091 s
Step   222: OL 1160.5  311.0  OA  126.0  31.4 CL  126.0  31.4 nm  0.104 s
Step   233: OL 1162.1  318.2  OA  121.8  33.6 CL  121.8  33.6 nm  0.089 s
Step   244: OL 1161.8  325.7  OA  126.7  46.6 CL  126.7  46.6 nm  0.090 s
Step   255: OL 1159.0  333.5  OA  117.5  23.2 CL  117.5  23.2 nm  0.091 s
Step   255 updated high order loop gain: 0.343
Step   266: OL 1153.3  341.4  OA  124.2  42.2 CL  124.2  42.2 nm  0.089 s
Step   277: OL 1145.1  349.4  OA  124.3  37.2 CL  124.3  37.2 nm  0.090 s
Step   288: OL 1135.0  357.9  OA  120.1  37.9 CL  120.1  37.9 nm  0.094 s
Step   299: OL 1123.7  367.2  OA  135.1  58.1 CL  135.1  58.1 nm  0.101 s
Step   310: OL 1111.3  377.2  OA  127.7  46.7 CL  127.7  46.7 nm  0.094 s
Step   321: OL 1097.5  387.7  OA  130.1  47.3 CL  130.1  47.3 nm  0.090 s
Step   332: OL 1083.0  399.3  OA  126.1  49.3 CL  126.1  49.3 nm  0.088 s
Step   342: OL 1069.8  410.9  OA  118.4  28.4 CL  118.4  28.4 nm  0.095 s
Step   354: OL 1053.7  426.2  OA  116.2   6.0 CL  116.2   6.0 nm  0.094 s
Step   365: OL 1039.8  441.4  OA  127.6  41.6 CL  127.6  41.6 nm  0.096 s
Step   376: OL 1026.7  457.1  OA  123.1  19.0 CL  123.1  19.0 nm  0.097 s
Step   387: OL 1014.2  473.1  OA  121.4  14.7 CL  121.4  14.7 nm  0.102 s
Step   398: OL 1001.8  488.9  OA  121.1  18.2 CL  121.1  18.2 nm  0.089 s
Step   409: OL  989.4  504.5  OA  125.0  20.8 CL  125.0  20.8 nm  0.104 s
Step   420: OL  976.6  519.5  OA  123.3  12.7 CL  123.3  12.7 nm  0.090 s
Step   431: OL  963.8  534.1  OA  126.6  23.8 CL  126.6  23.8 nm  0.098 s
Step   442: OL  951.7  548.6  OA  124.0  19.2 CL  124.0  19.2 nm  0.111 s
Step   450: OL  943.5  558.9  OA  122.8  11.8 CL  122.8  11.8 nm  0.766 s
Step   456: OL  938.1  566.8  OA  126.7  20.3 CL  126.7  20.3 nm  0.095 s
Step   467: OL  930.2  581.2  OA  118.7  12.7 CL  118.7  12.7 nm  0.103 s
Step   478: OL  925.0  595.3  OA  124.1  23.9 CL  124.1  23.9 nm  0.092 s
Step   489: OL  923.2  608.9  OA  120.4   9.1 CL  120.4   9.1 nm  0.094 s
Step   500: OL  923.7  622.0  OA  117.5  11.8 CL  117.5  11.8 nm  0.090 s
Step   511: OL  925.6  634.0  OA  122.6  15.6 CL  122.6  15.6 nm  0.091 s
Step   511 updated high order loop gain: 0.286
Step   522: OL  929.2  644.7  OA  121.2  17.7 CL  121.2  17.7 nm  0.090 s
Step   533: OL  933.9  653.4  OA  116.6  11.3 CL  116.6  11.3 nm  0.088 s
Step   544: OL  940.2  660.1  OA  114.4  12.2 CL  114.4  12.2 nm  0.094 s
Step   555: OL  948.3  665.0  OA  118.6   4.2 CL  118.6   4.2 nm  0.090 s
Step   566: OL  957.7  668.2  OA  113.5   6.6 CL  113.5   6.6 nm  0.096 s
Step   577: OL  968.2  670.0  OA  117.2  10.9 CL  117.2  10.9 nm  0.092 s
Step   588: OL  980.0  670.5  OA  114.1   6.6 CL  114.1   6.6 nm  0.093 s
Step   599: OL  992.7  669.1  OA  116.9  10.4 CL  116.9  10.4 nm  0.089 s
Step   610: OL 1005.7  665.5  OA  115.4   8.7 CL  115.4   8.7 nm  0.094 s
Step   621: OL 1018.9  660.2  OA  117.3  23.3 CL  117.3  23.3 nm  0.095 s
Step   632: OL 1031.8  653.2  OA  119.0  12.8 CL  119.0  12.8 nm  0.087 s
Step   643: OL 1044.1  644.6  OA  114.3   5.1 CL  114.3   5.1 nm  0.104 s
Step   654: OL 1055.3  634.8  OA  121.7  34.4 CL  121.7  34.4 nm  0.097 s
Step   665: OL 1065.9  624.0  OA  114.8   8.9 CL  114.8   8.9 nm  0.101 s
Step   676: OL 1075.6  612.5  OA  118.9  13.9 CL  118.9  13.9 nm  0.086 s
Step   687: OL 1085.0  601.1  OA  124.1  35.6 CL  124.1  35.6 nm  0.092 s
Step   698: OL 1093.3  589.1  OA  124.6  36.5 CL  124.6  36.5 nm  0.092 s
Step   709: OL 1100.0  576.1  OA  118.0  20.7 CL  118.0  20.7 nm  0.092 s
Step   720: OL 1104.6  562.6  OA  119.7  13.2 CL  119.7  13.2 nm  0.097 s
Step   731: OL 1107.1  549.0  OA  118.5  13.3 CL  118.5  13.3 nm  0.089 s
Step   742: OL 1107.3  535.4  OA  115.2  16.3 CL  115.2  16.3 nm  0.102 s
Step   753: OL 1105.3  522.0  OA  113.9  13.4 CL  113.9  13.4 nm  0.093 s
Step   764: OL 1101.2  509.1  OA  119.8   8.9 CL  119.8   8.9 nm  0.101 s
Step   767 updated high order loop gain: 0.263
Step   775: OL 1095.1  496.6  OA  114.6  17.0 CL  114.6  17.0 nm  0.088 s
Step   786: OL 1086.7  484.2  OA  122.3  23.6 CL  122.3  23.6 nm  0.090 s
Step   797: OL 1076.0  472.0  OA  119.0  17.1 CL  119.0  17.1 nm  0.092 s
Step   808: OL 1063.8  459.7  OA  116.1   7.6 CL  116.1   7.6 nm  0.090 s
Step   819: OL 1049.9  447.4  OA  119.3  15.8 CL  119.3  15.8 nm  0.091 s
Step   831: OL 1032.7  434.3  OA  114.6   6.8 CL  114.6   6.8 nm  0.097 s
Step   842: OL 1015.8  422.7  OA  118.2  19.1 CL  118.2  19.1 nm  0.089 s
Step   853: OL  998.2  411.7  OA  121.4  11.7 CL  121.4  11.7 nm  0.094 s
Step   864: OL  980.8  401.5  OA  114.2   8.0 CL  114.2   8.0 nm  0.091 s
Step   875: OL  963.9  392.3  OA  115.4   4.6 CL  115.4   4.6 nm  0.096 s
Step   886: OL  947.7  384.2  OA  113.0   3.6 CL  113.0   3.6 nm  0.099 s
Step   897: OL  931.0  376.9  OA  117.9  16.3 CL  117.9  16.3 nm  0.093 s
Step   908: OL  913.6  370.4  OA  114.1  13.7 CL  114.1  13.7 nm  0.097 s
Step   919: OL  896.0  364.9  OA  115.3  16.3 CL  115.3  16.3 nm  0.090 s
Step   930: OL  878.5  359.7  OA  115.8  20.5 CL  115.8  20.5 nm  0.095 s
Step   941: OL  861.4  354.5  OA  121.9   1.2 CL  121.9   1.2 nm  0.091 s
Step   952: OL  845.0  349.1  OA  113.0   4.0 CL  113.0   4.0 nm  0.093 s
Step   963: OL  829.7  343.4  OA  116.7  15.4 CL  116.7  15.4 nm  0.089 s
Step   974: OL  816.3  337.0  OA  117.8   4.0 CL  117.8   4.0 nm  0.090 s
Step   985: OL  804.3  330.1  OA  116.2  15.3 CL  116.2  15.3 nm  0.099 s
Step   996: OL  793.3  322.5  OA  117.7  20.2 CL  117.7  20.2 nm  0.089 s
Step  1007: OL  783.0  314.3  OA  122.9  23.7 CL  122.9  23.7 nm  0.089 s
Step  1018: OL  773.8  306.0  OA  114.0  13.5 CL  114.0  13.5 nm  0.092 s
Step  1023 updated high order loop gain: 0.249
Step  1029: OL  765.8  297.4  OA  121.6  19.1 CL  121.6  19.1 nm  0.096 s
Step  1040: OL  758.8  288.3  OA  121.4  25.6 CL  121.4  25.6 nm  0.089 s
Step  1051: OL  752.1  278.6  OA  119.2  22.4 CL  119.2  22.4 nm  0.099 s
Step  1062: OL  745.5  268.0  OA  123.4  31.2 CL  123.4  31.2 nm  0.086 s
Step  1073: OL  740.0  256.2  OA  121.4  26.2 CL  121.4  26.2 nm  0.093 s
Step  1084: OL  736.0  243.5  OA  120.8  24.0 CL  120.8  24.0 nm  0.088 s
Step  1095: OL  733.5  230.8  OA  118.9  31.0 CL  118.9  31.0 nm  0.090 s
Step  1106: OL  732.0  219.0  OA  118.1  21.0 CL  118.1  21.0 nm  0.088 s
Step  1117: OL  731.3  208.0  OA  112.7  23.6 CL  112.7  23.6 nm  0.093 s
Step  1128: OL  731.3  198.4  OA  111.7  11.2 CL  111.7  11.2 nm  0.090 s
Step  1139: OL  731.5  190.2  OA  115.5  23.4 CL  115.5  23.4 nm  0.093 s
Step  1150: OL  732.0  183.2  OA  112.0  23.3 CL  112.0  23.3 nm  0.092 s
Step  1161: OL  732.5  177.5  OA  113.3  28.3 CL  113.3  28.3 nm  0.095 s
Step  1172: OL  733.0  173.4  OA  109.7  10.3 CL  109.7  10.3 nm  0.086 s
Step  1183: OL  734.6  170.5  OA  113.3  10.4 CL  113.3  10.4 nm  0.097 s
Step  1194: OL  737.0  168.1  OA  109.8  15.3 CL  109.8  15.3 nm  0.091 s
Step  1205: OL  739.8  166.0  OA  112.0  17.2 CL  112.0  17.2 nm  0.092 s
Step  1216: OL  742.6  164.2  OA  111.7  10.1 CL  111.7  10.1 nm  0.096 s
Step  1228: OL  745.8  163.4  OA  111.0  18.4 CL  111.0  18.4 nm  0.098 s
Step  1239: OL  748.1  164.0  OA  111.7  26.6 CL  111.7  26.6 nm  0.092 s
Step  1250: OL  750.2  166.0  OA  110.0  24.9 CL  110.0  24.9 nm  0.095 s
Step  1261: OL  753.0  169.7  OA  112.0  24.3 CL  112.0  24.3 nm  0.090 s
Step  1272: OL  756.2  174.7  OA  113.4  24.3 CL  113.4  24.3 nm  0.092 s
Step  1279 updated high order loop gain: 0.239
Step  1283: OL  760.2  180.7  OA  116.2  33.6 CL  116.2  33.6 nm  0.090 s
Step  1294: OL  765.0  187.6  OA  115.8  20.2 CL  115.8  20.2 nm  0.088 s
Step  1305: OL  769.7  195.2  OA  114.1  24.1 CL  114.1  24.1 nm  0.098 s
Step  1316: OL  774.1  203.5  OA  116.7  22.7 CL  116.7  22.7 nm  0.092 s
Step  1327: OL  778.4  212.6  OA  116.8  33.5 CL  116.8  33.5 nm  0.097 s
Step  1338: OL  783.6  222.3  OA  115.2  27.2 CL  115.2  27.2 nm  0.094 s
Step  1349: OL  789.8  232.4  OA  113.8  39.3 CL  113.8  39.3 nm  0.093 s
Step  1360: OL  797.1  242.0  OA  112.0  24.6 CL  112.0  24.6 nm  0.093 s
Step  1371: OL  805.1  250.4  OA  110.6  31.3 CL  110.6  31.3 nm  0.092 s
Step  1382: OL  813.6  257.4  OA  108.8  29.0 CL  108.8  29.0 nm  0.103 s
Step  1393: OL  822.7  263.2  OA  111.7  31.9 CL  111.7  31.9 nm  0.095 s
Step  1404: OL  832.8  267.7  OA  118.0  29.8 CL  118.0  29.8 nm  0.094 s
Step  1415: OL  843.4  271.2  OA  114.0  17.3 CL  114.0  17.3 nm  0.092 s
Step  1426: OL  854.2  273.9  OA  112.1  23.5 CL  112.1  23.5 nm  0.092 s
Step  1437: OL  865.0  276.2  OA  117.4  32.5 CL  117.4  32.5 nm  0.096 s
Step  1448: OL  875.1  278.1  OA  106.0   9.2 CL  106.0   9.2 nm  0.089 s
Step  1459: OL  884.3  279.2  OA  112.0  32.4 CL  112.0  32.4 nm  0.093 s
Step  1470: OL  892.0  279.3  OA  111.7  17.9 CL  111.7  17.9 nm  0.089 s
Step  1481: OL  897.5  278.0  OA  106.2   7.7 CL  106.2   7.7 nm  0.102 s
Step  1492: OL  900.2  275.4  OA  112.8  37.4 CL  112.8  37.4 nm  0.088 s
Step  1501: OL  900.7  272.4  OA  111.1  14.0 CL  111.1  14.0 nm  0.090 s
Step  1512: OL  899.7  267.8  OA  108.1  10.2 CL  108.1  10.2 nm  0.088 s
Step  1523: OL  896.9  262.5  OA  108.5  21.5 CL  108.5  21.5 nm  0.093 s
Step  1534: OL  892.3  256.2  OA  110.3  20.8 CL  110.3  20.8 nm  0.091 s
Step  1535 updated high order loop gain: 0.236
Step  1545: OL  886.6  249.2  OA  110.9  22.0 CL  110.9  22.0 nm  0.094 s
Step  1556: OL  880.3  241.9  OA  109.4  13.4 CL  109.4  13.4 nm  0.099 s
Step  1567: OL  874.0  234.9  OA  111.7  12.3 CL  111.7  12.3 nm  0.089 s
Step  1578: OL  867.3  228.7  OA  115.7  27.4 CL  115.7  27.4 nm  0.098 s
Step  1589: OL  860.1  223.5  OA  110.8  16.6 CL  110.8  16.6 nm  0.092 s
Step 1599: Output PSF
Step  1599: OL  853.2  219.3  OA  113.9  23.7 CL  113.9  23.7 nm  1.391 s
Mean: 116.45 20.13 114.69  nm.

*** Simulation Finished at 2025/02/11 19:27:53 in nid003517. ***

