Warning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid003517/scheduler) failed: Invalid argument. 
/global/u2/b/bpeck/work/vismcao/maos -o studies/reduced_ngs/8_lgs/8mag_lgs/3750count -c master_files/reduced_ngs/8_lgs/8mag_lgs/kola_3750act.conf -O 
Output folder is 'studies/reduced_ngs/8_lgs/8mag_lgs/3750count'.
SRC: /global/homes/b/bpeck/code/maos v2.9 4c88b7c2 2024-11-13 16:45:33 -0800
BUILT: /global/homes/b/bpeck/code/maos/optim by GCC (v12) on 2024/11/18 09:40:03 CPU(F64,+O3) with CUDA(v122,F32)
Launched at 2025/02/11 18:55:41 in nid003517 with PID 1948534.
The web based job monitor can be accessed at http://localhost:10300
Main config file is /global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/8_lgs/8mag_lgs/kola_3750act.conf
Warning(path.c:48): Path not found: path=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/8_lgs/8mag_lgs/bin; abspath=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/8_lgs/8mag_lgs/bin; Ignored.
Warning(path.c:48): Path not found: path=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/8_lgs/8mag_lgs/atm; abspath=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/8_lgs/8mag_lgs/atm; Ignored.
Warning(readcfg.c:399): sim.apfsm has been renamed to powfs.apfsm.
Warning(readcfg.c:399): sim.epfsm has been renamed to powfs.epfsm.
Warning(readcfg.c:399): sim.alfsm has been renamed to powfs.alfsm.
Warning(readcfg.c:399): sim.commonfsm has been renamed to powfs.commonfsm.
Warning(readcfg.c:399): sim.idealfsm has been renamed to powfs.idealfsm.
Warning(readcfg.c:399): sim.zetafsm has been renamed to powfs.zetafsm.
Warning(readcfg.c:399): sim.f0fsm has been renamed to powfs.f0fsm.
Warning(readcfg.c:399): tsurf has been renamed to ncpa.tsurf.
loaded 132 (132 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_sim.conf'
loaded  19 ( 19 new) records from '/global/u2/b/bpeck/work/vismcao/./dm_none.conf'
loaded  19 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_ASM.conf'
loaded  19 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_DM2.conf'
loaded  19 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_DM3.conf'
loaded   0 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_dm_multiple.conf'
loaded   7 (  5 new) records from '/global/u2/b/bpeck/work/vismcao/./atm_mk13n50p_ground_detail.conf'
loaded  76 ( 69 new) records from '/global/homes/b/bpeck/code/maos/config/maos/powfs_common.conf'
loaded  44 ( 38 new) records from '/global/u2/b/bpeck/work/vismcao/./powfs_none.conf'
loaded  44 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_shwfs_lgs.conf'
loaded  44 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_shwfs_ttf_strap.conf'
loaded  44 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_shwfs_twfs_lbwfs.conf'
loaded   0 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_wfs_lgs_strap_lbwfs.conf'
loaded  71 ( 71 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_recon.conf'
Warning(readcfg.c:399): dbg.na_smooth has been renamed to powfs0_llt.na_smooth.
Warning(readcfg.c:399): dbg.na_interp has been renamed to powfs0_llt.na_interp.
Warning(readcfg.c:399): dbg.na_thres has been renamed to powfs0_llt.na_thres.
Warning(readcfg.c:399): dbg.na_fit_maxit has been renamed to powfs0_llt.na_fit_maxit.
Warning(readcfg.c:399): dbg.na_fit_svdthres has been renamed to powfs0_llt.na_fit_svdthres.
Warning(readcfg.c:399): dbg.na_fit_dh has been renamed to powfs0_llt.na_fit_dh.
Warning(readcfg.c:399): dbg.ncpa_preload has been renamed to ncpa.preload.
Warning(readcfg.c:399): dbg.ncpa_rmsci has been renamed to ncpa.rmsci.
Warning(readcfg.c:399): dbg.draw_opdmax has been renamed to plot.opdmax.
Warning(readcfg.c:399): dbg.draw_gmax has been renamed to plot.gmax.
loaded  95 ( 93 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_dbg.conf'
loaded   4 (  4 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_fit_mcao.conf'
Warning(readcfg.c:399): surf has been renamed to ncpa.surf.
loaded  39 (  7 new) records from '/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/8_lgs/8mag_lgs/kola_3750act.conf'
loaded   0 (  0 new) records from 'command line'
loaded  24 ( 18 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_llt_CL.conf'
Adjust LGS range by telescope altitude 4145m.
Zenith angle is 30 degree.
    Scaling turbulence height and LGS hs by sec(za).
    Scaling r0 by cos(za)^(3/5).
    Scaling wind speed and LGS signal level by cos(za).
powfs0: Adjusting dx from 0.0078125 to 0.00795. 
powfs0.llt.fsm: f0=0 Hz, LPF ep=0
powfs0.epfsm is set to 0.517618 (auto)
powfs2: Adjusting dx from 0.03125 to 0.0312778. 
powfs2 is TWFS for powfs0
sim.ephi is set to 0.427717 (auto)
sim.eplo is set to 0.427717 (auto)
Warning(parms.c:2296): Layer 1 at 17.3205m is very close to layer 0 at 0m (OK).
Warning(parms.c:2296): Layer 2 at 34.641m is very close to layer 1 at 17.3205m (OK).
Warning(parms.c:2296): Layer 3 at 51.9615m is very close to layer 2 at 34.641m (OK).
dm 0: stroke=30 um is provided in micron.
dm 0: assume ia stroke=2 um is provided in micron.
dm 1: stroke=7 um is provided in micron.
dm 1: assume ia stroke=2 um is provided in micron.
dm 2: stroke=7 um is provided in micron.
dm 2: assume ia stroke=2 um is provided in micron.
Focus blending is not implemented yet for integrated tomography
parms->sim.mffocus is reset to 0
There are 1 valid simulation seeds:  1
Output PSF for 1 directions
Used 449 of 456 supplied keys
Warning(readcfg.c:158): key "dbg.pwfs_flate" is not recognized, value is 0
Warning(readcfg.c:158): key "dbg.pwfs_flatv" is not recognized, value is 0
Warning(readcfg.c:158): key "dbg.pwfs_psx" is not recognized, value is [0 0 0 0]
Warning(readcfg.c:158): key "dbg.pwfs_psy" is not recognized, value is [0 0 0 0]
Warning(readcfg.c:158): key "dbg.pwfs_pupelong" is not recognized, value is 0
Warning(readcfg.c:158): key "dbg.pwfs_raw" is not recognized, value is 0
Warning(readcfg.c:158): key "dbg.pwfs_side" is not recognized, value is 4
[00;00mAperture[00;00m is 11 m with sampling 1/128 m
[00;00mTurbulence at 30 degree zenith angle:[00;00m r0=0.128424m, L0=30m, 14 layers.
    Greenwood freq is 25.1Hz, anisoplanatic angle is 1.58 as
    Sampled 8192x8192 at 1/128m. wind dir is randomized.
    layer 0: ht=      0 m, wt= 0.302, ws=  4.8 m/s
    layer 1: ht=     17 m, wt= 0.154, ws=  5.0 m/s
    layer 2: ht=     35 m, wt= 0.041, ws=  5.4 m/s
    layer 3: ht=     52 m, wt= 0.002, ws=  6.6 m/s
    layer 4: ht=    139 m, wt= 0.021, ws=  6.1 m/s
    layer 5: ht=    231 m, wt= 0.010, ws=  6.1 m/s
    layer 6: ht=    323 m, wt= 0.008, ws=  6.1 m/s
    layer 7: ht=    416 m, wt= 0.005, ws=  6.1 m/s
    layer 8: ht=    508 m, wt= 0.001, ws=  6.1 m/s
    layer 9: ht=    932 m, wt= 0.107, ws=  5.6 m/s
    layer 10: ht=   5022 m, wt= 0.144, ws= 11.1 m/s
    layer 11: ht=   9238 m, wt= 0.093, ws= 19.1 m/s
    layer 12: ht=  13856 m, wt= 0.075, ws=  8.2 m/s
    layer 13: ht=  22518 m, wt= 0.036, ws=  4.8 m/s
[00;00mReconstruction[00;00m: r0=0.128424m L0=30m. 14 layers. use cone coordinate.
    layer 0: ht=      0 m, wt= 0.302
    layer 1: ht=     17 m, wt= 0.154
    layer 2: ht=     35 m, wt= 0.041
    layer 3: ht=     52 m, wt= 0.002
    layer 4: ht=    139 m, wt= 0.021
    layer 5: ht=    231 m, wt= 0.010
    layer 6: ht=    323 m, wt= 0.008
    layer 7: ht=    416 m, wt= 0.005
    layer 8: ht=    508 m, wt= 0.001
    layer 9: ht=    932 m, wt= 0.107
    layer 10: ht=   5022 m, wt= 0.144
    layer 11: ht=   9238 m, wt= 0.093
    layer 12: ht=  13856 m, wt= 0.075
    layer 13: ht=  22518 m, wt= 0.036
[00;00mThere are 3 powfs[00;00m
  powfs0: Order 70, LGS at 99.1 km. Sampling 1/125.786 m. Thres 30%. [00;00mT/T is removed in right hand side in tomography.[00;00m
    CCD image is 25x25 @ 500x500 mas, blur 27% (sigma), 1500Hz, wvl: [ 5.89e-07]
    Gtilt in reconstruction. Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
  powfs1: Order  2, NGS at inf km. Sampling 1/16 m. Thres 30%. 
    Ztilt in reconstruction. Geomtric optics start at 2 with ztilt [00;00m(noisy)[00;00m
  powfs2: Order 20, NGS at inf km. Sampling 1/31.9716 m. Thres 50%. 
    CCD image is 4x4 @ 1500x1500 mas, blur 0% (sigma), 0.015Hz, wvl: [ 7.2e-07]
    Gtilt in reconstruction. Geomtric optics start at 50 with gtilt Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
[00;00mThere are 12 wfs[00;00m
    wfs 0: type 0, at (  30.00,    0.00) arcsec,  99 km, siglev is 30.3126 bkgrnd is 0.1
    wfs 1: type 0, at (  21.21,   21.21) arcsec,  99 km, siglev is 30.3126 bkgrnd is 0.1
    wfs 2: type 0, at (   0.00,   30.00) arcsec,  99 km, siglev is 30.3126 bkgrnd is 0.1
    wfs 3: type 0, at ( -21.21,   21.21) arcsec,  99 km, siglev is 30.3126 bkgrnd is 0.1
    wfs 4: type 0, at ( -30.00,    0.00) arcsec,  99 km, siglev is 30.3126 bkgrnd is 0.1
    wfs 5: type 0, at ( -21.21,  -21.21) arcsec,  99 km, siglev is 30.3126 bkgrnd is 0.1
    wfs 6: type 0, at (   0.00,  -30.00) arcsec,  99 km, siglev is 30.3126 bkgrnd is 0.1
    wfs 7: type 0, at (  21.21,  -21.21) arcsec,  99 km, siglev is 30.3126 bkgrnd is 0.1
    wfs 8: type 1, at (   5.00,    8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 9: type 1, at ( -10.00,    0.00) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 10: type 1, at (   5.00,   -8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 11: type 2, at (   0.00,    0.00) arcsec, inf km, siglev is 4.1558e+06 bkgrnd is 0.001
[00;00mThere are 3 DMs[00;00m
  DM 0 at -0.1km, actuator pitch 0.159m, offset   0, with 30.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 1 at    6km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 2 at   10km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
[00;00mTomography[00;00m is using CG, with [00;00mFourer Domain[00;00m preconditioner, [00;00m12[00;00m iterations, integrated tomo.
[00;00mDM Fitting [00;00mis using CG, with [00;00mNo[00;00m preconditioner, [00;00m10[00;00m iterations
[00;00mThere are 9 fit directions[00;00m
    Fit 0: weight is 0.444, at (   0.00,    0.00) arcsec
    Fit 1: weight is 0.111, at (  15.00,    0.00) arcsec
    Fit 2: weight is 0.111, at (   0.00,   15.00) arcsec
    Fit 3: weight is 0.111, at ( -15.00,    0.00) arcsec
    Fit 4: weight is 0.111, at (   0.00,  -15.00) arcsec
    Fit 5: weight is 0.028, at (  15.00,   15.00) arcsec
    Fit 6: weight is 0.028, at ( -15.00,   15.00) arcsec
    Fit 7: weight is 0.028, at ( -15.00,  -15.00) arcsec
    Fit 8: weight is 0.028, at (  15.00,  -15.00) arcsec
[00;00mThere are 1 evaluation directions[00;00m at sampling 1/128 m.
    Evl 0: weight is 1.000, at (   0.00,    0.00) arcsec
[00;00mSimulation[00;00m start at step 0, end at step 1600, with time step 1/1500s, [00;00mclose loop[00;00m.
After setup_parms:	120.5 MiB.
Warning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid003517/scheduler) failed: Invalid argument. 
CUDA: minimum memory requirement is 0.3GB
GPU 0 is NVIDIA A100-SXM4-40GB with arch 8.0, 38.9GB free, 39.3GB total device memory.
Using GPU 0
Use 1 GPUs for WFS Tomo Fit Evl

*** Preparation started at 2025/02/11 18:55:41 in nid003517. ***

Using OpenMP version 201511 with 128 threads
Reading aperture amplitude map from KECK.fits
Warning(accphi.c:477): 108390 points not covered by input screen
Warning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid003517/scheduler) failed: Invalid argument. 
 ->maos.c:447->setup.c:148->aper.c:74->utils.c:478->accphi.c:478
iwvl 0: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 1: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 2: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 3: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 4: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 5: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 6: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 7: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 8: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
After setup_aper:	343.0 MiB.

[00;00mSetting up powfs 0 geom[00;00m

There are 20 points in each subaperture of 0.159m.
There are 2972 valid subaperture.

[00;00mSetting up powfs 1 geom[00;00m

There are 88 points in each subaperture of 5.5m.
There are 4 valid subaperture.

[00;00mSetting up powfs 2 geom[00;00m

There are 18 points in each subaperture of 0.563m.
There are 236 valid subaperture.
After setup_powfs_init:	419.6 MiB.

[00;00mSetting up reconstructor geometry.[00;00m

PLOC is 143x143, with sampling of 0.08m (square)
    DM 0: grid is 73 x 73
    DM 1: grid is 75 x 75
    DM 2: grid is 81 x 81
FLOC is 143x143, with sampling of 0.08m (not square)
Tomography grid is square:
    layer 0: xloc grid is 252 x 252, sampling is 0.080 m, 63504 points
    layer 1: xloc grid is 252 x 252, sampling is 0.079 m, 63504 points
    layer 2: xloc grid is 252 x 252, sampling is 0.079 m, 63504 points
    layer 3: xloc grid is 252 x 252, sampling is 0.079 m, 63504 points
    layer 4: xloc grid is 252 x 252, sampling is 0.079 m, 63504 points
    layer 5: xloc grid is 252 x 252, sampling is 0.079 m, 63504 points
    layer 6: xloc grid is 252 x 252, sampling is 0.079 m, 63504 points
    layer 7: xloc grid is 252 x 252, sampling is 0.079 m, 63504 points
    layer 8: xloc grid is 252 x 252, sampling is 0.079 m, 63504 points
    layer 9: xloc grid is 252 x 252, sampling is 0.079 m, 63504 points
    layer 10: xloc grid is 252 x 252, sampling is 0.075 m, 63504 points
    layer 11: xloc grid is 252 x 252, sampling is 0.072 m, 63504 points
    layer 12: xloc grid is 252 x 252, sampling is 0.068 m, 63504 points
    layer 13: xloc grid is 252 x 252, sampling is 0.061 m, 63504 points

[00;00mSetting up powfs 0 PO WFS[00;00m

OTF dimension is 40x40 (calculated)
Uplink FWHM (illt 0, iwvl 0) is 0.576805"
Downlink FWHM (illt 0, iwvl 0) is 1.30857"
Generating matched filter for powfs 0
sa index   location       noise equivalent angle
    1483: (  4.9,  -0.2) m, (136.09, 132.28) mas
    1476: (  3.8,  -0.2) m, (143.85, 133.86) mas
    1469: (  2.7,  -0.2) m, (154.70, 135.98) mas
    1462: (  1.6,  -0.2) m, (167.56, 138.21) mas
    1460: (  1.3,  -0.2) m, (171.73, 138.85) mas
    1024: ( -0.5,  -1.4) m, (200.16, 145.23) mas
    1457: ( -1.7,  -0.2) m, (226.27, 144.35) mas
    1450: ( -2.9,  -0.2) m, (253.77, 146.08) mas
    1443: ( -4.0,  -0.2) m, (278.57, 147.71) mas
    1436: ( -5.1,  -0.2) m, (298.07, 149.31) mas
    1434: ( -5.4,  -0.2) m, (302.12, 149.71) mas
sa index   location       noise equivalent angle
    2456: (  2.7,   2.7) m, (139.19, 139.19) mas
    2196: (  1.9,   1.9) m, (153.92, 153.02) mas
    1895: (  1.1,   1.1) m, (156.21, 156.21) mas
    1836: (  1.0,   1.0) m, (158.19, 158.19) mas
    1087: (  0.5,  -1.3) m, (173.98, 196.22) mas
    1079: ( -1.3,  -1.3) m, (191.11, 191.11) mas
     778: ( -2.1,  -2.1) m, (213.50, 212.51) mas
     569: ( -2.7,  -2.7) m, (214.09, 214.09) mas
     366: ( -3.3,  -3.3) m, (225.39, 225.39) mas
     120: ( -3.0,  -4.3) m, (219.79, 243.45) mas
sa index   location       noise equivalent angle
    2756: (  0.0,   3.8) m, (137.37, 147.17) mas
    2439: (  0.0,   2.7) m, (139.57, 158.30) mas
    2068: (  0.0,   1.6) m, (141.89, 171.47) mas
    1948: (  0.0,   1.3) m, (142.56, 175.74) mas
    1351: (  1.3,  -0.5) m, (145.23, 200.16) mas
     907: (  0.0,  -1.7) m, (148.30, 231.94) mas
     536: (  0.0,  -2.9) m, (150.12, 260.33) mas
     219: (  0.0,  -4.0) m, (151.83, 285.93) mas
      99: (  0.0,  -4.5) m, (152.52, 295.02) mas
      11: (  2.2,  -4.9) m, (159.41, 306.47) mas
sa index   location       noise equivalent angle
    2421: ( -2.9,   2.7) m, (139.19, 139.19) mas
    2171: ( -2.1,   1.9) m, (155.06, 154.19) mas
    1882: ( -1.3,   1.1) m, (156.21, 156.21) mas
    1831: ( -1.1,   1.0) m, (158.19, 158.19) mas
    1083: ( -0.6,  -1.3) m, (176.65, 199.02) mas
    1091: (  1.1,  -1.3) m, (191.11, 191.11) mas
     803: (  1.9,  -2.1) m, (211.87, 211.15) mas
     602: (  2.5,  -2.7) m, (214.09, 214.09) mas
     455: (  3.0,  -3.2) m, (222.19, 222.19) mas
     157: (  2.9,  -4.3) m, (219.79, 243.45) mas
sa index   location       noise equivalent angle
    1436: ( -5.1,  -0.2) m, (136.09, 132.28) mas
    1443: ( -4.0,  -0.2) m, (143.85, 133.86) mas
    1450: ( -2.9,  -0.2) m, (154.70, 135.98) mas
    1457: ( -1.7,  -0.2) m, (167.56, 138.21) mas
    1459: ( -1.4,  -0.2) m, (171.73, 138.85) mas
    1950: (  0.3,   1.3) m, (200.16, 145.23) mas
    1462: (  1.6,  -0.2) m, (226.27, 144.35) mas
    1469: (  2.7,  -0.2) m, (253.77, 146.08) mas
    1476: (  3.8,  -0.2) m, (278.57, 147.71) mas
    1483: (  4.9,  -0.2) m, (298.07, 149.31) mas
    1485: (  5.2,  -0.2) m, (302.12, 149.71) mas
sa index   location       noise equivalent angle
     366: ( -3.3,  -3.3) m, (135.35, 135.35) mas
     569: ( -2.7,  -2.7) m, (140.36, 140.36) mas
     836: ( -1.9,  -1.9) m, (148.14, 148.14) mas
    1137: ( -1.1,  -1.1) m, (158.19, 158.19) mas
    1295: (  1.1,  -0.6) m, (194.14, 172.03) mas
    1836: (  1.0,   1.0) m, (188.22, 188.22) mas
    1956: (  1.3,   1.3) m, (193.64, 193.64) mas
    2251: (  2.1,   2.1) m, (220.15, 223.02) mas
    2456: (  2.7,   2.7) m, (216.81, 216.81) mas
    2854: (  2.9,   4.1) m, (219.79, 243.45) mas
sa index   location       noise equivalent angle
     219: (  0.0,  -4.0) m, (137.37, 147.17) mas
     536: (  0.0,  -2.9) m, (139.57, 158.30) mas
     907: (  0.0,  -1.7) m, (141.89, 171.47) mas
    1027: (  0.0,  -1.4) m, (142.56, 175.74) mas
    1626: (  1.3,   0.3) m, (145.23, 200.16) mas
    2068: (  0.0,   1.6) m, (148.30, 231.94) mas
    2439: (  0.0,   2.7) m, (150.12, 260.33) mas
    2756: (  0.0,   3.8) m, (151.83, 285.93) mas
    2876: (  0.0,   4.3) m, (152.52, 295.02) mas
    2961: ( -2.4,   4.8) m, (165.42, 316.57) mas
sa index   location       noise equivalent angle
     455: (  3.0,  -3.2) m, (136.68, 136.68) mas
     602: (  2.5,  -2.7) m, (140.36, 140.36) mas
     859: (  1.7,  -1.9) m, (148.11, 148.11) mas
    1142: (  1.0,  -1.1) m, (158.19, 158.19) mas
    1294: ( -1.3,  -0.6) m, (199.33, 176.95) mas
    1831: ( -1.1,   1.0) m, (188.22, 188.22) mas
    1939: ( -1.4,   1.3) m, (193.64, 193.64) mas
    2224: ( -2.2,   2.1) m, (220.01, 222.58) mas
    2421: ( -2.9,   2.7) m, (216.81, 216.81) mas
    2817: ( -3.0,   4.1) m, (219.79, 243.45) mas

[00;00mSetting up powfs 2 PO WFS[00;00m

OTF dimension is 48x48 (calculated)
Generating matched filter for powfs 2
Use sanea to derive neasim
Use sanea to derive neasim

[00;00mSetting up reconstructor[00;00m

Recon NEA: cmf(184.79) cmf(183.50) cmf(184.87) cmf(183.47) cmf(184.75) cmf(183.42) cmf(184.79) cmf(183.45) geom(0.31) geom(0.31) geom(0.31) mf(0.14)  mas
Setup or update control matrix parameters.
RRtwfs svd threshold is 1e-10
Replacing HA by HA*fit->actextrap
Adding piston cr to fit matrix
Adding TT cr on upper DMs to fit matrix.
Before assembling fit matrix:	4544.8 MiB.
Building fit->FR
Building fit->FL
Adding tikhonov constraint of 1.0e-07 to FLM
The maximum eigen value is estimated to be around 2.8e-04
DM Fit number of Low rank terms: 16 in LHS
After assemble fit matrix:	6213.6 MiB.
After setup_recon:	6213.6 MiB.
GPU 0: mem used 1640 MB (wfs init)
GPU 0: mem used 2668 MB (recon init)
GPU 0: mem used 2698 MB (perf init)

*** Simulation started at 2025/02/11 18:57:00 in nid003517. ***

Running seed 1
GPU 0: mem used 2700 MB (wfs seeding)
Wind dir: 267.3 261.7 167.0 130.5 300.7  32.3 119.8 139.0 150.8 277.7 203.0 133.1  45.9 265.1 deg
Using /global/homes/b/bpeck/.aos/cache/atm/vonkarman_14_8192x8192_0.0078125_1115374592d.bin
After genatm:	6099.7 MiB.
Step     #  Open Loop  PR TT  On axis  PR TT  Field RMS PR TT     Timing 
Step     0: OL  884.6  248.3  OA  884.6 248.3 CL  884.6 248.3 nm  0.091 s
Step    15: OL  908.2  254.1  OA  115.9  33.0 CL  115.9  33.0 nm  0.062 s
Step    30: OL  932.2  258.6  OA  110.2  24.9 CL  110.2  24.9 nm  0.070 s
Step    45: OL  955.0  260.9  OA  114.7  37.9 CL  114.7  37.9 nm  0.067 s
Step    60: OL  977.2  260.7  OA  116.8  13.7 CL  116.8  13.7 nm  0.073 s
Step    75: OL  999.7  259.1  OA  115.4  33.4 CL  115.4  33.4 nm  0.068 s
Step    89: OL 1021.0  257.9  OA  119.6  30.3 CL  119.6  30.3 nm  0.070 s
Step   103: OL 1042.2  257.3  OA  119.8  36.2 CL  119.8  36.2 nm  0.071 s
Step   118: OL 1065.0  258.1  OA  113.0  27.6 CL  113.0  27.6 nm  0.069 s
Step   132: OL 1084.9  260.7  OA  112.7  25.2 CL  112.7  25.2 nm  0.078 s
Step   146: OL 1103.6  265.5  OA  114.9  26.6 CL  114.9  26.6 nm  0.070 s
Step   161: OL 1120.9  272.5  OA  120.1  41.5 CL  120.1  41.5 nm  0.072 s
Step   175: OL 1134.5  280.7  OA  123.0  40.6 CL  123.0  40.6 nm  0.071 s
Step   190: OL 1145.6  290.3  OA  117.7  38.9 CL  117.7  38.9 nm  0.075 s
Step   204: OL 1153.1  299.3  OA  109.5  21.2 CL  109.5  21.2 nm  0.076 s
Step   218: OL 1158.3  308.2  OA  110.5  22.6 CL  110.5  22.6 nm  0.074 s
Step   233: OL 1160.6  318.0  OA  111.0  23.7 CL  111.0  23.7 nm  0.071 s
Step   248: OL 1159.6  328.4  OA  112.6  34.4 CL  112.6  34.4 nm  0.077 s
Step   255 updated high order loop gain: 0.364
Step   262: OL 1154.0  338.4  OA  117.7  42.5 CL  117.7  42.5 nm  0.073 s
Step   276: OL 1144.2  348.5  OA  111.7  29.0 CL  111.7  29.0 nm  0.070 s
Step   290: OL 1131.5  359.4  OA  110.1  24.9 CL  110.1  24.9 nm  0.069 s
Step   305: OL 1115.9  372.6  OA  112.2  23.3 CL  112.2  23.3 nm  0.071 s
Step   319: OL 1099.5  385.7  OA  117.0  36.6 CL  117.0  36.6 nm  0.070 s
Step   333: OL 1081.7  400.4  OA  108.9  25.6 CL  108.9  25.6 nm  0.077 s
Step   348: OL 1062.6  418.4  OA  109.9  31.9 CL  109.9  31.9 nm  0.076 s
Step   362: OL 1045.2  437.2  OA  112.7  28.6 CL  112.7  28.6 nm  0.070 s
Step   377: OL 1027.9  458.6  OA  112.5  26.5 CL  112.5  26.5 nm  0.074 s
Step   392: OL 1011.5  480.4  OA  109.7  17.4 CL  109.7  17.4 nm  0.069 s
Step   406: OL  996.0  500.4  OA  112.0  25.1 CL  112.0  25.1 nm  0.074 s
Step   421: OL  978.9  520.9  OA  109.1  12.5 CL  109.1  12.5 nm  0.071 s
Step   436: OL  962.2  540.9  OA  106.7  16.7 CL  106.7  16.7 nm  0.074 s
Step   451: OL  946.5  560.3  OA  112.6  19.4 CL  112.6  19.4 nm  0.069 s
Step   466: OL  934.8  580.0  OA  106.2  16.3 CL  106.2  16.3 nm  0.076 s
Step   481: OL  928.0  599.2  OA  111.9  18.3 CL  111.9  18.3 nm  0.070 s
Step   495: OL  926.6  616.3  OA  110.9  27.8 CL  110.9  27.8 nm  0.081 s
Step   509: OL  928.1  632.0  OA  113.1  23.1 CL  113.1  23.1 nm  0.069 s
Step   511 updated high order loop gain: 0.323
Step   523: OL  932.0  645.7  OA  108.6  12.7 CL  108.6  12.7 nm  0.076 s
Step   538: OL  938.7  656.8  OA  111.9  10.3 CL  111.9  10.3 nm  0.070 s
Step   553: OL  948.5  664.4  OA  112.2  21.2 CL  112.2  21.2 nm  0.076 s
Step   567: OL  960.1  668.5  OA  109.0  11.8 CL  109.0  11.8 nm  0.071 s
Step   582: OL  974.4  670.6  OA  108.1   7.5 CL  108.1   7.5 nm  0.076 s
Step   596: OL  989.8  669.8  OA  114.5  25.9 CL  114.5  25.9 nm  0.069 s
Step   611: OL 1007.2  665.2  OA  114.6  27.5 CL  114.6  27.5 nm  0.070 s
Step   625: OL 1023.7  657.9  OA  106.1  21.6 CL  106.1  21.6 nm  0.070 s
Step   639: OL 1039.5  647.9  OA  109.6  14.9 CL  109.6  14.9 nm  0.070 s
Step   654: OL 1055.0  634.9  OA  107.9   8.8 CL  107.9   8.8 nm  0.071 s
Step   669: OL 1068.9  619.9  OA  106.0   9.7 CL  106.0   9.7 nm  0.068 s
Step   684: OL 1081.8  604.3  OA  111.1  21.2 CL  111.1  21.2 nm  0.071 s
Step   699: OL 1093.0  588.0  OA  108.7   7.1 CL  108.7   7.1 nm  0.070 s
Step   713: OL 1100.8  571.3  OA  108.4  13.6 CL  108.4  13.6 nm  0.068 s
Step   728: OL 1105.3  552.7  OA  110.9  24.3 CL  110.9  24.3 nm  0.070 s
Step   743: OL 1105.9  534.2  OA  111.8   8.9 CL  111.8   8.9 nm  0.068 s
Step   758: OL 1102.6  516.2  OA  111.3  13.7 CL  111.3  13.7 nm  0.072 s
Step   767 updated high order loop gain: 0.302
Step   772: OL 1096.1  500.0  OA  112.2  21.8 CL  112.2  21.8 nm  0.068 s
Step   786: OL 1085.8  484.3  OA  112.4  20.8 CL  112.4  20.8 nm  0.068 s
Step   801: OL 1070.7  467.5  OA  110.1  10.4 CL  110.1  10.4 nm  0.070 s
Step   816: OL 1052.9  450.8  OA  110.3  15.6 CL  110.3  15.6 nm  0.095 s
Step   830: OL 1033.1  435.4  OA  112.2  19.4 CL  112.2  19.4 nm  0.069 s
Step   845: OL 1010.0  419.7  OA  109.6  19.6 CL  109.6  19.6 nm  0.069 s
Step   859: OL  987.7  406.0  OA  109.6  10.5 CL  109.6  10.5 nm  0.077 s
Step   874: OL  964.4  393.2  OA  111.4  13.7 CL  111.4  13.7 nm  0.067 s
Step   888: OL  943.7  382.9  OA  105.9  12.4 CL  105.9  12.4 nm  0.084 s
Step   903: OL  920.8  373.2  OA  108.8  19.5 CL  108.8  19.5 nm  0.068 s
Step   918: OL  896.7  365.5  OA  107.1  16.2 CL  107.1  16.2 nm  0.107 s
Step   933: OL  873.0  358.3  OA  105.9   7.1 CL  105.9   7.1 nm  0.068 s
Step   948: OL  850.3  351.1  OA  106.6  12.3 CL  106.6  12.3 nm  0.075 s
Step   963: OL  829.5  343.4  OA  111.0  21.8 CL  111.0  21.8 nm  0.070 s
Step   978: OL  812.0  334.6  OA  106.3  11.0 CL  106.3  11.0 nm  0.068 s
Step   992: OL  798.0  325.4  OA  105.6   9.2 CL  105.6   9.2 nm  0.069 s
Step  1006: OL  785.2  315.2  OA  110.7  19.4 CL  110.7  19.4 nm  0.083 s
Step  1020: OL  774.2  304.5  OA  109.3  15.0 CL  109.3  15.0 nm  0.071 s
Step  1023 updated high order loop gain: 0.293
Step  1035: OL  764.4  292.6  OA  110.0   7.5 CL  110.0   7.5 nm  0.074 s
Step  1050: OL  755.8  279.6  OA  111.6  22.6 CL  111.6  22.6 nm  0.074 s
Step  1064: OL  747.7  266.1  OA  108.8  10.7 CL  108.8  10.7 nm  0.072 s
Step  1079: OL  741.2  249.5  OA  111.6   1.3 CL  111.6   1.3 nm  0.068 s
Step  1094: OL  737.8  232.0  OA  112.7  17.2 CL  112.7  17.2 nm  0.073 s
Step  1108: OL  736.6  217.1  OA  108.8   5.9 CL  108.8   5.9 nm  0.068 s
Step  1123: OL  736.4  202.7  OA  104.2  15.7 CL  104.2  15.7 nm  0.073 s
Step  1138: OL  737.2  191.0  OA  104.9  18.3 CL  104.9  18.3 nm  0.067 s
Step  1153: OL  738.2  181.7  OA  103.7   8.2 CL  103.7   8.2 nm  0.075 s
Step  1168: OL  738.9  175.0  OA  105.8  17.5 CL  105.8  17.5 nm  0.067 s
Step  1182: OL  740.4  171.0  OA  101.4  14.3 CL  101.4  14.3 nm  0.081 s
Step  1197: OL  743.4  167.8  OA  106.7  20.8 CL  106.7  20.8 nm  0.070 s
Step  1212: OL  746.6  165.1  OA  107.9  23.6 CL  107.9  23.6 nm  0.078 s
Step  1227: OL  749.7  163.7  OA  107.5  12.8 CL  107.5  12.8 nm  0.069 s
Step  1241: OL  751.6  164.5  OA  107.2  28.6 CL  107.2  28.6 nm  0.080 s
Step  1256: OL  753.5  168.1  OA  105.4  21.2 CL  105.4  21.2 nm  0.072 s
Step  1270: OL  755.9  174.0  OA  103.1  15.2 CL  103.1  15.2 nm  0.075 s
Step  1279 updated high order loop gain: 0.288
Step  1285: OL  759.5  182.2  OA  105.1  17.1 CL  105.1  17.1 nm  0.070 s
Step  1299: OL  764.0  191.2  OA  110.0  18.5 CL  110.0  18.5 nm  0.073 s
Step  1313: OL  768.1  201.4  OA  114.5  24.9 CL  114.5  24.9 nm  0.073 s
Step  1328: OL  772.4  213.7  OA  108.3  12.2 CL  108.3  12.2 nm  0.069 s
Step  1342: OL  777.9  226.2  OA  106.2  28.1 CL  106.2  28.1 nm  0.067 s
Step  1357: OL  786.0  239.7  OA  105.0  10.5 CL  105.0  10.5 nm  0.071 s
Step  1372: OL  796.0  251.3  OA  102.7  14.5 CL  102.7  14.5 nm  0.069 s
Step  1387: OL  807.1  260.4  OA  110.6  25.5 CL  110.6  25.5 nm  0.070 s
Step  1402: OL  820.0  267.2  OA  104.6  13.0 CL  104.6  13.0 nm  0.074 s
Step  1417: OL  834.5  271.9  OA  108.3  10.6 CL  108.3  10.6 nm  0.076 s
Step  1431: OL  848.6  275.2  OA  105.4  20.5 CL  105.4  20.5 nm  0.071 s
Step  1446: OL  862.8  278.0  OA  103.5  11.0 CL  103.5  11.0 nm  0.075 s
Step  1460: OL  875.3  279.4  OA  106.6  30.6 CL  106.6  30.6 nm  0.071 s
Step  1475: OL  886.1  279.0  OA  104.7   3.7 CL  104.7   3.7 nm  0.068 s
Step  1490: OL  892.3  276.1  OA  102.4   1.1 CL  102.4   1.1 nm  0.070 s
Step  1505: OL  894.3  270.9  OA  105.0   3.3 CL  105.0   3.3 nm  0.067 s
Step  1519: OL  893.3  264.6  OA  104.9  13.3 CL  104.9  13.3 nm  0.068 s
Step  1534: OL  888.8  256.3  OA  101.3  17.5 CL  101.3  17.5 nm  0.073 s
Step  1535 updated high order loop gain: 0.286
Step  1548: OL  882.4  247.3  OA  105.5  15.0 CL  105.5  15.0 nm  0.068 s
Step  1563: OL  875.0  237.4  OA  103.7   6.9 CL  103.7   6.9 nm  0.070 s
Step  1578: OL  866.7  228.7  OA  110.2  15.8 CL  110.2  15.8 nm  0.071 s
Step  1592: OL  858.2  222.2  OA  106.9  11.3 CL  106.9  11.3 nm  0.068 s
Step 1599: Output PSF
Step  1599: OL  853.6  219.3  OA  109.6  19.5 CL  109.6  19.5 nm  2.115 s
Mean: 108.67 18.29 107.12  nm.

*** Simulation Finished at 2025/02/11 18:59:04 in nid003517. ***

