Warning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid003517/scheduler) failed: Invalid argument. 
/global/u2/b/bpeck/work/vismcao/maos -o studies/reduced_ngs/8_lgs/8mag_lgs/2750count -c master_files/reduced_ngs/8_lgs/8mag_lgs/kola_2750act.conf -O 
Output folder is 'studies/reduced_ngs/8_lgs/8mag_lgs/2750count'.
SRC: /global/homes/b/bpeck/code/maos v2.9 4c88b7c2 2024-11-13 16:45:33 -0800
BUILT: /global/homes/b/bpeck/code/maos/optim by GCC (v12) on 2024/11/18 09:40:03 CPU(F64,+O3) with CUDA(v122,F32)
Launched at 2025/02/11 18:43:46 in nid003517 with PID 1946053.
The web based job monitor can be accessed at http://localhost:10300
Main config file is /global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/8_lgs/8mag_lgs/kola_2750act.conf
Warning(path.c:48): Path not found: path=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/8_lgs/8mag_lgs/bin; abspath=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/8_lgs/8mag_lgs/bin; Ignored.
Warning(path.c:48): Path not found: path=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/8_lgs/8mag_lgs/atm; abspath=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/8_lgs/8mag_lgs/atm; Ignored.
Warning(readcfg.c:399): sim.apfsm has been renamed to powfs.apfsm.
Warning(readcfg.c:399): sim.epfsm has been renamed to powfs.epfsm.
Warning(readcfg.c:399): sim.alfsm has been renamed to powfs.alfsm.
Warning(readcfg.c:399): sim.commonfsm has been renamed to powfs.commonfsm.
Warning(readcfg.c:399): sim.idealfsm has been renamed to powfs.idealfsm.
Warning(readcfg.c:399): sim.zetafsm has been renamed to powfs.zetafsm.
Warning(readcfg.c:399): sim.f0fsm has been renamed to powfs.f0fsm.
Warning(readcfg.c:399): tsurf has been renamed to ncpa.tsurf.
loaded 132 (132 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_sim.conf'
loaded  19 ( 19 new) records from '/global/u2/b/bpeck/work/vismcao/./dm_none.conf'
loaded  19 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_ASM.conf'
loaded  19 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_DM2.conf'
loaded  19 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_DM3.conf'
loaded   0 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_dm_multiple.conf'
loaded   7 (  5 new) records from '/global/u2/b/bpeck/work/vismcao/./atm_mk13n50p_ground_detail.conf'
loaded  76 ( 69 new) records from '/global/homes/b/bpeck/code/maos/config/maos/powfs_common.conf'
loaded  44 ( 38 new) records from '/global/u2/b/bpeck/work/vismcao/./powfs_none.conf'
loaded  44 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_shwfs_lgs.conf'
loaded  44 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_shwfs_ttf_strap.conf'
loaded  44 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_shwfs_twfs_lbwfs.conf'
loaded   0 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_wfs_lgs_strap_lbwfs.conf'
loaded  71 ( 71 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_recon.conf'
Warning(readcfg.c:399): dbg.na_smooth has been renamed to powfs0_llt.na_smooth.
Warning(readcfg.c:399): dbg.na_interp has been renamed to powfs0_llt.na_interp.
Warning(readcfg.c:399): dbg.na_thres has been renamed to powfs0_llt.na_thres.
Warning(readcfg.c:399): dbg.na_fit_maxit has been renamed to powfs0_llt.na_fit_maxit.
Warning(readcfg.c:399): dbg.na_fit_svdthres has been renamed to powfs0_llt.na_fit_svdthres.
Warning(readcfg.c:399): dbg.na_fit_dh has been renamed to powfs0_llt.na_fit_dh.
Warning(readcfg.c:399): dbg.ncpa_preload has been renamed to ncpa.preload.
Warning(readcfg.c:399): dbg.ncpa_rmsci has been renamed to ncpa.rmsci.
Warning(readcfg.c:399): dbg.draw_opdmax has been renamed to plot.opdmax.
Warning(readcfg.c:399): dbg.draw_gmax has been renamed to plot.gmax.
loaded  95 ( 93 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_dbg.conf'
loaded   4 (  4 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_fit_mcao.conf'
Warning(readcfg.c:399): surf has been renamed to ncpa.surf.
loaded  39 (  7 new) records from '/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/8_lgs/8mag_lgs/kola_2750act.conf'
loaded   0 (  0 new) records from 'command line'
loaded  24 ( 18 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_llt_CL.conf'
Adjust LGS range by telescope altitude 4145m.
Zenith angle is 30 degree.
    Scaling turbulence height and LGS hs by sec(za).
    Scaling r0 by cos(za)^(3/5).
    Scaling wind speed and LGS signal level by cos(za).
powfs0: Adjusting dx from 0.0078125 to 0.00775. 
powfs0.llt.fsm: f0=0 Hz, LPF ep=0
powfs0.epfsm is set to 0.517618 (auto)
powfs2: Adjusting dx from 0.03125 to 0.0312778. 
powfs2 is TWFS for powfs0
sim.ephi is set to 0.427717 (auto)
sim.eplo is set to 0.427717 (auto)
Warning(parms.c:2296): Layer 1 at 17.3205m is very close to layer 0 at 0m (OK).
Warning(parms.c:2296): Layer 2 at 34.641m is very close to layer 1 at 17.3205m (OK).
Warning(parms.c:2296): Layer 3 at 51.9615m is very close to layer 2 at 34.641m (OK).
dm 0: stroke=30 um is provided in micron.
dm 0: assume ia stroke=2 um is provided in micron.
dm 1: stroke=7 um is provided in micron.
dm 1: assume ia stroke=2 um is provided in micron.
dm 2: stroke=7 um is provided in micron.
dm 2: assume ia stroke=2 um is provided in micron.
Focus blending is not implemented yet for integrated tomography
parms->sim.mffocus is reset to 0
There are 1 valid simulation seeds:  1
Output PSF for 1 directions
Used 449 of 456 supplied keys
Warning(readcfg.c:158): key "dbg.pwfs_flate" is not recognized, value is 0
Warning(readcfg.c:158): key "dbg.pwfs_flatv" is not recognized, value is 0
Warning(readcfg.c:158): key "dbg.pwfs_psx" is not recognized, value is [0 0 0 0]
Warning(readcfg.c:158): key "dbg.pwfs_psy" is not recognized, value is [0 0 0 0]
Warning(readcfg.c:158): key "dbg.pwfs_pupelong" is not recognized, value is 0
Warning(readcfg.c:158): key "dbg.pwfs_raw" is not recognized, value is 0
Warning(readcfg.c:158): key "dbg.pwfs_side" is not recognized, value is 4
[00;00mAperture[00;00m is 11 m with sampling 1/128 m
[00;00mTurbulence at 30 degree zenith angle:[00;00m r0=0.128424m, L0=30m, 14 layers.
    Greenwood freq is 25.1Hz, anisoplanatic angle is 1.58 as
    Sampled 8192x8192 at 1/128m. wind dir is randomized.
    layer 0: ht=      0 m, wt= 0.302, ws=  4.8 m/s
    layer 1: ht=     17 m, wt= 0.154, ws=  5.0 m/s
    layer 2: ht=     35 m, wt= 0.041, ws=  5.4 m/s
    layer 3: ht=     52 m, wt= 0.002, ws=  6.6 m/s
    layer 4: ht=    139 m, wt= 0.021, ws=  6.1 m/s
    layer 5: ht=    231 m, wt= 0.010, ws=  6.1 m/s
    layer 6: ht=    323 m, wt= 0.008, ws=  6.1 m/s
    layer 7: ht=    416 m, wt= 0.005, ws=  6.1 m/s
    layer 8: ht=    508 m, wt= 0.001, ws=  6.1 m/s
    layer 9: ht=    932 m, wt= 0.107, ws=  5.6 m/s
    layer 10: ht=   5022 m, wt= 0.144, ws= 11.1 m/s
    layer 11: ht=   9238 m, wt= 0.093, ws= 19.1 m/s
    layer 12: ht=  13856 m, wt= 0.075, ws=  8.2 m/s
    layer 13: ht=  22518 m, wt= 0.036, ws=  4.8 m/s
[00;00mReconstruction[00;00m: r0=0.128424m L0=30m. 14 layers. use cone coordinate.
    layer 0: ht=      0 m, wt= 0.302
    layer 1: ht=     17 m, wt= 0.154
    layer 2: ht=     35 m, wt= 0.041
    layer 3: ht=     52 m, wt= 0.002
    layer 4: ht=    139 m, wt= 0.021
    layer 5: ht=    231 m, wt= 0.010
    layer 6: ht=    323 m, wt= 0.008
    layer 7: ht=    416 m, wt= 0.005
    layer 8: ht=    508 m, wt= 0.001
    layer 9: ht=    932 m, wt= 0.107
    layer 10: ht=   5022 m, wt= 0.144
    layer 11: ht=   9238 m, wt= 0.093
    layer 12: ht=  13856 m, wt= 0.075
    layer 13: ht=  22518 m, wt= 0.036
[00;00mThere are 3 powfs[00;00m
  powfs0: Order 60, LGS at 99.1 km. Sampling 1/129.032 m. Thres 30%. [00;00mT/T is removed in right hand side in tomography.[00;00m
    CCD image is 25x25 @ 500x500 mas, blur 27% (sigma), 1500Hz, wvl: [ 5.89e-07]
    Gtilt in reconstruction. Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
  powfs1: Order  2, NGS at inf km. Sampling 1/16 m. Thres 30%. 
    Ztilt in reconstruction. Geomtric optics start at 2 with ztilt [00;00m(noisy)[00;00m
  powfs2: Order 20, NGS at inf km. Sampling 1/31.9716 m. Thres 50%. 
    CCD image is 4x4 @ 1500x1500 mas, blur 0% (sigma), 0.015Hz, wvl: [ 7.2e-07]
    Gtilt in reconstruction. Geomtric optics start at 50 with gtilt Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
[00;00mThere are 12 wfs[00;00m
    wfs 0: type 0, at (  30.00,    0.00) arcsec,  99 km, siglev is 41.4818 bkgrnd is 0.1
    wfs 1: type 0, at (  21.21,   21.21) arcsec,  99 km, siglev is 41.4818 bkgrnd is 0.1
    wfs 2: type 0, at (   0.00,   30.00) arcsec,  99 km, siglev is 41.4818 bkgrnd is 0.1
    wfs 3: type 0, at ( -21.21,   21.21) arcsec,  99 km, siglev is 41.4818 bkgrnd is 0.1
    wfs 4: type 0, at ( -30.00,    0.00) arcsec,  99 km, siglev is 41.4818 bkgrnd is 0.1
    wfs 5: type 0, at ( -21.21,  -21.21) arcsec,  99 km, siglev is 41.4818 bkgrnd is 0.1
    wfs 6: type 0, at (   0.00,  -30.00) arcsec,  99 km, siglev is 41.4818 bkgrnd is 0.1
    wfs 7: type 0, at (  21.21,  -21.21) arcsec,  99 km, siglev is 41.4818 bkgrnd is 0.1
    wfs 8: type 1, at (   5.00,    8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 9: type 1, at ( -10.00,    0.00) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 10: type 1, at (   5.00,   -8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 11: type 2, at (   0.00,    0.00) arcsec, inf km, siglev is 4.1558e+06 bkgrnd is 0.001
[00;00mThere are 3 DMs[00;00m
  DM 0 at -0.1km, actuator pitch 0.186m, offset   0, with 30.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 1 at    6km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 2 at   10km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
[00;00mTomography[00;00m is using CG, with [00;00mFourer Domain[00;00m preconditioner, [00;00m12[00;00m iterations, integrated tomo.
[00;00mDM Fitting [00;00mis using CG, with [00;00mNo[00;00m preconditioner, [00;00m10[00;00m iterations
[00;00mThere are 9 fit directions[00;00m
    Fit 0: weight is 0.444, at (   0.00,    0.00) arcsec
    Fit 1: weight is 0.111, at (  15.00,    0.00) arcsec
    Fit 2: weight is 0.111, at (   0.00,   15.00) arcsec
    Fit 3: weight is 0.111, at ( -15.00,    0.00) arcsec
    Fit 4: weight is 0.111, at (   0.00,  -15.00) arcsec
    Fit 5: weight is 0.028, at (  15.00,   15.00) arcsec
    Fit 6: weight is 0.028, at ( -15.00,   15.00) arcsec
    Fit 7: weight is 0.028, at ( -15.00,  -15.00) arcsec
    Fit 8: weight is 0.028, at (  15.00,  -15.00) arcsec
[00;00mThere are 1 evaluation directions[00;00m at sampling 1/128 m.
    Evl 0: weight is 1.000, at (   0.00,    0.00) arcsec
[00;00mSimulation[00;00m start at step 0, end at step 1600, with time step 1/1500s, [00;00mclose loop[00;00m.
After setup_parms:	120.5 MiB.
Warning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid003517/scheduler) failed: Invalid argument. 
CUDA: minimum memory requirement is 0.3GB
GPU 0 is NVIDIA A100-SXM4-40GB with arch 8.0, 38.9GB free, 39.3GB total device memory.
Using GPU 0
Use 1 GPUs for WFS Tomo Fit Evl

*** Preparation started at 2025/02/11 18:43:46 in nid003517. ***

Using OpenMP version 201511 with 128 threads
Reading aperture amplitude map from KECK.fits
Warning(accphi.c:477): 108066 points not covered by input screen
Warning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid003517/scheduler) failed: Invalid argument. 
 ->maos.c:447->setup.c:148->aper.c:74->utils.c:478->accphi.c:478
iwvl 0: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 1: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 2: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 3: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 4: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 5: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 6: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 7: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 8: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
After setup_aper:	344.7 MiB.

[00;00mSetting up powfs 0 geom[00;00m

There are 24 points in each subaperture of 0.186m.
There are 2160 valid subaperture.

[00;00mSetting up powfs 1 geom[00;00m

There are 88 points in each subaperture of 5.5m.
There are 4 valid subaperture.

[00;00mSetting up powfs 2 geom[00;00m

There are 18 points in each subaperture of 0.563m.
There are 236 valid subaperture.
After setup_powfs_init:	439.3 MiB.

[00;00mSetting up reconstructor geometry.[00;00m

PLOC is 123x123, with sampling of 0.09m (square)
    DM 0: grid is 63 x 63
    DM 1: grid is 75 x 75
    DM 2: grid is 81 x 81
FLOC is 123x123, with sampling of 0.09m (not square)
Tomography grid is square:
    layer 0: xloc grid is 216 x 216, sampling is 0.093 m, 46656 points
    layer 1: xloc grid is 216 x 216, sampling is 0.093 m, 46656 points
    layer 2: xloc grid is 216 x 216, sampling is 0.093 m, 46656 points
    layer 3: xloc grid is 216 x 216, sampling is 0.093 m, 46656 points
    layer 4: xloc grid is 216 x 216, sampling is 0.093 m, 46656 points
    layer 5: xloc grid is 216 x 216, sampling is 0.093 m, 46656 points
    layer 6: xloc grid is 216 x 216, sampling is 0.093 m, 46656 points
    layer 7: xloc grid is 216 x 216, sampling is 0.093 m, 46656 points
    layer 8: xloc grid is 216 x 216, sampling is 0.093 m, 46656 points
    layer 9: xloc grid is 216 x 216, sampling is 0.092 m, 46656 points
    layer 10: xloc grid is 216 x 216, sampling is 0.088 m, 46656 points
    layer 11: xloc grid is 216 x 216, sampling is 0.084 m, 46656 points
    layer 12: xloc grid is 216 x 216, sampling is 0.080 m, 46656 points
    layer 13: xloc grid is 216 x 216, sampling is 0.072 m, 46656 points

[00;00mSetting up powfs 0 PO WFS[00;00m

OTF dimension is 48x48 (calculated)
Uplink FWHM (illt 0, iwvl 0) is 0.578423"
Downlink FWHM (illt 0, iwvl 0) is 1.19849"
Generating matched filter for powfs 0
sa index   location       noise equivalent angle
    1076: (  4.8,  -0.2) m, (107.20, 104.30) mas
    1070: (  3.7,  -0.2) m, (114.51, 105.49) mas
    1064: (  2.6,  -0.2) m, (126.83, 106.72) mas
    1058: (  1.5,  -0.2) m, (143.37, 107.77) mas
    1057: (  1.3,  -0.2) m, (145.72, 107.91) mas
     732: ( -0.6,  -1.5) m, (169.35, 112.11) mas
    1053: ( -1.7,  -0.2) m, (179.95, 110.22) mas
    1047: ( -2.8,  -0.2) m, (194.46, 111.10) mas
    1041: ( -3.9,  -0.2) m, (211.28, 111.98) mas
    1035: ( -5.0,  -0.2) m, (228.27, 112.89) mas
    1033: ( -5.4,  -0.2) m, (233.50, 113.17) mas
sa index   location       noise equivalent angle
    1764: (  2.6,   2.6) m, (110.53, 110.53) mas
    1587: (  1.9,   1.9) m, (120.70, 120.11) mas
    1384: (  1.1,   1.1) m, (124.39, 124.39) mas
    1333: (  0.9,   0.9) m, (126.22, 126.22) mas
     787: (  0.6,  -1.3) m, (131.10, 155.23) mas
     778: ( -1.3,  -1.3) m, (153.48, 153.48) mas
     575: ( -2.0,  -2.0) m, (167.54, 167.30) mas
     398: ( -2.8,  -2.8) m, (170.87, 170.87) mas
     270: ( -3.3,  -3.3) m, (177.38, 177.38) mas
      94: ( -3.0,  -4.3) m, (173.35, 189.64) mas
sa index   location       noise equivalent angle
    1984: (  0.0,   3.7) m, (107.62, 116.58) mas
    1750: (  0.0,   2.6) m, (108.88, 129.19) mas
    1478: (  0.0,   1.5) m, (109.96, 146.15) mas
    1428: (  0.0,   1.3) m, (110.10, 148.56) mas
     962: (  1.3,  -0.6) m, (112.11, 169.35) mas
     684: ( -0.2,  -1.7) m, (118.69, 191.99) mas
     413: (  0.0,  -2.8) m, (113.41, 198.34) mas
     178: (  0.0,  -3.9) m, (114.32, 215.56) mas
      75: ( -0.2,  -4.5) m, (121.21, 235.39) mas
sa index   location       noise equivalent angle
    1735: ( -2.8,   2.6) m, (110.53, 110.53) mas
    1566: ( -2.0,   1.9) m, (121.26, 120.86) mas
    1371: ( -1.3,   1.1) m, (124.39, 124.39) mas
    1328: ( -1.1,   0.9) m, (126.22, 126.22) mas
     781: ( -0.7,  -1.3) m, (131.10, 155.23) mas
     790: (  1.1,  -1.3) m, (153.48, 153.48) mas
     596: (  1.9,  -2.0) m, (166.76, 166.29) mas
     427: (  2.6,  -2.8) m, (170.87, 170.87) mas
     305: (  3.2,  -3.3) m, (177.38, 177.38) mas
     125: (  2.8,  -4.3) m, (173.35, 189.64) mas
sa index   location       noise equivalent angle
    1035: ( -5.0,  -0.2) m, (107.20, 104.30) mas
    1041: ( -3.9,  -0.2) m, (114.51, 105.49) mas
    1047: ( -2.8,  -0.2) m, (126.83, 106.72) mas
    1053: ( -1.7,  -0.2) m, (143.37, 107.77) mas
    1054: ( -1.5,  -0.2) m, (145.72, 107.91) mas
     737: (  0.4,  -1.5) m, (169.35, 112.11) mas
    1058: (  1.5,  -0.2) m, (179.95, 110.22) mas
    1064: (  2.6,  -0.2) m, (194.46, 111.10) mas
    1070: (  3.7,  -0.2) m, (211.28, 111.98) mas
    1076: (  4.8,  -0.2) m, (228.27, 112.89) mas
    1078: (  5.2,  -0.2) m, (233.50, 113.17) mas
sa index   location       noise equivalent angle
     270: ( -3.3,  -3.3) m, (107.08, 107.08) mas
     441: ( -2.6,  -2.6) m, (111.92, 111.92) mas
     625: ( -1.9,  -1.9) m, (118.44, 118.44) mas
     828: ( -1.1,  -1.1) m, (126.22, 126.22) mas
    1374: ( -0.7,   1.1) m, (131.10, 155.23) mas
    1333: (  0.9,   0.9) m, (151.29, 151.29) mas
    1435: (  1.3,   1.3) m, (155.49, 155.49) mas
    1634: (  2.0,   2.0) m, (173.58, 176.35) mas
    1807: (  2.8,   2.8) m, (173.20, 173.20) mas
    2067: (  2.8,   4.1) m, (173.35, 189.64) mas
sa index   location       noise equivalent angle
     178: (  0.0,  -3.9) m, (107.62, 116.58) mas
     413: (  0.0,  -2.8) m, (108.88, 129.19) mas
     685: (  0.0,  -1.7) m, (109.96, 146.15) mas
     735: (  0.0,  -1.5) m, (110.10, 148.56) mas
    1200: (  1.3,   0.4) m, (112.11, 169.35) mas
    1477: ( -0.2,   1.5) m, (118.69, 191.99) mas
    1750: (  0.0,   2.6) m, (113.41, 198.34) mas
    1984: (  0.0,   3.7) m, (114.32, 215.56) mas
    2086: (  0.0,   4.3) m, (114.80, 224.68) mas
sa index   location       noise equivalent angle
     305: (  3.2,  -3.3) m, (107.08, 107.08) mas
     468: (  2.4,  -2.6) m, (111.92, 111.92) mas
     644: (  1.7,  -1.9) m, (118.44, 118.44) mas
     832: (  0.9,  -1.1) m, (126.22, 126.22) mas
    1381: (  0.6,   1.1) m, (131.10, 155.23) mas
    1328: ( -1.1,   0.9) m, (151.29, 151.29) mas
    1420: ( -1.5,   1.3) m, (155.49, 155.49) mas
    1611: ( -2.2,   2.0) m, (173.21, 175.42) mas
    1776: ( -3.0,   2.8) m, (173.20, 173.20) mas
    2036: ( -3.0,   4.1) m, (173.35, 189.64) mas

[00;00mSetting up powfs 2 PO WFS[00;00m

OTF dimension is 48x48 (calculated)
Generating matched filter for powfs 2
Use sanea to derive neasim
Use sanea to derive neasim

[00;00mSetting up reconstructor[00;00m

Recon NEA: cmf(146.64) cmf(147.06) cmf(146.65) cmf(147.00) cmf(146.56) cmf(146.93) cmf(146.54) cmf(146.98) geom(0.31) geom(0.31) geom(0.31) mf(0.14)  mas
Setup or update control matrix parameters.
RRtwfs svd threshold is 1e-10
Replacing HA by HA*fit->actextrap
Adding piston cr to fit matrix
Adding TT cr on upper DMs to fit matrix.
Before assembling fit matrix:	3777.6 MiB.
Building fit->FR
Building fit->FL
Adding tikhonov constraint of 1.0e-07 to FLM
The maximum eigen value is estimated to be around 3.1e-04
DM Fit number of Low rank terms: 16 in LHS
After assemble fit matrix:	5030.8 MiB.
After setup_recon:	5030.8 MiB.
GPU 0: mem used 1656 MB (wfs init)
GPU 0: mem used 2446 MB (recon init)
GPU 0: mem used 2476 MB (perf init)

*** Simulation started at 2025/02/11 18:44:48 in nid003517. ***

Running seed 1
GPU 0: mem used 2476 MB (wfs seeding)
Wind dir: 267.3 261.7 167.0 130.5 300.7  32.3 119.8 139.0 150.8 277.7 203.0 133.1  45.9 265.1 deg
Using /global/homes/b/bpeck/.aos/cache/atm/vonkarman_14_8192x8192_0.0078125_1115374592d.bin
After genatm:	5032.9 MiB.
Step     #  Open Loop  PR TT  On axis  PR TT  Field RMS PR TT     Timing 
Step     0: OL  884.6  248.3  OA  884.6 248.3 CL  884.6 248.3 nm  0.086 s
Step    20: OL  916.1  255.8  OA  116.3  11.8 CL  116.3  11.8 nm  0.057 s
Step    38: OL  944.3  260.2  OA  111.6  16.4 CL  111.6  16.4 nm  0.056 s
Step    55: OL  969.6  261.0  OA  110.0  14.4 CL  110.0  14.4 nm  0.056 s
Step    73: OL  996.6  259.3  OA  112.9   2.7 CL  112.9   2.7 nm  0.057 s
Step    91: OL 1024.1  257.8  OA  113.9  15.9 CL  113.9  15.9 nm  0.056 s
Step   108: OL 1049.9  257.4  OA  111.6   7.3 CL  111.6   7.3 nm  0.058 s
Step   125: OL 1075.3  259.0  OA  109.5   8.7 CL  109.5   8.7 nm  0.070 s
Step   143: OL 1099.9  264.3  OA  111.7  24.1 CL  111.7  24.1 nm  0.056 s
Step   160: OL 1120.0  271.9  OA  112.9  12.4 CL  112.9  12.4 nm  0.068 s
Step   176: OL 1135.5  281.2  OA  113.0   1.1 CL  113.0   1.1 nm  0.062 s
Step   194: OL 1147.9  292.8  OA  114.6  17.6 CL  114.6  17.6 nm  0.057 s
Step   212: OL 1156.1  304.3  OA  107.3  13.9 CL  107.3  13.9 nm  0.057 s
Step   230: OL 1159.9  316.0  OA  109.3  26.6 CL  109.3  26.6 nm  0.063 s
Step   248: OL 1158.8  328.3  OA  108.9  16.2 CL  108.9  16.2 nm  0.056 s
Step   255 updated high order loop gain: 0.373
Step   266: OL 1150.7  341.2  OA  105.4  12.6 CL  105.4  12.6 nm  0.058 s
Step   283: OL 1137.0  353.7  OA  111.2  20.4 CL  111.2  20.4 nm  0.056 s
Step   300: OL 1119.7  368.0  OA  111.7  27.1 CL  111.7  27.1 nm  0.056 s
Step   317: OL 1100.0  383.7  OA  112.1  18.5 CL  112.1  18.5 nm  0.069 s
Step   335: OL 1077.1  402.6  OA  114.5  28.7 CL  114.5  28.7 nm  0.056 s
Step   351: OL 1056.6  422.2  OA  112.4  27.1 CL  112.4  27.1 nm  0.065 s
Step   368: OL 1036.0  445.7  OA  106.5   9.8 CL  106.5   9.8 nm  0.055 s
Step   386: OL 1016.0  471.6  OA  110.0  11.5 CL  110.0  11.5 nm  0.067 s
Step   404: OL  996.9  497.5  OA  106.6  10.8 CL  106.6  10.8 nm  0.057 s
Step   421: OL  978.2  520.9  OA  108.5   2.4 CL  108.5   2.4 nm  0.067 s
Step   438: OL  959.6  543.5  OA  110.1  14.7 CL  110.1  14.7 nm  0.057 s
Step   456: OL  942.4  566.9  OA  112.7  20.6 CL  112.7  20.6 nm  0.060 s
Step   473: OL  931.5  589.0  OA  110.0  20.7 CL  110.0  20.7 nm  0.056 s
Step   491: OL  927.3  611.5  OA  111.3  20.6 CL  111.3  20.6 nm  0.056 s
Step 492, DM 1: 1 actuators over ia limit. trials=2: success.
Step 498, DM 1: 1 actuators over ia limit. trials=2: success.
Step 499, DM 1: 1 actuators over ia limit. trials=2: success.
Step 500, DM 1: 1 actuators over ia limit. trials=2: success.
Step   508: OL  928.6  631.0  OA  117.4  23.0 CL  117.4  23.0 nm  0.056 s
Step   511 updated high order loop gain: 0.347
Step 511, DM 1: 1 actuators over ia limit. trials=2: success.
Step 512, DM 1: 1 actuators over ia limit. trials=2: success.
Step 513, DM 1: 1 actuators over ia limit. trials=2: success.
Step 514, DM 1: 1 actuators over ia limit. trials=2: success.
Step 515, DM 1: 1 actuators over ia limit. trials=2: success.
Step 516, DM 1: 1 actuators over ia limit. trials=2: success.
Step 517, DM 1: 1 actuators over ia limit. trials=2: success.
Step 518, DM 1: 1 actuators over ia limit. trials=2: success.
Step 519, DM 1: 1 actuators over ia limit. trials=2: success.
Step 520, DM 1: 1 actuators over ia limit. trials=2: success.
Step 521, DM 1: 1 actuators over ia limit. trials=2: success.
Step 522, DM 1: 1 actuators over ia limit. trials=2: success.
Step   523: OL  932.9  645.7  OA  115.7  26.8 CL  115.7  26.8 nm  0.056 s
Step 523, DM 1: 1 actuators over ia limit. trials=2: success.
Step 524, DM 1: 1 actuators over ia limit. trials=2: success.
Step 525, DM 1: 1 actuators over ia limit. trials=2: success.
Step 526, DM 1: 1 actuators over ia limit. trials=2: success.
Step 527, DM 1: 1 actuators over ia limit. trials=2: success.
Step 528, DM 1: 1 actuators over ia limit. trials=2: success.
Step 529, DM 1: 1 actuators over ia limit. trials=2: success.
Step 530, DM 1: 1 actuators over ia limit. trials=2: success.
Step 531, DM 1: 1 actuators over ia limit. trials=2: success.
Step 532, DM 1: 1 actuators over ia limit. trials=2: success.
Step 533, DM 1: 1 actuators over ia limit. trials=2: success.
Step 534, DM 1: 1 actuators over ia limit. trials=2: success.
Step 535, DM 1: 1 actuators over ia limit. trials=2: success.
Step 536, DM 1: 1 actuators over ia limit. trials=2: success.
Step 537, DM 1: 1 actuators over ia limit. trials=2: success.
Step 538, DM 1: 1 actuators over ia limit. trials=2: success.
Step 539, DM 1: 1 actuators over ia limit. trials=2: success.
Step   540: OL  940.7  658.0  OA  108.6   9.6 CL  108.6   9.6 nm  0.066 s
Step 540, DM 1: 1 actuators over ia limit. trials=2: success.
Step 541, DM 1: 1 actuators over ia limit. trials=2: success.
Step 542, DM 1: 1 actuators over ia limit. trials=2: success.
Step 543, DM 1: 1 actuators over ia limit. trials=2: success.
Step 544, DM 1: 1 actuators over ia limit. trials=2: success.
Step 545, DM 1: 1 actuators over ia limit. trials=2: success.
Step 546, DM 1: 1 actuators over ia limit. trials=2: success.
Step 547, DM 1: 1 actuators over ia limit. trials=2: success.
Step 548, DM 1: 1 actuators over ia limit. trials=2: success.
Step 549, DM 1: 1 actuators over ia limit. trials=2: success.
Step 550, DM 1: 1 actuators over ia limit. trials=2: success.
Step 551, DM 1: 1 actuators over ia limit. trials=2: success.
Step 552, DM 1: 1 actuators over ia limit. trials=2: success.
Step   558: OL  953.1  666.2  OA  111.0  20.9 CL  111.0  20.9 nm  0.056 s
Step   575: OL  967.9  669.9  OA  108.1  15.6 CL  108.1  15.6 nm  0.068 s
Step   593: OL  986.7  670.2  OA  105.3  10.9 CL  105.3  10.9 nm  0.058 s
Step   610: OL 1006.2  665.7  OA  104.7  19.5 CL  104.7  19.5 nm  0.061 s
Step   627: OL 1026.1  656.7  OA  107.2  22.4 CL  107.2  22.4 nm  0.057 s
Step   645: OL 1046.0  643.0  OA  107.7   6.1 CL  107.7   6.1 nm  0.058 s
Step   662: OL 1062.5  627.1  OA  107.4  11.5 CL  107.4  11.5 nm  0.056 s
Step   679: OL 1077.6  609.5  OA  105.7   6.8 CL  105.7   6.8 nm  0.091 s
Step   696: OL 1091.2  591.4  OA  106.8   9.8 CL  106.8   9.8 nm  0.068 s
Step   714: OL 1101.6  570.1  OA  108.7  15.3 CL  108.7  15.3 nm  0.057 s
Step   732: OL 1106.6  547.8  OA  107.0  10.2 CL  107.0  10.2 nm  0.067 s
Step   750: OL 1105.8  525.6  OA  108.3   2.5 CL  108.3   2.5 nm  0.056 s
Step   767: OL 1100.0  505.7  OA  113.1  22.3 CL  113.1  22.3 nm  0.072 s
Step   767 updated high order loop gain: 0.337
Step   784: OL 1089.3  486.4  OA  110.1  12.4 CL  110.1  12.4 nm  0.055 s
Step   801: OL 1073.1  467.4  OA  107.9   5.9 CL  107.9   5.9 nm  0.063 s
Step   818: OL 1052.8  448.5  OA  109.3  15.8 CL  109.3  15.8 nm  0.055 s
Step   836: OL 1026.9  428.8  OA  110.0  16.0 CL  110.0  16.0 nm  0.057 s
Step   853: OL 1000.1  411.6  OA  109.8   3.0 CL  109.8   3.0 nm  0.064 s
Step   870: OL  973.1  396.3  OA  106.1   7.8 CL  106.1   7.8 nm  0.055 s
Step   887: OL  947.7  383.5  OA  108.5  12.9 CL  108.5  12.9 nm  0.066 s
Step   905: OL  919.7  372.0  OA  103.9   5.6 CL  103.9   5.6 nm  0.054 s
Step   922: OL  892.0  363.4  OA  103.2   7.8 CL  103.2   7.8 nm  0.065 s
Step   940: OL  863.3  354.9  OA  105.3  20.4 CL  105.3  20.4 nm  0.056 s
Step   958: OL  836.5  346.0  OA  103.6   5.9 CL  103.6   5.9 nm  0.065 s
Step   975: OL  815.2  336.4  OA  103.7  10.6 CL  103.7  10.6 nm  0.057 s
Step   993: OL  796.3  324.7  OA  106.6  13.3 CL  106.6  13.3 nm  0.056 s
Step  1010: OL  780.6  312.1  OA  105.1   2.9 CL  105.1   2.9 nm  0.055 s
Step  1023 updated high order loop gain: 0.333
Step  1026: OL  768.5  299.8  OA  107.6   8.4 CL  107.6   8.4 nm  0.056 s
Step  1044: OL  757.6  284.8  OA  111.6  18.3 CL  111.6  18.3 nm  0.055 s
Step  1062: OL  747.6  268.1  OA  109.1   9.9 CL  109.1   9.9 nm  0.056 s
Step  1080: OL  740.1  248.3  OA  109.0  11.8 CL  109.0  11.8 nm  0.057 s
Step  1098: OL  736.9  227.6  OA  111.4  17.4 CL  111.4  17.4 nm  0.056 s
Step  1115: OL  736.4  210.1  OA  114.6  32.6 CL  114.6  32.6 nm  0.056 s
Step  1132: OL  737.3  195.4  OA  109.2  23.4 CL  109.2  23.4 nm  0.058 s
Step  1149: OL  738.8  184.0  OA  108.4  23.4 CL  108.4  23.4 nm  0.069 s
Step  1167: OL  740.0  175.4  OA  107.2  29.9 CL  107.2  29.9 nm  0.056 s
Step  1185: OL  742.3  170.4  OA  105.8   6.8 CL  105.8   6.8 nm  0.066 s
Step  1201: OL  745.8  167.0  OA  106.6  19.0 CL  106.6  19.0 nm  0.054 s
Step  1219: OL  749.6  164.3  OA  109.6  27.2 CL  109.6  27.2 nm  0.057 s
Step  1237: OL  752.3  164.1  OA  106.1  16.7 CL  106.1  16.7 nm  0.057 s
Step  1255: OL  754.0  167.8  OA  104.2  11.3 CL  104.2  11.3 nm  0.055 s
Step  1272: OL  756.6  175.0  OA  108.0  28.3 CL  108.0  28.3 nm  0.057 s
Step  1279 updated high order loop gain: 0.326
Step  1290: OL  761.2  185.3  OA  110.4  31.1 CL  110.4  31.1 nm  0.058 s
Step  1307: OL  766.3  196.9  OA  112.8  33.3 CL  112.8  33.3 nm  0.058 s
Step  1324: OL  771.3  210.2  OA  109.8  28.2 CL  109.8  28.2 nm  0.057 s
Step  1341: OL  778.0  225.3  OA  105.4  29.7 CL  105.4  29.7 nm  0.066 s
Step  1359: OL  788.4  241.4  OA  106.9  26.0 CL  106.9  26.0 nm  0.056 s
Step  1377: OL  801.1  254.5  OA  107.1  29.6 CL  107.1  29.6 nm  0.063 s
Step  1395: OL  816.0  264.3  OA  106.2  19.0 CL  106.2  19.0 nm  0.059 s
Step  1413: OL  833.6  270.7  OA  104.3  11.1 CL  104.3  11.1 nm  0.064 s
Step  1430: OL  851.5  274.9  OA  106.1  17.8 CL  106.1  17.8 nm  0.054 s
Step  1447: OL  868.6  278.1  OA  104.5  13.6 CL  104.5  13.6 nm  0.071 s
Step  1464: OL  884.2  279.5  OA  104.6   8.0 CL  104.6   8.0 nm  0.056 s
Step  1481: OL  895.4  278.0  OA  102.2   8.6 CL  102.2   8.6 nm  0.059 s
Step  1499: OL  900.6  273.2  OA  103.3   5.4 CL  103.3   5.4 nm  0.055 s
Step  1517: OL  900.0  265.4  OA  103.5   3.5 CL  103.5   3.5 nm  0.072 s
Step  1534: OL  895.3  256.2  OA  102.1  14.0 CL  102.1  14.0 nm  0.056 s
Step  1535 updated high order loop gain: 0.323
Step  1552: OL  886.6  244.5  OA  102.6  12.0 CL  102.6  12.0 nm  0.065 s
Step  1569: OL  877.4  233.6  OA  107.6  13.4 CL  107.6  13.4 nm  0.057 s
Step  1587: OL  866.3  224.2  OA  106.4  11.6 CL  106.4  11.6 nm  0.061 s
Step 1599: Output PSF
Step  1599: OL  858.1  219.2  OA  103.0   4.7 CL  103.0   4.7 nm  2.558 s
Mean: 107.73 17.47 106.30  nm.

*** Simulation Finished at 2025/02/11 18:46:34 in nid003517. ***

