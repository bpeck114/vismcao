Warning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid003517/scheduler) failed: Invalid argument. 
/global/u2/b/bpeck/work/vismcao/maos -o studies/reduced_ngs/8_lgs/8mag_lgs/4750count -c master_files/reduced_ngs/8_lgs/8mag_lgs/kola_4750act.conf -O 
Output folder is 'studies/reduced_ngs/8_lgs/8mag_lgs/4750count'.
SRC: /global/homes/b/bpeck/code/maos v2.9 4c88b7c2 2024-11-13 16:45:33 -0800
BUILT: /global/homes/b/bpeck/code/maos/optim by GCC (v12) on 2024/11/18 09:40:03 CPU(F64,+O3) with CUDA(v122,F32)
Launched at 2025/02/11 19:10:39 in nid003517 with PID 1951506.
The web based job monitor can be accessed at http://localhost:10300
Main config file is /global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/8_lgs/8mag_lgs/kola_4750act.conf
Warning(path.c:48): Path not found: path=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/8_lgs/8mag_lgs/bin; abspath=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/8_lgs/8mag_lgs/bin; Ignored.
Warning(path.c:48): Path not found: path=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/8_lgs/8mag_lgs/atm; abspath=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/8_lgs/8mag_lgs/atm; Ignored.
Warning(readcfg.c:399): sim.apfsm has been renamed to powfs.apfsm.
Warning(readcfg.c:399): sim.epfsm has been renamed to powfs.epfsm.
Warning(readcfg.c:399): sim.alfsm has been renamed to powfs.alfsm.
Warning(readcfg.c:399): sim.commonfsm has been renamed to powfs.commonfsm.
Warning(readcfg.c:399): sim.idealfsm has been renamed to powfs.idealfsm.
Warning(readcfg.c:399): sim.zetafsm has been renamed to powfs.zetafsm.
Warning(readcfg.c:399): sim.f0fsm has been renamed to powfs.f0fsm.
Warning(readcfg.c:399): tsurf has been renamed to ncpa.tsurf.
loaded 132 (132 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_sim.conf'
loaded  19 ( 19 new) records from '/global/u2/b/bpeck/work/vismcao/./dm_none.conf'
loaded  19 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_ASM.conf'
loaded  19 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_DM2.conf'
loaded  19 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_DM3.conf'
loaded   0 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_dm_multiple.conf'
loaded   7 (  5 new) records from '/global/u2/b/bpeck/work/vismcao/./atm_mk13n50p_ground_detail.conf'
loaded  76 ( 69 new) records from '/global/homes/b/bpeck/code/maos/config/maos/powfs_common.conf'
loaded  44 ( 38 new) records from '/global/u2/b/bpeck/work/vismcao/./powfs_none.conf'
loaded  44 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_shwfs_lgs.conf'
loaded  44 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_shwfs_ttf_strap.conf'
loaded  44 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_shwfs_twfs_lbwfs.conf'
loaded   0 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_wfs_lgs_strap_lbwfs.conf'
loaded  71 ( 71 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_recon.conf'
Warning(readcfg.c:399): dbg.na_smooth has been renamed to powfs0_llt.na_smooth.
Warning(readcfg.c:399): dbg.na_interp has been renamed to powfs0_llt.na_interp.
Warning(readcfg.c:399): dbg.na_thres has been renamed to powfs0_llt.na_thres.
Warning(readcfg.c:399): dbg.na_fit_maxit has been renamed to powfs0_llt.na_fit_maxit.
Warning(readcfg.c:399): dbg.na_fit_svdthres has been renamed to powfs0_llt.na_fit_svdthres.
Warning(readcfg.c:399): dbg.na_fit_dh has been renamed to powfs0_llt.na_fit_dh.
Warning(readcfg.c:399): dbg.ncpa_preload has been renamed to ncpa.preload.
Warning(readcfg.c:399): dbg.ncpa_rmsci has been renamed to ncpa.rmsci.
Warning(readcfg.c:399): dbg.draw_opdmax has been renamed to plot.opdmax.
Warning(readcfg.c:399): dbg.draw_gmax has been renamed to plot.gmax.
loaded  95 ( 93 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_dbg.conf'
loaded   4 (  4 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_fit_mcao.conf'
Warning(readcfg.c:399): surf has been renamed to ncpa.surf.
loaded  39 (  7 new) records from '/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/8_lgs/8mag_lgs/kola_4750act.conf'
loaded   0 (  0 new) records from 'command line'
loaded  24 ( 18 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_llt_CL.conf'
Adjust LGS range by telescope altitude 4145m.
Zenith angle is 30 degree.
    Scaling turbulence height and LGS hs by sec(za).
    Scaling r0 by cos(za)^(3/5).
    Scaling wind speed and LGS signal level by cos(za).
powfs0: Adjusting dx from 0.0078125 to 0.00783333. 
powfs0.llt.fsm: f0=0 Hz, LPF ep=0
powfs0.epfsm is set to 0.517618 (auto)
powfs2: Adjusting dx from 0.03125 to 0.0312778. 
powfs2 is TWFS for powfs0
sim.ephi is set to 0.427717 (auto)
sim.eplo is set to 0.427717 (auto)
Warning(parms.c:2296): Layer 1 at 17.3205m is very close to layer 0 at 0m (OK).
Warning(parms.c:2296): Layer 2 at 34.641m is very close to layer 1 at 17.3205m (OK).
Warning(parms.c:2296): Layer 3 at 51.9615m is very close to layer 2 at 34.641m (OK).
dm 0: stroke=30 um is provided in micron.
dm 0: assume ia stroke=2 um is provided in micron.
dm 1: stroke=7 um is provided in micron.
dm 1: assume ia stroke=2 um is provided in micron.
dm 2: stroke=7 um is provided in micron.
dm 2: assume ia stroke=2 um is provided in micron.
Focus blending is not implemented yet for integrated tomography
parms->sim.mffocus is reset to 0
There are 1 valid simulation seeds:  1
Output PSF for 1 directions
Used 449 of 456 supplied keys
Warning(readcfg.c:158): key "dbg.pwfs_flate" is not recognized, value is 0
Warning(readcfg.c:158): key "dbg.pwfs_flatv" is not recognized, value is 0
Warning(readcfg.c:158): key "dbg.pwfs_psx" is not recognized, value is [0 0 0 0]
Warning(readcfg.c:158): key "dbg.pwfs_psy" is not recognized, value is [0 0 0 0]
Warning(readcfg.c:158): key "dbg.pwfs_pupelong" is not recognized, value is 0
Warning(readcfg.c:158): key "dbg.pwfs_raw" is not recognized, value is 0
Warning(readcfg.c:158): key "dbg.pwfs_side" is not recognized, value is 4
[00;00mAperture[00;00m is 11 m with sampling 1/128 m
[00;00mTurbulence at 30 degree zenith angle:[00;00m r0=0.128424m, L0=30m, 14 layers.
    Greenwood freq is 25.1Hz, anisoplanatic angle is 1.58 as
    Sampled 8192x8192 at 1/128m. wind dir is randomized.
    layer 0: ht=      0 m, wt= 0.302, ws=  4.8 m/s
    layer 1: ht=     17 m, wt= 0.154, ws=  5.0 m/s
    layer 2: ht=     35 m, wt= 0.041, ws=  5.4 m/s
    layer 3: ht=     52 m, wt= 0.002, ws=  6.6 m/s
    layer 4: ht=    139 m, wt= 0.021, ws=  6.1 m/s
    layer 5: ht=    231 m, wt= 0.010, ws=  6.1 m/s
    layer 6: ht=    323 m, wt= 0.008, ws=  6.1 m/s
    layer 7: ht=    416 m, wt= 0.005, ws=  6.1 m/s
    layer 8: ht=    508 m, wt= 0.001, ws=  6.1 m/s
    layer 9: ht=    932 m, wt= 0.107, ws=  5.6 m/s
    layer 10: ht=   5022 m, wt= 0.144, ws= 11.1 m/s
    layer 11: ht=   9238 m, wt= 0.093, ws= 19.1 m/s
    layer 12: ht=  13856 m, wt= 0.075, ws=  8.2 m/s
    layer 13: ht=  22518 m, wt= 0.036, ws=  4.8 m/s
[00;00mReconstruction[00;00m: r0=0.128424m L0=30m. 14 layers. use cone coordinate.
    layer 0: ht=      0 m, wt= 0.302
    layer 1: ht=     17 m, wt= 0.154
    layer 2: ht=     35 m, wt= 0.041
    layer 3: ht=     52 m, wt= 0.002
    layer 4: ht=    139 m, wt= 0.021
    layer 5: ht=    231 m, wt= 0.010
    layer 6: ht=    323 m, wt= 0.008
    layer 7: ht=    416 m, wt= 0.005
    layer 8: ht=    508 m, wt= 0.001
    layer 9: ht=    932 m, wt= 0.107
    layer 10: ht=   5022 m, wt= 0.144
    layer 11: ht=   9238 m, wt= 0.093
    layer 12: ht=  13856 m, wt= 0.075
    layer 13: ht=  22518 m, wt= 0.036
[00;00mThere are 3 powfs[00;00m
  powfs0: Order 79, LGS at 99.1 km. Sampling 1/127.66 m. Thres 30%. [00;00mT/T is removed in right hand side in tomography.[00;00m
    CCD image is 25x25 @ 500x500 mas, blur 27% (sigma), 1500Hz, wvl: [ 5.89e-07]
    Gtilt in reconstruction. Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
  powfs1: Order  2, NGS at inf km. Sampling 1/16 m. Thres 30%. 
    Ztilt in reconstruction. Geomtric optics start at 2 with ztilt [00;00m(noisy)[00;00m
  powfs2: Order 20, NGS at inf km. Sampling 1/31.9716 m. Thres 50%. 
    CCD image is 4x4 @ 1500x1500 mas, blur 0% (sigma), 0.015Hz, wvl: [ 7.2e-07]
    Gtilt in reconstruction. Geomtric optics start at 50 with gtilt Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
[00;00mThere are 12 wfs[00;00m
    wfs 0: type 0, at (  30.00,    0.00) arcsec,  99 km, siglev is 23.8382 bkgrnd is 0.1
    wfs 1: type 0, at (  21.21,   21.21) arcsec,  99 km, siglev is 23.8382 bkgrnd is 0.1
    wfs 2: type 0, at (   0.00,   30.00) arcsec,  99 km, siglev is 23.8382 bkgrnd is 0.1
    wfs 3: type 0, at ( -21.21,   21.21) arcsec,  99 km, siglev is 23.8382 bkgrnd is 0.1
    wfs 4: type 0, at ( -30.00,    0.00) arcsec,  99 km, siglev is 23.8382 bkgrnd is 0.1
    wfs 5: type 0, at ( -21.21,  -21.21) arcsec,  99 km, siglev is 23.8382 bkgrnd is 0.1
    wfs 6: type 0, at (   0.00,  -30.00) arcsec,  99 km, siglev is 23.8382 bkgrnd is 0.1
    wfs 7: type 0, at (  21.21,  -21.21) arcsec,  99 km, siglev is 23.8382 bkgrnd is 0.1
    wfs 8: type 1, at (   5.00,    8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 9: type 1, at ( -10.00,    0.00) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 10: type 1, at (   5.00,   -8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 11: type 2, at (   0.00,    0.00) arcsec, inf km, siglev is 4.1558e+06 bkgrnd is 0.001
[00;00mThere are 3 DMs[00;00m
  DM 0 at -0.1km, actuator pitch 0.141m, offset   0, with 30.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 1 at    6km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 2 at   10km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
[00;00mTomography[00;00m is using CG, with [00;00mFourer Domain[00;00m preconditioner, [00;00m12[00;00m iterations, integrated tomo.
[00;00mDM Fitting [00;00mis using CG, with [00;00mNo[00;00m preconditioner, [00;00m10[00;00m iterations
[00;00mThere are 9 fit directions[00;00m
    Fit 0: weight is 0.444, at (   0.00,    0.00) arcsec
    Fit 1: weight is 0.111, at (  15.00,    0.00) arcsec
    Fit 2: weight is 0.111, at (   0.00,   15.00) arcsec
    Fit 3: weight is 0.111, at ( -15.00,    0.00) arcsec
    Fit 4: weight is 0.111, at (   0.00,  -15.00) arcsec
    Fit 5: weight is 0.028, at (  15.00,   15.00) arcsec
    Fit 6: weight is 0.028, at ( -15.00,   15.00) arcsec
    Fit 7: weight is 0.028, at ( -15.00,  -15.00) arcsec
    Fit 8: weight is 0.028, at (  15.00,  -15.00) arcsec
[00;00mThere are 1 evaluation directions[00;00m at sampling 1/128 m.
    Evl 0: weight is 1.000, at (   0.00,    0.00) arcsec
[00;00mSimulation[00;00m start at step 0, end at step 1600, with time step 1/1500s, [00;00mclose loop[00;00m.
After setup_parms:	120.5 MiB.
Warning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid003517/scheduler) failed: Invalid argument. 
CUDA: minimum memory requirement is 0.3GB
GPU 0 is NVIDIA A100-SXM4-40GB with arch 8.0, 38.9GB free, 39.3GB total device memory.
Using GPU 0
Use 1 GPUs for WFS Tomo Fit Evl

*** Preparation started at 2025/02/11 19:10:39 in nid003517. ***

Using OpenMP version 201511 with 128 threads
Reading aperture amplitude map from KECK.fits
Warning(accphi.c:477): 108016 points not covered by input screen
Warning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid003517/scheduler) failed: Invalid argument. 
 ->maos.c:447->setup.c:148->aper.c:74->utils.c:478->accphi.c:478
iwvl 0: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 1: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 2: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 3: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 4: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 5: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 6: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 7: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 8: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
After setup_aper:	344.7 MiB.

[00;00mSetting up powfs 0 geom[00;00m

There are 18 points in each subaperture of 0.141m.
There are 3737 valid subaperture.

[00;00mSetting up powfs 1 geom[00;00m

There are 88 points in each subaperture of 5.5m.
There are 4 valid subaperture.

[00;00mSetting up powfs 2 geom[00;00m

There are 18 points in each subaperture of 0.563m.
There are 236 valid subaperture.
After setup_powfs_init:	441.5 MiB.

[00;00mSetting up reconstructor geometry.[00;00m

PLOC is 161x161, with sampling of 0.07m (square)
    DM 0: grid is 82 x 82
    DM 1: grid is 75 x 75
    DM 2: grid is 81 x 81
FLOC is 161x161, with sampling of 0.07m (not square)
Tomography grid is square:
    layer 0: xloc grid is 280 x 280, sampling is 0.070 m, 78400 points
    layer 1: xloc grid is 280 x 280, sampling is 0.070 m, 78400 points
    layer 2: xloc grid is 280 x 280, sampling is 0.070 m, 78400 points
    layer 3: xloc grid is 280 x 280, sampling is 0.070 m, 78400 points
    layer 4: xloc grid is 280 x 280, sampling is 0.070 m, 78400 points
    layer 5: xloc grid is 280 x 280, sampling is 0.070 m, 78400 points
    layer 6: xloc grid is 280 x 280, sampling is 0.070 m, 78400 points
    layer 7: xloc grid is 280 x 280, sampling is 0.070 m, 78400 points
    layer 8: xloc grid is 280 x 280, sampling is 0.070 m, 78400 points
    layer 9: xloc grid is 280 x 280, sampling is 0.070 m, 78400 points
    layer 10: xloc grid is 280 x 280, sampling is 0.067 m, 78400 points
    layer 11: xloc grid is 280 x 280, sampling is 0.064 m, 78400 points
    layer 12: xloc grid is 280 x 280, sampling is 0.061 m, 78400 points
Warning(map.c:195): ninx=280 is too small. need 281
Warning(map.c:200): niny=280 is too small. need 281
    layer 13: xloc grid is 280 x 280, sampling is 0.054 m, 78400 points

[00;00mSetting up powfs 0 PO WFS[00;00m

OTF dimension is 36x36 (calculated)
Uplink FWHM (illt 0, iwvl 0) is 0.580741"
Downlink FWHM (illt 0, iwvl 0) is 1.39318"
Generating matched filter for powfs 0
sa index   location       noise equivalent angle
    1838: (  4.9,  -0.2) m, (171.58, 164.44) mas
    1830: (  3.7,  -0.2) m, (184.57, 166.46) mas
    1822: (  2.6,  -0.2) m, (201.52, 169.12) mas
    1815: (  1.6,  -0.2) m, (217.71, 171.66) mas
    1813: (  1.3,  -0.2) m, (222.81, 172.45) mas
    1334: ( -0.5,  -1.3) m, (253.63, 181.08) mas
    1808: ( -1.8,  -0.2) m, (274.68, 180.73) mas
    1800: ( -2.9,  -0.2) m, (294.26, 183.67) mas
    1792: ( -4.0,  -0.2) m, (314.80, 186.52) mas
    1785: ( -5.0,  -0.2) m, (333.93, 188.95) mas
    1782: ( -5.4,  -0.2) m, (342.22, 189.96) mas
sa index   location       noise equivalent angle
    3044: (  2.6,   2.6) m, (175.95, 175.95) mas
    2755: (  1.9,   1.9) m, (192.30, 191.26) mas
    2349: (  1.1,   1.1) m, (197.19, 197.19) mas
    2288: (  0.9,   0.9) m, (199.35, 199.35) mas
    1341: (  0.5,  -1.3) m, (207.69, 236.01) mas
    1396: ( -1.2,  -1.2) m, (234.58, 234.58) mas
     990: ( -2.0,  -2.0) m, (259.61, 257.76) mas
     700: ( -2.7,  -2.7) m, (263.62, 263.62) mas
     422: ( -3.5,  -3.5) m, (282.81, 283.65) mas
     150: ( -3.0,  -4.3) m, (270.34, 294.20) mas
sa index   location       noise equivalent angle
    3435: ( -0.2,   3.7) m, (166.46, 184.57) mas
    3026: (  0.1,   2.6) m, (169.12, 201.52) mas
    2610: (  0.1,   1.6) m, (171.66, 217.71) mas
    2476: (  0.1,   1.3) m, (172.45, 222.81) mas
    1689: ( -1.3,  -0.5) m, (181.08, 253.63) mas
    1137: (  0.1,  -1.8) m, (180.73, 274.68) mas
     665: (  0.1,  -2.9) m, (183.67, 294.26) mas
     262: (  0.1,  -4.0) m, (186.52, 314.80) mas
      80: ( -0.2,  -4.6) m, (194.03, 333.01) mas
sa index   location       noise equivalent angle
    3006: ( -2.7,   2.6) m, (175.95, 175.95) mas
    2727: ( -2.0,   1.9) m, (193.69, 192.13) mas
    2340: ( -1.2,   1.1) m, (197.19, 197.19) mas
    2284: ( -1.1,   0.9) m, (199.35, 199.35) mas
    1333: ( -0.6,  -1.3) m, (207.69, 236.01) mas
    1405: (  1.1,  -1.2) m, (234.58, 234.58) mas
    1018: (  1.9,  -2.0) m, (258.03, 256.51) mas
     738: (  2.6,  -2.7) m, (263.62, 263.62) mas
     470: (  3.3,  -3.5) m, (286.58, 287.70) mas
     192: (  2.9,  -4.3) m, (270.34, 294.20) mas
sa index   location       noise equivalent angle
    1843: ( -5.4,  -0.1) m, (164.71, 163.27) mas
    1847: ( -4.9,  -0.1) m, (172.80, 164.55) mas
    1855: ( -3.7,  -0.1) m, (186.25, 166.63) mas
    1863: ( -2.6,  -0.1) m, (203.64, 169.33) mas
    1871: ( -1.5,  -0.1) m, (222.79, 172.30) mas
    1340: (  0.4,  -1.3) m, (253.60, 181.06) mas
    1874: (  1.3,  -0.1) m, (268.51, 179.59) mas
    1877: (  1.8,  -0.1) m, (277.03, 180.86) mas
    1885: (  2.9,  -0.1) m, (296.66, 183.75) mas
    1893: (  4.0,  -0.1) m, (317.49, 186.58) mas
    1900: (  5.0,  -0.1) m, (336.71, 188.97) mas
sa index   location       noise equivalent angle
     422: ( -3.5,  -3.5) m, (172.48, 173.07) mas
     756: ( -2.6,  -2.6) m, (177.26, 177.26) mas
    1056: ( -1.9,  -1.9) m, (186.86, 186.86) mas
    1457: ( -1.1,  -1.1) m, (199.35, 199.35) mas
    1631: (  1.2,  -0.6) m, (236.01, 207.69) mas
    2288: (  0.9,   0.9) m, (231.21, 231.21) mas
    2417: (  1.2,   1.2) m, (237.18, 237.18) mas
    2817: (  2.0,   2.0) m, (274.10, 278.80) mas
    3100: (  2.7,   2.7) m, (266.61, 266.61) mas
    3592: (  2.9,   4.2) m, (270.34, 294.20) mas
sa index   location       noise equivalent angle
     305: ( -0.2,  -3.9) m, (166.46, 184.57) mas
     720: (  0.1,  -2.7) m, (169.12, 201.52) mas
    1137: (  0.1,  -1.8) m, (171.66, 217.71) mas
    1271: (  0.1,  -1.5) m, (172.45, 222.81) mas
    2054: ( -1.3,   0.4) m, (181.06, 253.60) mas
    2610: (  0.1,   1.6) m, (180.73, 274.68) mas
    3081: (  0.1,   2.7) m, (183.67, 294.26) mas
    3482: (  0.1,   3.9) m, (186.52, 314.80) mas
    3660: ( -0.2,   4.4) m, (200.66, 341.26) mas
sa index   location       noise equivalent angle
     470: (  3.3,  -3.5) m, (175.10, 175.91) mas
     792: (  2.5,  -2.6) m, (177.26, 177.26) mas
    1082: (  1.8,  -1.9) m, (186.86, 186.86) mas
    1460: (  0.9,  -1.1) m, (199.35, 199.35) mas
    1628: ( -1.3,  -0.6) m, (236.01, 207.69) mas
    2284: ( -1.1,   0.9) m, (231.21, 231.21) mas
    2399: ( -1.3,   1.2) m, (237.18, 237.18) mas
    2787: ( -2.2,   2.0) m, (273.20, 278.03) mas
    3060: ( -2.9,   2.7) m, (266.61, 266.61) mas
    3550: ( -3.0,   4.2) m, (270.34, 294.20) mas

[00;00mSetting up powfs 2 PO WFS[00;00m

OTF dimension is 48x48 (calculated)
Generating matched filter for powfs 2
Use sanea to derive neasim
Use sanea to derive neasim

[00;00mSetting up reconstructor[00;00m

Recon NEA: cmf(224.82) cmf(226.41) cmf(225.17) cmf(226.83) cmf(225.37) cmf(226.81) cmf(225.13) cmf(226.39) geom(0.31) geom(0.31) geom(0.31) mf(0.14)  mas
Setup or update control matrix parameters.
RRtwfs svd threshold is 1e-10
Replacing HA by HA*fit->actextrap
Adding piston cr to fit matrix
Adding TT cr on upper DMs to fit matrix.
Before assembling fit matrix:	5226.1 MiB.
Building fit->FR
Building fit->FL
Adding tikhonov constraint of 1.0e-07 to FLM
The maximum eigen value is estimated to be around 2.6e-04
DM Fit number of Low rank terms: 16 in LHS
After assemble fit matrix:	7246.1 MiB.
After setup_recon:	7246.1 MiB.
GPU 0: mem used 1624 MB (wfs init)
GPU 0: mem used 2888 MB (recon init)
GPU 0: mem used 2918 MB (perf init)

*** Simulation started at 2025/02/11 19:12:21 in nid003517. ***

Running seed 1
GPU 0: mem used 2918 MB (wfs seeding)
Wind dir: 267.3 261.7 167.0 130.5 300.7  32.3 119.8 139.0 150.8 277.7 203.0 133.1  45.9 265.1 deg
Using /global/homes/b/bpeck/.aos/cache/atm/vonkarman_14_8192x8192_0.0078125_1115374592d.bin
After genatm:	7128.0 MiB.
Step     #  Open Loop  PR TT  On axis  PR TT  Field RMS PR TT     Timing 
Step     0: OL  884.6  248.3  OA  884.6 248.3 CL  884.6 248.3 nm  0.117 s
Step    14: OL  906.3  253.8  OA  142.6  73.5 CL  142.6  73.5 nm  0.075 s
Step    27: OL  926.8  257.9  OA  124.1  38.5 CL  124.1  38.5 nm  0.086 s
Step    39: OL  945.2  260.4  OA  124.4  16.2 CL  124.4  16.2 nm  0.082 s
Step    52: OL  964.4  261.2  OA  120.4  18.9 CL  120.4  18.9 nm  0.088 s
Step    65: OL  983.8  260.3  OA  117.8   9.5 CL  117.8   9.5 nm  0.082 s
Step    77: OL 1001.9  259.0  OA  117.2  12.4 CL  117.2  12.4 nm  0.083 s
Step    89: OL 1020.3  258.0  OA  128.2  24.5 CL  128.2  24.5 nm  0.080 s
Step   101: OL 1038.7  257.5  OA  121.4  15.9 CL  121.4  15.9 nm  0.088 s
Step   113: OL 1057.2  257.8  OA  122.4  25.0 CL  122.4  25.0 nm  0.082 s
Step   125: OL 1075.0  259.2  OA  117.4  11.5 CL  117.4  11.5 nm  0.087 s
Step   138: OL 1093.1  262.7  OA  121.4  25.8 CL  121.4  25.8 nm  0.080 s
Step   150: OL 1108.7  267.4  OA  124.1  39.2 CL  124.1  39.2 nm  0.093 s
Step   162: OL 1122.3  273.3  OA  127.3  43.6 CL  127.3  43.6 nm  0.087 s
Step   171: OL 1131.4  278.4  OA  123.0  16.1 CL  123.0  16.1 nm  0.694 s
Step   179: OL 1138.5  283.4  OA  129.2  34.3 CL  129.2  34.3 nm  0.081 s
Step   192: OL 1147.7  291.8  OA  122.9  22.8 CL  122.9  22.8 nm  0.079 s
Step   204: OL 1154.1  299.5  OA  117.4   4.0 CL  117.4   4.0 nm  0.083 s
Step   217: OL 1159.3  307.7  OA  118.8  37.5 CL  118.8  37.5 nm  0.087 s
Step   229: OL 1161.8  315.5  OA  120.3  35.3 CL  120.3  35.3 nm  0.080 s
Step   241: OL 1162.3  323.6  OA  118.7  33.6 CL  118.7  33.6 nm  0.083 s
Step   253: OL 1159.9  332.1  OA  114.3  17.5 CL  114.3  17.5 nm  0.081 s
Step   255 updated high order loop gain: 0.346
Step   266: OL 1153.5  341.4  OA  118.1  29.2 CL  118.1  29.2 nm  0.087 s
Step   278: OL 1144.4  350.1  OA  116.5  27.3 CL  116.5  27.3 nm  0.080 s
Step   290: OL 1133.0  359.5  OA  114.0  23.9 CL  114.0  23.9 nm  0.090 s
Step   303: OL 1119.4  370.8  OA  116.5  35.2 CL  116.5  35.2 nm  0.081 s
Step   315: OL 1105.3  381.9  OA  123.9  42.5 CL  123.9  42.5 nm  0.086 s
Step   327: OL 1089.9  393.9  OA  126.7  39.8 CL  126.7  39.8 nm  0.080 s
Step   340: OL 1072.7  408.5  OA  111.7  29.2 CL  111.7  29.2 nm  0.087 s
Step   352: OL 1056.8  423.6  OA  112.5  20.8 CL  112.5  20.8 nm  0.082 s
Step   365: OL 1040.2  441.4  OA  115.9  33.5 CL  115.9  33.5 nm  0.088 s
Step   377: OL 1025.7  458.6  OA  116.0  30.3 CL  116.0  30.3 nm  0.083 s
Step   390: OL 1010.9  477.4  OA  112.0  14.6 CL  112.0  14.6 nm  0.093 s
Step   402: OL  997.4  494.6  OA  111.0   5.9 CL  111.0   5.9 nm  0.081 s
Step   415: OL  982.4  512.8  OA  117.8  33.1 CL  117.8  33.1 nm  0.089 s
Step   427: OL  968.3  528.8  OA  115.2  17.1 CL  115.2  17.1 nm  0.082 s
Step   439: OL  954.6  544.7  OA  116.8  37.1 CL  116.8  37.1 nm  0.092 s
Step   451: OL  942.3  560.2  OA  116.5  21.7 CL  116.5  21.7 nm  0.084 s
Step   464: OL  931.8  577.3  OA  114.6  21.3 CL  114.6  21.3 nm  0.089 s
Step   475: OL  925.8  591.4  OA  115.0  19.2 CL  115.0  19.2 nm  0.080 s
Step   488: OL  922.9  607.7  OA  115.9  13.0 CL  115.9  13.0 nm  0.086 s
Step   501: OL  923.5  623.1  OA  117.9   9.3 CL  117.9   9.3 nm  0.078 s
Step   511 updated high order loop gain: 0.298
Step   513: OL  925.8  636.1  OA  114.0   0.6 CL  114.0   0.6 nm  0.080 s
Step   526: OL  930.4  648.1  OA  112.0   6.4 CL  112.0   6.4 nm  0.085 s
Step   539: OL  936.9  657.3  OA  112.4   3.9 CL  112.4   3.9 nm  0.080 s
Step   552: OL  945.8  663.8  OA  115.3   2.1 CL  115.3   2.1 nm  0.090 s
Step   565: OL  956.7  668.0  OA  107.9  11.5 CL  107.9  11.5 nm  0.081 s
Step   577: OL  968.2  670.0  OA  112.2  11.8 CL  112.2  11.8 nm  0.087 s
Step   589: OL  981.1  670.5  OA  110.2  12.5 CL  110.2  12.5 nm  0.084 s
Step   601: OL  995.0  668.5  OA  109.1   6.3 CL  109.1   6.3 nm  0.079 s
Step   614: OL 1010.5  663.8  OA  110.3   5.8 CL  110.3   5.8 nm  0.081 s
Step   627: OL 1026.0  656.6  OA  110.7   9.1 CL  110.7   9.1 nm  0.088 s
Step   639: OL 1039.8  647.8  OA  110.8  13.8 CL  110.8  13.8 nm  0.081 s
Step   652: OL 1053.5  636.6  OA  114.0  14.2 CL  114.0  14.2 nm  0.085 s
Step   665: OL 1066.0  624.0  OA  114.0  18.2 CL  114.0  18.2 nm  0.083 s
Step   677: OL 1076.7  611.5  OA  112.8   8.9 CL  112.8   8.9 nm  0.089 s
Step   690: OL 1087.7  597.9  OA  120.2  24.5 CL  120.2  24.5 nm  0.081 s
Step   702: OL 1096.3  584.4  OA  114.5  17.7 CL  114.5  17.7 nm  0.088 s
Step   714: OL 1102.8  570.0  OA  120.6  19.1 CL  120.6  19.1 nm  0.078 s
Step   726: OL 1106.6  555.1  OA  118.4   3.3 CL  118.4   3.3 nm  0.082 s
Step   738: OL 1108.0  540.3  OA  122.4  17.3 CL  122.4  17.3 nm  0.081 s
Step   750: OL 1106.7  525.6  OA  116.5  11.1 CL  116.5  11.1 nm  0.092 s
Step   762: OL 1102.9  511.4  OA  116.2  16.3 CL  116.2  16.3 nm  0.081 s
Step   767 updated high order loop gain: 0.277
Step   774: OL 1096.6  497.7  OA  118.9  17.1 CL  118.9  17.1 nm  0.087 s
Step   786: OL 1087.4  484.2  OA  122.1   6.8 CL  122.1   6.8 nm  0.086 s
Step   799: OL 1074.5  469.7  OA  118.0  11.5 CL  118.0  11.5 nm  0.086 s
Step   812: OL 1059.5  455.2  OA  118.8  22.4 CL  118.8  22.4 nm  0.081 s
Step   824: OL 1043.5  441.9  OA  118.2   5.9 CL  118.2   5.9 nm  0.087 s
Step   836: OL 1025.5  428.9  OA  114.6  14.4 CL  114.6  14.4 nm  0.080 s
Step   848: OL 1006.6  416.6  OA  113.0  17.6 CL  113.0  17.6 nm  0.087 s
Step   861: OL  985.8  404.2  OA  117.9  12.7 CL  117.9  12.7 nm  0.080 s
Step   873: OL  967.2  393.9  OA  120.5   9.1 CL  120.5   9.1 nm  0.081 s
Step   885: OL  949.4  384.9  OA  118.7   6.3 CL  118.7   6.3 nm  0.079 s
Step   898: OL  929.7  376.2  OA  119.2  21.7 CL  119.2  21.7 nm  0.087 s
Step   910: OL  910.6  369.4  OA  110.9  11.0 CL  110.9  11.0 nm  0.086 s
Step   923: OL  889.7  363.0  OA  115.5   6.3 CL  115.5   6.3 nm  0.087 s
Step   936: OL  869.1  356.8  OA  113.0   6.1 CL  113.0   6.1 nm  0.083 s
Step   948: OL  850.8  351.1  OA  119.1   9.1 CL  119.1   9.1 nm  0.081 s
Step   960: OL  833.7  345.0  OA  113.4   4.5 CL  113.4   4.5 nm  0.082 s
Step   972: OL  818.6  338.2  OA  116.3   5.3 CL  116.3   5.3 nm  0.091 s
Step   984: OL  805.4  330.8  OA  110.8   5.0 CL  110.8   5.0 nm  0.084 s
Step   996: OL  793.4  322.5  OA  116.4  13.0 CL  116.4  13.0 nm  0.086 s
Step  1008: OL  782.2  313.6  OA  118.0  16.0 CL  118.0  16.0 nm  0.081 s
Step  1020: OL  772.4  304.4  OA  114.6  14.6 CL  114.6  14.6 nm  0.087 s
Step  1023 updated high order loop gain: 0.266
Step  1032: OL  763.9  295.0  OA  120.2  29.6 CL  120.2  29.6 nm  0.086 s
Step  1045: OL  755.9  283.9  OA  116.9  19.4 CL  116.9  19.4 nm  0.081 s
Step  1057: OL  748.7  272.9  OA  114.2   6.9 CL  114.2   6.9 nm  0.093 s
Step  1070: OL  741.6  259.6  OA  111.9  13.5 CL  111.9  13.5 nm  0.085 s
Step  1083: OL  736.5  244.7  OA  120.2   9.3 CL  120.2   9.3 nm  0.085 s
Step  1095: OL  733.7  230.8  OA  115.0   8.2 CL  115.0   8.2 nm  0.080 s
Step  1107: OL  732.3  218.0  OA  114.4  13.1 CL  114.4  13.1 nm  0.089 s
Step  1120: OL  731.8  205.3  OA  112.1  23.0 CL  112.1  23.0 nm  0.081 s
Step  1133: OL  731.9  194.5  OA  106.8  17.8 CL  106.8  17.8 nm  0.090 s
Step  1145: OL  732.4  186.2  OA  109.4  23.1 CL  109.4  23.1 nm  0.080 s
Step  1158: OL  732.9  178.9  OA  102.9   9.9 CL  102.9   9.9 nm  0.085 s
Step  1171: OL  733.4  173.8  OA  109.2  28.7 CL  109.2  28.7 nm  0.080 s
Step  1183: OL  734.9  170.6  OA  109.0  16.4 CL  109.0  16.4 nm  0.087 s
Step  1195: OL  737.6  167.9  OA  108.7  16.7 CL  108.7  16.7 nm  0.082 s
Step  1207: OL  740.6  165.6  OA  111.5  22.7 CL  111.5  22.7 nm  0.079 s
Step  1219: OL  743.7  163.9  OA  107.5  16.4 CL  107.5  16.4 nm  0.079 s
Step  1230: OL  746.5  163.4  OA  111.2  13.7 CL  111.2  13.7 nm  0.078 s
Step  1242: OL  748.7  164.4  OA  109.9  23.5 CL  109.9  23.5 nm  0.086 s
Step  1255: OL  751.4  167.5  OA  107.4  25.2 CL  107.4  25.2 nm  0.080 s
Step  1267: OL  754.6  172.3  OA  110.9  28.5 CL  110.9  28.5 nm  0.086 s
Step  1279: OL  758.4  178.5  OA  106.1  14.8 CL  106.1  14.8 nm  0.080 s
Step  1279 updated high order loop gain: 0.256
Step  1291: OL  763.3  185.7  OA  109.7  29.2 CL  109.7  29.2 nm  0.088 s
Step  1303: OL  768.4  193.8  OA  113.2  19.5 CL  113.2  19.5 nm  0.082 s
Step  1315: OL  773.2  202.7  OA  116.1  31.4 CL  116.1  31.4 nm  0.081 s
Step  1327: OL  777.9  212.6  OA  113.6  23.1 CL  113.6  23.1 nm  0.085 s
Step  1339: OL  783.6  223.2  OA  109.7  25.6 CL  109.7  25.6 nm  0.082 s
Step  1351: OL  790.4  234.2  OA  115.3  32.4 CL  115.3  32.4 nm  0.084 s
Step  1364: OL  799.3  245.3  OA  112.6  29.9 CL  112.6  29.9 nm  0.084 s
Step  1376: OL  808.2  253.8  OA  115.2  35.0 CL  115.2  35.0 nm  0.082 s
Step  1388: OL  817.7  260.7  OA  111.5  27.6 CL  111.5  27.6 nm  0.082 s
Step  1400: OL  828.3  266.2  OA  111.5  16.0 CL  111.5  16.0 nm  0.091 s
Step  1412: OL  839.8  270.3  OA  111.7  16.8 CL  111.7  16.8 nm  0.080 s
Step  1424: OL  851.7  273.4  OA  112.4  19.7 CL  112.4  19.7 nm  0.081 s
Step  1437: OL  864.3  276.2  OA  116.4  36.2 CL  116.4  36.2 nm  0.082 s
Step  1449: OL  875.2  278.3  OA  107.5  16.9 CL  107.5  16.9 nm  0.082 s
Step  1461: OL  885.2  279.3  OA  109.4   3.7 CL  109.4   3.7 nm  0.086 s
Step  1473: OL  893.1  279.1  OA  112.5  25.0 CL  112.5  25.0 nm  0.080 s
Step  1486: OL  898.2  277.0  OA  109.3   2.7 CL  109.3   2.7 nm  0.092 s
Step  1498: OL  899.9  273.5  OA  110.1  18.3 CL  110.1  18.3 nm  0.082 s
Step  1511: OL  899.0  268.2  OA  107.8  14.2 CL  107.8  14.2 nm  0.086 s
Step  1523: OL  896.2  262.5  OA  108.1   6.6 CL  108.1   6.6 nm  0.079 s
Step  1535: OL  891.3  255.6  OA  108.9   8.9 CL  108.9   8.9 nm  0.081 s
Step  1535 updated high order loop gain: 0.254
Step  1547: OL  884.9  247.9  OA  112.4  26.6 CL  112.4  26.6 nm  0.081 s
Step  1559: OL  878.2  239.9  OA  107.5  13.8 CL  107.5  13.8 nm  0.081 s
Step  1571: OL  871.1  232.5  OA  109.6  10.6 CL  109.6  10.6 nm  0.095 s
Step  1583: OL  863.5  226.2  OA  115.0  16.6 CL  115.0  16.6 nm  0.081 s
Step  1595: OL  855.4  220.9  OA  113.6  27.9 CL  113.6  27.9 nm  0.085 s
Step 1599: Output PSF
Step  1599: OL  852.7  219.3  OA  112.4  14.0 CL  112.4  14.0 nm  1.690 s
Mean: 113.36 18.09 111.91  nm.

*** Simulation Finished at 2025/02/11 19:14:47 in nid003517. ***

