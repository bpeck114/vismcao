Warning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid003517/scheduler) failed: Invalid argument. 
/global/u2/b/bpeck/work/vismcao/maos -o studies/reduced_ngs/8_lgs/8mag_lgs/3500count -c master_files/reduced_ngs/8_lgs/8mag_lgs/kola_3500act.conf -O 
Output folder is 'studies/reduced_ngs/8_lgs/8mag_lgs/3500count'.
SRC: /global/homes/b/bpeck/code/maos v2.9 4c88b7c2 2024-11-13 16:45:33 -0800
BUILT: /global/homes/b/bpeck/code/maos/optim by GCC (v12) on 2024/11/18 09:40:03 CPU(F64,+O3) with CUDA(v122,F32)
Launched at 2025/02/11 18:52:38 in nid003517 with PID 1948131.
The web based job monitor can be accessed at http://localhost:10300
Main config file is /global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/8_lgs/8mag_lgs/kola_3500act.conf
Warning(path.c:48): Path not found: path=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/8_lgs/8mag_lgs/bin; abspath=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/8_lgs/8mag_lgs/bin; Ignored.
Warning(path.c:48): Path not found: path=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/8_lgs/8mag_lgs/atm; abspath=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/8_lgs/8mag_lgs/atm; Ignored.
Warning(readcfg.c:399): sim.apfsm has been renamed to powfs.apfsm.
Warning(readcfg.c:399): sim.epfsm has been renamed to powfs.epfsm.
Warning(readcfg.c:399): sim.alfsm has been renamed to powfs.alfsm.
Warning(readcfg.c:399): sim.commonfsm has been renamed to powfs.commonfsm.
Warning(readcfg.c:399): sim.idealfsm has been renamed to powfs.idealfsm.
Warning(readcfg.c:399): sim.zetafsm has been renamed to powfs.zetafsm.
Warning(readcfg.c:399): sim.f0fsm has been renamed to powfs.f0fsm.
Warning(readcfg.c:399): tsurf has been renamed to ncpa.tsurf.
loaded 132 (132 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_sim.conf'
loaded  19 ( 19 new) records from '/global/u2/b/bpeck/work/vismcao/./dm_none.conf'
loaded  19 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_ASM.conf'
loaded  19 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_DM2.conf'
loaded  19 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_DM3.conf'
loaded   0 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_dm_multiple.conf'
loaded   7 (  5 new) records from '/global/u2/b/bpeck/work/vismcao/./atm_mk13n50p_ground_detail.conf'
loaded  76 ( 69 new) records from '/global/homes/b/bpeck/code/maos/config/maos/powfs_common.conf'
loaded  44 ( 38 new) records from '/global/u2/b/bpeck/work/vismcao/./powfs_none.conf'
loaded  44 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_shwfs_lgs.conf'
loaded  44 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_shwfs_ttf_strap.conf'
loaded  44 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_shwfs_twfs_lbwfs.conf'
loaded   0 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_wfs_lgs_strap_lbwfs.conf'
loaded  71 ( 71 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_recon.conf'
Warning(readcfg.c:399): dbg.na_smooth has been renamed to powfs0_llt.na_smooth.
Warning(readcfg.c:399): dbg.na_interp has been renamed to powfs0_llt.na_interp.
Warning(readcfg.c:399): dbg.na_thres has been renamed to powfs0_llt.na_thres.
Warning(readcfg.c:399): dbg.na_fit_maxit has been renamed to powfs0_llt.na_fit_maxit.
Warning(readcfg.c:399): dbg.na_fit_svdthres has been renamed to powfs0_llt.na_fit_svdthres.
Warning(readcfg.c:399): dbg.na_fit_dh has been renamed to powfs0_llt.na_fit_dh.
Warning(readcfg.c:399): dbg.ncpa_preload has been renamed to ncpa.preload.
Warning(readcfg.c:399): dbg.ncpa_rmsci has been renamed to ncpa.rmsci.
Warning(readcfg.c:399): dbg.draw_opdmax has been renamed to plot.opdmax.
Warning(readcfg.c:399): dbg.draw_gmax has been renamed to plot.gmax.
loaded  95 ( 93 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_dbg.conf'
loaded   4 (  4 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_fit_mcao.conf'
Warning(readcfg.c:399): surf has been renamed to ncpa.surf.
loaded  39 (  7 new) records from '/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/8_lgs/8mag_lgs/kola_3500act.conf'
loaded   0 (  0 new) records from 'command line'
loaded  24 ( 18 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_llt_CL.conf'
Adjust LGS range by telescope altitude 4145m.
Zenith angle is 30 degree.
    Scaling turbulence height and LGS hs by sec(za).
    Scaling r0 by cos(za)^(3/5).
    Scaling wind speed and LGS signal level by cos(za).
powfs0: Adjusting dx from 0.0078125 to 0.0075. 
powfs0.llt.fsm: f0=0 Hz, LPF ep=0
powfs0.epfsm is set to 0.517618 (auto)
powfs2: Adjusting dx from 0.03125 to 0.0312778. 
powfs2 is TWFS for powfs0
sim.ephi is set to 0.427717 (auto)
sim.eplo is set to 0.427717 (auto)
Warning(parms.c:2296): Layer 1 at 17.3205m is very close to layer 0 at 0m (OK).
Warning(parms.c:2296): Layer 2 at 34.641m is very close to layer 1 at 17.3205m (OK).
Warning(parms.c:2296): Layer 3 at 51.9615m is very close to layer 2 at 34.641m (OK).
dm 0: stroke=30 um is provided in micron.
dm 0: assume ia stroke=2 um is provided in micron.
dm 1: stroke=7 um is provided in micron.
dm 1: assume ia stroke=2 um is provided in micron.
dm 2: stroke=7 um is provided in micron.
dm 2: assume ia stroke=2 um is provided in micron.
Focus blending is not implemented yet for integrated tomography
parms->sim.mffocus is reset to 0
There are 1 valid simulation seeds:  1
Output PSF for 1 directions
Used 449 of 456 supplied keys
Warning(readcfg.c:158): key "dbg.pwfs_flate" is not recognized, value is 0
Warning(readcfg.c:158): key "dbg.pwfs_flatv" is not recognized, value is 0
Warning(readcfg.c:158): key "dbg.pwfs_psx" is not recognized, value is [0 0 0 0]
Warning(readcfg.c:158): key "dbg.pwfs_psy" is not recognized, value is [0 0 0 0]
Warning(readcfg.c:158): key "dbg.pwfs_pupelong" is not recognized, value is 0
Warning(readcfg.c:158): key "dbg.pwfs_raw" is not recognized, value is 0
Warning(readcfg.c:158): key "dbg.pwfs_side" is not recognized, value is 4
[00;00mAperture[00;00m is 11 m with sampling 1/128 m
[00;00mTurbulence at 30 degree zenith angle:[00;00m r0=0.128424m, L0=30m, 14 layers.
    Greenwood freq is 25.1Hz, anisoplanatic angle is 1.58 as
    Sampled 8192x8192 at 1/128m. wind dir is randomized.
    layer 0: ht=      0 m, wt= 0.302, ws=  4.8 m/s
    layer 1: ht=     17 m, wt= 0.154, ws=  5.0 m/s
    layer 2: ht=     35 m, wt= 0.041, ws=  5.4 m/s
    layer 3: ht=     52 m, wt= 0.002, ws=  6.6 m/s
    layer 4: ht=    139 m, wt= 0.021, ws=  6.1 m/s
    layer 5: ht=    231 m, wt= 0.010, ws=  6.1 m/s
    layer 6: ht=    323 m, wt= 0.008, ws=  6.1 m/s
    layer 7: ht=    416 m, wt= 0.005, ws=  6.1 m/s
    layer 8: ht=    508 m, wt= 0.001, ws=  6.1 m/s
    layer 9: ht=    932 m, wt= 0.107, ws=  5.6 m/s
    layer 10: ht=   5022 m, wt= 0.144, ws= 11.1 m/s
    layer 11: ht=   9238 m, wt= 0.093, ws= 19.1 m/s
    layer 12: ht=  13856 m, wt= 0.075, ws=  8.2 m/s
    layer 13: ht=  22518 m, wt= 0.036, ws=  4.8 m/s
[00;00mReconstruction[00;00m: r0=0.128424m L0=30m. 14 layers. use cone coordinate.
    layer 0: ht=      0 m, wt= 0.302
    layer 1: ht=     17 m, wt= 0.154
    layer 2: ht=     35 m, wt= 0.041
    layer 3: ht=     52 m, wt= 0.002
    layer 4: ht=    139 m, wt= 0.021
    layer 5: ht=    231 m, wt= 0.010
    layer 6: ht=    323 m, wt= 0.008
    layer 7: ht=    416 m, wt= 0.005
    layer 8: ht=    508 m, wt= 0.001
    layer 9: ht=    932 m, wt= 0.107
    layer 10: ht=   5022 m, wt= 0.144
    layer 11: ht=   9238 m, wt= 0.093
    layer 12: ht=  13856 m, wt= 0.075
    layer 13: ht=  22518 m, wt= 0.036
[00;00mThere are 3 powfs[00;00m
  powfs0: Order 67, LGS at 99.1 km. Sampling 1/133.333 m. Thres 30%. [00;00mT/T is removed in right hand side in tomography.[00;00m
    CCD image is 25x25 @ 500x500 mas, blur 27% (sigma), 1500Hz, wvl: [ 5.89e-07]
    Gtilt in reconstruction. Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
  powfs1: Order  2, NGS at inf km. Sampling 1/16 m. Thres 30%. 
    Ztilt in reconstruction. Geomtric optics start at 2 with ztilt [00;00m(noisy)[00;00m
  powfs2: Order 20, NGS at inf km. Sampling 1/31.9716 m. Thres 50%. 
    CCD image is 4x4 @ 1500x1500 mas, blur 0% (sigma), 0.015Hz, wvl: [ 7.2e-07]
    Gtilt in reconstruction. Geomtric optics start at 50 with gtilt Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
[00;00mThere are 12 wfs[00;00m
    wfs 0: type 0, at (  30.00,    0.00) arcsec,  99 km, siglev is 32.644 bkgrnd is 0.1
    wfs 1: type 0, at (  21.21,   21.21) arcsec,  99 km, siglev is 32.644 bkgrnd is 0.1
    wfs 2: type 0, at (   0.00,   30.00) arcsec,  99 km, siglev is 32.644 bkgrnd is 0.1
    wfs 3: type 0, at ( -21.21,   21.21) arcsec,  99 km, siglev is 32.644 bkgrnd is 0.1
    wfs 4: type 0, at ( -30.00,    0.00) arcsec,  99 km, siglev is 32.644 bkgrnd is 0.1
    wfs 5: type 0, at ( -21.21,  -21.21) arcsec,  99 km, siglev is 32.644 bkgrnd is 0.1
    wfs 6: type 0, at (   0.00,  -30.00) arcsec,  99 km, siglev is 32.644 bkgrnd is 0.1
    wfs 7: type 0, at (  21.21,  -21.21) arcsec,  99 km, siglev is 32.644 bkgrnd is 0.1
    wfs 8: type 1, at (   5.00,    8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 9: type 1, at ( -10.00,    0.00) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 10: type 1, at (   5.00,   -8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 11: type 2, at (   0.00,    0.00) arcsec, inf km, siglev is 4.1558e+06 bkgrnd is 0.001
[00;00mThere are 3 DMs[00;00m
  DM 0 at -0.1km, actuator pitch 0.165m, offset   0, with 30.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 1 at    6km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 2 at   10km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
[00;00mTomography[00;00m is using CG, with [00;00mFourer Domain[00;00m preconditioner, [00;00m12[00;00m iterations, integrated tomo.
[00;00mDM Fitting [00;00mis using CG, with [00;00mNo[00;00m preconditioner, [00;00m10[00;00m iterations
[00;00mThere are 9 fit directions[00;00m
    Fit 0: weight is 0.444, at (   0.00,    0.00) arcsec
    Fit 1: weight is 0.111, at (  15.00,    0.00) arcsec
    Fit 2: weight is 0.111, at (   0.00,   15.00) arcsec
    Fit 3: weight is 0.111, at ( -15.00,    0.00) arcsec
    Fit 4: weight is 0.111, at (   0.00,  -15.00) arcsec
    Fit 5: weight is 0.028, at (  15.00,   15.00) arcsec
    Fit 6: weight is 0.028, at ( -15.00,   15.00) arcsec
    Fit 7: weight is 0.028, at ( -15.00,  -15.00) arcsec
    Fit 8: weight is 0.028, at (  15.00,  -15.00) arcsec
[00;00mThere are 1 evaluation directions[00;00m at sampling 1/128 m.
    Evl 0: weight is 1.000, at (   0.00,    0.00) arcsec
[00;00mSimulation[00;00m start at step 0, end at step 1600, with time step 1/1500s, [00;00mclose loop[00;00m.
After setup_parms:	120.5 MiB.
Warning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid003517/scheduler) failed: Invalid argument. 
CUDA: minimum memory requirement is 0.3GB
GPU 0 is NVIDIA A100-SXM4-40GB with arch 8.0, 38.9GB free, 39.3GB total device memory.
Using GPU 0
Use 1 GPUs for WFS Tomo Fit Evl

*** Preparation started at 2025/02/11 18:52:39 in nid003517. ***

Using OpenMP version 201511 with 128 threads
Reading aperture amplitude map from KECK.fits
Warning(accphi.c:477): 108130 points not covered by input screen
Warning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid003517/scheduler) failed: Invalid argument. 
 ->start.S:122->maos.c:456->maos.c:447->setup.c:148->aper.c:74->utils.c:478->accphi.c:478
iwvl 0: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 1: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 2: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 3: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 4: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 5: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 6: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 7: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 8: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
After setup_aper:	341.1 MiB.

[00;00mSetting up powfs 0 geom[00;00m

There are 22 points in each subaperture of 0.165m.
There are 2734 valid subaperture.

[00;00mSetting up powfs 1 geom[00;00m

There are 88 points in each subaperture of 5.5m.
There are 4 valid subaperture.

[00;00mSetting up powfs 2 geom[00;00m

There are 18 points in each subaperture of 0.563m.
There are 236 valid subaperture.
After setup_powfs_init:	425.0 MiB.

[00;00mSetting up reconstructor geometry.[00;00m

PLOC is 137x137, with sampling of 0.08m (square)
    DM 0: grid is 70 x 70
    DM 1: grid is 75 x 75
    DM 2: grid is 81 x 81
FLOC is 137x137, with sampling of 0.08m (not square)
Tomography grid is square:
    layer 0: xloc grid is 240 x 240, sampling is 0.083 m, 57600 points
    layer 1: xloc grid is 240 x 240, sampling is 0.082 m, 57600 points
    layer 2: xloc grid is 240 x 240, sampling is 0.082 m, 57600 points
    layer 3: xloc grid is 240 x 240, sampling is 0.082 m, 57600 points
    layer 4: xloc grid is 240 x 240, sampling is 0.082 m, 57600 points
    layer 5: xloc grid is 240 x 240, sampling is 0.082 m, 57600 points
    layer 6: xloc grid is 240 x 240, sampling is 0.082 m, 57600 points
    layer 7: xloc grid is 240 x 240, sampling is 0.082 m, 57600 points
    layer 8: xloc grid is 240 x 240, sampling is 0.082 m, 57600 points
    layer 9: xloc grid is 240 x 240, sampling is 0.082 m, 57600 points
    layer 10: xloc grid is 240 x 240, sampling is 0.078 m, 57600 points
    layer 11: xloc grid is 240 x 240, sampling is 0.075 m, 57600 points
    layer 12: xloc grid is 240 x 240, sampling is 0.071 m, 57600 points
Warning(map.c:195): ninx=240 is too small. need 241
Warning(map.c:200): niny=240 is too small. need 241
    layer 13: xloc grid is 240 x 240, sampling is 0.064 m, 57600 points

[00;00mSetting up powfs 0 PO WFS[00;00m

OTF dimension is 48x48 (calculated)
Uplink FWHM (illt 0, iwvl 0) is 0.576822"
Downlink FWHM (illt 0, iwvl 0) is 1.17002"
Generating matched filter for powfs 0
sa index   location       noise equivalent angle
    1338: (  4.9,  -0.2) m, (127.75, 124.06) mas
    1331: (  3.7,  -0.2) m, (135.61, 125.59) mas
    1325: (  2.7,  -0.2) m, (145.41, 127.35) mas
    1318: (  1.6,  -0.2) m, (158.53, 129.38) mas
    1316: (  1.2,  -0.2) m, (163.74, 130.04) mas
     956: ( -0.6,  -1.4) m, (196.82, 135.58) mas
    1313: ( -1.7,  -0.2) m, (220.98, 134.44) mas
    1306: ( -2.9,  -0.2) m, (241.94, 135.87) mas
    1300: ( -3.9,  -0.2) m, (256.58, 137.10) mas
    1293: ( -5.0,  -0.2) m, (272.37, 138.52) mas
    1291: ( -5.4,  -0.2) m, (277.81, 138.96) mas
sa index   location       noise equivalent angle
    2261: (  2.7,   2.7) m, (130.43, 130.43) mas
    2014: (  1.9,   1.9) m, (144.80, 143.80) mas
    1726: (  1.1,   1.1) m, (148.06, 148.06) mas
    1673: (  0.9,   0.9) m, (150.39, 150.39) mas
    1015: (  0.6,  -1.2) m, (159.01, 182.23) mas
    1009: ( -1.2,  -1.2) m, (179.94, 179.94) mas
     721: ( -2.1,  -2.1) m, (199.98, 198.93) mas
     522: ( -2.7,  -2.7) m, (203.47, 203.47) mas
     331: ( -3.4,  -3.4) m, (215.02, 215.02) mas
     133: ( -3.1,  -4.2) m, (209.38, 229.26) mas
sa index   location       noise equivalent angle
    2505: ( -0.2,   3.7) m, (125.59, 135.61) mas
    2245: (  0.1,   2.7) m, (127.35, 145.41) mas
    1889: ( -0.2,   1.6) m, (129.38, 158.53) mas
    1775: ( -0.2,   1.2) m, (130.04, 163.74) mas
    1213: (  1.2,  -0.6) m, (135.58, 196.82) mas
     844: ( -0.2,  -1.7) m, (134.44, 220.98) mas
     490: ( -0.2,  -2.9) m, (135.87, 241.94) mas
     228: ( -0.2,  -3.9) m, (137.10, 256.58) mas
      72: ( -0.2,  -4.5) m, (137.92, 265.86) mas
       5: ( -2.6,  -4.9) m, (148.05, 279.97) mas
sa index   location       noise equivalent angle
    2227: ( -2.9,   2.7) m, (130.43, 130.43) mas
    1990: ( -2.1,   1.9) m, (145.04, 143.97) mas
    1717: ( -1.2,   1.1) m, (148.06, 148.06) mas
    1670: ( -1.1,   0.9) m, (150.39, 150.39) mas
    1012: ( -0.7,  -1.2) m, (160.42, 183.81) mas
    1018: (  1.1,  -1.2) m, (179.94, 179.94) mas
     745: (  1.9,  -2.1) m, (199.74, 198.88) mas
     554: (  2.6,  -2.7) m, (203.47, 203.47) mas
     371: (  3.2,  -3.4) m, (215.02, 215.02) mas
     169: (  2.9,  -4.2) m, (209.38, 229.26) mas
sa index   location       noise equivalent angle
    1343: ( -5.4,  -0.1) m, (126.03, 123.63) mas
    1346: ( -4.9,  -0.1) m, (128.39, 124.13) mas
    1353: ( -3.7,  -0.1) m, (136.78, 125.74) mas
    1359: ( -2.7,  -0.1) m, (146.70, 127.48) mas
    1366: ( -1.6,  -0.1) m, (161.45, 129.64) mas
     962: (  0.4,  -1.4) m, (196.82, 135.58) mas
    1368: (  1.2,  -0.1) m, (213.58, 133.82) mas
    1371: (  1.7,  -0.1) m, (224.47, 134.47) mas
    1378: (  2.9,  -0.1) m, (244.19, 135.86) mas
    1384: (  3.9,  -0.1) m, (258.46, 137.07) mas
    1391: (  5.0,  -0.1) m, (274.18, 138.46) mas
sa index   location       noise equivalent angle
     331: ( -3.4,  -3.4) m, (126.63, 126.63) mas
     522: ( -2.7,  -2.7) m, (131.45, 131.45) mas
     777: ( -1.9,  -1.9) m, (139.93, 139.93) mas
    1062: ( -1.1,  -1.1) m, (150.39, 150.39) mas
    1720: ( -0.7,   1.1) m, (157.91, 181.06) mas
    1673: (  0.9,   0.9) m, (177.50, 177.50) mas
    1784: (  1.2,   1.2) m, (182.28, 182.28) mas
    2067: (  2.1,   2.1) m, (207.18, 210.25) mas
    2261: (  2.7,   2.7) m, (206.06, 206.06) mas
    2602: (  2.9,   4.0) m, (209.38, 229.26) mas
sa index   location       noise equivalent angle
     228: ( -0.2,  -3.9) m, (125.59, 135.61) mas
     492: (  0.1,  -2.9) m, (127.35, 145.41) mas
     844: ( -0.2,  -1.7) m, (129.38, 158.53) mas
     958: ( -0.2,  -1.4) m, (131.08, 164.84) mas
    1522: ( -1.4,   0.4) m, (135.58, 196.82) mas
    1889: ( -0.2,   1.6) m, (134.44, 220.98) mas
    2243: ( -0.2,   2.7) m, (135.87, 241.94) mas
    2505: ( -0.2,   3.7) m, (137.10, 256.57) mas
    2661: ( -0.2,   4.4) m, (137.92, 265.85) mas
    2715: ( -2.6,   4.7) m, (149.71, 282.90) mas
sa index   location       noise equivalent angle
     371: (  3.2,  -3.4) m, (126.63, 126.63) mas
     554: (  2.6,  -2.7) m, (131.45, 131.45) mas
    1018: (  1.1,  -1.2) m, (148.06, 148.06) mas
    1065: (  0.9,  -1.1) m, (150.39, 150.39) mas
    1723: (  0.6,   1.1) m, (157.18, 180.22) mas
    1670: ( -1.1,   0.9) m, (177.50, 177.50) mas
    1768: ( -1.4,   1.2) m, (182.28, 182.28) mas
    2041: ( -2.2,   2.1) m, (207.02, 209.55) mas
    2227: ( -2.9,   2.7) m, (206.06, 206.06) mas
    2566: ( -3.1,   4.0) m, (209.38, 229.26) mas

[00;00mSetting up powfs 2 PO WFS[00;00m

OTF dimension is 48x48 (calculated)
Generating matched filter for powfs 2
Use sanea to derive neasim
Use sanea to derive neasim

[00;00mSetting up reconstructor[00;00m

Recon NEA: cmf(175.13) cmf(174.40) cmf(174.96) cmf(174.02) cmf(174.60) cmf(173.91) cmf(174.79) cmf(174.28) geom(0.31) geom(0.31) geom(0.31) mf(0.14)  mas
Setup or update control matrix parameters.
RRtwfs svd threshold is 1e-10
Replacing HA by HA*fit->actextrap
Adding piston cr to fit matrix
Adding TT cr on upper DMs to fit matrix.
Before assembling fit matrix:	4647.3 MiB.
Building fit->FR
Building fit->FL
Adding tikhonov constraint of 1.0e-07 to FLM
The maximum eigen value is estimated to be around 2.9e-04
DM Fit number of Low rank terms: 16 in LHS
After assemble fit matrix:	6209.6 MiB.
After setup_recon:	6209.6 MiB.
GPU 0: mem used 1866 MB (wfs init)
GPU 0: mem used 2826 MB (recon init)
GPU 0: mem used 2858 MB (perf init)

*** Simulation started at 2025/02/11 18:53:38 in nid003517. ***

Running seed 1
GPU 0: mem used 2858 MB (wfs seeding)
Wind dir: 267.3 261.7 167.0 130.5 300.7  32.3 119.8 139.0 150.8 277.7 203.0 133.1  45.9 265.1 deg
Using /global/homes/b/bpeck/.aos/cache/atm/vonkarman_14_8192x8192_0.0078125_1115374592d.bin
After genatm:	6021.4 MiB.
Step     #  Open Loop  PR TT  On axis  PR TT  Field RMS PR TT     Timing 
Step     0: OL  884.6  248.3  OA  884.6 248.3 CL  884.6 248.3 nm  0.092 s
Step    17: OL  911.1  254.8  OA  115.3  13.7 CL  115.3  13.7 nm  0.060 s
Step    32: OL  934.6  259.2  OA  119.9  17.2 CL  119.9  17.2 nm  0.077 s
Step    47: OL  957.1  261.1  OA  116.0   8.3 CL  116.0   8.3 nm  0.068 s
Step    62: OL  979.3  260.6  OA  116.7  11.1 CL  116.7  11.1 nm  0.078 s
Step    76: OL 1000.3  259.1  OA  117.4   2.4 CL  117.4   2.4 nm  0.068 s
Step    91: OL 1023.4  257.9  OA  121.3  11.8 CL  121.3  11.8 nm  0.079 s
Step   106: OL 1046.4  257.5  OA  122.5  18.6 CL  122.5  18.6 nm  0.066 s
Step   121: OL 1069.3  258.7  OA  114.5  20.2 CL  114.5  20.2 nm  0.078 s
Step   136: OL 1090.5  262.1  OA  117.5  23.2 CL  117.5  23.2 nm  0.068 s
Step   146: OL 1103.8  265.7  OA  120.8  28.5 CL  120.8  28.5 nm  0.078 s
Step   161: OL 1121.3  272.8  OA  122.0  28.7 CL  122.0  28.7 nm  0.068 s
Step   176: OL 1136.1  281.5  OA  121.7  27.2 CL  121.7  27.2 nm  0.079 s
Step   191: OL 1147.2  291.1  OA  121.1  18.4 CL  121.1  18.4 nm  0.066 s
Step   206: OL 1155.2  300.8  OA  113.1  13.8 CL  113.1  13.8 nm  0.082 s
Step   221: OL 1160.5  310.4  OA  120.9  41.3 CL  120.9  41.3 nm  0.065 s
Step   236: OL 1162.6  320.2  OA  118.9  29.0 CL  118.9  29.0 nm  0.069 s
Step   251: OL 1160.7  330.7  OA  114.4  19.4 CL  114.4  19.4 nm  0.071 s
Step   255 updated high order loop gain: 0.364
Step   265: OL 1154.2  340.7  OA  114.4  28.0 CL  114.4  28.0 nm  0.077 s
Step   280: OL 1142.7  351.6  OA  114.4  20.3 CL  114.4  20.3 nm  0.067 s
Step   295: OL 1127.9  363.7  OA  117.5  29.4 CL  117.5  29.4 nm  0.070 s
Step   309: OL 1112.4  376.3  OA  130.9  52.9 CL  130.9  52.9 nm  0.079 s
Step   324: OL 1093.5  390.7  OA  118.5  28.6 CL  118.5  28.6 nm  0.066 s
Step   338: OL 1075.0  406.1  OA  111.5  20.6 CL  111.5  20.6 nm  0.079 s
Step   353: OL 1055.0  424.9  OA  115.7  25.8 CL  115.7  25.8 nm  0.067 s
Step   368: OL 1036.0  445.7  OA  117.9  33.3 CL  117.9  33.3 nm  0.076 s
Step   383: OL 1018.2  467.2  OA  117.4  13.3 CL  117.4  13.3 nm  0.069 s
Step   398: OL 1001.2  488.9  OA  117.1  24.0 CL  117.1  24.0 nm  0.113 s
Step   413: OL  984.1  510.1  OA  119.2  15.9 CL  119.2  15.9 nm  0.066 s
Step   428: OL  966.6  530.1  OA  111.7  10.2 CL  111.7  10.2 nm  0.066 s
Step   443: OL  949.9  549.9  OA  116.4  15.5 CL  116.4  15.5 nm  0.076 s
Step   458: OL  935.7  569.4  OA  123.5  32.7 CL  123.5  32.7 nm  0.067 s
Step   473: OL  926.3  588.9  OA  116.0   8.8 CL  116.0   8.8 nm  0.078 s
Step   488: OL  922.6  607.7  OA  117.3  11.9 CL  117.3  11.9 nm  0.067 s
Step 494, DM 2: 1 actuators over ia limit. trials=2: success.
Step 495, DM 2: 1 actuators over ia limit. trials=2: success.
Step 496, DM 2: 1 actuators over ia limit. trials=2: success.
Step 497, DM 2: 1 actuators over ia limit. trials=2: success.
Step 498, DM 2: 1 actuators over ia limit. trials=2: success.
Step 499, DM 2: 1 actuators over ia limit. trials=2: success.
Step 500, DM 2: 1 actuators over ia limit. trials=2: success.
Step 501, DM 2: 1 actuators over ia limit. trials=2: success.
Step   502: OL  923.2  624.2  OA  117.0   5.7 CL  117.0   5.7 nm  0.079 s
Step 502, DM 2: 1 actuators over ia limit. trials=2: success.
Step 503, DM 2: 1 actuators over ia limit. trials=2: success.
Step 504, DM 2: 1 actuators over ia limit. trials=2: success.
Step 505, DM 2: 1 actuators over ia limit. trials=2: success.
Step 506, DM 2: 1 actuators over ia limit. trials=2: success.
Step 507, DM 2: 1 actuators over ia limit. trials=2: success.
Step 508, DM 2: 1 actuators over ia limit. trials=2: success.
Step 509, DM 2: 1 actuators over ia limit. trials=2: success.
Step 510, DM 2: 1 actuators over ia limit. trials=2: success.
Step   511 updated high order loop gain: 0.346
Step 511, DM 2: 1 actuators over ia limit. trials=2: success.
Step 512, DM 2: 1 actuators over ia limit. trials=2: success.
Step 513, DM 2: 1 actuators over ia limit. trials=2: success.
Step 514, DM 2: 1 actuators over ia limit. trials=2: success.
Step 515, DM 2: 1 actuators over ia limit. trials=2: success.
Step 516, DM 2: 1 actuators over ia limit. trials=2: success.
Step   517: OL  926.7  640.0  OA  119.7  16.4 CL  119.7  16.4 nm  0.070 s
Step 517, DM 2: 1 actuators over ia limit. trials=2: success.
Step 518, DM 2: 1 actuators over ia limit. trials=2: success.
Step 519, DM 2: 1 actuators over ia limit. trials=2: success.
Step 520, DM 2: 1 actuators over ia limit. trials=2: success.
Step 521, DM 2: 1 actuators over ia limit. trials=2: success.
Step 522, DM 2: 1 actuators over ia limit. trials=2: success.
Step 523, DM 2: 1 actuators over ia limit. trials=2: success.
Step 524, DM 2: 1 actuators over ia limit. trials=2: success.
Step 525, DM 2: 1 actuators over ia limit. trials=2: success.
Step 526, DM 2: 1 actuators over ia limit. trials=2: success.
Step 527, DM 2: 1 actuators over ia limit. trials=2: success.
Step 528, DM 2: 1 actuators over ia limit. trials=2: success.
Step 529, DM 2: 1 actuators over ia limit. trials=2: success.
Step 530, DM 2: 1 actuators over ia limit. trials=2: success.
Step 531, DM 2: 1 actuators over ia limit. trials=2: success.
Step   532: OL  932.8  652.7  OA  120.3  10.2 CL  120.3  10.2 nm  0.080 s
Step 532, DM 2: 1 actuators over ia limit. trials=2: success.
Step 533, DM 2: 1 actuators over ia limit. trials=2: success.
Step 534, DM 2: 1 actuators over ia limit. trials=2: success.
Step 535, DM 2: 1 actuators over ia limit. trials=2: success.
Step 536, DM 2: 1 actuators over ia limit. trials=2: success.
Step 537, DM 2: 1 actuators over ia limit. trials=2: success.
Step 538, DM 2: 1 actuators over ia limit. trials=2: success.
Step 539, DM 2: 1 actuators over ia limit. trials=2: success.
Step 540, DM 2: 1 actuators over ia limit. trials=2: success.
Step 541, DM 2: 1 actuators over ia limit. trials=2: success.
Step 542, DM 2: 1 actuators over ia limit. trials=2: success.
Step 543, DM 2: 1 actuators over ia limit. trials=2: success.
Step 544, DM 2: 1 actuators over ia limit. trials=2: success.
Step 545, DM 2: 1 actuators over ia limit. trials=2: success.
Step 546, DM 2: 1 actuators over ia limit. trials=2: success.
Step   547: OL  941.7  661.6  OA  116.5  11.9 CL  116.5  11.9 nm  0.066 s
Step 547, DM 2: 1 actuators over ia limit. trials=2: success.
Step 548, DM 2: 1 actuators over ia limit. trials=2: success.
Step 549, DM 2: 1 actuators over ia limit. trials=2: success.
Step 550, DM 2: 1 actuators over ia limit. trials=2: success.
Step 551, DM 2: 1 actuators over ia limit. trials=2: success.
Step 552, DM 2: 1 actuators over ia limit. trials=2: success.
Step 553, DM 2: 1 actuators over ia limit. trials=2: success.
Step 554, DM 2: 1 actuators over ia limit. trials=2: success.
Step 555, DM 2: 1 actuators over ia limit. trials=2: success.
Step   562: OL  953.8  667.2  OA  117.1   6.0 CL  117.1   6.0 nm  0.068 s
Step 563, DM 2: 1 actuators over ia limit. trials=2: success.
Step 564, DM 2: 1 actuators over ia limit. trials=2: success.
Step 565, DM 2: 1 actuators over ia limit. trials=2: success.
Step 566, DM 2: 1 actuators over ia limit. trials=2: success.
Step 567, DM 2: 1 actuators over ia limit. trials=2: success.
Step   577: OL  968.0  670.0  OA  113.9  12.7 CL  113.9  12.7 nm  0.076 s
Step   592: OL  984.4  670.2  OA  115.0   8.2 CL  115.0   8.2 nm  0.066 s
Step   607: OL 1002.1  666.7  OA  112.1  14.4 CL  112.1  14.4 nm  0.068 s
Step   622: OL 1020.1  659.6  OA  119.3  25.6 CL  119.3  25.6 nm  0.067 s
Step   637: OL 1037.6  649.4  OA  116.4  14.7 CL  116.4  14.7 nm  0.071 s
Step   652: OL 1053.5  636.6  OA  114.6   7.6 CL  114.6   7.6 nm  0.073 s
Step   667: OL 1067.9  621.9  OA  116.4   7.1 CL  116.4   7.1 nm  0.073 s
Step   682: OL 1081.1  606.3  OA  118.4  15.9 CL  118.4  15.9 nm  0.071 s
Step   697: OL 1092.9  590.2  OA  115.2  16.0 CL  115.2  16.0 nm  0.069 s
Step   712: OL 1101.7  572.5  OA  119.0   9.1 CL  119.0   9.1 nm  0.072 s
Step   726: OL 1106.5  555.1  OA  119.1   6.8 CL  119.1   6.8 nm  0.070 s
Step   735: OL 1107.7  544.0  OA  117.7   7.1 CL  117.7   7.1 nm  0.078 s
Step   750: OL 1106.4  525.6  OA  120.1  20.0 CL  120.1  20.0 nm  0.068 s
Step   765: OL 1101.3  508.0  OA  118.8   5.3 CL  118.8   5.3 nm  0.091 s
Step   767 updated high order loop gain: 0.336
Step   780: OL 1092.2  490.9  OA  120.0   3.9 CL  120.0   3.9 nm  0.068 s
Step   795: OL 1078.7  474.2  OA  118.2  12.0 CL  118.2  12.0 nm  0.076 s
Step   810: OL 1062.0  457.4  OA  119.2   2.5 CL  119.2   2.5 nm  0.066 s
Step   824: OL 1043.6  441.9  OA  117.0   7.3 CL  117.0   7.3 nm  0.078 s
Step   839: OL 1021.0  425.7  OA  118.4  16.8 CL  118.4  16.8 nm  0.068 s
Step   853: OL  998.8  411.7  OA  118.8  12.2 CL  118.8  12.2 nm  0.067 s
Step   868: OL  975.1  398.0  OA  115.0   6.2 CL  115.0   6.2 nm  0.067 s
Step   883: OL  952.6  386.3  OA  117.3   9.6 CL  117.3   9.6 nm  0.067 s
Step   898: OL  929.9  376.2  OA  113.9  12.3 CL  113.9  12.3 nm  0.068 s
Step   912: OL  907.6  368.3  OA  111.4   5.4 CL  111.4   5.4 nm  0.067 s
Step   927: OL  883.6  361.1  OA  111.0  10.4 CL  111.0  10.4 nm  0.079 s
Step   942: OL  860.1  354.0  OA  115.2   3.2 CL  115.2   3.2 nm  0.069 s
Step   957: OL  837.9  346.5  OA  119.2  11.2 CL  119.2  11.2 nm  0.077 s
Step   972: OL  818.7  338.2  OA  115.2  11.2 CL  115.2  11.2 nm  0.066 s
Step   987: OL  802.3  328.8  OA  115.4  22.4 CL  115.4  22.4 nm  0.069 s
Step  1002: OL  787.6  318.1  OA  113.1   4.8 CL  113.1   4.8 nm  0.073 s
Step  1016: OL  775.4  307.5  OA  115.2   5.2 CL  115.2   5.2 nm  0.070 s
Step  1023 updated high order loop gain: 0.330
Step  1031: OL  764.5  295.8  OA  114.6  17.4 CL  114.6  17.4 nm  0.068 s
Step  1046: OL  755.4  283.1  OA  118.2  15.7 CL  118.2  15.7 nm  0.066 s
Step  1061: OL  746.4  269.0  OA  116.0   8.8 CL  116.0   8.8 nm  0.068 s
Step  1076: OL  739.1  252.9  OA  115.4   8.5 CL  115.4   8.5 nm  0.068 s
Step  1088: OL  735.3  238.8  OA  119.4  22.9 CL  119.4  22.9 nm  0.067 s
Step  1102: OL  732.9  223.2  OA  115.2  10.8 CL  115.2  10.8 nm  0.073 s
Step  1117: OL  732.1  208.1  OA  110.0  14.9 CL  110.0  14.9 nm  0.068 s
Step  1132: OL  732.2  195.3  OA  109.8  18.3 CL  109.8  18.3 nm  0.068 s
Step  1146: OL  732.7  185.6  OA  111.3  22.0 CL  111.3  22.0 nm  0.068 s
Step  1161: OL  733.2  177.6  OA  111.1  21.7 CL  111.1  21.7 nm  0.078 s
Step  1176: OL  734.1  172.3  OA  109.1   5.1 CL  109.1   5.1 nm  0.070 s
Step  1191: OL  736.9  168.8  OA  110.7  15.1 CL  110.7  15.1 nm  0.076 s
Step  1206: OL  740.5  165.8  OA  112.7  12.9 CL  112.7  12.9 nm  0.065 s
Step  1221: OL  744.4  163.8  OA  112.3  17.2 CL  112.3  17.2 nm  0.076 s
Step  1236: OL  747.8  163.7  OA  112.4  25.7 CL  112.4  25.7 nm  0.071 s
Step  1250: OL  750.3  166.0  OA  110.7  19.3 CL  110.7  19.3 nm  0.068 s
Step  1265: OL  754.0  171.4  OA  107.5  24.5 CL  107.5  24.5 nm  0.069 s
Step  1279: OL  758.3  178.5  OA  113.3  24.8 CL  113.3  24.8 nm  0.081 s
Step  1279 updated high order loop gain: 0.322
Step  1294: OL  764.5  187.6  OA  119.3  36.0 CL  119.3  36.0 nm  0.066 s
Step  1309: OL  770.7  198.2  OA  115.8  19.0 CL  115.8  19.0 nm  0.079 s
Step  1324: OL  776.4  210.0  OA  113.1  24.6 CL  113.1  24.6 nm  0.068 s
Step  1338: OL  782.7  222.3  OA  114.5  29.8 CL  114.5  29.8 nm  0.077 s
Step  1353: OL  791.1  236.0  OA  110.2  16.8 CL  110.2  16.8 nm  0.067 s
Step  1368: OL  801.5  248.3  OA  110.3  29.8 CL  110.3  29.8 nm  0.078 s
Step  1383: OL  812.8  258.0  OA  112.7  22.0 CL  112.7  22.0 nm  0.069 s
Step  1398: OL  825.4  265.4  OA  113.6  24.9 CL  113.6  24.9 nm  0.077 s
Step  1412: OL  838.5  270.3  OA  112.8  18.8 CL  112.8  18.8 nm  0.068 s
Step  1426: OL  852.3  273.9  OA  114.9  23.3 CL  114.9  23.3 nm  0.071 s
Step  1441: OL  866.6  277.0  OA  109.4  21.2 CL  109.4  21.2 nm  0.068 s
Step  1456: OL  880.0  279.1  OA  108.1   8.9 CL  108.1   8.9 nm  0.068 s
Step  1471: OL  891.1  279.2  OA  110.4   6.1 CL  110.4   6.1 nm  0.069 s
Step  1486: OL  897.5  277.0  OA  110.0  13.5 CL  110.0  13.5 nm  0.067 s
Step  1501: OL  899.2  272.4  OA  111.0  17.2 CL  111.0  17.2 nm  0.068 s
Step  1516: OL  897.4  266.0  OA  110.6  18.6 CL  110.6  18.6 nm  0.067 s
Step  1531: OL  892.7  258.1  OA  108.5   7.4 CL  108.5   7.4 nm  0.067 s
Step  1535 updated high order loop gain: 0.321
Step  1546: OL  885.2  248.6  OA  110.2  14.6 CL  110.2  14.6 nm  0.068 s
Step  1560: OL  877.5  239.3  OA  114.5  28.6 CL  114.5  28.6 nm  0.070 s
Step  1574: OL  869.6  230.8  OA  115.5  24.2 CL  115.5  24.2 nm  0.066 s
Step  1589: OL  860.0  223.5  OA  114.5  21.6 CL  114.5  21.6 nm  0.067 s
Step 1599: Output PSF
Step  1599: OL  853.3  219.3  OA  115.3   8.9 CL  115.3   8.9 nm  1.206 s
Mean: 114.84 17.34 113.52  nm.

*** Simulation Finished at 2025/02/11 18:55:40 in nid003517. ***

