Warning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid003517/scheduler) failed: Invalid argument. 
/global/u2/b/bpeck/work/vismcao/maos -o studies/reduced_ngs/8_lgs/8mag_lgs/5750count -c master_files/reduced_ngs/8_lgs/8mag_lgs/kola_5750act.conf -O 
Output folder is 'studies/reduced_ngs/8_lgs/8mag_lgs/5750count'.
SRC: /global/homes/b/bpeck/code/maos v2.9 4c88b7c2 2024-11-13 16:45:33 -0800
BUILT: /global/homes/b/bpeck/code/maos/optim by GCC (v12) on 2024/11/18 09:40:03 CPU(F64,+O3) with CUDA(v122,F32)
Launched at 2025/02/11 19:27:54 in nid003517 with PID 1957017.
The web based job monitor can be accessed at http://localhost:10300
Main config file is /global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/8_lgs/8mag_lgs/kola_5750act.conf
Warning(path.c:48): Path not found: path=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/8_lgs/8mag_lgs/bin; abspath=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/8_lgs/8mag_lgs/bin; Ignored.
Warning(path.c:48): Path not found: path=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/8_lgs/8mag_lgs/atm; abspath=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/8_lgs/8mag_lgs/atm; Ignored.
Warning(readcfg.c:399): sim.apfsm has been renamed to powfs.apfsm.
Warning(readcfg.c:399): sim.epfsm has been renamed to powfs.epfsm.
Warning(readcfg.c:399): sim.alfsm has been renamed to powfs.alfsm.
Warning(readcfg.c:399): sim.commonfsm has been renamed to powfs.commonfsm.
Warning(readcfg.c:399): sim.idealfsm has been renamed to powfs.idealfsm.
Warning(readcfg.c:399): sim.zetafsm has been renamed to powfs.zetafsm.
Warning(readcfg.c:399): sim.f0fsm has been renamed to powfs.f0fsm.
Warning(readcfg.c:399): tsurf has been renamed to ncpa.tsurf.
loaded 132 (132 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_sim.conf'
loaded  19 ( 19 new) records from '/global/u2/b/bpeck/work/vismcao/./dm_none.conf'
loaded  19 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_ASM.conf'
loaded  19 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_DM2.conf'
loaded  19 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_DM3.conf'
loaded   0 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_dm_multiple.conf'
loaded   7 (  5 new) records from '/global/u2/b/bpeck/work/vismcao/./atm_mk13n50p_ground_detail.conf'
loaded  76 ( 69 new) records from '/global/homes/b/bpeck/code/maos/config/maos/powfs_common.conf'
loaded  44 ( 38 new) records from '/global/u2/b/bpeck/work/vismcao/./powfs_none.conf'
loaded  44 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_shwfs_lgs.conf'
loaded  44 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_shwfs_ttf_strap.conf'
loaded  44 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_shwfs_twfs_lbwfs.conf'
loaded   0 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_wfs_lgs_strap_lbwfs.conf'
loaded  71 ( 71 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_recon.conf'
Warning(readcfg.c:399): dbg.na_smooth has been renamed to powfs0_llt.na_smooth.
Warning(readcfg.c:399): dbg.na_interp has been renamed to powfs0_llt.na_interp.
Warning(readcfg.c:399): dbg.na_thres has been renamed to powfs0_llt.na_thres.
Warning(readcfg.c:399): dbg.na_fit_maxit has been renamed to powfs0_llt.na_fit_maxit.
Warning(readcfg.c:399): dbg.na_fit_svdthres has been renamed to powfs0_llt.na_fit_svdthres.
Warning(readcfg.c:399): dbg.na_fit_dh has been renamed to powfs0_llt.na_fit_dh.
Warning(readcfg.c:399): dbg.ncpa_preload has been renamed to ncpa.preload.
Warning(readcfg.c:399): dbg.ncpa_rmsci has been renamed to ncpa.rmsci.
Warning(readcfg.c:399): dbg.draw_opdmax has been renamed to plot.opdmax.
Warning(readcfg.c:399): dbg.draw_gmax has been renamed to plot.gmax.
loaded  95 ( 93 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_dbg.conf'
loaded   4 (  4 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_fit_mcao.conf'
Warning(readcfg.c:399): surf has been renamed to ncpa.surf.
loaded  39 (  7 new) records from '/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/8_lgs/8mag_lgs/kola_5750act.conf'
loaded   0 (  0 new) records from 'command line'
loaded  24 ( 18 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_llt_CL.conf'
Adjust LGS range by telescope altitude 4145m.
Zenith angle is 30 degree.
    Scaling turbulence height and LGS hs by sec(za).
    Scaling r0 by cos(za)^(3/5).
    Scaling wind speed and LGS signal level by cos(za).
powfs0: Adjusting dx from 0.0078125 to 0.0080625. 
powfs0.llt.fsm: f0=0 Hz, LPF ep=0
powfs0.epfsm is set to 0.517618 (auto)
powfs2: Adjusting dx from 0.03125 to 0.0312778. 
powfs2 is TWFS for powfs0
sim.ephi is set to 0.427717 (auto)
sim.eplo is set to 0.427717 (auto)
Warning(parms.c:2296): Layer 1 at 17.3205m is very close to layer 0 at 0m (OK).
Warning(parms.c:2296): Layer 2 at 34.641m is very close to layer 1 at 17.3205m (OK).
Warning(parms.c:2296): Layer 3 at 51.9615m is very close to layer 2 at 34.641m (OK).
dm 0: stroke=30 um is provided in micron.
dm 0: assume ia stroke=2 um is provided in micron.
dm 1: stroke=7 um is provided in micron.
dm 1: assume ia stroke=2 um is provided in micron.
dm 2: stroke=7 um is provided in micron.
dm 2: assume ia stroke=2 um is provided in micron.
Focus blending is not implemented yet for integrated tomography
parms->sim.mffocus is reset to 0
There are 1 valid simulation seeds:  1
Output PSF for 1 directions
Used 449 of 456 supplied keys
Warning(readcfg.c:158): key "dbg.pwfs_flate" is not recognized, value is 0
Warning(readcfg.c:158): key "dbg.pwfs_flatv" is not recognized, value is 0
Warning(readcfg.c:158): key "dbg.pwfs_psx" is not recognized, value is [0 0 0 0]
Warning(readcfg.c:158): key "dbg.pwfs_psy" is not recognized, value is [0 0 0 0]
Warning(readcfg.c:158): key "dbg.pwfs_pupelong" is not recognized, value is 0
Warning(readcfg.c:158): key "dbg.pwfs_raw" is not recognized, value is 0
Warning(readcfg.c:158): key "dbg.pwfs_side" is not recognized, value is 4
[00;00mAperture[00;00m is 11 m with sampling 1/128 m
[00;00mTurbulence at 30 degree zenith angle:[00;00m r0=0.128424m, L0=30m, 14 layers.
    Greenwood freq is 25.1Hz, anisoplanatic angle is 1.58 as
    Sampled 8192x8192 at 1/128m. wind dir is randomized.
    layer 0: ht=      0 m, wt= 0.302, ws=  4.8 m/s
    layer 1: ht=     17 m, wt= 0.154, ws=  5.0 m/s
    layer 2: ht=     35 m, wt= 0.041, ws=  5.4 m/s
    layer 3: ht=     52 m, wt= 0.002, ws=  6.6 m/s
    layer 4: ht=    139 m, wt= 0.021, ws=  6.1 m/s
    layer 5: ht=    231 m, wt= 0.010, ws=  6.1 m/s
    layer 6: ht=    323 m, wt= 0.008, ws=  6.1 m/s
    layer 7: ht=    416 m, wt= 0.005, ws=  6.1 m/s
    layer 8: ht=    508 m, wt= 0.001, ws=  6.1 m/s
    layer 9: ht=    932 m, wt= 0.107, ws=  5.6 m/s
    layer 10: ht=   5022 m, wt= 0.144, ws= 11.1 m/s
    layer 11: ht=   9238 m, wt= 0.093, ws= 19.1 m/s
    layer 12: ht=  13856 m, wt= 0.075, ws=  8.2 m/s
    layer 13: ht=  22518 m, wt= 0.036, ws=  4.8 m/s
[00;00mReconstruction[00;00m: r0=0.128424m L0=30m. 14 layers. use cone coordinate.
    layer 0: ht=      0 m, wt= 0.302
    layer 1: ht=     17 m, wt= 0.154
    layer 2: ht=     35 m, wt= 0.041
    layer 3: ht=     52 m, wt= 0.002
    layer 4: ht=    139 m, wt= 0.021
    layer 5: ht=    231 m, wt= 0.010
    layer 6: ht=    323 m, wt= 0.008
    layer 7: ht=    416 m, wt= 0.005
    layer 8: ht=    508 m, wt= 0.001
    layer 9: ht=    932 m, wt= 0.107
    layer 10: ht=   5022 m, wt= 0.144
    layer 11: ht=   9238 m, wt= 0.093
    layer 12: ht=  13856 m, wt= 0.075
    layer 13: ht=  22518 m, wt= 0.036
[00;00mThere are 3 powfs[00;00m
  powfs0: Order 86, LGS at 99.1 km. Sampling 1/124.031 m. Thres 30%. [00;00mT/T is removed in right hand side in tomography.[00;00m
    CCD image is 25x25 @ 500x500 mas, blur 27% (sigma), 1500Hz, wvl: [ 5.89e-07]
    Gtilt in reconstruction. Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
  powfs1: Order  2, NGS at inf km. Sampling 1/16 m. Thres 30%. 
    Ztilt in reconstruction. Geomtric optics start at 2 with ztilt [00;00m(noisy)[00;00m
  powfs2: Order 20, NGS at inf km. Sampling 1/31.9716 m. Thres 50%. 
    CCD image is 4x4 @ 1500x1500 mas, blur 0% (sigma), 0.015Hz, wvl: [ 7.2e-07]
    Gtilt in reconstruction. Geomtric optics start at 50 with gtilt Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
[00;00mThere are 12 wfs[00;00m
    wfs 0: type 0, at (  30.00,    0.00) arcsec,  99 km, siglev is 19.9532 bkgrnd is 0.1
    wfs 1: type 0, at (  21.21,   21.21) arcsec,  99 km, siglev is 19.9532 bkgrnd is 0.1
    wfs 2: type 0, at (   0.00,   30.00) arcsec,  99 km, siglev is 19.9532 bkgrnd is 0.1
    wfs 3: type 0, at ( -21.21,   21.21) arcsec,  99 km, siglev is 19.9532 bkgrnd is 0.1
    wfs 4: type 0, at ( -30.00,    0.00) arcsec,  99 km, siglev is 19.9532 bkgrnd is 0.1
    wfs 5: type 0, at ( -21.21,  -21.21) arcsec,  99 km, siglev is 19.9532 bkgrnd is 0.1
    wfs 6: type 0, at (   0.00,  -30.00) arcsec,  99 km, siglev is 19.9532 bkgrnd is 0.1
    wfs 7: type 0, at (  21.21,  -21.21) arcsec,  99 km, siglev is 19.9532 bkgrnd is 0.1
    wfs 8: type 1, at (   5.00,    8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 9: type 1, at ( -10.00,    0.00) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 10: type 1, at (   5.00,   -8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 11: type 2, at (   0.00,    0.00) arcsec, inf km, siglev is 4.1558e+06 bkgrnd is 0.001
[00;00mThere are 3 DMs[00;00m
  DM 0 at -0.1km, actuator pitch 0.129m, offset   0, with 30.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 1 at    6km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 2 at   10km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
[00;00mTomography[00;00m is using CG, with [00;00mFourer Domain[00;00m preconditioner, [00;00m12[00;00m iterations, integrated tomo.
[00;00mDM Fitting [00;00mis using CG, with [00;00mNo[00;00m preconditioner, [00;00m10[00;00m iterations
[00;00mThere are 9 fit directions[00;00m
    Fit 0: weight is 0.444, at (   0.00,    0.00) arcsec
    Fit 1: weight is 0.111, at (  15.00,    0.00) arcsec
    Fit 2: weight is 0.111, at (   0.00,   15.00) arcsec
    Fit 3: weight is 0.111, at ( -15.00,    0.00) arcsec
    Fit 4: weight is 0.111, at (   0.00,  -15.00) arcsec
    Fit 5: weight is 0.028, at (  15.00,   15.00) arcsec
    Fit 6: weight is 0.028, at ( -15.00,   15.00) arcsec
    Fit 7: weight is 0.028, at ( -15.00,  -15.00) arcsec
    Fit 8: weight is 0.028, at (  15.00,  -15.00) arcsec
[00;00mThere are 1 evaluation directions[00;00m at sampling 1/128 m.
    Evl 0: weight is 1.000, at (   0.00,    0.00) arcsec
[00;00mSimulation[00;00m start at step 0, end at step 1600, with time step 1/1500s, [00;00mclose loop[00;00m.
After setup_parms:	120.5 MiB.
Warning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid003517/scheduler) failed: Invalid argument. 
CUDA: minimum memory requirement is 0.3GB
GPU 0 is NVIDIA A100-SXM4-40GB with arch 8.0, 38.9GB free, 39.3GB total device memory.
Using GPU 0
Use 1 GPUs for WFS Tomo Fit Evl

*** Preparation started at 2025/02/11 19:27:54 in nid003517. ***

Using OpenMP version 201511 with 128 threads
Reading aperture amplitude map from KECK.fits
Warning(accphi.c:477): 108398 points not covered by input screen
Warning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid003517/scheduler) failed: Invalid argument. 
 ->maos.c:447->setup.c:148->aper.c:74->utils.c:478->accphi.c:478
iwvl 0: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 1: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 2: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 3: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 4: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 5: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 6: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 7: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 8: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
After setup_aper:	344.5 MiB.

[00;00mSetting up powfs 0 geom[00;00m

There are 16 points in each subaperture of 0.129m.
There are 4460 valid subaperture.

[00;00mSetting up powfs 1 geom[00;00m

There are 88 points in each subaperture of 5.5m.
There are 4 valid subaperture.

[00;00mSetting up powfs 2 geom[00;00m

There are 18 points in each subaperture of 0.563m.
There are 236 valid subaperture.
After setup_powfs_init:	418.7 MiB.

[00;00mSetting up reconstructor geometry.[00;00m

PLOC is 175x175, with sampling of 0.06m (square)
    DM 0: grid is 89 x 89
    DM 1: grid is 75 x 75
    DM 2: grid is 81 x 81
FLOC is 175x175, with sampling of 0.06m (not square)
Tomography grid is square:
    layer 0: xloc grid is 320 x 320, sampling is 0.065 m, 102400 points
    layer 1: xloc grid is 320 x 320, sampling is 0.064 m, 102400 points
    layer 2: xloc grid is 320 x 320, sampling is 0.064 m, 102400 points
    layer 3: xloc grid is 320 x 320, sampling is 0.064 m, 102400 points
    layer 4: xloc grid is 320 x 320, sampling is 0.064 m, 102400 points
    layer 5: xloc grid is 320 x 320, sampling is 0.064 m, 102400 points
    layer 6: xloc grid is 320 x 320, sampling is 0.064 m, 102400 points
    layer 7: xloc grid is 320 x 320, sampling is 0.064 m, 102400 points
    layer 8: xloc grid is 320 x 320, sampling is 0.064 m, 102400 points
    layer 9: xloc grid is 320 x 320, sampling is 0.064 m, 102400 points
    layer 10: xloc grid is 320 x 320, sampling is 0.061 m, 102400 points
    layer 11: xloc grid is 320 x 320, sampling is 0.058 m, 102400 points
    layer 12: xloc grid is 320 x 320, sampling is 0.055 m, 102400 points
    layer 13: xloc grid is 320 x 320, sampling is 0.050 m, 102400 points

[00;00mSetting up powfs 0 PO WFS[00;00m

OTF dimension is 32x32 (calculated)
Uplink FWHM (illt 0, iwvl 0) is 0.578379"
Downlink FWHM (illt 0, iwvl 0) is 1.49255"
Generating matched filter for powfs 0
sa index   location       noise equivalent angle
    2228: (  4.9,  -0.1) m, (195.24, 187.03) mas
    2219: (  3.7,  -0.1) m, (210.90, 189.13) mas
    2211: (  2.7,  -0.1) m, (229.14, 191.54) mas
    2202: (  1.5,  -0.1) m, (253.77, 194.69) mas
    2200: (  1.3,  -0.1) m, (261.72, 195.67) mas
    1607: ( -0.5,  -1.3) m, (317.46, 216.61) mas
    2194: ( -1.8,  -0.1) m, (340.29, 205.00) mas
    2186: ( -2.8,  -0.1) m, (368.18, 208.19) mas
    2177: ( -4.0,  -0.1) m, (398.23, 211.66) mas
    2169: ( -5.0,  -0.1) m, (426.36, 214.77) mas
    2166: ( -5.4,  -0.1) m, (435.42, 215.85) mas
sa index   location       noise equivalent angle
    4275: (  3.0,   4.1) m, (196.17, 187.85) mas
    3683: (  2.7,   2.7) m, (198.99, 198.99) mas
    3303: (  1.9,   1.9) m, (221.95, 220.69) mas
    2863: (  1.2,   1.2) m, (223.42, 223.42) mas
    2723: (  0.9,   0.9) m, (228.65, 228.65) mas
    1615: (  0.5,  -1.3) m, (237.22, 273.45) mas
    1675: ( -1.2,  -1.2) m, (270.21, 270.21) mas
    1231: ( -1.9,  -1.9) m, (287.55, 287.55) mas
     781: ( -2.8,  -2.8) m, (308.40, 308.40) mas
     535: ( -3.4,  -3.4) m, (320.89, 320.89) mas
     236: ( -3.1,  -4.1) m, (315.32, 340.53) mas
sa index   location       noise equivalent angle
    4108: (  0.0,   3.7) m, (197.59, 217.53) mas
    3662: (  0.0,   2.7) m, (200.20, 236.50) mas
    3073: (  0.0,   1.5) m, (203.61, 262.16) mas
    2927: (  0.0,   1.3) m, (204.66, 270.43) mas
    1996: (  1.2,  -0.5) m, (208.84, 309.17) mas
    1319: (  0.0,  -1.8) m, (214.79, 352.29) mas
     803: (  0.0,  -2.8) m, (218.25, 381.33) mas
     308: (  0.0,  -4.0) m, (222.03, 412.57) mas
     116: (  0.0,  -4.5) m, (223.53, 424.53) mas
       2: ( -2.3,  -4.9) m, (236.21, 436.81) mas
sa index   location       noise equivalent angle
    4228: ( -3.1,   4.1) m, (196.17, 187.85) mas
    3640: ( -2.8,   2.7) m, (198.99, 198.99) mas
    3272: ( -2.1,   1.9) m, (224.48, 224.24) mas
    2844: ( -1.3,   1.2) m, (223.42, 223.42) mas
    2720: ( -1.0,   0.9) m, (228.65, 228.65) mas
    2537: (  1.2,   0.5) m, (273.45, 237.22) mas
    1684: (  1.0,  -1.2) m, (270.21, 270.21) mas
    1260: (  1.8,  -1.9) m, (287.55, 287.55) mas
     824: (  2.7,  -2.8) m, (308.40, 308.40) mas
     586: (  3.2,  -3.4) m, (320.89, 320.89) mas
     283: (  3.0,  -4.1) m, (315.32, 340.53) mas
sa index   location       noise equivalent angle
    2169: ( -5.0,  -0.1) m, (195.24, 187.03) mas
    2178: ( -3.9,  -0.1) m, (210.90, 189.13) mas
    2186: ( -2.8,  -0.1) m, (229.14, 191.54) mas
    2195: ( -1.7,  -0.1) m, (253.77, 194.69) mas
    2197: ( -1.4,  -0.1) m, (261.72, 195.67) mas
    1614: (  0.4,  -1.3) m, (313.31, 212.60) mas
    2203: (  1.7,  -0.1) m, (340.29, 205.00) mas
    2211: (  2.7,  -0.1) m, (368.18, 208.19) mas
    2220: (  3.9,  -0.1) m, (398.23, 211.66) mas
    2228: (  4.9,  -0.1) m, (426.36, 214.77) mas
    2231: (  5.3,  -0.1) m, (435.42, 215.85) mas
sa index   location       noise equivalent angle
     188: ( -3.1,  -4.3) m, (196.17, 187.85) mas
     535: ( -3.4,  -3.4) m, (193.51, 193.51) mas
     843: ( -2.7,  -2.7) m, (201.22, 201.22) mas
    1231: ( -1.9,  -1.9) m, (212.84, 212.84) mas
    1675: ( -1.2,  -1.2) m, (226.04, 226.04) mas
    1931: (  1.2,  -0.6) m, (273.45, 237.22) mas
    2723: (  0.9,   0.9) m, (267.68, 267.68) mas
    2863: (  1.2,   1.2) m, (272.76, 272.76) mas
    3303: (  1.9,   1.9) m, (308.65, 307.50) mas
    3745: (  2.8,   2.8) m, (311.24, 311.24) mas
    4227: (  3.0,   4.0) m, (315.32, 340.53) mas
sa index   location       noise equivalent angle
     356: (  0.0,  -3.9) m, (197.59, 217.53) mas
     803: (  0.0,  -2.8) m, (200.20, 236.50) mas
    1392: (  0.0,  -1.7) m, (203.61, 262.16) mas
    1538: (  0.0,  -1.4) m, (204.66, 270.43) mas
    2470: (  1.2,   0.4) m, (206.97, 307.48) mas
    3146: (  0.0,   1.7) m, (214.79, 352.29) mas
    3662: (  0.0,   2.7) m, (218.25, 381.33) mas
    4156: (  0.0,   3.9) m, (222.03, 412.57) mas
    4348: (  0.0,   4.4) m, (223.53, 424.53) mas
    4446: ( -2.3,   4.8) m, (246.23, 452.21) mas
sa index   location       noise equivalent angle
     235: (  3.0,  -4.3) m, (196.17, 187.85) mas
     764: (  2.8,  -3.0) m, (196.27, 196.27) mas
     884: (  2.6,  -2.7) m, (201.22, 201.22) mas
    1260: (  1.8,  -1.9) m, (212.84, 212.84) mas
    1684: (  1.0,  -1.2) m, (226.04, 226.04) mas
    1928: ( -1.3,  -0.6) m, (273.45, 237.22) mas
    2720: ( -1.0,   0.9) m, (267.68, 267.68) mas
    2844: ( -1.3,   1.2) m, (272.76, 272.76) mas
    3272: ( -2.1,   1.9) m, (312.16, 312.09) mas
    3700: ( -3.0,   2.8) m, (311.24, 311.24) mas
    4180: ( -3.1,   4.0) m, (315.32, 340.53) mas

[00;00mSetting up powfs 2 PO WFS[00;00m

OTF dimension is 48x48 (calculated)
Generating matched filter for powfs 2
Use sanea to derive neasim
Use sanea to derive neasim

[00;00mSetting up reconstructor[00;00m

Recon NEA: cmf(265.62) cmf(264.01) cmf(265.82) cmf(264.08) cmf(265.73) cmf(263.96) cmf(265.63) cmf(263.88) geom(0.31) geom(0.31) geom(0.31) mf(0.14)  mas
Setup or update control matrix parameters.
RRtwfs svd threshold is 1e-10
Replacing HA by HA*fit->actextrap
Adding piston cr to fit matrix
Adding TT cr on upper DMs to fit matrix.
Before assembling fit matrix:	5941.0 MiB.
Building fit->FR
Building fit->FL
Adding tikhonov constraint of 1.0e-07 to FLM
The maximum eigen value is estimated to be around 2.5e-04
DM Fit number of Low rank terms: 16 in LHS
After assemble fit matrix:	8309.1 MiB.
After setup_recon:	8309.1 MiB.
GPU 0: mem used 1624 MB (wfs init)
GPU 0: mem used 3130 MB (recon init)
GPU 0: mem used 3160 MB (perf init)

*** Simulation started at 2025/02/11 19:29:58 in nid003517. ***

Running seed 1
GPU 0: mem used 3162 MB (wfs seeding)
Wind dir: 267.3 261.7 167.0 130.5 300.7  32.3 119.8 139.0 150.8 277.7 203.0 133.1  45.9 265.1 deg
Using /global/homes/b/bpeck/.aos/cache/atm/vonkarman_14_8192x8192_0.0078125_1115374592d.bin
After genatm:	8150.3 MiB.
Step     #  Open Loop  PR TT  On axis  PR TT  Field RMS PR TT     Timing 
Step     0: OL  884.6  248.3  OA  884.6 248.3 CL  884.6 248.3 nm  0.247 s
Step    10: OL  900.0  252.3  OA  232.6 144.3 CL  232.6 144.3 nm  0.082 s
Step    22: OL  919.0  256.4  OA  129.1  25.9 CL  129.1  25.9 nm  0.091 s
Step    33: OL  936.2  259.4  OA  134.8  39.1 CL  134.8  39.1 nm  0.106 s
Step    44: OL  952.8  260.9  OA  120.9  37.5 CL  120.9  37.5 nm  0.095 s
Step    55: OL  969.0  261.1  OA  126.3  36.5 CL  126.3  36.5 nm  0.106 s
Step    66: OL  985.4  260.2  OA  120.8  20.9 CL  120.8  20.9 nm  0.093 s
Step    77: OL 1002.0  259.0  OA  125.6  13.9 CL  125.6  13.9 nm  0.105 s
Step    88: OL 1018.9  258.1  OA  126.3   1.9 CL  126.3   1.9 nm  0.097 s
Step    99: OL 1035.7  257.5  OA  130.0  16.6 CL  130.0  16.6 nm  0.096 s
Step   106: OL 1046.4  257.5  OA  130.9  33.5 CL  130.9  33.5 nm  0.093 s
Step   117: OL 1063.2  258.2  OA  121.1  25.9 CL  121.1  25.9 nm  0.097 s
Step   128: OL 1079.2  259.8  OA  123.6  22.3 CL  123.6  22.3 nm  0.100 s
Step   139: OL 1094.4  263.0  OA  127.8  25.2 CL  127.8  25.2 nm  0.092 s
Step   150: OL 1108.6  267.3  OA  124.4  14.1 CL  124.4  14.1 nm  0.095 s
Step   161: OL 1121.1  272.7  OA  130.0  27.7 CL  130.0  27.7 nm  0.092 s
Step   172: OL 1132.2  279.0  OA  133.2  46.4 CL  133.2  46.4 nm  0.096 s
Step   183: OL 1141.5  285.9  OA  126.0  21.9 CL  126.0  21.9 nm  0.093 s
Step   194: OL 1148.8  293.1  OA  119.5  19.5 CL  119.5  19.5 nm  0.092 s
Step   205: OL 1154.5  300.1  OA  127.8  41.2 CL  127.8  41.2 nm  0.098 s
Step   216: OL 1158.9  307.1  OA  130.0  34.2 CL  130.0  34.2 nm  0.092 s
Step   227: OL 1161.5  314.2  OA  117.2  21.4 CL  117.2  21.4 nm  0.093 s
Step   238: OL 1162.3  321.5  OA  130.0  53.4 CL  130.0  53.4 nm  0.097 s
Step   249: OL 1161.1  329.2  OA  126.5  29.7 CL  126.5  29.7 nm  0.096 s
Step   255 updated high order loop gain: 0.341
Step   260: OL 1157.0  337.1  OA  124.4  41.4 CL  124.4  41.4 nm  0.103 s
Step   271: OL 1150.1  345.0  OA  123.0  43.1 CL  123.0  43.1 nm  0.092 s
Step   281: OL 1141.7  352.3  OA  116.5  20.5 CL  116.5  20.5 nm  0.096 s
Step   292: OL 1130.9  361.2  OA  118.1  25.3 CL  118.1  25.3 nm  0.093 s
Step   303: OL 1119.2  370.8  OA  117.8  28.1 CL  117.8  28.1 nm  0.094 s
Step   314: OL 1106.1  380.9  OA  122.1  34.2 CL  122.1  34.2 nm  0.097 s
Step   325: OL 1091.9  391.7  OA  115.2  32.7 CL  115.2  32.7 nm  0.096 s
Step   336: OL 1077.3  403.8  OA  119.2  25.4 CL  119.2  25.4 nm  0.103 s
Step   347: OL 1062.7  417.1  OA  116.0  29.4 CL  116.0  29.4 nm  0.094 s
Step   358: OL 1048.4  431.6  OA  118.7  23.5 CL  118.7  23.5 nm  0.105 s
Step   369: OL 1034.7  447.1  OA  124.4  40.4 CL  124.4  40.4 nm  0.090 s
Step   380: OL 1021.6  462.9  OA  113.5   7.1 CL  113.5   7.1 nm  0.107 s
Step   391: OL 1009.0  478.8  OA  117.1  27.1 CL  117.1  27.1 nm  0.095 s
Step   402: OL  996.5  494.6  OA  116.7  15.8 CL  116.7  15.8 nm  0.093 s
Step   413: OL  983.9  510.1  OA  117.8  17.2 CL  117.8  17.2 nm  0.110 s
Step   424: OL  971.0  524.8  OA  111.5  19.5 CL  111.5  19.5 nm  0.093 s
Step   435: OL  958.5  539.4  OA  113.5   7.0 CL  113.5   7.0 nm  0.104 s
Step   446: OL  946.6  553.7  OA  118.0  36.4 CL  118.0  36.4 nm  0.098 s
Step   457: OL  936.6  568.1  OA  113.4  13.1 CL  113.4  13.1 nm  0.093 s
Step   468: OL  929.0  582.5  OA  115.9  11.3 CL  115.9  11.3 nm  0.097 s
Step   479: OL  924.2  596.5  OA  121.8  32.3 CL  121.8  32.3 nm  0.092 s
Step   490: OL  922.6  610.1  OA  114.7  18.7 CL  114.7  18.7 nm  0.110 s
Step   501: OL  923.3  623.1  OA  116.8  13.6 CL  116.8  13.6 nm  0.108 s
Step   511 updated high order loop gain: 0.287
Step   512: OL  925.4  635.0  OA  123.7  33.8 CL  123.7  33.8 nm  0.100 s
Step   523: OL  929.2  645.5  OA  113.4  20.8 CL  113.4  20.8 nm  0.104 s
Step   534: OL  934.1  654.1  OA  116.3  17.8 CL  116.3  17.8 nm  0.095 s
Step   545: OL  940.7  660.6  OA  118.0   0.8 CL  118.0   0.8 nm  0.096 s
Step   556: OL  948.9  665.4  OA  115.5  14.6 CL  115.5  14.6 nm  0.095 s
Step   566: OL  957.6  668.2  OA  108.6   8.5 CL  108.6   8.5 nm  0.098 s
Step   577: OL  968.2  670.0  OA  108.5  15.5 CL  108.5  15.5 nm  0.091 s
Step   587: OL  978.8  670.5  OA  114.5   5.4 CL  114.5   5.4 nm  0.092 s
Step   598: OL  991.5  669.3  OA  113.9  10.9 CL  113.9  10.9 nm  0.094 s
Step   609: OL 1004.5  665.9  OA  117.0   9.1 CL  117.0   9.1 nm  0.108 s
Step   620: OL 1017.7  660.7  OA  114.5   4.8 CL  114.5   4.8 nm  0.093 s
Step   631: OL 1030.6  653.9  OA  112.7  12.4 CL  112.7  12.4 nm  0.104 s
Step   642: OL 1043.0  645.4  OA  113.4   7.9 CL  113.4   7.9 nm  0.092 s
Step   653: OL 1054.3  635.8  OA  115.4  15.1 CL  115.4  15.1 nm  0.094 s
Step   664: OL 1064.7  625.1  OA  119.4  12.0 CL  119.4  12.0 nm  0.092 s
Step   675: OL 1074.5  613.6  OA  118.7  16.7 CL  118.7  16.7 nm  0.091 s
Step   686: OL 1083.8  602.2  OA  119.5  24.6 CL  119.5  24.6 nm  0.092 s
Step   697: OL 1092.1  590.2  OA  116.7   8.0 CL  116.7   8.0 nm  0.097 s
Step   708: OL 1098.8  577.4  OA  124.8  31.8 CL  124.8  31.8 nm  0.101 s
Step   719: OL 1103.4  563.9  OA  121.6  16.8 CL  121.6  16.8 nm  0.099 s
Step   729: OL 1105.9  551.5  OA  114.5  16.5 CL  114.5  16.5 nm  0.099 s
Step   740: OL 1106.4  537.9  OA  113.8   8.1 CL  113.8   8.1 nm  0.093 s
Step   751: OL 1104.9  524.5  OA  120.7  18.4 CL  120.7  18.4 nm  0.101 s
Step   762: OL 1101.2  511.5  OA  119.0  24.8 CL  119.0  24.8 nm  0.095 s
Step   767 updated high order loop gain: 0.262
Step   773: OL 1095.5  498.9  OA  120.3   9.2 CL  120.3   9.2 nm  0.110 s
Step   784: OL 1087.4  486.5  OA  118.5  20.0 CL  118.5  20.0 nm  0.088 s
Step   795: OL 1076.9  474.2  OA  117.5   9.7 CL  117.5   9.7 nm  0.106 s
Step   806: OL 1064.8  462.0  OA  125.2  34.4 CL  125.2  34.4 nm  0.093 s
Step   817: OL 1051.0  449.7  OA  118.4  14.1 CL  118.4  14.1 nm  0.092 s
Step   828: OL 1035.5  437.6  OA  120.2   3.8 CL  120.2   3.8 nm  0.092 s
Step   839: OL 1018.7  425.8  OA  116.2   6.0 CL  116.2   6.0 nm  0.091 s
Step   850: OL 1001.1  414.7  OA  120.7  30.1 CL  120.7  30.1 nm  0.096 s
Step   861: OL  983.5  404.3  OA  118.8   8.8 CL  118.8   8.8 nm  0.091 s
Step   872: OL  966.3  394.8  OA  115.2   5.2 CL  115.2   5.2 nm  0.092 s
Step   883: OL  950.1  386.4  OA  118.3  15.3 CL  118.3  15.3 nm  0.092 s
Step   894: OL  933.6  378.9  OA  110.7   2.5 CL  110.7   2.5 nm  0.157 s
Step   905: OL  916.6  372.2  OA  118.3  23.6 CL  118.3  23.6 nm  0.102 s
Step   916: OL  899.1  366.5  OA  113.5  15.9 CL  113.5  15.9 nm  0.092 s
Step   927: OL  881.8  361.2  OA  114.6   6.1 CL  114.6   6.1 nm  0.092 s
Step   938: OL  864.9  356.0  OA  114.0  16.2 CL  114.0  16.2 nm  0.096 s
Step   949: OL  848.6  350.7  OA  114.6  18.7 CL  114.6  18.7 nm  0.096 s
Step   960: OL  833.4  345.1  OA  118.9  17.6 CL  118.9  17.6 nm  0.104 s
Step   971: OL  820.0  338.9  OA  120.0  18.1 CL  120.0  18.1 nm  0.092 s
Step   982: OL  808.1  332.2  OA  116.9  15.8 CL  116.9  15.8 nm  0.100 s
Step   993: OL  797.4  324.8  OA  117.8  13.3 CL  117.8  13.3 nm  0.093 s
Step  1004: OL  787.4  316.7  OA  118.9   4.8 CL  118.9   4.8 nm  0.101 s
Step  1015: OL  778.2  308.3  OA  127.8  37.7 CL  127.8  37.7 nm  0.091 s
Step  1023 updated high order loop gain: 0.249
Step  1026: OL  770.3  299.9  OA  118.6  18.8 CL  118.6  18.8 nm  0.094 s
Step  1037: OL  763.3  290.9  OA  113.8  17.9 CL  113.8  17.9 nm  0.098 s
Step  1048: OL  756.9  281.4  OA  117.5  15.1 CL  117.5  15.1 nm  0.091 s
Step  1059: OL  750.2  271.1  OA  120.6  23.3 CL  120.6  23.3 nm  0.106 s
Step  1070: OL  744.2  259.7  OA  120.8  16.0 CL  120.8  16.0 nm  0.090 s
Step  1081: OL  739.7  247.1  OA  116.3  14.9 CL  116.3  14.9 nm  0.094 s
Step  1092: OL  736.8  234.3  OA  113.4   9.2 CL  113.4   9.2 nm  0.095 s
Step  1103: OL  735.1  222.2  OA  116.3  10.8 CL  116.3  10.8 nm  0.094 s
Step  1114: OL  734.1  211.0  OA  120.2  31.3 CL  120.2  31.3 nm  0.092 s
Step  1125: OL  733.8  200.9  OA  110.8  12.8 CL  110.8  12.8 nm  0.093 s
Step  1136: OL  733.8  192.4  OA  111.3  18.3 CL  111.3  18.3 nm  0.099 s
Step  1147: OL  734.2  185.0  OA  107.2   8.0 CL  107.2   8.0 nm  0.092 s
Step  1158: OL  734.4  179.0  OA  111.3  28.5 CL  111.3  28.5 nm  0.094 s
Step  1169: OL  734.6  174.5  OA  113.4  12.4 CL  113.4  12.4 nm  0.098 s
Step  1180: OL  735.5  171.3  OA  106.6  20.6 CL  106.6  20.6 nm  0.093 s
Step  1191: OL  737.6  168.8  OA  108.4   8.5 CL  108.4   8.5 nm  0.097 s
Step  1202: OL  740.1  166.6  OA  113.5   8.9 CL  113.5   8.9 nm  0.096 s
Step  1213: OL  742.6  164.7  OA  109.0   8.4 CL  109.0   8.4 nm  0.091 s
Step  1224: OL  745.4  163.6  OA  106.4   4.6 CL  106.4   4.6 nm  0.093 s
Step  1235: OL  747.7  163.6  OA  108.5  19.7 CL  108.5  19.7 nm  0.094 s
Step  1246: OL  749.6  165.1  OA  112.3  22.7 CL  112.3  22.7 nm  0.091 s
Step  1257: OL  751.9  168.2  OA  108.5  17.2 CL  108.5  17.2 nm  0.090 s
Step  1268: OL  754.8  172.8  OA  110.4  18.5 CL  110.4  18.5 nm  0.096 s
Step  1279: OL  758.2  178.5  OA  109.9  20.0 CL  109.9  20.0 nm  0.093 s
Step  1279 updated high order loop gain: 0.240
Step  1290: OL  762.7  185.0  OA  116.1  28.1 CL  116.1  28.1 nm  0.110 s
Step  1301: OL  767.3  192.4  OA  116.3  25.9 CL  116.3  25.9 nm  0.093 s
Step  1312: OL  771.6  200.4  OA  116.7  22.9 CL  116.7  22.9 nm  0.103 s
Step  1323: OL  775.7  209.2  OA  115.8  31.2 CL  115.8  31.2 nm  0.092 s
Step  1334: OL  780.3  218.7  OA  114.7  27.0 CL  114.7  27.0 nm  0.094 s
Step  1345: OL  785.9  228.8  OA  112.8  21.9 CL  112.8  21.9 nm  0.090 s
Step  1355: OL  791.9  237.8  OA  120.4  47.2 CL  120.4  47.2 nm  0.093 s
Step  1366: OL  799.7  246.8  OA  113.3  15.6 CL  113.3  15.6 nm  0.092 s
Step  1377: OL  807.7  254.4  OA  115.2  31.8 CL  115.2  31.8 nm  0.093 s
Step  1388: OL  816.3  260.7  OA  112.1  30.8 CL  112.1  30.8 nm  0.101 s
Step  1399: OL  825.9  265.8  OA  115.2  14.6 CL  115.2  14.6 nm  0.094 s
Step  1410: OL  836.2  269.7  OA  115.2  23.2 CL  115.2  23.2 nm  0.104 s
Step  1421: OL  847.0  272.8  OA  112.7  23.2 CL  112.7  23.2 nm  0.093 s
Step  1432: OL  857.7  275.3  OA  116.2  29.4 CL  116.2  29.4 nm  0.097 s
Step  1443: OL  867.8  277.4  OA  113.2  20.4 CL  113.2  20.4 nm  0.103 s
Step  1454: OL  877.5  278.9  OA  114.2  20.3 CL  114.2  20.3 nm  0.090 s
Step  1465: OL  886.0  279.4  OA  110.4   3.3 CL  110.4   3.3 nm  0.103 s
Step  1476: OL  892.3  278.8  OA  113.0   5.1 CL  113.0   5.1 nm  0.090 s
Step  1487: OL  896.0  276.8  OA  110.9   4.2 CL  110.9   4.2 nm  0.091 s
Step  1498: OL  897.3  273.6  OA  109.7   8.1 CL  109.7   8.1 nm  0.093 s
Step  1509: OL  896.3  269.2  OA  110.6   7.2 CL  110.6   7.2 nm  0.093 s
Step  1520: OL  893.8  264.1  OA  109.9  18.3 CL  109.9  18.3 nm  0.094 s
Step  1531: OL  889.8  258.1  OA  107.9  25.2 CL  107.9  25.2 nm  0.090 s
Step  1535 updated high order loop gain: 0.238
Step  1542: OL  884.1  251.2  OA  111.1  17.5 CL  111.1  17.5 nm  0.103 s
Step  1553: OL  877.9  244.0  OA  115.7  27.9 CL  115.7  27.9 nm  0.095 s
Step  1564: OL  871.6  236.8  OA  113.9  17.8 CL  113.9  17.8 nm  0.093 s
Step  1575: OL  865.0  230.3  OA  116.6  19.7 CL  116.6  19.7 nm  0.092 s
Step  1586: OL  858.1  224.9  OA  114.8   8.5 CL  114.8   8.5 nm  0.102 s
Step  1597: OL  850.8  220.2  OA  116.1  15.7 CL  116.1  15.7 nm  0.094 s
Step 1599: Output PSF
Step  1599: OL  849.4  219.4  OA  113.4  16.0 CL  113.4  16.0 nm  1.257 s
Mean: 115.35 19.14 113.75  nm.

*** Simulation Finished at 2025/02/11 19:32:45 in nid003517. ***

