---------------------------
Job id = 35949881
Proc id = 0
nid001972
Mon 17 Feb 2025 02:43:19 PM PST
---------------------------
/var/spool/slurmd/job35949881/slurm_script: line 17: cd: /global/homes/b/bpeck/work/vismcao: No such file or directory
[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: No such file or directory. 
[00;00m[0;36mWarning(daemonize.c:230): Error redirect stdout
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
/global/cfs/cdirs/ulens/vismcao/maos -o studies/reduced_ngs/9_lgs/8mag_lgs/1000count -c master_files/reduced_ngs/9_lgs/8mag_lgs/kola_1000act.conf -O 
Output folder is 'studies/reduced_ngs/9_lgs/8mag_lgs/1000count'.
SRC: /global/homes/b/bpeck/code/maos v2.9 4c88b7c2 2024-11-13 16:45:33 -0800
BUILT: /global/homes/b/bpeck/code/maos/optim by GCC (v12) on 2024/11/18 09:40:03 CPU(F64,+O3) with CUDA(v122,F32)
Launched at 2025/02/17 14:43:47 in nid001972 with PID 1689197.
The web based job monitor can be accessed at http://localhost:10300
Main config file is /global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_1000act.conf
[00;00m[0;36mWarning(path.c:48): Path not found: path=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; abspath=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; Ignored.
[00;00m[0;36mWarning(path.c:48): Path not found: path=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; abspath=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; Ignored.
[00;00m[0;36mWarning(readcfg.c:399): sim.apfsm has been renamed to powfs.apfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.epfsm has been renamed to powfs.epfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.alfsm has been renamed to powfs.alfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.commonfsm has been renamed to powfs.commonfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.idealfsm has been renamed to powfs.idealfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.zetafsm has been renamed to powfs.zetafsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.f0fsm has been renamed to powfs.f0fsm.
[00;00m[0;36mWarning(readcfg.c:399): tsurf has been renamed to ncpa.tsurf.
loaded 132 (132 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_sim.conf'
loaded  19 ( 19 new) records from '/global/cfs/cdirs/ulens/vismcao/./dm_none.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_ASM.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_DM2.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_DM3.conf'
loaded   0 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_dm_multiple.conf'
loaded   7 (  5 new) records from '/global/cfs/cdirs/ulens/vismcao/./atm_mk13n50p_ground_detail.conf'
loaded  76 ( 69 new) records from '/global/homes/b/bpeck/code/maos/config/maos/powfs_common.conf'
loaded  44 ( 38 new) records from '/global/cfs/cdirs/ulens/vismcao/./powfs_none.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_lgs.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_ttf_strap.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_twfs_lbwfs.conf'
loaded   0 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_wfs_lgs_strap_lbwfs.conf'
loaded  71 ( 71 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_recon.conf'
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_smooth has been renamed to powfs0_llt.na_smooth.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_interp has been renamed to powfs0_llt.na_interp.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_thres has been renamed to powfs0_llt.na_thres.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_maxit has been renamed to powfs0_llt.na_fit_maxit.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_svdthres has been renamed to powfs0_llt.na_fit_svdthres.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_dh has been renamed to powfs0_llt.na_fit_dh.
[00;00m[0;36mWarning(readcfg.c:399): dbg.ncpa_preload has been renamed to ncpa.preload.
[00;00m[0;36mWarning(readcfg.c:399): dbg.ncpa_rmsci has been renamed to ncpa.rmsci.
[00;00m[0;36mWarning(readcfg.c:399): dbg.draw_opdmax has been renamed to plot.opdmax.
[00;00m[0;36mWarning(readcfg.c:399): dbg.draw_gmax has been renamed to plot.gmax.
loaded  95 ( 93 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_dbg.conf'
loaded   4 (  4 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_fit_mcao.conf'
[00;00m[0;36mWarning(readcfg.c:399): surf has been renamed to ncpa.surf.
loaded  39 (  7 new) records from '/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_1000act.conf'
loaded   0 (  0 new) records from 'command line'
loaded  24 ( 18 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_llt_CL.conf'
Adjust LGS range by telescope altitude 4145m.
Zenith angle is 30 degree.
    Scaling turbulence height and LGS hs by sec(za).
    Scaling r0 by cos(za)^(3/5).
    Scaling wind speed and LGS signal level by cos(za).
powfs0: Adjusting dx from 0.0078125 to 0.0077. 
powfs0.llt.fsm: f0=0 Hz, LPF ep=0
powfs0.epfsm is set to 0.517618 (auto)
powfs2: Adjusting dx from 0.03125 to 0.0312778. 
powfs2 is TWFS for powfs0
sim.ephi is set to 0.427717 (auto)
sim.eplo is set to 0.427717 (auto)
[00;00m[0;36mWarning(parms.c:2296): Layer 1 at 17.3205m is very close to layer 0 at 0m (OK).
[00;00m[0;36mWarning(parms.c:2296): Layer 2 at 34.641m is very close to layer 1 at 17.3205m (OK).
[00;00m[0;36mWarning(parms.c:2296): Layer 3 at 51.9615m is very close to layer 2 at 34.641m (OK).
dm 0: stroke=30 um is provided in micron.
dm 0: assume ia stroke=2 um is provided in micron.
dm 1: stroke=7 um is provided in micron.
dm 1: assume ia stroke=2 um is provided in micron.
dm 2: stroke=7 um is provided in micron.
dm 2: assume ia stroke=2 um is provided in micron.
Focus blending is not implemented yet for integrated tomography
parms->sim.mffocus is reset to 0
There are 1 valid simulation seeds:  1
Output PSF for 1 directions
Used 449 of 456 supplied keys
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_flate" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_flatv" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_psx" is not recognized, value is [0 0 0 0]
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_psy" is not recognized, value is [0 0 0 0]
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_pupelong" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_raw" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_side" is not recognized, value is 4
[00;00mAperture[00;00m is 11 m with sampling 1/128 m
[00;00mTurbulence at 30 degree zenith angle:[00;00m r0=0.128424m, L0=30m, 14 layers.
    Greenwood freq is 25.1Hz, anisoplanatic angle is 1.58 as
    Sampled 8192x8192 at 1/128m. wind dir is randomized.
    layer 0: ht=      0 m, wt= 0.302, ws=  4.8 m/s
    layer 1: ht=     17 m, wt= 0.154, ws=  5.0 m/s
    layer 2: ht=     35 m, wt= 0.041, ws=  5.4 m/s
    layer 3: ht=     52 m, wt= 0.002, ws=  6.6 m/s
    layer 4: ht=    139 m, wt= 0.021, ws=  6.1 m/s
    layer 5: ht=    231 m, wt= 0.010, ws=  6.1 m/s
    layer 6: ht=    323 m, wt= 0.008, ws=  6.1 m/s
    layer 7: ht=    416 m, wt= 0.005, ws=  6.1 m/s
    layer 8: ht=    508 m, wt= 0.001, ws=  6.1 m/s
    layer 9: ht=    932 m, wt= 0.107, ws=  5.6 m/s
    layer 10: ht=   5022 m, wt= 0.144, ws= 11.1 m/s
    layer 11: ht=   9238 m, wt= 0.093, ws= 19.1 m/s
    layer 12: ht=  13856 m, wt= 0.075, ws=  8.2 m/s
    layer 13: ht=  22518 m, wt= 0.036, ws=  4.8 m/s
[00;00mReconstruction[00;00m: r0=0.128424m L0=30m. 14 layers. use cone coordinate.
    layer 0: ht=      0 m, wt= 0.302
    layer 1: ht=     17 m, wt= 0.154
    layer 2: ht=     35 m, wt= 0.041
    layer 3: ht=     52 m, wt= 0.002
    layer 4: ht=    139 m, wt= 0.021
    layer 5: ht=    231 m, wt= 0.010
    layer 6: ht=    323 m, wt= 0.008
    layer 7: ht=    416 m, wt= 0.005
    layer 8: ht=    508 m, wt= 0.001
    layer 9: ht=    932 m, wt= 0.107
    layer 10: ht=   5022 m, wt= 0.144
    layer 11: ht=   9238 m, wt= 0.093
    layer 12: ht=  13856 m, wt= 0.075
    layer 13: ht=  22518 m, wt= 0.036
[00;00mThere are 3 powfs[00;00m
  powfs0: Order 36, LGS at 99.1 km. Sampling 1/129.87 m. Thres 30%. [00;00mT/T is removed in right hand side in tomography.[00;00m
    CCD image is 25x25 @ 500x500 mas, blur 27% (sigma), 1500Hz, wvl: [ 5.89e-07]
    Gtilt in reconstruction. Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
  powfs1: Order  2, NGS at inf km. Sampling 1/16 m. Thres 30%. 
    Ztilt in reconstruction. Geomtric optics start at 2 with ztilt [00;00m(noisy)[00;00m
  powfs2: Order 20, NGS at inf km. Sampling 1/31.9716 m. Thres 50%. 
    CCD image is 4x4 @ 1500x1500 mas, blur 0% (sigma), 0.015Hz, wvl: [ 7.2e-07]
    Gtilt in reconstruction. Geomtric optics start at 50 with gtilt Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
[00;00mThere are 13 wfs[00;00m
    wfs 0: type 0, at (  30.00,    0.00) arcsec,  99 km, siglev is 113.746 bkgrnd is 0.1
    wfs 1: type 0, at (  22.98,   19.28) arcsec,  99 km, siglev is 113.746 bkgrnd is 0.1
    wfs 2: type 0, at (   5.21,   29.54) arcsec,  99 km, siglev is 113.746 bkgrnd is 0.1
    wfs 3: type 0, at ( -15.00,   25.98) arcsec,  99 km, siglev is 113.746 bkgrnd is 0.1
    wfs 4: type 0, at ( -28.19,   10.26) arcsec,  99 km, siglev is 113.746 bkgrnd is 0.1
    wfs 5: type 0, at ( -28.19,  -10.26) arcsec,  99 km, siglev is 113.746 bkgrnd is 0.1
    wfs 6: type 0, at ( -15.00,  -25.98) arcsec,  99 km, siglev is 113.746 bkgrnd is 0.1
    wfs 7: type 0, at (   5.21,  -29.54) arcsec,  99 km, siglev is 113.746 bkgrnd is 0.1
    wfs 8: type 0, at (  22.98,  -19.28) arcsec,  99 km, siglev is 113.746 bkgrnd is 0.1
    wfs 9: type 1, at (   5.00,    8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 10: type 1, at ( -10.00,    0.00) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 11: type 1, at (   5.00,   -8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 12: type 2, at (   0.00,    0.00) arcsec, inf km, siglev is 4.1558e+06 bkgrnd is 0.001
[00;00mThere are 3 DMs[00;00m
  DM 0 at -0.1km, actuator pitch 0.308m, offset   0, with 30.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 1 at    6km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 2 at   10km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
[00;00mTomography[00;00m is using CG, with [00;00mFourer Domain[00;00m preconditioner, [00;00m12[00;00m iterations, integrated tomo.
[00;00mDM Fitting [00;00mis using CG, with [00;00mNo[00;00m preconditioner, [00;00m10[00;00m iterations
[00;00mThere are 9 fit directions[00;00m
    Fit 0: weight is 0.444, at (   0.00,    0.00) arcsec
    Fit 1: weight is 0.111, at (  15.00,    0.00) arcsec
    Fit 2: weight is 0.111, at (   0.00,   15.00) arcsec
    Fit 3: weight is 0.111, at ( -15.00,    0.00) arcsec
    Fit 4: weight is 0.111, at (   0.00,  -15.00) arcsec
    Fit 5: weight is 0.028, at (  15.00,   15.00) arcsec
    Fit 6: weight is 0.028, at ( -15.00,   15.00) arcsec
    Fit 7: weight is 0.028, at ( -15.00,  -15.00) arcsec
    Fit 8: weight is 0.028, at (  15.00,  -15.00) arcsec
[00;00mThere are 1 evaluation directions[00;00m at sampling 1/128 m.
    Evl 0: weight is 1.000, at (   0.00,    0.00) arcsec
[00;00mSimulation[00;00m start at step 0, end at step 1600, with time step 1/1500s, [00;00mclose loop[00;00m.
After setup_parms:	120.5 MiB.
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
CUDA: minimum memory requirement is 0.4GB
GPU 0 is NVIDIA A100-SXM4-40GB with arch 8.0, 38.9GB free, 39.3GB total device memory.
Using GPU 0
Use 1 GPUs for WFS Tomo Fit Evl

*** Preparation started at 2025/02/17 14:43:48 in nid001972. ***

Using OpenMP version 201511 with 128 threads
Reading aperture amplitude map from KECK.fits
[00;00m[0;36mWarning(accphi.c:477): 108520 points not covered by input screen
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
 ->maos.c:447->setup.c:148->aper.c:74->utils.c:478->accphi.c:478
iwvl 0: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 1: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 2: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 3: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 4: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 5: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 6: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 7: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 8: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
After setup_aper:	341.1 MiB.

[00;00mSetting up powfs 0 geom[00;00m

There are 40 points in each subaperture of 0.308m.
There are 787 valid subaperture.

[00;00mSetting up powfs 1 geom[00;00m

There are 88 points in each subaperture of 5.5m.
There are 4 valid subaperture.

[00;00mSetting up powfs 2 geom[00;00m

There are 18 points in each subaperture of 0.563m.
There are 236 valid subaperture.
After setup_powfs_init:	411.5 MiB.

[00;00mSetting up reconstructor geometry.[00;00m

PLOC is 75x75, with sampling of 0.15m (square)
    DM 0: grid is 39 x 39
    DM 1: grid is 75 x 75
    DM 2: grid is 80 x 79
FLOC is 75x75, with sampling of 0.15m (not square)
Tomography grid is square:
    layer 0: xloc grid is 140 x 140, sampling is 0.154 m, 19600 points
    layer 1: xloc grid is 140 x 140, sampling is 0.154 m, 19600 points
    layer 2: xloc grid is 140 x 140, sampling is 0.154 m, 19600 points
    layer 3: xloc grid is 140 x 140, sampling is 0.154 m, 19600 points
    layer 4: xloc grid is 140 x 140, sampling is 0.154 m, 19600 points
    layer 5: xloc grid is 140 x 140, sampling is 0.154 m, 19600 points
    layer 6: xloc grid is 140 x 140, sampling is 0.153 m, 19600 points
    layer 7: xloc grid is 140 x 140, sampling is 0.153 m, 19600 points
    layer 8: xloc grid is 140 x 140, sampling is 0.153 m, 19600 points
    layer 9: xloc grid is 140 x 140, sampling is 0.153 m, 19600 points
    layer 10: xloc grid is 140 x 140, sampling is 0.146 m, 19600 points
    layer 11: xloc grid is 140 x 140, sampling is 0.140 m, 19600 points
    layer 12: xloc grid is 140 x 140, sampling is 0.132 m, 19600 points
    layer 13: xloc grid is 140 x 140, sampling is 0.119 m, 19600 points

[00;00mSetting up powfs 0 PO WFS[00;00m

OTF dimension is 80x80 (calculated)
Uplink FWHM (illt 0, iwvl 0) is 0.580135"
Downlink FWHM (illt 0, iwvl 0) is 1.07529"
Generating matched filter for powfs 0
sa index   location       noise equivalent angle
     392: (  4.9,  -0.3) m, ( 57.13,  55.63) mas
     388: (  3.7,  -0.3) m, ( 61.18,  56.13) mas
     385: (  2.8,  -0.3) m, ( 65.41,  56.54) mas
     381: (  1.5,  -0.3) m, ( 72.76,  57.07) mas
     380: (  1.2,  -0.3) m, ( 74.62,  57.19) mas
     269: ( -0.6,  -1.5) m, ( 86.28,  59.01) mas
     378: ( -1.8,  -0.3) m, ( 93.80,  58.20) mas
     375: ( -2.8,  -0.3) m, ( 99.93,  58.50) mas
     371: ( -4.0,  -0.3) m, (108.66,  58.88) mas
     368: ( -4.9,  -0.3) m, (115.35,  59.15) mas
     367: ( -5.2,  -0.3) m, (117.66,  59.24) mas
sa index   location       noise equivalent angle
     666: (  3.4,   2.8) m, ( 57.38,  56.93) mas
     583: (  2.2,   1.8) m, ( 61.73,  59.87) mas
     522: (  1.5,   1.2) m, ( 65.50,  64.20) mas
     490: (  0.9,   0.9) m, ( 67.95,  63.84) mas
     515: ( -0.6,   1.2) m, ( 77.13,  62.76) mas
     297: ( -1.2,  -1.2) m, ( 80.31,  75.18) mas
     265: ( -1.8,  -1.5) m, ( 86.86,  79.45) mas
     204: ( -2.5,  -2.2) m, ( 87.71,  80.43) mas
     121: ( -3.7,  -3.1) m, ( 95.36,  85.84) mas
      12: ( -3.1,  -4.6) m, ( 93.75,  98.79) mas
sa index   location       noise equivalent angle
     782: (  0.6,   4.6) m, ( 57.48,  59.49) mas
     767: (  0.6,   4.3) m, ( 55.88,  58.47) mas
     630: (  0.3,   2.5) m, ( 56.92,  66.58) mas
     604: (  0.3,   2.2) m, ( 57.05,  68.19) mas
     517: (  0.0,   1.2) m, ( 58.27,  74.65) mas
     379: ( -1.5,  -0.3) m, ( 62.49,  84.55) mas
     270: ( -0.3,  -1.5) m, ( 61.65,  95.16) mas
     157: ( -0.6,  -2.8) m, ( 59.90,  99.51) mas
     131: ( -0.6,  -3.1) m, ( 59.97, 101.57) mas
      19: ( -0.9,  -4.6) m, ( 61.04, 112.90) mas
       1: ( -2.5,  -4.9) m, ( 68.53, 118.71) mas
sa index   location       noise equivalent angle
     756: ( -2.8,   4.3) m, ( 55.90,  56.68) mas
     697: ( -2.2,   3.4) m, ( 57.53,  59.50) mas
     649: ( -1.8,   2.8) m, ( 58.11,  61.71) mas
     514: ( -0.9,   1.2) m, ( 61.45,  69.82) mas
     515: ( -0.6,   1.2) m, ( 62.63,  69.83) mas
     436: (  1.2,   0.3) m, ( 71.85,  75.14) mas
     273: (  0.6,  -1.5) m, ( 68.58,  86.77) mas
     189: (  1.2,  -2.5) m, ( 71.83,  92.45) mas
     138: (  1.5,  -3.1) m, ( 73.50,  96.35) mas
      89: (  1.8,  -3.7) m, ( 75.81, 101.15) mas
      30: (  2.5,  -4.6) m, ( 78.56, 106.61) mas
sa index   location       noise equivalent angle
     504: ( -4.0,   1.2) m, ( 59.68,  56.49) mas
     481: ( -3.1,   0.9) m, ( 63.69,  57.37) mas
     459: ( -2.2,   0.6) m, ( 70.08,  59.44) mas
     435: ( -1.5,   0.3) m, ( 72.45,  59.25) mas
     270: ( -0.3,  -1.5) m, ( 83.50,  69.10) mas
     352: (  1.2,  -0.6) m, ( 90.00,  62.72) mas
     328: (  1.8,  -0.9) m, ( 95.94,  65.46) mas
     306: (  2.8,  -1.2) m, (100.06,  65.45) mas
     283: (  3.7,  -1.5) m, (106.44,  66.93) mas
sa index   location       noise equivalent angle
     258: ( -4.0,  -1.5) m, ( 59.68,  56.49) mas
     291: ( -3.1,  -1.2) m, ( 63.69,  57.37) mas
     321: ( -2.2,  -0.9) m, ( 70.20,  59.60) mas
     351: ( -1.5,  -0.6) m, ( 72.45,  59.25) mas
     516: ( -0.3,   1.2) m, ( 82.69,  68.50) mas
     436: (  1.2,   0.3) m, ( 90.00,  62.72) mas
     466: (  1.8,   0.6) m, ( 95.76,  65.28) mas
     496: (  2.8,   0.9) m, (100.06,  65.45) mas
     529: (  3.7,   1.2) m, (106.44,  66.93) mas
sa index   location       noise equivalent angle
      13: ( -2.8,  -4.6) m, ( 55.90,  56.68) mas
      76: ( -2.2,  -3.7) m, ( 57.63,  59.61) mas
     127: ( -1.8,  -3.1) m, ( 58.11,  61.71) mas
     268: ( -0.9,  -1.5) m, ( 61.45,  69.82) mas
     269: ( -0.6,  -1.5) m, ( 62.63,  69.83) mas
     352: (  1.2,  -0.6) m, ( 71.85,  75.14) mas
     519: (  0.6,   1.2) m, ( 68.58,  86.77) mas
     607: (  1.2,   2.2) m, ( 71.83,  92.45) mas
     660: (  1.5,   2.8) m, ( 73.50,  96.35) mas
     710: (  1.8,   3.4) m, ( 75.66, 100.89) mas
     773: (  2.5,   4.3) m, ( 78.56, 106.61) mas
sa index   location       noise equivalent angle
       7: (  0.6,  -4.9) m, ( 56.79,  58.76) mas
      24: (  0.6,  -4.6) m, ( 55.88,  58.47) mas
     160: (  0.3,  -2.8) m, ( 56.92,  66.58) mas
     186: (  0.3,  -2.5) m, ( 57.08,  68.23) mas
     271: (  0.0,  -1.5) m, ( 58.80,  75.28) mas
     407: ( -1.5,   0.0) m, ( 62.45,  84.49) mas
     516: ( -0.3,   1.2) m, ( 61.07,  94.36) mas
     627: ( -0.6,   2.5) m, ( 59.90,  99.51) mas
     653: ( -0.6,   2.8) m, ( 59.97, 101.57) mas
     762: ( -0.9,   4.3) m, ( 61.04, 112.90) mas
     776: ( -2.5,   4.6) m, ( 69.50, 120.27) mas
sa index   location       noise equivalent angle
     144: (  3.4,  -3.1) m, ( 57.38,  56.93) mas
     219: (  2.2,  -2.2) m, ( 61.71,  59.86) mas
     276: (  1.5,  -1.5) m, ( 65.50,  64.20) mas
     300: (  0.9,  -1.2) m, ( 67.95,  63.84) mas
     269: ( -0.6,  -1.5) m, ( 77.13,  62.76) mas
     487: ( -1.2,   0.9) m, ( 80.31,  75.18) mas
     511: ( -1.8,   1.2) m, ( 86.86,  79.45) mas
     568: ( -2.5,   1.8) m, ( 87.77,  80.47) mas
     643: ( -3.7,   2.8) m, ( 95.36,  85.84) mas
     755: ( -3.1,   4.3) m, ( 94.71,  99.84) mas

[00;00mSetting up powfs 2 PO WFS[00;00m

OTF dimension is 48x48 (calculated)
Generating matched filter for powfs 2
Use sanea to derive neasim
Use sanea to derive neasim

[00;00mSetting up reconstructor[00;00m

Recon NEA: cmf(75.71) cmf(75.76) cmf(75.58) cmf(75.76) cmf(75.66) cmf(75.63) cmf(75.69) cmf(75.49) cmf(75.70) geom(0.31) geom(0.31) geom(0.31) mf(0.14)  mas
Setup or update control matrix parameters.
RRtwfs svd threshold is 1e-10
Replacing HA by HA*fit->actextrap
Adding piston cr to fit matrix
Adding TT cr on upper DMs to fit matrix.
Before assembling fit matrix:	2816.7 MiB.
Building fit->FR
Building fit->FL
Adding tikhonov constraint of 1.0e-07 to FLM
The maximum eigen value is estimated to be around 3.6e-04
DM Fit number of Low rank terms: 16 in LHS
After assemble fit matrix:	3393.2 MiB.
After setup_recon:	3393.2 MiB.
GPU 0: mem used 1898 MB (wfs init)
GPU 0: mem used 2274 MB (recon init)
GPU 0: mem used 2304 MB (perf init)

*** Simulation started at 2025/02/17 14:44:23 in nid001972. ***

Running seed 1
GPU 0: mem used 2304 MB (wfs seeding)
Wind dir: 267.3 261.7 167.0 130.5 300.7  32.3 119.8 139.0 150.8 277.7 203.0 133.1  45.9 265.1 deg
Using /global/homes/b/bpeck/.aos/cache/atm/vonkarman_14_8192x8192_0.0078125_1115374592d.bin
After genatm:	3399.0 MiB.
Step     #  Open Loop  PR TT  On axis  PR TT  Field RMS PR TT     Timing 
Step     0: OL  884.6  248.3  OA  884.6 248.3 CL  884.6 248.3 nm  0.090 s
Step    23: OL  921.0  256.7  OA  111.8   7.3 CL  111.8   7.3 nm  0.038 s
Step    46: OL  956.6  261.0  OA  106.2  10.8 CL  106.2  10.8 nm  0.044 s
Step    69: OL  990.8  259.8  OA  109.2   6.9 CL  109.2   6.9 nm  0.047 s
Step    92: OL 1025.8  257.7  OA  109.6  14.5 CL  109.6  14.5 nm  0.042 s
Step   115: OL 1060.6  257.8  OA  109.1   9.4 CL  109.1   9.4 nm  0.043 s
Step   138: OL 1093.2  262.5  OA  107.2  10.1 CL  107.2  10.1 nm  0.046 s
Step   161: OL 1120.9  272.5  OA  110.0  18.5 CL  110.0  18.5 nm  0.042 s
Step   184: OL 1141.7  286.4  OA  109.4  13.4 CL  109.4  13.4 nm  0.040 s
Step   207: OL 1154.4  301.2  OA  109.4  26.8 CL  109.4  26.8 nm  0.048 s
Step   230: OL 1160.5  316.0  OA  107.7   8.8 CL  107.7   8.8 nm  0.043 s
Step   253: OL 1158.5  332.0  OA  106.9   6.1 CL  106.9   6.1 nm  0.045 s
Step   255 updated high order loop gain: 0.374
Step   276: OL 1145.0  348.6  OA  109.9  21.9 CL  109.9  21.9 nm  0.049 s
Step   298: OL 1124.7  366.4  OA  105.0  10.8 CL  105.0  10.8 nm  0.043 s
Step   321: OL 1099.0  387.7  OA  108.0  20.6 CL  108.0  20.6 nm  0.044 s
Step   344: OL 1070.5  413.5  OA  107.0   4.5 CL  107.0   4.5 nm  0.046 s
Step   368: OL 1041.8  445.8  OA  109.6  15.3 CL  109.6  15.3 nm  0.043 s
Step   392: OL 1016.2  480.5  OA  112.3   2.7 CL  112.3   2.7 nm  0.043 s
Step   415: OL  992.0  513.0  OA  109.7  10.9 CL  109.7  10.9 nm  0.051 s
Step   438: OL  967.0  543.6  OA  108.2   2.8 CL  108.2   2.8 nm  0.043 s
Step   461: OL  946.2  573.7  OA  108.1  10.7 CL  108.1  10.7 nm  0.041 s
Step   484: OL  935.9  603.1  OA  108.1  11.3 CL  108.1  11.3 nm  0.050 s
Step   507: OL  935.9  630.1  OA  112.4  22.3 CL  112.4  22.3 nm  0.042 s
Step   511 updated high order loop gain: 0.360
Step   530: OL  942.0  651.6  OA  110.3  12.9 CL  110.3  12.9 nm  0.042 s
Step   553: OL  954.3  664.6  OA  111.5  10.8 CL  111.5  10.8 nm  0.049 s
Step   576: OL  972.8  670.3  OA  111.4  18.7 CL  111.4  18.7 nm  0.040 s
Step   599: OL  996.2  669.4  OA  111.4  14.1 CL  111.4  14.1 nm  0.043 s
Step   622: OL 1021.9  659.9  OA  110.4  12.0 CL  110.4  12.0 nm  0.050 s
Step   645: OL 1046.6  643.2  OA  108.7   8.0 CL  108.7   8.0 nm  0.080 s
Step   668: OL 1067.7  621.2  OA  108.5   5.9 CL  108.5   5.9 nm  0.044 s
Step   691: OL 1086.2  597.0  OA  115.2  15.2 CL  115.2  15.2 nm  0.048 s
Step   714: OL 1099.6  570.2  OA  114.5  15.7 CL  114.5  15.7 nm  0.042 s
Step   737: OL 1104.2  541.8  OA  116.4  14.2 CL  116.4  14.2 nm  0.043 s
Step   759: OL 1100.1  515.1  OA  113.4   9.0 CL  113.4   9.0 nm  0.053 s
Step   767 updated high order loop gain: 0.355
Step   782: OL 1087.1  488.9  OA  109.2   5.0 CL  109.2   5.0 nm  0.043 s
Step   805: OL 1064.6  463.1  OA  111.8   5.0 CL  111.8   5.0 nm  0.045 s
Step   828: OL 1034.8  437.6  OA  110.2   5.8 CL  110.2   5.8 nm  0.048 s
Step   851: OL  999.6  413.7  OA  108.7   4.9 CL  108.7   4.9 nm  0.040 s
Step   874: OL  963.8  393.2  OA  111.1   6.1 CL  111.1   6.1 nm  0.040 s
Step   897: OL  929.6  376.9  OA  109.8  14.6 CL  109.8  14.6 nm  0.049 s
Step   920: OL  893.3  364.5  OA  109.9  12.5 CL  109.9  12.5 nm  0.046 s
Step   944: OL  856.2  353.1  OA  111.6   5.7 CL  111.6   5.7 nm  0.048 s
Step   966: OL  825.8  341.8  OA  113.3   9.4 CL  113.3   9.4 nm  0.052 s
Step   989: OL  801.1  327.5  OA  110.5  15.6 CL  110.5  15.6 nm  0.043 s
Step  1012: OL  780.4  310.6  OA  110.6  14.3 CL  110.6  14.3 nm  0.044 s
Step  1023 updated high order loop gain: 0.352
Step  1034: OL  764.9  293.4  OA  112.7  14.5 CL  112.7  14.5 nm  0.048 s
Step  1057: OL  751.8  273.0  OA  110.6  15.4 CL  110.6  15.4 nm  0.042 s
Step  1080: OL  741.5  248.3  OA  115.2  20.8 CL  115.2  20.8 nm  0.040 s
Step  1103: OL  737.7  222.3  OA  112.6  24.0 CL  112.6  24.0 nm  0.052 s
Step  1126: OL  737.7  200.2  OA  109.5  21.7 CL  109.5  21.7 nm  0.042 s
Step  1149: OL  739.2  184.0  OA  110.8  18.0 CL  110.8  18.0 nm  0.041 s
Step  1172: OL  740.6  173.7  OA  111.2  33.7 CL  111.2  33.7 nm  0.047 s
Step  1195: OL  744.6  168.2  OA  108.3  19.1 CL  108.3  19.1 nm  0.041 s
Step  1218: OL  749.5  164.4  OA  110.7  15.2 CL  110.7  15.2 nm  0.041 s
Step  1241: OL  752.7  164.6  OA  109.9  24.1 CL  109.9  24.1 nm  0.053 s
Step  1264: OL  755.4  171.3  OA  109.2  19.1 CL  109.2  19.1 nm  0.041 s
Step  1279 updated high order loop gain: 0.351
Step  1287: OL  760.3  183.4  OA  106.9  15.8 CL  106.9  15.8 nm  0.045 s
Step  1310: OL  766.9  199.2  OA  111.6  22.2 CL  111.6  22.2 nm  0.050 s
Step  1333: OL  773.8  218.1  OA  109.8  22.4 CL  109.8  22.4 nm  0.045 s
Step  1356: OL  784.9  238.9  OA  108.1  16.1 CL  108.1  16.1 nm  0.044 s
Step  1379: OL  800.5  255.8  OA  105.6  14.4 CL  105.6  14.4 nm  0.051 s
Step  1402: OL  819.8  267.2  OA  108.1  16.4 CL  108.1  16.4 nm  0.047 s
Step  1425: OL  842.4  273.8  OA  110.8  16.8 CL  110.8  16.8 nm  0.040 s
Step  1448: OL  864.3  278.3  OA  107.1  11.8 CL  107.1  11.8 nm  0.043 s
Step  1471: OL  883.0  279.3  OA  105.4   9.2 CL  105.4   9.2 nm  0.042 s
Step  1494: OL  891.7  275.0  OA  107.0   6.7 CL  107.0   6.7 nm  0.040 s
Step  1517: OL  892.0  265.6  OA  106.7   2.5 CL  106.7   2.5 nm  0.043 s
Step  1535 updated high order loop gain: 0.351
Step  1540: OL  884.7  252.5  OA  106.4   5.2 CL  106.4   5.2 nm  0.040 s
Step  1563: OL  874.1  237.4  OA  109.8   7.3 CL  109.8   7.3 nm  0.041 s
Step  1586: OL  861.1  224.8  OA  110.8   6.7 CL  110.8   6.7 nm  0.048 s
Step 1599: Output PSF
Step  1599: OL  852.9  219.3  OA  110.5  13.2 CL  110.5  13.2 nm  1.111 s
Mean: 110.26 14.75 109.27  nm.

*** Simulation Finished at 2025/02/17 14:45:48 in nid001972. ***

[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
/global/cfs/cdirs/ulens/vismcao/maos -o studies/reduced_ngs/9_lgs/8mag_lgs/1250count -c master_files/reduced_ngs/9_lgs/8mag_lgs/kola_1250act.conf -O 
Output folder is 'studies/reduced_ngs/9_lgs/8mag_lgs/1250count'.
SRC: /global/homes/b/bpeck/code/maos v2.9 4c88b7c2 2024-11-13 16:45:33 -0800
BUILT: /global/homes/b/bpeck/code/maos/optim by GCC (v12) on 2024/11/18 09:40:03 CPU(F64,+O3) with CUDA(v122,F32)
Launched at 2025/02/17 14:45:49 in nid001972 with PID 1689533.
The web based job monitor can be accessed at http://localhost:10300
Main config file is /global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_1250act.conf
[00;00m[0;36mWarning(path.c:48): Path not found: path=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; abspath=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; Ignored.
[00;00m[0;36mWarning(path.c:48): Path not found: path=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; abspath=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; Ignored.
[00;00m[0;36mWarning(readcfg.c:399): sim.apfsm has been renamed to powfs.apfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.epfsm has been renamed to powfs.epfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.alfsm has been renamed to powfs.alfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.commonfsm has been renamed to powfs.commonfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.idealfsm has been renamed to powfs.idealfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.zetafsm has been renamed to powfs.zetafsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.f0fsm has been renamed to powfs.f0fsm.
[00;00m[0;36mWarning(readcfg.c:399): tsurf has been renamed to ncpa.tsurf.
loaded 132 (132 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_sim.conf'
loaded  19 ( 19 new) records from '/global/cfs/cdirs/ulens/vismcao/./dm_none.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_ASM.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_DM2.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_DM3.conf'
loaded   0 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_dm_multiple.conf'
loaded   7 (  5 new) records from '/global/cfs/cdirs/ulens/vismcao/./atm_mk13n50p_ground_detail.conf'
loaded  76 ( 69 new) records from '/global/homes/b/bpeck/code/maos/config/maos/powfs_common.conf'
loaded  44 ( 38 new) records from '/global/cfs/cdirs/ulens/vismcao/./powfs_none.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_lgs.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_ttf_strap.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_twfs_lbwfs.conf'
loaded   0 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_wfs_lgs_strap_lbwfs.conf'
loaded  71 ( 71 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_recon.conf'
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_smooth has been renamed to powfs0_llt.na_smooth.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_interp has been renamed to powfs0_llt.na_interp.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_thres has been renamed to powfs0_llt.na_thres.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_maxit has been renamed to powfs0_llt.na_fit_maxit.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_svdthres has been renamed to powfs0_llt.na_fit_svdthres.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_dh has been renamed to powfs0_llt.na_fit_dh.
[00;00m[0;36mWarning(readcfg.c:399): dbg.ncpa_preload has been renamed to ncpa.preload.
[00;00m[0;36mWarning(readcfg.c:399): dbg.ncpa_rmsci has been renamed to ncpa.rmsci.
[00;00m[0;36mWarning(readcfg.c:399): dbg.draw_opdmax has been renamed to plot.opdmax.
[00;00m[0;36mWarning(readcfg.c:399): dbg.draw_gmax has been renamed to plot.gmax.
loaded  95 ( 93 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_dbg.conf'
loaded   4 (  4 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_fit_mcao.conf'
[00;00m[0;36mWarning(readcfg.c:399): surf has been renamed to ncpa.surf.
loaded  39 (  7 new) records from '/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_1250act.conf'
loaded   0 (  0 new) records from 'command line'
loaded  24 ( 18 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_llt_CL.conf'
Adjust LGS range by telescope altitude 4145m.
Zenith angle is 30 degree.
    Scaling turbulence height and LGS hs by sec(za).
    Scaling r0 by cos(za)^(3/5).
    Scaling wind speed and LGS signal level by cos(za).
powfs0: Adjusting dx from 0.0078125 to 0.00766667. 
powfs0.llt.fsm: f0=0 Hz, LPF ep=0
powfs0.epfsm is set to 0.517618 (auto)
powfs2: Adjusting dx from 0.03125 to 0.0312778. 
powfs2 is TWFS for powfs0
sim.ephi is set to 0.427717 (auto)
sim.eplo is set to 0.427717 (auto)
[00;00m[0;36mWarning(parms.c:2296): Layer 1 at 17.3205m is very close to layer 0 at 0m (OK).
[00;00m[0;36mWarning(parms.c:2296): Layer 2 at 34.641m is very close to layer 1 at 17.3205m (OK).
[00;00m[0;36mWarning(parms.c:2296): Layer 3 at 51.9615m is very close to layer 2 at 34.641m (OK).
dm 0: stroke=30 um is provided in micron.
dm 0: assume ia stroke=2 um is provided in micron.
dm 1: stroke=7 um is provided in micron.
dm 1: assume ia stroke=2 um is provided in micron.
dm 2: stroke=7 um is provided in micron.
dm 2: assume ia stroke=2 um is provided in micron.
Focus blending is not implemented yet for integrated tomography
parms->sim.mffocus is reset to 0
There are 1 valid simulation seeds:  1
Output PSF for 1 directions
Used 449 of 456 supplied keys
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_flate" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_flatv" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_psx" is not recognized, value is [0 0 0 0]
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_psy" is not recognized, value is [0 0 0 0]
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_pupelong" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_raw" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_side" is not recognized, value is 4
[00;00mAperture[00;00m is 11 m with sampling 1/128 m
[00;00mTurbulence at 30 degree zenith angle:[00;00m r0=0.128424m, L0=30m, 14 layers.
    Greenwood freq is 25.1Hz, anisoplanatic angle is 1.58 as
    Sampled 8192x8192 at 1/128m. wind dir is randomized.
    layer 0: ht=      0 m, wt= 0.302, ws=  4.8 m/s
    layer 1: ht=     17 m, wt= 0.154, ws=  5.0 m/s
    layer 2: ht=     35 m, wt= 0.041, ws=  5.4 m/s
    layer 3: ht=     52 m, wt= 0.002, ws=  6.6 m/s
    layer 4: ht=    139 m, wt= 0.021, ws=  6.1 m/s
    layer 5: ht=    231 m, wt= 0.010, ws=  6.1 m/s
    layer 6: ht=    323 m, wt= 0.008, ws=  6.1 m/s
    layer 7: ht=    416 m, wt= 0.005, ws=  6.1 m/s
    layer 8: ht=    508 m, wt= 0.001, ws=  6.1 m/s
    layer 9: ht=    932 m, wt= 0.107, ws=  5.6 m/s
    layer 10: ht=   5022 m, wt= 0.144, ws= 11.1 m/s
    layer 11: ht=   9238 m, wt= 0.093, ws= 19.1 m/s
    layer 12: ht=  13856 m, wt= 0.075, ws=  8.2 m/s
    layer 13: ht=  22518 m, wt= 0.036, ws=  4.8 m/s
[00;00mReconstruction[00;00m: r0=0.128424m L0=30m. 14 layers. use cone coordinate.
    layer 0: ht=      0 m, wt= 0.302
    layer 1: ht=     17 m, wt= 0.154
    layer 2: ht=     35 m, wt= 0.041
    layer 3: ht=     52 m, wt= 0.002
    layer 4: ht=    139 m, wt= 0.021
    layer 5: ht=    231 m, wt= 0.010
    layer 6: ht=    323 m, wt= 0.008
    layer 7: ht=    416 m, wt= 0.005
    layer 8: ht=    508 m, wt= 0.001
    layer 9: ht=    932 m, wt= 0.107
    layer 10: ht=   5022 m, wt= 0.144
    layer 11: ht=   9238 m, wt= 0.093
    layer 12: ht=  13856 m, wt= 0.075
    layer 13: ht=  22518 m, wt= 0.036
[00;00mThere are 3 powfs[00;00m
  powfs0: Order 40, LGS at 99.1 km. Sampling 1/130.435 m. Thres 30%. [00;00mT/T is removed in right hand side in tomography.[00;00m
    CCD image is 25x25 @ 500x500 mas, blur 27% (sigma), 1500Hz, wvl: [ 5.89e-07]
    Gtilt in reconstruction. Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
  powfs1: Order  2, NGS at inf km. Sampling 1/16 m. Thres 30%. 
    Ztilt in reconstruction. Geomtric optics start at 2 with ztilt [00;00m(noisy)[00;00m
  powfs2: Order 20, NGS at inf km. Sampling 1/31.9716 m. Thres 50%. 
    CCD image is 4x4 @ 1500x1500 mas, blur 0% (sigma), 0.015Hz, wvl: [ 7.2e-07]
    Gtilt in reconstruction. Geomtric optics start at 50 with gtilt Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
[00;00mThere are 13 wfs[00;00m
    wfs 0: type 0, at (  30.00,    0.00) arcsec,  99 km, siglev is 91.338 bkgrnd is 0.1
    wfs 1: type 0, at (  22.98,   19.28) arcsec,  99 km, siglev is 91.338 bkgrnd is 0.1
    wfs 2: type 0, at (   5.21,   29.54) arcsec,  99 km, siglev is 91.338 bkgrnd is 0.1
    wfs 3: type 0, at ( -15.00,   25.98) arcsec,  99 km, siglev is 91.338 bkgrnd is 0.1
    wfs 4: type 0, at ( -28.19,   10.26) arcsec,  99 km, siglev is 91.338 bkgrnd is 0.1
    wfs 5: type 0, at ( -28.19,  -10.26) arcsec,  99 km, siglev is 91.338 bkgrnd is 0.1
    wfs 6: type 0, at ( -15.00,  -25.98) arcsec,  99 km, siglev is 91.338 bkgrnd is 0.1
    wfs 7: type 0, at (   5.21,  -29.54) arcsec,  99 km, siglev is 91.338 bkgrnd is 0.1
    wfs 8: type 0, at (  22.98,  -19.28) arcsec,  99 km, siglev is 91.338 bkgrnd is 0.1
    wfs 9: type 1, at (   5.00,    8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 10: type 1, at ( -10.00,    0.00) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 11: type 1, at (   5.00,   -8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 12: type 2, at (   0.00,    0.00) arcsec, inf km, siglev is 4.1558e+06 bkgrnd is 0.001
[00;00mThere are 3 DMs[00;00m
  DM 0 at -0.1km, actuator pitch 0.276m, offset   0, with 30.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 1 at    6km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 2 at   10km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
[00;00mTomography[00;00m is using CG, with [00;00mFourer Domain[00;00m preconditioner, [00;00m12[00;00m iterations, integrated tomo.
[00;00mDM Fitting [00;00mis using CG, with [00;00mNo[00;00m preconditioner, [00;00m10[00;00m iterations
[00;00mThere are 9 fit directions[00;00m
    Fit 0: weight is 0.444, at (   0.00,    0.00) arcsec
    Fit 1: weight is 0.111, at (  15.00,    0.00) arcsec
    Fit 2: weight is 0.111, at (   0.00,   15.00) arcsec
    Fit 3: weight is 0.111, at ( -15.00,    0.00) arcsec
    Fit 4: weight is 0.111, at (   0.00,  -15.00) arcsec
    Fit 5: weight is 0.028, at (  15.00,   15.00) arcsec
    Fit 6: weight is 0.028, at ( -15.00,   15.00) arcsec
    Fit 7: weight is 0.028, at ( -15.00,  -15.00) arcsec
    Fit 8: weight is 0.028, at (  15.00,  -15.00) arcsec
[00;00mThere are 1 evaluation directions[00;00m at sampling 1/128 m.
    Evl 0: weight is 1.000, at (   0.00,    0.00) arcsec
[00;00mSimulation[00;00m start at step 0, end at step 1600, with time step 1/1500s, [00;00mclose loop[00;00m.
After setup_parms:	120.3 MiB.
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
CUDA: minimum memory requirement is 0.4GB
GPU 0 is NVIDIA A100-SXM4-40GB with arch 8.0, 38.9GB free, 39.3GB total device memory.
Using GPU 0
Use 1 GPUs for WFS Tomo Fit Evl

*** Preparation started at 2025/02/17 14:45:50 in nid001972. ***

Using OpenMP version 201511 with 128 threads
Reading aperture amplitude map from KECK.fits
[00;00m[0;36mWarning(accphi.c:477): 108260 points not covered by input screen
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
 ->maos.c:447->setup.c:148->aper.c:74->utils.c:478->accphi.c:478
iwvl 0: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 1: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 2: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 3: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 4: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 5: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 6: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 7: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 8: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
After setup_aper:	342.9 MiB.

[00;00mSetting up powfs 0 geom[00;00m

There are 36 points in each subaperture of 0.276m.
There are 995 valid subaperture.

[00;00mSetting up powfs 1 geom[00;00m

There are 88 points in each subaperture of 5.5m.
There are 4 valid subaperture.

[00;00mSetting up powfs 2 geom[00;00m

There are 18 points in each subaperture of 0.563m.
There are 236 valid subaperture.
After setup_powfs_init:	428.8 MiB.

[00;00mSetting up reconstructor geometry.[00;00m

PLOC is 83x83, with sampling of 0.14m (square)
    DM 0: grid is 44 x 43
    DM 1: grid is 75 x 75
    DM 2: grid is 80 x 79
FLOC is 83x83, with sampling of 0.14m (not square)
Tomography grid is square:
    layer 0: xloc grid is 144 x 144, sampling is 0.138 m, 20736 points
    layer 1: xloc grid is 144 x 144, sampling is 0.138 m, 20736 points
    layer 2: xloc grid is 144 x 144, sampling is 0.138 m, 20736 points
    layer 3: xloc grid is 144 x 144, sampling is 0.138 m, 20736 points
    layer 4: xloc grid is 144 x 144, sampling is 0.138 m, 20736 points
    layer 5: xloc grid is 144 x 144, sampling is 0.138 m, 20736 points
    layer 6: xloc grid is 144 x 144, sampling is 0.138 m, 20736 points
    layer 7: xloc grid is 144 x 144, sampling is 0.137 m, 20736 points
    layer 8: xloc grid is 144 x 144, sampling is 0.137 m, 20736 points
    layer 9: xloc grid is 144 x 144, sampling is 0.137 m, 20736 points
    layer 10: xloc grid is 144 x 144, sampling is 0.131 m, 20736 points
    layer 11: xloc grid is 144 x 144, sampling is 0.125 m, 20736 points
    layer 12: xloc grid is 144 x 144, sampling is 0.119 m, 20736 points
[00;00m[0;36mWarning(map.c:195): ninx=144 is too small. need 145
[00;00m[0;36mWarning(map.c:200): niny=144 is too small. need 145
    layer 13: xloc grid is 144 x 144, sampling is 0.107 m, 20736 points

[00;00mSetting up powfs 0 PO WFS[00;00m

OTF dimension is 72x72 (calculated)
Uplink FWHM (illt 0, iwvl 0) is 0.581315"
Downlink FWHM (illt 0, iwvl 0) is 1.09963"
Generating matched filter for powfs 0
sa index   location       noise equivalent angle
     495: (  5.0,  -0.3) m, ( 65.70,  64.15) mas
     491: (  3.9,  -0.3) m, ( 69.57,  64.67) mas
     487: (  2.8,  -0.3) m, ( 75.24,  65.29) mas
     483: (  1.7,  -0.3) m, ( 81.84,  65.91) mas
     482: (  1.4,  -0.3) m, ( 83.63,  66.07) mas
     322: ( -0.6,  -1.7) m, ( 97.18,  68.45) mas
     479: ( -1.7,  -0.3) m, (105.05,  67.62) mas
     475: ( -2.8,  -0.3) m, (113.81,  68.13) mas
     471: ( -3.9,  -0.3) m, (123.27,  68.61) mas
     467: ( -5.0,  -0.3) m, (132.90,  69.05) mas
     466: ( -5.2,  -0.3) m, (135.30,  69.16) mas
sa index   location       noise equivalent angle
     807: (  3.0,   2.5) m, ( 67.23,  66.43) mas
     712: (  1.9,   1.7) m, ( 72.01,  69.62) mas
     642: (  1.4,   1.1) m, ( 80.09,  74.96) mas
     606: (  0.8,   0.8) m, ( 80.44,  75.86) mas
     604: ( -1.1,   0.8) m, ( 94.10,  77.14) mas
     387: ( -1.4,  -1.1) m, ( 92.59,  85.13) mas
     352: ( -1.7,  -1.4) m, (101.50,  90.75) mas
     216: ( -3.0,  -2.5) m, (104.71,  94.29) mas
     187: ( -3.3,  -2.8) m, (106.71,  96.17) mas
      33: ( -3.0,  -4.4) m, (104.28, 108.40) mas
sa index   location       noise equivalent angle
     929: (  0.6,   3.9) m, ( 64.73,  69.07) mas
     797: (  0.3,   2.5) m, ( 65.69,  76.12) mas
     769: (  0.3,   2.2) m, ( 65.82,  77.62) mas
     670: ( -0.3,   1.4) m, ( 69.74,  85.97) mas
     479: ( -1.7,  -0.3) m, ( 71.76,  94.46) mas
     323: ( -0.3,  -1.7) m, ( 71.14, 108.23) mas
     225: ( -0.6,  -2.5) m, ( 69.10, 110.95) mas
      89: ( -0.8,  -3.9) m, ( 70.15, 122.59) mas
      65: ( -0.8,  -4.1) m, ( 70.22, 124.99) mas
sa index   location       noise equivalent angle
     964: ( -2.8,   4.4) m, ( 64.37,  64.99) mas
     918: ( -2.5,   3.9) m, ( 64.96,  66.48) mas
     790: ( -1.7,   2.5) m, ( 67.39,  72.27) mas
     733: ( -1.4,   1.9) m, ( 70.57,  77.66) mas
     634: ( -0.8,   1.1) m, ( 70.85,  80.37) mas
     388: ( -1.1,  -1.1) m, ( 74.19,  99.70) mas
     360: (  0.6,  -1.4) m, ( 78.23,  97.43) mas
     261: (  1.1,  -2.2) m, ( 84.11, 107.25) mas
     204: (  1.4,  -2.8) m, ( 83.06, 107.89) mas
      76: (  2.2,  -4.1) m, ( 88.16, 118.79) mas
      30: (  2.5,  -4.7) m, ( 89.95, 123.38) mas
sa index   location       noise equivalent angle
     655: ( -4.4,   1.4) m, ( 66.98,  64.72) mas
     624: ( -3.6,   1.1) m, ( 70.34,  65.49) mas
     573: ( -1.9,   0.6) m, ( 82.19,  69.76) mas
     511: ( -1.7,   0.0) m, ( 81.41,  69.08) mas
     639: (  0.6,   1.1) m, ( 96.15,  67.50) mas
     450: (  1.4,  -0.6) m, (102.69,  72.03) mas
     395: (  2.5,  -1.1) m, (111.40,  74.65) mas
     370: (  3.3,  -1.4) m, (118.26,  76.12) mas
     339: (  4.1,  -1.7) m, (125.39,  77.63) mas
sa index   location       noise equivalent angle
     308: ( -4.4,  -1.7) m, ( 66.98,  64.72) mas
     345: ( -3.6,  -1.4) m, ( 70.34,  65.49) mas
     415: ( -1.9,  -0.8) m, ( 81.95,  69.43) mas
     479: ( -1.7,  -0.3) m, ( 81.41,  69.08) mas
     360: (  0.6,  -1.4) m, ( 96.17,  67.53) mas
     546: (  1.4,   0.3) m, (102.69,  72.03) mas
     612: (  2.5,   0.8) m, (111.40,  74.65) mas
     649: (  3.3,   1.1) m, (118.26,  76.12) mas
     686: (  4.1,   1.4) m, (125.39,  77.63) mas
sa index   location       noise equivalent angle
      11: ( -2.8,  -4.7) m, ( 64.37,  64.99) mas
      59: ( -2.5,  -4.1) m, ( 64.96,  66.48) mas
     193: ( -1.7,  -2.8) m, ( 67.39,  72.27) mas
     252: ( -1.4,  -2.2) m, ( 70.74,  77.93) mas
     355: ( -0.8,  -1.4) m, ( 70.90,  80.45) mas
     604: ( -1.1,   0.8) m, ( 73.40,  98.74) mas
     639: (  0.6,   1.1) m, ( 78.19,  97.38) mas
     742: (  1.1,   1.9) m, ( 83.82, 106.94) mas
     801: (  1.4,   2.5) m, ( 83.06, 107.89) mas
     935: (  2.2,   3.9) m, ( 88.16, 118.79) mas
     983: (  2.5,   4.4) m, ( 89.95, 123.38) mas
sa index   location       noise equivalent angle
      70: (  0.6,  -4.1) m, ( 64.73,  69.07) mas
     200: (  0.3,  -2.8) m, ( 65.69,  76.12) mas
     228: (  0.3,  -2.5) m, ( 65.82,  77.62) mas
     323: ( -0.3,  -1.7) m, ( 69.74,  85.97) mas
     511: ( -1.7,   0.0) m, ( 71.76,  94.46) mas
     670: ( -0.3,   1.4) m, ( 71.14, 108.23) mas
     766: ( -0.6,   2.2) m, ( 69.10, 110.95) mas
     901: ( -0.8,   3.6) m, ( 70.15, 122.59) mas
     924: ( -0.8,   3.9) m, ( 70.22, 124.99) mas
sa index   location       noise equivalent angle
     210: (  3.0,  -2.8) m, ( 67.23,  66.43) mas
     297: (  1.9,  -1.9) m, ( 72.01,  69.62) mas
     363: (  1.4,  -1.4) m, ( 80.09,  74.96) mas
     389: (  0.8,  -1.1) m, ( 81.12,  76.48) mas
     388: ( -1.1,  -1.1) m, ( 95.04,  77.94) mas
     603: ( -1.4,   0.8) m, ( 92.59,  85.13) mas
     631: ( -1.7,   1.1) m, (101.50,  90.75) mas
     757: ( -3.0,   2.2) m, (104.71,  94.29) mas
     784: ( -3.3,   2.5) m, (106.71,  96.17) mas
     940: ( -3.0,   4.1) m, (104.28, 108.40) mas

[00;00mSetting up powfs 2 PO WFS[00;00m

OTF dimension is 48x48 (calculated)
Generating matched filter for powfs 2
Use sanea to derive neasim
Use sanea to derive neasim

[00;00mSetting up reconstructor[00;00m

Recon NEA: cmf(86.56) cmf(86.57) cmf(86.38) cmf(86.56) cmf(86.44) cmf(86.42) cmf(86.49) cmf(86.30) cmf(86.52) geom(0.31) geom(0.31) geom(0.31) mf(0.14)  mas
Setup or update control matrix parameters.
RRtwfs svd threshold is 1e-10
Replacing HA by HA*fit->actextrap
Adding piston cr to fit matrix
Adding TT cr on upper DMs to fit matrix.
Before assembling fit matrix:	2966.5 MiB.
Building fit->FR
Building fit->FL
Adding tikhonov constraint of 1.0e-07 to FLM
The maximum eigen value is estimated to be around 3.5e-04
DM Fit number of Low rank terms: 16 in LHS
After assemble fit matrix:	3661.8 MiB.
After setup_recon:	3661.8 MiB.
GPU 0: mem used 1916 MB (wfs init)
GPU 0: mem used 2334 MB (recon init)
GPU 0: mem used 2364 MB (perf init)

*** Simulation started at 2025/02/17 14:46:26 in nid001972. ***

Running seed 1
GPU 0: mem used 2364 MB (wfs seeding)
Wind dir: 267.3 261.7 167.0 130.5 300.7  32.3 119.8 139.0 150.8 277.7 203.0 133.1  45.9 265.1 deg
Using /global/homes/b/bpeck/.aos/cache/atm/vonkarman_14_8192x8192_0.0078125_1115374592d.bin
After genatm:	3696.8 MiB.
Step     #  Open Loop  PR TT  On axis  PR TT  Field RMS PR TT     Timing 
Step     0: OL  884.6  248.3  OA  884.6 248.3 CL  884.6 248.3 nm  0.076 s
Step    25: OL  924.3  257.3  OA  111.2  28.8 CL  111.2  28.8 nm  0.054 s
Step    46: OL  956.7  261.0  OA  109.0  22.4 CL  109.0  22.4 nm  0.046 s
Step    67: OL  987.9  260.0  OA  104.9  15.6 CL  104.9  15.6 nm  0.050 s
Step    88: OL 1019.8  257.9  OA  110.3  19.3 CL  110.3  19.3 nm  0.046 s
Step   109: OL 1051.7  257.4  OA  109.8   9.4 CL  109.8   9.4 nm  0.048 s
Step   130: OL 1082.3  260.1  OA  105.9  16.7 CL  105.9  16.7 nm  0.044 s
Step   151: OL 1109.8  267.6  OA  105.8   1.2 CL  105.8   1.2 nm  0.055 s
Step   172: OL 1131.9  278.8  OA  107.5  17.4 CL  107.5  17.4 nm  0.043 s
Step   193: OL 1147.4  292.2  OA  106.4  11.9 CL  106.4  11.9 nm  0.047 s
Step   214: OL 1156.9  305.6  OA  102.4  14.3 CL  102.4  14.3 nm  0.048 s
Step   235: OL 1160.6  319.3  OA  101.4   9.3 CL  101.4   9.3 nm  0.047 s
Step   255 updated high order loop gain: 0.374
Step   256: OL 1157.0  334.1  OA  103.2   6.3 CL  103.2   6.3 nm  0.068 s
Step   277: OL 1143.5  349.3  OA  104.6  10.3 CL  104.6  10.3 nm  0.047 s
Step   297: OL 1124.6  365.4  OA  102.0   5.0 CL  102.0   5.0 nm  0.044 s
Step   318: OL 1101.2  384.7  OA  104.6  20.4 CL  104.6  20.4 nm  0.049 s
Step   339: OL 1075.0  407.3  OA  105.6  17.3 CL  105.6  17.3 nm  0.047 s
Step   360: OL 1048.9  434.5  OA  105.6   6.1 CL  105.6   6.1 nm  0.050 s
Step   381: OL 1025.0  464.5  OA  105.8   2.7 CL  105.8   2.7 nm  0.058 s
Step   402: OL 1002.8  494.8  OA  111.2  17.5 CL  111.2  17.5 nm  0.049 s
Step   423: OL  979.9  523.7  OA  109.8  22.4 CL  109.8  22.4 nm  0.047 s
Step   444: OL  957.3  551.4  OA  107.4  22.2 CL  107.4  22.2 nm  0.060 s
Step   465: OL  940.0  578.8  OA  103.8   4.3 CL  103.8   4.3 nm  0.047 s
Step   486: OL  932.2  605.5  OA  105.3  12.4 CL  105.3  12.4 nm  0.048 s
Step   507: OL  932.7  630.0  OA  109.9  15.7 CL  109.9  15.7 nm  0.057 s
Step   511 updated high order loop gain: 0.355
Step   528: OL  938.5  649.9  OA  107.3  11.5 CL  107.3  11.5 nm  0.048 s
Step   549: OL  949.4  662.8  OA  109.2  14.3 CL  109.2  14.3 nm  0.049 s
Step   570: OL  965.7  669.3  OA  107.0  12.2 CL  107.0  12.2 nm  0.051 s
Step   591: OL  986.3  670.6  OA  107.2  15.7 CL  107.2  15.7 nm  0.046 s
Step   611: OL 1008.6  665.4  OA  107.6  13.6 CL  107.6  13.6 nm  0.047 s
Step   632: OL 1032.3  653.4  OA  104.8   7.3 CL  104.8   7.3 nm  0.046 s
Step   653: OL 1054.0  635.9  OA  105.9   1.7 CL  105.9   1.7 nm  0.045 s
Step   674: OL 1072.7  614.8  OA  107.8   6.4 CL  107.8   6.4 nm  0.048 s
Step   695: OL 1089.4  592.6  OA  110.1   6.1 CL  110.1   6.1 nm  0.050 s
Step   716: OL 1101.1  567.7  OA  108.9   6.7 CL  108.9   6.7 nm  0.046 s
Step   737: OL 1105.2  541.7  OA  111.8  22.5 CL  111.8  22.5 nm  0.048 s
Step   758: OL 1101.7  516.2  OA  107.7   5.9 CL  107.7   5.9 nm  0.049 s
Step   767 updated high order loop gain: 0.350
Step   779: OL 1090.6  492.2  OA  108.4   7.0 CL  108.4   7.0 nm  0.047 s
Step   800: OL 1071.4  468.7  OA  108.0   8.9 CL  108.0   8.9 nm  0.055 s
Step   820: OL 1047.4  446.4  OA  108.0   7.3 CL  108.0   7.3 nm  0.052 s
Step   841: OL 1016.4  423.7  OA  105.2   9.8 CL  105.2   9.8 nm  0.051 s
Step   862: OL  983.4  403.3  OA  104.8   3.0 CL  104.8   3.0 nm  0.048 s
Step   883: OL  951.8  386.4  OA  106.3  13.0 CL  106.3  13.0 nm  0.053 s
Step   903: OL  921.4  373.2  OA  106.9   8.2 CL  106.9   8.2 nm  0.045 s
Step   924: OL  887.5  362.6  OA  107.0  10.8 CL  107.0  10.8 nm  0.049 s
Step   945: OL  854.9  352.6  OA  108.7   6.4 CL  108.7   6.4 nm  0.053 s
Step   966: OL  825.8  341.7  OA  107.7  15.1 CL  107.7  15.1 nm  0.044 s
Step   987: OL  802.7  328.8  OA  108.9  10.6 CL  108.9  10.6 nm  0.048 s
Step  1008: OL  783.4  313.7  OA  107.8   5.5 CL  107.8   5.5 nm  0.054 s
Step  1023 updated high order loop gain: 0.346
Step  1029: OL  767.9  297.5  OA  109.3  12.3 CL  109.3  12.3 nm  0.043 s
Step  1050: OL  755.6  279.6  OA  110.5  14.4 CL  110.5  14.4 nm  0.049 s
Step  1071: OL  744.7  258.6  OA  106.4   5.9 CL  106.4   5.9 nm  0.055 s
Step  1092: OL  738.9  234.3  OA  105.8   7.4 CL  105.8   7.4 nm  0.047 s
Step  1113: OL  737.8  212.1  OA  112.0  24.1 CL  112.0  24.1 nm  0.046 s
Step  1134: OL  738.4  194.0  OA  107.2  23.5 CL  107.2  23.5 nm  0.048 s
Step  1155: OL  739.6  180.7  OA  105.3  20.4 CL  105.3  20.4 nm  0.049 s
Step  1176: OL  740.7  172.6  OA  106.8  24.0 CL  106.8  24.0 nm  0.044 s
Step  1197: OL  744.5  167.8  OA  107.9  30.4 CL  107.9  30.4 nm  0.048 s
Step  1218: OL  748.7  164.3  OA  108.1  17.1 CL  108.1  17.1 nm  0.068 s
Step  1230: OL  750.9  163.7  OA  105.2  18.7 CL  105.2  18.7 nm  0.047 s
Step  1250: OL  753.0  166.3  OA  104.4  17.5 CL  104.4  17.5 nm  0.059 s
Step  1271: OL  756.3  174.5  OA  104.5   7.2 CL  104.5   7.2 nm  0.046 s
Step  1279 updated high order loop gain: 0.340
Step  1291: OL  761.5  185.9  OA  109.2  27.6 CL  109.2  27.6 nm  0.049 s
Step  1311: OL  767.5  199.9  OA  108.7  20.7 CL  108.7  20.7 nm  0.055 s
Step  1332: OL  773.9  217.1  OA  104.7  15.5 CL  104.7  15.5 nm  0.045 s
Step  1353: OL  784.0  236.2  OA  105.0  13.9 CL  105.0  13.9 nm  0.046 s
Step  1374: OL  798.1  252.6  OA  103.1  25.3 CL  103.1  25.3 nm  0.055 s
Step  1395: OL  814.9  264.3  OA  106.1  26.4 CL  106.1  26.4 nm  0.045 s
Step  1416: OL  834.9  271.6  OA  102.3   8.0 CL  102.3   8.0 nm  0.045 s
Step  1436: OL  855.0  276.2  OA  106.3  12.0 CL  106.3  12.0 nm  0.054 s
Step  1457: OL  874.1  279.2  OA  102.7  10.4 CL  102.7  10.4 nm  0.049 s
Step  1478: OL  888.5  278.6  OA  105.9  15.8 CL  105.9  15.8 nm  0.045 s
Step  1498: OL  894.1  273.6  OA  105.2   7.7 CL  105.2   7.7 nm  0.056 s
Step  1519: OL  893.2  264.6  OA  102.9   4.4 CL  102.9   4.4 nm  0.049 s
Step  1535 updated high order loop gain: 0.340
Step  1540: OL  886.1  252.5  OA  100.8   8.0 CL  100.8   8.0 nm  0.047 s
Step  1561: OL  876.2  238.6  OA  104.8   3.7 CL  104.8   3.7 nm  0.054 s
Step  1582: OL  864.7  226.6  OA  110.5   9.2 CL  110.5   9.2 nm  0.048 s
Step 1599: Output PSF
Step  1599: OL  853.7  219.3  OA  107.3  13.0 CL  107.3  13.0 nm  1.353 s
Mean: 107.02 15.51 105.89  nm.

*** Simulation Finished at 2025/02/17 14:47:55 in nid001972. ***

[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
/global/cfs/cdirs/ulens/vismcao/maos -o studies/reduced_ngs/9_lgs/8mag_lgs/1500count -c master_files/reduced_ngs/9_lgs/8mag_lgs/kola_1500act.conf -O 
Output folder is 'studies/reduced_ngs/9_lgs/8mag_lgs/1500count'.
SRC: /global/homes/b/bpeck/code/maos v2.9 4c88b7c2 2024-11-13 16:45:33 -0800
BUILT: /global/homes/b/bpeck/code/maos/optim by GCC (v12) on 2024/11/18 09:40:03 CPU(F64,+O3) with CUDA(v122,F32)
Launched at 2025/02/17 14:47:55 in nid001972 with PID 1689837.
The web based job monitor can be accessed at http://localhost:10300
Main config file is /global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_1500act.conf
[00;00m[0;36mWarning(path.c:48): Path not found: path=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; abspath=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; Ignored.
[00;00m[0;36mWarning(path.c:48): Path not found: path=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; abspath=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; Ignored.
[00;00m[0;36mWarning(readcfg.c:399): sim.apfsm has been renamed to powfs.apfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.epfsm has been renamed to powfs.epfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.alfsm has been renamed to powfs.alfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.commonfsm has been renamed to powfs.commonfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.idealfsm has been renamed to powfs.idealfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.zetafsm has been renamed to powfs.zetafsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.f0fsm has been renamed to powfs.f0fsm.
[00;00m[0;36mWarning(readcfg.c:399): tsurf has been renamed to ncpa.tsurf.
loaded 132 (132 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_sim.conf'
loaded  19 ( 19 new) records from '/global/cfs/cdirs/ulens/vismcao/./dm_none.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_ASM.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_DM2.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_DM3.conf'
loaded   0 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_dm_multiple.conf'
loaded   7 (  5 new) records from '/global/cfs/cdirs/ulens/vismcao/./atm_mk13n50p_ground_detail.conf'
loaded  76 ( 69 new) records from '/global/homes/b/bpeck/code/maos/config/maos/powfs_common.conf'
loaded  44 ( 38 new) records from '/global/cfs/cdirs/ulens/vismcao/./powfs_none.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_lgs.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_ttf_strap.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_twfs_lbwfs.conf'
loaded   0 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_wfs_lgs_strap_lbwfs.conf'
loaded  71 ( 71 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_recon.conf'
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_smooth has been renamed to powfs0_llt.na_smooth.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_interp has been renamed to powfs0_llt.na_interp.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_thres has been renamed to powfs0_llt.na_thres.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_maxit has been renamed to powfs0_llt.na_fit_maxit.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_svdthres has been renamed to powfs0_llt.na_fit_svdthres.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_dh has been renamed to powfs0_llt.na_fit_dh.
[00;00m[0;36mWarning(readcfg.c:399): dbg.ncpa_preload has been renamed to ncpa.preload.
[00;00m[0;36mWarning(readcfg.c:399): dbg.ncpa_rmsci has been renamed to ncpa.rmsci.
[00;00m[0;36mWarning(readcfg.c:399): dbg.draw_opdmax has been renamed to plot.opdmax.
[00;00m[0;36mWarning(readcfg.c:399): dbg.draw_gmax has been renamed to plot.gmax.
loaded  95 ( 93 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_dbg.conf'
loaded   4 (  4 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_fit_mcao.conf'
[00;00m[0;36mWarning(readcfg.c:399): surf has been renamed to ncpa.surf.
loaded  39 (  7 new) records from '/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_1500act.conf'
loaded   0 (  0 new) records from 'command line'
loaded  24 ( 18 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_llt_CL.conf'
Adjust LGS range by telescope altitude 4145m.
Zenith angle is 30 degree.
    Scaling turbulence height and LGS hs by sec(za).
    Scaling r0 by cos(za)^(3/5).
    Scaling wind speed and LGS signal level by cos(za).
powfs0: Adjusting dx from 0.0078125 to 0.007875. 
powfs0.llt.fsm: f0=0 Hz, LPF ep=0
powfs0.epfsm is set to 0.517618 (auto)
powfs2: Adjusting dx from 0.03125 to 0.0312778. 
powfs2 is TWFS for powfs0
sim.ephi is set to 0.427717 (auto)
sim.eplo is set to 0.427717 (auto)
[00;00m[0;36mWarning(parms.c:2296): Layer 1 at 17.3205m is very close to layer 0 at 0m (OK).
[00;00m[0;36mWarning(parms.c:2296): Layer 2 at 34.641m is very close to layer 1 at 17.3205m (OK).
[00;00m[0;36mWarning(parms.c:2296): Layer 3 at 51.9615m is very close to layer 2 at 34.641m (OK).
dm 0: stroke=30 um is provided in micron.
dm 0: assume ia stroke=2 um is provided in micron.
dm 1: stroke=7 um is provided in micron.
dm 1: assume ia stroke=2 um is provided in micron.
dm 2: stroke=7 um is provided in micron.
dm 2: assume ia stroke=2 um is provided in micron.
Focus blending is not implemented yet for integrated tomography
parms->sim.mffocus is reset to 0
There are 1 valid simulation seeds:  1
Output PSF for 1 directions
Used 449 of 456 supplied keys
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_flate" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_flatv" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_psx" is not recognized, value is [0 0 0 0]
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_psy" is not recognized, value is [0 0 0 0]
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_pupelong" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_raw" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_side" is not recognized, value is 4
[00;00mAperture[00;00m is 11 m with sampling 1/128 m
[00;00mTurbulence at 30 degree zenith angle:[00;00m r0=0.128424m, L0=30m, 14 layers.
    Greenwood freq is 25.1Hz, anisoplanatic angle is 1.58 as
    Sampled 8192x8192 at 1/128m. wind dir is randomized.
    layer 0: ht=      0 m, wt= 0.302, ws=  4.8 m/s
    layer 1: ht=     17 m, wt= 0.154, ws=  5.0 m/s
    layer 2: ht=     35 m, wt= 0.041, ws=  5.4 m/s
    layer 3: ht=     52 m, wt= 0.002, ws=  6.6 m/s
    layer 4: ht=    139 m, wt= 0.021, ws=  6.1 m/s
    layer 5: ht=    231 m, wt= 0.010, ws=  6.1 m/s
    layer 6: ht=    323 m, wt= 0.008, ws=  6.1 m/s
    layer 7: ht=    416 m, wt= 0.005, ws=  6.1 m/s
    layer 8: ht=    508 m, wt= 0.001, ws=  6.1 m/s
    layer 9: ht=    932 m, wt= 0.107, ws=  5.6 m/s
    layer 10: ht=   5022 m, wt= 0.144, ws= 11.1 m/s
    layer 11: ht=   9238 m, wt= 0.093, ws= 19.1 m/s
    layer 12: ht=  13856 m, wt= 0.075, ws=  8.2 m/s
    layer 13: ht=  22518 m, wt= 0.036, ws=  4.8 m/s
[00;00mReconstruction[00;00m: r0=0.128424m L0=30m. 14 layers. use cone coordinate.
    layer 0: ht=      0 m, wt= 0.302
    layer 1: ht=     17 m, wt= 0.154
    layer 2: ht=     35 m, wt= 0.041
    layer 3: ht=     52 m, wt= 0.002
    layer 4: ht=    139 m, wt= 0.021
    layer 5: ht=    231 m, wt= 0.010
    layer 6: ht=    323 m, wt= 0.008
    layer 7: ht=    416 m, wt= 0.005
    layer 8: ht=    508 m, wt= 0.001
    layer 9: ht=    932 m, wt= 0.107
    layer 10: ht=   5022 m, wt= 0.144
    layer 11: ht=   9238 m, wt= 0.093
    layer 12: ht=  13856 m, wt= 0.075
    layer 13: ht=  22518 m, wt= 0.036
[00;00mThere are 3 powfs[00;00m
  powfs0: Order 44, LGS at 99.1 km. Sampling 1/126.984 m. Thres 30%. [00;00mT/T is removed in right hand side in tomography.[00;00m
    CCD image is 25x25 @ 500x500 mas, blur 27% (sigma), 1500Hz, wvl: [ 5.89e-07]
    Gtilt in reconstruction. Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
  powfs1: Order  2, NGS at inf km. Sampling 1/16 m. Thres 30%. 
    Ztilt in reconstruction. Geomtric optics start at 2 with ztilt [00;00m(noisy)[00;00m
  powfs2: Order 20, NGS at inf km. Sampling 1/31.9716 m. Thres 50%. 
    CCD image is 4x4 @ 1500x1500 mas, blur 0% (sigma), 0.015Hz, wvl: [ 7.2e-07]
    Gtilt in reconstruction. Geomtric optics start at 50 with gtilt Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
[00;00mThere are 13 wfs[00;00m
    wfs 0: type 0, at (  30.00,    0.00) arcsec,  99 km, siglev is 76.1436 bkgrnd is 0.1
    wfs 1: type 0, at (  22.98,   19.28) arcsec,  99 km, siglev is 76.1436 bkgrnd is 0.1
    wfs 2: type 0, at (   5.21,   29.54) arcsec,  99 km, siglev is 76.1436 bkgrnd is 0.1
    wfs 3: type 0, at ( -15.00,   25.98) arcsec,  99 km, siglev is 76.1436 bkgrnd is 0.1
    wfs 4: type 0, at ( -28.19,   10.26) arcsec,  99 km, siglev is 76.1436 bkgrnd is 0.1
    wfs 5: type 0, at ( -28.19,  -10.26) arcsec,  99 km, siglev is 76.1436 bkgrnd is 0.1
    wfs 6: type 0, at ( -15.00,  -25.98) arcsec,  99 km, siglev is 76.1436 bkgrnd is 0.1
    wfs 7: type 0, at (   5.21,  -29.54) arcsec,  99 km, siglev is 76.1436 bkgrnd is 0.1
    wfs 8: type 0, at (  22.98,  -19.28) arcsec,  99 km, siglev is 76.1436 bkgrnd is 0.1
    wfs 9: type 1, at (   5.00,    8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 10: type 1, at ( -10.00,    0.00) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 11: type 1, at (   5.00,   -8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 12: type 2, at (   0.00,    0.00) arcsec, inf km, siglev is 4.1558e+06 bkgrnd is 0.001
[00;00mThere are 3 DMs[00;00m
  DM 0 at -0.1km, actuator pitch 0.252m, offset   0, with 30.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 1 at    6km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 2 at   10km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
[00;00mTomography[00;00m is using CG, with [00;00mFourer Domain[00;00m preconditioner, [00;00m12[00;00m iterations, integrated tomo.
[00;00mDM Fitting [00;00mis using CG, with [00;00mNo[00;00m preconditioner, [00;00m10[00;00m iterations
[00;00mThere are 9 fit directions[00;00m
    Fit 0: weight is 0.444, at (   0.00,    0.00) arcsec
    Fit 1: weight is 0.111, at (  15.00,    0.00) arcsec
    Fit 2: weight is 0.111, at (   0.00,   15.00) arcsec
    Fit 3: weight is 0.111, at ( -15.00,    0.00) arcsec
    Fit 4: weight is 0.111, at (   0.00,  -15.00) arcsec
    Fit 5: weight is 0.028, at (  15.00,   15.00) arcsec
    Fit 6: weight is 0.028, at ( -15.00,   15.00) arcsec
    Fit 7: weight is 0.028, at ( -15.00,  -15.00) arcsec
    Fit 8: weight is 0.028, at (  15.00,  -15.00) arcsec
[00;00mThere are 1 evaluation directions[00;00m at sampling 1/128 m.
    Evl 0: weight is 1.000, at (   0.00,    0.00) arcsec
[00;00mSimulation[00;00m start at step 0, end at step 1600, with time step 1/1500s, [00;00mclose loop[00;00m.
After setup_parms:	120.5 MiB.
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
CUDA: minimum memory requirement is 0.3GB
GPU 0 is NVIDIA A100-SXM4-40GB with arch 8.0, 38.9GB free, 39.3GB total device memory.
Using GPU 0
Use 1 GPUs for WFS Tomo Fit Evl

*** Preparation started at 2025/02/17 14:47:56 in nid001972. ***

Using OpenMP version 201511 with 128 threads
Reading aperture amplitude map from KECK.fits
[00;00m[0;36mWarning(accphi.c:477): 108520 points not covered by input screen
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
 ->maos.c:447->setup.c:148->aper.c:74->utils.c:478->accphi.c:478
iwvl 0: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 1: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 2: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 3: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 4: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 5: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 6: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 7: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 8: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
After setup_aper:	344.7 MiB.

[00;00mSetting up powfs 0 geom[00;00m

There are 32 points in each subaperture of 0.252m.
There are 1201 valid subaperture.

[00;00mSetting up powfs 1 geom[00;00m

There are 88 points in each subaperture of 5.5m.
There are 4 valid subaperture.

[00;00mSetting up powfs 2 geom[00;00m

There are 18 points in each subaperture of 0.563m.
There are 236 valid subaperture.
After setup_powfs_init:	425.5 MiB.

[00;00mSetting up reconstructor geometry.[00;00m

PLOC is 91x91, with sampling of 0.13m (square)
    DM 0: grid is 47 x 47
    DM 1: grid is 75 x 75
    DM 2: grid is 80 x 79
FLOC is 91x91, with sampling of 0.13m (not square)
Tomography grid is square:
    layer 0: xloc grid is 160 x 160, sampling is 0.126 m, 25600 points
    layer 1: xloc grid is 160 x 160, sampling is 0.126 m, 25600 points
    layer 2: xloc grid is 160 x 160, sampling is 0.126 m, 25600 points
    layer 3: xloc grid is 160 x 160, sampling is 0.126 m, 25600 points
    layer 4: xloc grid is 160 x 160, sampling is 0.126 m, 25600 points
    layer 5: xloc grid is 160 x 160, sampling is 0.126 m, 25600 points
    layer 6: xloc grid is 160 x 160, sampling is 0.126 m, 25600 points
    layer 7: xloc grid is 160 x 160, sampling is 0.125 m, 25600 points
    layer 8: xloc grid is 160 x 160, sampling is 0.125 m, 25600 points
    layer 9: xloc grid is 160 x 160, sampling is 0.125 m, 25600 points
    layer 10: xloc grid is 160 x 160, sampling is 0.120 m, 25600 points
    layer 11: xloc grid is 160 x 160, sampling is 0.114 m, 25600 points
    layer 12: xloc grid is 160 x 160, sampling is 0.108 m, 25600 points
    layer 13: xloc grid is 160 x 160, sampling is 0.097 m, 25600 points

[00;00mSetting up powfs 0 PO WFS[00;00m

OTF dimension is 64x64 (calculated)
Uplink FWHM (illt 0, iwvl 0) is 0.579373"
Downlink FWHM (illt 0, iwvl 0) is 1.12518"
Generating matched filter for powfs 0
sa index   location       noise equivalent angle
     598: (  4.8,  -0.3) m, ( 74.61,  72.44) mas
     594: (  3.8,  -0.3) m, ( 78.78,  72.92) mas
     590: (  2.8,  -0.3) m, ( 84.75,  73.49) mas
     585: (  1.5,  -0.3) m, ( 93.98,  74.26) mas
     584: (  1.3,  -0.3) m, ( 95.72,  74.40) mas
     411: ( -0.5,  -1.5) m, (109.99,  76.32) mas
     582: ( -1.8,  -0.3) m, (120.72,  76.18) mas
     578: ( -2.8,  -0.3) m, (129.71,  76.76) mas
     573: ( -4.0,  -0.3) m, (141.30,  77.44) mas
     569: ( -5.0,  -0.3) m, (150.67,  77.97) mas
     568: ( -5.3,  -0.3) m, (153.21,  78.10) mas
sa index   location       noise equivalent angle
     945: (  2.8,   2.3) m, ( 76.63,  75.43) mas
     911: (  2.5,   2.0) m, ( 80.46,  79.11) mas
     758: (  1.3,   1.0) m, ( 84.88,  81.34) mas
     721: (  1.0,   0.8) m, ( 86.38,  82.68) mas
     718: ( -1.3,   0.8) m, (103.36,  83.14) mas
     480: ( -1.3,  -1.0) m, (102.99,  94.58) mas
     445: ( -1.5,  -1.3) m, (104.90,  96.34) mas
     258: ( -3.0,  -2.5) m, (117.29, 105.81) mas
     225: ( -3.3,  -2.8) m, (119.43, 107.84) mas
      27: ( -3.0,  -4.5) m, (116.96, 122.80) mas
sa index   location       noise equivalent angle
    1115: (  0.5,   3.8) m, ( 72.99,  78.06) mas
    1089: (  0.5,   3.5) m, ( 73.13,  79.43) mas
     902: (  0.3,   2.0) m, ( 75.50,  90.59) mas
     791: (  0.0,   1.3) m, ( 75.70,  95.84) mas
     583: ( -1.5,  -0.3) m, ( 79.42, 106.47) mas
     373: ( -0.5,  -1.8) m, ( 76.99, 119.61) mas
     301: ( -0.5,  -2.3) m, ( 78.77, 126.48) mas
     114: ( -0.8,  -3.8) m, ( 78.36, 137.79) mas
      13: ( -1.0,  -4.8) m, ( 79.39, 147.18) mas
       8: ( -2.5,  -4.8) m, ( 85.66, 147.06) mas
sa index   location       noise equivalent angle
    1179: ( -2.8,   4.5) m, ( 75.57,  76.34) mas
    1129: ( -2.5,   4.0) m, ( 73.05,  74.38) mas
     928: ( -1.5,   2.3) m, ( 75.99,  82.36) mas
     861: ( -1.3,   1.8) m, ( 77.44,  86.03) mas
     788: ( -0.8,   1.3) m, ( 79.32,  89.24) mas
     653: (  1.3,   0.3) m, ( 91.74,  96.41) mas
     416: (  0.8,  -1.5) m, ( 88.39, 110.61) mas
     275: (  1.3,  -2.5) m, ( 91.84, 119.31) mas
     212: (  1.5,  -3.0) m, ( 93.59, 123.65) mas
      74: (  2.3,  -4.3) m, ( 98.90, 134.68) mas
      24: (  2.5,  -4.8) m, (105.00, 145.29) mas
sa index   location       noise equivalent angle
     775: ( -4.0,   1.3) m, ( 76.91,  73.25) mas
     742: ( -3.3,   1.0) m, ( 80.63,  73.94) mas
     713: ( -2.5,   0.8) m, ( 85.53,  74.77) mas
     651: ( -1.5,   0.3) m, ( 92.62,  76.43) mas
     412: ( -0.3,  -1.5) m, (106.49,  88.37) mas
     550: (  1.3,  -0.5) m, (115.19,  80.18) mas
     488: (  2.3,  -1.0) m, (123.78,  82.81) mas
     459: (  3.0,  -1.3) m, (130.51,  84.32) mas
     428: (  3.8,  -1.5) m, (137.41,  85.88) mas
     565: (  5.0,  -0.5) m, (149.57,  81.51) mas
sa index   location       noise equivalent angle
     397: ( -4.0,  -1.5) m, ( 76.91,  73.25) mas
     438: ( -3.3,  -1.3) m, ( 80.63,  73.94) mas
     475: ( -2.5,  -1.0) m, ( 85.53,  74.77) mas
     548: ( -1.5,  -0.5) m, ( 92.62,  76.43) mas
     790: ( -0.3,   1.3) m, (106.49,  88.37) mas
     653: (  1.3,   0.3) m, (115.19,  80.18) mas
     726: (  2.3,   0.8) m, (123.78,  82.81) mas
     765: (  3.0,   1.0) m, (130.51,  84.32) mas
     806: (  3.8,   1.3) m, (137.41,  85.88) mas
     668: (  5.0,   0.3) m, (149.57,  81.51) mas
sa index   location       noise equivalent angle
       7: ( -2.8,  -4.8) m, ( 74.59,  75.31) mas
      55: ( -2.5,  -4.3) m, ( 73.05,  74.38) mas
     264: ( -1.5,  -2.5) m, ( 75.99,  82.36) mas
     333: ( -1.3,  -2.0) m, ( 77.21,  85.90) mas
     410: ( -0.8,  -1.5) m, ( 79.32,  89.24) mas
     550: (  1.3,  -0.5) m, ( 91.74,  96.41) mas
     794: (  0.8,   1.3) m, ( 88.39, 110.61) mas
     939: (  1.3,   2.3) m, ( 91.84, 119.31) mas
    1004: (  1.5,   2.8) m, ( 93.59, 123.65) mas
    1148: (  2.3,   4.0) m, ( 98.90, 134.68) mas
    1194: (  2.5,   4.5) m, (106.61, 147.55) mas
sa index   location       noise equivalent angle
      93: (  0.5,  -4.0) m, ( 72.99,  78.06) mas
     119: (  0.5,  -3.8) m, ( 73.13,  79.43) mas
     304: (  0.3,  -2.3) m, ( 75.75,  90.91) mas
     413: (  0.0,  -1.5) m, ( 75.70,  95.84) mas
     617: ( -1.5,   0.0) m, ( 79.42, 106.47) mas
     827: ( -0.5,   1.5) m, ( 76.99, 119.61) mas
     899: ( -0.5,   2.0) m, ( 78.51, 125.97) mas
    1084: ( -0.8,   3.5) m, ( 78.36, 137.79) mas
    1184: ( -1.0,   4.5) m, ( 79.39, 147.18) mas
    1180: ( -2.5,   4.5) m, ( 85.66, 147.06) mas
sa index   location       noise equivalent angle
     281: (  2.8,  -2.5) m, ( 76.63,  75.43) mas
     313: (  2.5,  -2.3) m, ( 80.58,  79.45) mas
     452: (  1.3,  -1.3) m, ( 84.88,  81.34) mas
     483: (  1.0,  -1.0) m, ( 86.38,  82.68) mas
     480: ( -1.3,  -1.0) m, (103.36,  83.14) mas
     718: ( -1.3,   0.8) m, (102.99,  94.58) mas
     749: ( -1.5,   1.0) m, (104.90,  96.34) mas
     922: ( -3.0,   2.3) m, (117.29, 105.81) mas
     953: ( -3.3,   2.5) m, (119.43, 107.84) mas
    1153: ( -3.0,   4.3) m, (116.96, 122.80) mas

[00;00mSetting up powfs 2 PO WFS[00;00m

OTF dimension is 48x48 (calculated)
Generating matched filter for powfs 2
Use sanea to derive neasim
Use sanea to derive neasim

[00;00mSetting up reconstructor[00;00m

Recon NEA: cmf(97.26) cmf(97.07) cmf(97.02) cmf(97.18) cmf(97.17) cmf(97.18) cmf(97.21) cmf(97.06) cmf(97.10) geom(0.31) geom(0.31) geom(0.31) mf(0.14)  mas
Setup or update control matrix parameters.
RRtwfs svd threshold is 1e-10
Replacing HA by HA*fit->actextrap
Adding piston cr to fit matrix
Adding TT cr on upper DMs to fit matrix.
Before assembling fit matrix:	3150.4 MiB.
Building fit->FR
Building fit->FL
Adding tikhonov constraint of 1.0e-07 to FLM
The maximum eigen value is estimated to be around 3.4e-04
DM Fit number of Low rank terms: 16 in LHS
After assemble fit matrix:	3927.0 MiB.
After setup_recon:	3927.0 MiB.
GPU 0: mem used 1880 MB (wfs init)
GPU 0: mem used 2364 MB (recon init)
GPU 0: mem used 2394 MB (perf init)

*** Simulation started at 2025/02/17 14:48:38 in nid001972. ***

Running seed 1
GPU 0: mem used 2394 MB (wfs seeding)
Wind dir: 267.3 261.7 167.0 130.5 300.7  32.3 119.8 139.0 150.8 277.7 203.0 133.1  45.9 265.1 deg
Using /global/homes/b/bpeck/.aos/cache/atm/vonkarman_14_8192x8192_0.0078125_1115374592d.bin
After genatm:	3890.0 MiB.
Step     #  Open Loop  PR TT  On axis  PR TT  Field RMS PR TT     Timing 
Step     0: OL  884.6  248.3  OA  884.6 248.3 CL  884.6 248.3 nm  0.169 s
Step    26: OL  925.8  257.6  OA  105.7  17.6 CL  105.7  17.6 nm  0.044 s
Step    48: OL  959.5  261.0  OA  107.5  14.7 CL  107.5  14.7 nm  0.043 s
Step    71: OL  993.8  259.6  OA  107.0  12.2 CL  107.0  12.2 nm  0.045 s
Step    94: OL 1028.7  257.6  OA  107.4  14.4 CL  107.4  14.4 nm  0.043 s
Step   117: OL 1063.6  258.0  OA  104.5   7.6 CL  104.5   7.6 nm  0.046 s
Step   140: OL 1095.8  263.2  OA  105.1  21.5 CL  105.1  21.5 nm  0.044 s
Step   162: OL 1122.0  273.1  OA  102.8   9.6 CL  102.8   9.6 nm  0.043 s
Step   185: OL 1142.4  287.1  OA  105.2  19.1 CL  105.2  19.1 nm  0.052 s
Step   208: OL 1154.9  301.9  OA  104.6  11.3 CL  104.6  11.3 nm  0.042 s
Step   231: OL 1160.6  316.7  OA  102.1  12.5 CL  102.1  12.5 nm  0.045 s
Step   253: OL 1158.5  332.0  OA  100.5   7.8 CL  100.5   7.8 nm  0.043 s
Step   255 updated high order loop gain: 0.377
Step   275: OL 1145.6  347.9  OA  102.0   8.9 CL  102.0   8.9 nm  0.049 s
Step   293: OL 1129.3  362.0  OA  103.2  14.9 CL  103.2  14.9 nm  0.043 s
Step   316: OL 1104.5  382.8  OA  103.8  16.5 CL  103.8  16.5 nm  0.044 s
Step   338: OL 1077.2  406.2  OA  100.7  11.4 CL  100.7  11.4 nm  0.041 s
Step   361: OL 1048.7  435.9  OA  103.4  11.1 CL  103.4  11.1 nm  0.043 s
Step   383: OL 1024.0  467.4  OA  104.9  11.2 CL  104.9  11.2 nm  0.044 s
Step   406: OL 1000.0  500.5  OA  107.2   5.0 CL  107.2   5.0 nm  0.043 s
Step   429: OL  974.7  531.7  OA  103.8   9.2 CL  103.8   9.2 nm  0.044 s
Step   452: OL  951.3  561.7  OA  105.1  18.5 CL  105.1  18.5 nm  0.051 s
Step   475: OL  937.0  591.7  OA  105.6  20.0 CL  105.6  20.0 nm  0.044 s
Step   498: OL  934.0  620.0  OA  106.3  19.3 CL  106.3  19.3 nm  0.051 s
Step   511 updated high order loop gain: 0.357
Step   521: OL  938.0  644.1  OA  105.8  12.2 CL  105.8  12.2 nm  0.044 s
Step   544: OL  947.9  660.4  OA  105.0  14.3 CL  105.0  14.3 nm  0.051 s
Step   567: OL  964.4  668.7  OA  105.1  11.4 CL  105.1  11.4 nm  0.043 s
Step   588: OL  984.0  670.8  OA  104.5   9.1 CL  104.5   9.1 nm  0.044 s
Step   610: OL 1007.8  665.8  OA  106.4  12.9 CL  106.4  12.9 nm  0.052 s
Step   632: OL 1032.6  653.4  OA  105.0  20.9 CL  105.0  20.9 nm  0.042 s
Step   655: OL 1056.0  634.1  OA  104.2   2.5 CL  104.2   2.5 nm  0.043 s
Step   677: OL 1075.2  611.7  OA  106.3   6.5 CL  106.3   6.5 nm  0.052 s
Step   699: OL 1091.9  588.1  OA  106.5   4.7 CL  106.5   4.7 nm  0.044 s
Step   720: OL 1102.1  562.7  OA  106.5   9.9 CL  106.5   9.9 nm  0.051 s
Step   743: OL 1104.4  534.3  OA  104.7  10.8 CL  104.7  10.8 nm  0.042 s
Step   766: OL 1097.7  506.9  OA  106.3  15.8 CL  106.3  15.8 nm  0.044 s
Step   767 updated high order loop gain: 0.350
Step   789: OL 1081.5  481.0  OA  105.2   3.7 CL  105.2   3.7 nm  0.044 s
Step   812: OL 1056.7  455.3  OA  104.9   1.3 CL  104.9   1.3 nm  0.042 s
Step   835: OL 1024.8  430.0  OA  105.0   5.9 CL  105.0   5.9 nm  0.047 s
Step   858: OL  988.8  407.0  OA  105.7   6.2 CL  105.7   6.2 nm  0.042 s
Step   880: OL  955.1  388.6  OA  104.6   8.6 CL  104.6   8.6 nm  0.044 s
Step   902: OL  922.0  373.8  OA  101.3   5.7 CL  101.3   5.7 nm  0.045 s
Step   925: OL  885.4  362.1  OA  105.2  11.3 CL  105.2  11.3 nm  0.052 s
Step   948: OL  850.3  351.2  OA  108.1   9.3 CL  108.1   9.3 nm  0.043 s
Step   971: OL  819.8  338.9  OA  104.3   7.4 CL  104.3   7.4 nm  0.044 s
Step   993: OL  797.0  324.7  OA  102.2   7.8 CL  102.2   7.8 nm  0.052 s
Step  1014: OL  778.6  309.1  OA  107.8  17.4 CL  107.8  17.4 nm  0.042 s
Step  1023 updated high order loop gain: 0.346
Step  1036: OL  763.7  291.7  OA  109.3  21.5 CL  109.3  21.5 nm  0.056 s
Step  1059: OL  750.7  271.1  OA  106.9  16.2 CL  106.9  16.2 nm  0.054 s
Step  1082: OL  741.1  246.0  OA  105.6   8.8 CL  105.6   8.8 nm  0.042 s
Step  1104: OL  737.6  221.2  OA  106.5  17.2 CL  106.5  17.2 nm  0.043 s
Step  1127: OL  737.6  199.4  OA  106.7  27.4 CL  106.7  27.4 nm  0.042 s
Step  1150: OL  739.0  183.4  OA  105.8  19.3 CL  105.8  19.3 nm  0.042 s
Step  1173: OL  740.3  173.4  OA  103.6  20.2 CL  103.6  20.2 nm  0.052 s
Step  1195: OL  744.1  168.2  OA  107.1  26.0 CL  107.1  26.0 nm  0.044 s
Step  1217: OL  748.7  164.5  OA  105.3  23.5 CL  105.3  23.5 nm  0.045 s
Step  1239: OL  752.0  164.3  OA  105.1  17.5 CL  105.1  17.5 nm  0.043 s
Step  1262: OL  754.9  170.4  OA  104.1  15.9 CL  104.1  15.9 nm  0.049 s
Step  1279 updated high order loop gain: 0.339
Step  1285: OL  759.6  182.2  OA  103.4  19.2 CL  103.4  19.2 nm  0.043 s
Step  1307: OL  766.2  196.9  OA  107.1  16.9 CL  107.1  16.9 nm  0.044 s
Step  1329: OL  772.5  214.5  OA  103.0  13.4 CL  103.0  13.4 nm  0.052 s
Step  1350: OL  781.5  233.5  OA  102.3  19.8 CL  102.3  19.8 nm  0.043 s
Step  1367: OL  792.0  247.8  OA  106.8  34.8 CL  106.8  34.8 nm  0.043 s
Step  1389: OL  808.5  261.4  OA  102.4  17.3 CL  102.4  17.3 nm  0.048 s
Step  1412: OL  829.8  270.5  OA  103.1  10.3 CL  103.1  10.3 nm  0.043 s
Step  1435: OL  852.7  276.0  OA  103.1  20.3 CL  103.1  20.3 nm  0.044 s
Step  1457: OL  873.2  279.3  OA  105.5  15.1 CL  105.5  15.1 nm  0.050 s
Step  1480: OL  888.9  278.3  OA  102.8   9.6 CL  102.8   9.6 nm  0.042 s
Step  1503: OL  893.8  271.7  OA  101.1   8.3 CL  101.1   8.3 nm  0.043 s
Step  1526: OL  890.8  261.0  OA   99.1   7.8 CL   99.1   7.8 nm  0.054 s
Step  1535 updated high order loop gain: 0.340
Step  1548: OL  881.9  247.3  OA  100.8   8.8 CL  100.8   8.8 nm  0.042 s
Step  1563: OL  875.0  237.4  OA  102.4  13.3 CL  102.4  13.3 nm  0.044 s
Step  1586: OL  862.3  224.8  OA  105.8  15.7 CL  105.8  15.7 nm  0.043 s
Step 1599: Output PSF
Step  1599: OL  854.0  219.3  OA  106.9  19.3 CL  106.9  19.3 nm  2.043 s
Mean: 105.10 15.76 103.92  nm.

*** Simulation Finished at 2025/02/17 14:50:02 in nid001972. ***

[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
/global/cfs/cdirs/ulens/vismcao/maos -o studies/reduced_ngs/9_lgs/8mag_lgs/1750count -c master_files/reduced_ngs/9_lgs/8mag_lgs/kola_1750act.conf -O 
Output folder is 'studies/reduced_ngs/9_lgs/8mag_lgs/1750count'.
SRC: /global/homes/b/bpeck/code/maos v2.9 4c88b7c2 2024-11-13 16:45:33 -0800
BUILT: /global/homes/b/bpeck/code/maos/optim by GCC (v12) on 2024/11/18 09:40:03 CPU(F64,+O3) with CUDA(v122,F32)
Launched at 2025/02/17 14:50:03 in nid001972 with PID 1690147.
The web based job monitor can be accessed at http://localhost:10300
Main config file is /global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_1750act.conf
[00;00m[0;36mWarning(path.c:48): Path not found: path=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; abspath=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; Ignored.
[00;00m[0;36mWarning(path.c:48): Path not found: path=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; abspath=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; Ignored.
[00;00m[0;36mWarning(readcfg.c:399): sim.apfsm has been renamed to powfs.apfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.epfsm has been renamed to powfs.epfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.alfsm has been renamed to powfs.alfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.commonfsm has been renamed to powfs.commonfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.idealfsm has been renamed to powfs.idealfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.zetafsm has been renamed to powfs.zetafsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.f0fsm has been renamed to powfs.f0fsm.
[00;00m[0;36mWarning(readcfg.c:399): tsurf has been renamed to ncpa.tsurf.
loaded 132 (132 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_sim.conf'
loaded  19 ( 19 new) records from '/global/cfs/cdirs/ulens/vismcao/./dm_none.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_ASM.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_DM2.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_DM3.conf'
loaded   0 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_dm_multiple.conf'
loaded   7 (  5 new) records from '/global/cfs/cdirs/ulens/vismcao/./atm_mk13n50p_ground_detail.conf'
loaded  76 ( 69 new) records from '/global/homes/b/bpeck/code/maos/config/maos/powfs_common.conf'
loaded  44 ( 38 new) records from '/global/cfs/cdirs/ulens/vismcao/./powfs_none.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_lgs.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_ttf_strap.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_twfs_lbwfs.conf'
loaded   0 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_wfs_lgs_strap_lbwfs.conf'
loaded  71 ( 71 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_recon.conf'
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_smooth has been renamed to powfs0_llt.na_smooth.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_interp has been renamed to powfs0_llt.na_interp.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_thres has been renamed to powfs0_llt.na_thres.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_maxit has been renamed to powfs0_llt.na_fit_maxit.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_svdthres has been renamed to powfs0_llt.na_fit_svdthres.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_dh has been renamed to powfs0_llt.na_fit_dh.
[00;00m[0;36mWarning(readcfg.c:399): dbg.ncpa_preload has been renamed to ncpa.preload.
[00;00m[0;36mWarning(readcfg.c:399): dbg.ncpa_rmsci has been renamed to ncpa.rmsci.
[00;00m[0;36mWarning(readcfg.c:399): dbg.draw_opdmax has been renamed to plot.opdmax.
[00;00m[0;36mWarning(readcfg.c:399): dbg.draw_gmax has been renamed to plot.gmax.
loaded  95 ( 93 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_dbg.conf'
loaded   4 (  4 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_fit_mcao.conf'
[00;00m[0;36mWarning(readcfg.c:399): surf has been renamed to ncpa.surf.
loaded  39 (  7 new) records from '/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_1750act.conf'
loaded   0 (  0 new) records from 'command line'
loaded  24 ( 18 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_llt_CL.conf'
Adjust LGS range by telescope altitude 4145m.
Zenith angle is 30 degree.
    Scaling turbulence height and LGS hs by sec(za).
    Scaling r0 by cos(za)^(3/5).
    Scaling wind speed and LGS signal level by cos(za).
powfs0: Adjusting dx from 0.0078125 to 0.00776667. 
powfs0.llt.fsm: f0=0 Hz, LPF ep=0
powfs0.epfsm is set to 0.517618 (auto)
powfs2: Adjusting dx from 0.03125 to 0.0312778. 
powfs2 is TWFS for powfs0
sim.ephi is set to 0.427717 (auto)
sim.eplo is set to 0.427717 (auto)
[00;00m[0;36mWarning(parms.c:2296): Layer 1 at 17.3205m is very close to layer 0 at 0m (OK).
[00;00m[0;36mWarning(parms.c:2296): Layer 2 at 34.641m is very close to layer 1 at 17.3205m (OK).
[00;00m[0;36mWarning(parms.c:2296): Layer 3 at 51.9615m is very close to layer 2 at 34.641m (OK).
dm 0: stroke=30 um is provided in micron.
dm 0: assume ia stroke=2 um is provided in micron.
dm 1: stroke=7 um is provided in micron.
dm 1: assume ia stroke=2 um is provided in micron.
dm 2: stroke=7 um is provided in micron.
dm 2: assume ia stroke=2 um is provided in micron.
Focus blending is not implemented yet for integrated tomography
parms->sim.mffocus is reset to 0
There are 1 valid simulation seeds:  1
Output PSF for 1 directions
Used 449 of 456 supplied keys
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_flate" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_flatv" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_psx" is not recognized, value is [0 0 0 0]
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_psy" is not recognized, value is [0 0 0 0]
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_pupelong" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_raw" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_side" is not recognized, value is 4
[00;00mAperture[00;00m is 11 m with sampling 1/128 m
[00;00mTurbulence at 30 degree zenith angle:[00;00m r0=0.128424m, L0=30m, 14 layers.
    Greenwood freq is 25.1Hz, anisoplanatic angle is 1.58 as
    Sampled 8192x8192 at 1/128m. wind dir is randomized.
    layer 0: ht=      0 m, wt= 0.302, ws=  4.8 m/s
    layer 1: ht=     17 m, wt= 0.154, ws=  5.0 m/s
    layer 2: ht=     35 m, wt= 0.041, ws=  5.4 m/s
    layer 3: ht=     52 m, wt= 0.002, ws=  6.6 m/s
    layer 4: ht=    139 m, wt= 0.021, ws=  6.1 m/s
    layer 5: ht=    231 m, wt= 0.010, ws=  6.1 m/s
    layer 6: ht=    323 m, wt= 0.008, ws=  6.1 m/s
    layer 7: ht=    416 m, wt= 0.005, ws=  6.1 m/s
    layer 8: ht=    508 m, wt= 0.001, ws=  6.1 m/s
    layer 9: ht=    932 m, wt= 0.107, ws=  5.6 m/s
    layer 10: ht=   5022 m, wt= 0.144, ws= 11.1 m/s
    layer 11: ht=   9238 m, wt= 0.093, ws= 19.1 m/s
    layer 12: ht=  13856 m, wt= 0.075, ws=  8.2 m/s
    layer 13: ht=  22518 m, wt= 0.036, ws=  4.8 m/s
[00;00mReconstruction[00;00m: r0=0.128424m L0=30m. 14 layers. use cone coordinate.
    layer 0: ht=      0 m, wt= 0.302
    layer 1: ht=     17 m, wt= 0.154
    layer 2: ht=     35 m, wt= 0.041
    layer 3: ht=     52 m, wt= 0.002
    layer 4: ht=    139 m, wt= 0.021
    layer 5: ht=    231 m, wt= 0.010
    layer 6: ht=    323 m, wt= 0.008
    layer 7: ht=    416 m, wt= 0.005
    layer 8: ht=    508 m, wt= 0.001
    layer 9: ht=    932 m, wt= 0.107
    layer 10: ht=   5022 m, wt= 0.144
    layer 11: ht=   9238 m, wt= 0.093
    layer 12: ht=  13856 m, wt= 0.075
    layer 13: ht=  22518 m, wt= 0.036
[00;00mThere are 3 powfs[00;00m
  powfs0: Order 48, LGS at 99.1 km. Sampling 1/128.755 m. Thres 30%. [00;00mT/T is removed in right hand side in tomography.[00;00m
    CCD image is 25x25 @ 500x500 mas, blur 27% (sigma), 1500Hz, wvl: [ 5.89e-07]
    Gtilt in reconstruction. Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
  powfs1: Order  2, NGS at inf km. Sampling 1/16 m. Thres 30%. 
    Ztilt in reconstruction. Geomtric optics start at 2 with ztilt [00;00m(noisy)[00;00m
  powfs2: Order 20, NGS at inf km. Sampling 1/31.9716 m. Thres 50%. 
    CCD image is 4x4 @ 1500x1500 mas, blur 0% (sigma), 0.015Hz, wvl: [ 7.2e-07]
    Gtilt in reconstruction. Geomtric optics start at 50 with gtilt Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
[00;00mThere are 13 wfs[00;00m
    wfs 0: type 0, at (  30.00,    0.00) arcsec,  99 km, siglev is 65.0948 bkgrnd is 0.1
    wfs 1: type 0, at (  22.98,   19.28) arcsec,  99 km, siglev is 65.0948 bkgrnd is 0.1
    wfs 2: type 0, at (   5.21,   29.54) arcsec,  99 km, siglev is 65.0948 bkgrnd is 0.1
    wfs 3: type 0, at ( -15.00,   25.98) arcsec,  99 km, siglev is 65.0948 bkgrnd is 0.1
    wfs 4: type 0, at ( -28.19,   10.26) arcsec,  99 km, siglev is 65.0948 bkgrnd is 0.1
    wfs 5: type 0, at ( -28.19,  -10.26) arcsec,  99 km, siglev is 65.0948 bkgrnd is 0.1
    wfs 6: type 0, at ( -15.00,  -25.98) arcsec,  99 km, siglev is 65.0948 bkgrnd is 0.1
    wfs 7: type 0, at (   5.21,  -29.54) arcsec,  99 km, siglev is 65.0948 bkgrnd is 0.1
    wfs 8: type 0, at (  22.98,  -19.28) arcsec,  99 km, siglev is 65.0948 bkgrnd is 0.1
    wfs 9: type 1, at (   5.00,    8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 10: type 1, at ( -10.00,    0.00) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 11: type 1, at (   5.00,   -8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 12: type 2, at (   0.00,    0.00) arcsec, inf km, siglev is 4.1558e+06 bkgrnd is 0.001
[00;00mThere are 3 DMs[00;00m
  DM 0 at -0.1km, actuator pitch 0.233m, offset   0, with 30.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 1 at    6km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 2 at   10km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
[00;00mTomography[00;00m is using CG, with [00;00mFourer Domain[00;00m preconditioner, [00;00m12[00;00m iterations, integrated tomo.
[00;00mDM Fitting [00;00mis using CG, with [00;00mNo[00;00m preconditioner, [00;00m10[00;00m iterations
[00;00mThere are 9 fit directions[00;00m
    Fit 0: weight is 0.444, at (   0.00,    0.00) arcsec
    Fit 1: weight is 0.111, at (  15.00,    0.00) arcsec
    Fit 2: weight is 0.111, at (   0.00,   15.00) arcsec
    Fit 3: weight is 0.111, at ( -15.00,    0.00) arcsec
    Fit 4: weight is 0.111, at (   0.00,  -15.00) arcsec
    Fit 5: weight is 0.028, at (  15.00,   15.00) arcsec
    Fit 6: weight is 0.028, at ( -15.00,   15.00) arcsec
    Fit 7: weight is 0.028, at ( -15.00,  -15.00) arcsec
    Fit 8: weight is 0.028, at (  15.00,  -15.00) arcsec
[00;00mThere are 1 evaluation directions[00;00m at sampling 1/128 m.
    Evl 0: weight is 1.000, at (   0.00,    0.00) arcsec
[00;00mSimulation[00;00m start at step 0, end at step 1600, with time step 1/1500s, [00;00mclose loop[00;00m.
After setup_parms:	120.5 MiB.
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
CUDA: minimum memory requirement is 0.4GB
GPU 0 is NVIDIA A100-SXM4-40GB with arch 8.0, 38.9GB free, 39.3GB total device memory.
Using GPU 0
Use 1 GPUs for WFS Tomo Fit Evl

*** Preparation started at 2025/02/17 14:50:04 in nid001972. ***

Using OpenMP version 201511 with 128 threads
Reading aperture amplitude map from KECK.fits
[00;00m[0;36mWarning(accphi.c:477): 108300 points not covered by input screen
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
 ->maos.c:447->setup.c:148->aper.c:74->utils.c:478->accphi.c:478
iwvl 0: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 1: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 2: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 3: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 4: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 5: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 6: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 7: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 8: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
After setup_aper:	344.5 MiB.

[00;00mSetting up powfs 0 geom[00;00m

There are 30 points in each subaperture of 0.233m.
There are 1383 valid subaperture.

[00;00mSetting up powfs 1 geom[00;00m

There are 88 points in each subaperture of 5.5m.
There are 4 valid subaperture.

[00;00mSetting up powfs 2 geom[00;00m

There are 18 points in each subaperture of 0.563m.
There are 236 valid subaperture.
After setup_powfs_init:	429.3 MiB.

[00;00mSetting up reconstructor geometry.[00;00m

PLOC is 99x99, with sampling of 0.12m (square)
    DM 0: grid is 51 x 51
    DM 1: grid is 75 x 75
    DM 2: grid is 80 x 79
FLOC is 99x99, with sampling of 0.12m (not square)
Tomography grid is square:
    layer 0: xloc grid is 180 x 180, sampling is 0.117 m, 32400 points
    layer 1: xloc grid is 180 x 180, sampling is 0.116 m, 32400 points
    layer 2: xloc grid is 180 x 180, sampling is 0.116 m, 32400 points
    layer 3: xloc grid is 180 x 180, sampling is 0.116 m, 32400 points
    layer 4: xloc grid is 180 x 180, sampling is 0.116 m, 32400 points
    layer 5: xloc grid is 180 x 180, sampling is 0.116 m, 32400 points
    layer 6: xloc grid is 180 x 180, sampling is 0.116 m, 32400 points
    layer 7: xloc grid is 180 x 180, sampling is 0.116 m, 32400 points
    layer 8: xloc grid is 180 x 180, sampling is 0.116 m, 32400 points
    layer 9: xloc grid is 180 x 180, sampling is 0.115 m, 32400 points
    layer 10: xloc grid is 180 x 180, sampling is 0.111 m, 32400 points
    layer 11: xloc grid is 180 x 180, sampling is 0.106 m, 32400 points
    layer 12: xloc grid is 180 x 180, sampling is 0.100 m, 32400 points
    layer 13: xloc grid is 180 x 180, sampling is 0.090 m, 32400 points

[00;00mSetting up powfs 0 PO WFS[00;00m

OTF dimension is 60x60 (calculated)
Uplink FWHM (illt 0, iwvl 0) is 0.577825"
Downlink FWHM (illt 0, iwvl 0) is 1.13399"
Generating matched filter for powfs 0
sa index   location       noise equivalent angle
     688: (  4.9,  -0.2) m, (5000.00, 5000.00) mas
     683: (  3.7,  -0.2) m, (5000.00, 5000.00) mas
     678: (  2.6,  -0.2) m, (5000.00, 5000.00) mas
     674: (  1.6,  -0.2) m, (5000.00, 5000.00) mas
     673: (  1.4,  -0.2) m, (5000.00, 5000.00) mas
     493: (  0.5,  -1.4) m, (5000.00, 5000.00) mas
     669: ( -1.9,  -0.2) m, (5000.00, 5000.00) mas
     665: ( -2.8,  -0.2) m, (5000.00, 5000.00) mas
     660: ( -4.0,  -0.2) m, (5000.00, 5000.00) mas
     655: ( -5.1,  -0.2) m, (5000.00, 5000.00) mas
     654: ( -5.4,  -0.2) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    1094: (  2.8,   2.3) m, (5000.00, 5000.00) mas
    1059: (  2.6,   2.1) m, (5000.00, 5000.00) mas
     858: (  1.2,   0.9) m, (5000.00, 5000.00) mas
     820: (  0.9,   0.7) m, (5000.00, 5000.00) mas
     493: (  0.5,  -1.4) m, (5000.00, 5000.00) mas
     525: ( -1.4,  -1.2) m, (5000.00, 5000.00) mas
     484: ( -1.6,  -1.4) m, (5000.00, 5000.00) mas
     324: ( -2.8,  -2.3) m, (5000.00, 5000.00) mas
     254: ( -3.3,  -2.8) m, (5000.00, 5000.00) mas
      41: ( -3.0,  -4.4) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    1377: (  0.7,   4.7) m, (5000.00, 5000.00) mas
    1359: (  0.7,   4.4) m, (5000.00, 5000.00) mas
    1218: (  0.5,   3.3) m, (5000.00, 5000.00) mas
    1013: (  0.2,   1.9) m, (5000.00, 5000.00) mas
     894: (  0.2,   1.2) m, (5000.00, 5000.00) mas
     597: (  1.2,  -0.7) m, (5000.00, 5000.00) mas
     409: ( -0.5,  -1.9) m, (5000.00, 5000.00) mas
     370: ( -0.5,  -2.1) m, (5000.00, 5000.00) mas
     165: ( -0.7,  -3.5) m, (5000.00, 5000.00) mas
       5: ( -0.9,  -4.9) m, (5000.00, 5000.00) mas
       2: ( -2.3,  -4.9) m, (100.45, 173.75) mas
sa index   location       noise equivalent angle
    1318: ( -2.6,   4.2) m, (5000.00, 5000.00) mas
    1263: ( -2.3,   3.7) m, (5000.00, 5000.00) mas
    1109: ( -1.6,   2.6) m, (5000.00, 5000.00) mas
    1042: ( -1.4,   2.1) m, (5000.00, 5000.00) mas
     889: ( -0.9,   1.2) m, (5000.00, 5000.00) mas
     748: (  1.2,   0.2) m, (5000.00, 5000.00) mas
     454: (  0.7,  -1.6) m, (5000.00, 5000.00) mas
     341: (  1.2,  -2.3) m, (5000.00, 5000.00) mas
     274: (  1.4,  -2.8) m, (5000.00, 5000.00) mas
     119: (  2.1,  -4.0) m, (5000.00, 5000.00) mas
      38: (  2.6,  -4.7) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
     953: ( -4.7,   1.6) m, (5000.00, 5000.00) mas
     877: ( -3.7,   1.2) m, (5000.00, 5000.00) mas
     844: ( -3.0,   0.9) m, (5000.00, 5000.00) mas
     814: ( -2.3,   0.7) m, (5000.00, 5000.00) mas
     784: ( -1.4,   0.5) m, (5000.00, 5000.00) mas
     856: (  0.7,   0.9) m, (5000.00, 5000.00) mas
     598: (  1.4,  -0.7) m, (5000.00, 5000.00) mas
     567: (  2.1,  -0.9) m, (5000.00, 5000.00) mas
     537: (  2.8,  -1.2) m, (5000.00, 5000.00) mas
     468: (  4.0,  -1.6) m, (5000.00, 5000.00) mas
     651: (  5.1,  -0.5) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
     391: ( -4.7,  -1.9) m, (5000.00, 5000.00) mas
     475: ( -3.7,  -1.4) m, (5000.00, 5000.00) mas
     518: ( -3.0,  -1.2) m, (5000.00, 5000.00) mas
     556: ( -2.3,  -0.9) m, (5000.00, 5000.00) mas
     596: ( -1.4,  -0.7) m, (5000.00, 5000.00) mas
     891: ( -0.5,   1.2) m, (5000.00, 5000.00) mas
     786: (  1.4,   0.5) m, (5000.00, 5000.00) mas
     825: (  2.1,   0.7) m, (5000.00, 5000.00) mas
     865: (  2.8,   0.9) m, (5000.00, 5000.00) mas
     950: (  4.0,   1.4) m, (5000.00, 5000.00) mas
     765: (  5.1,   0.2) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
      43: ( -2.6,  -4.4) m, (5000.00, 5000.00) mas
     100: ( -2.3,  -4.0) m, (5000.00, 5000.00) mas
     261: ( -1.6,  -2.8) m, (5000.00, 5000.00) mas
     330: ( -1.4,  -2.3) m, (5000.00, 5000.00) mas
     487: ( -0.9,  -1.4) m, (5000.00, 5000.00) mas
     634: (  1.2,  -0.5) m, (5000.00, 5000.00) mas
     936: (  0.7,   1.4) m, (5000.00, 5000.00) mas
    1053: (  1.2,   2.1) m, (5000.00, 5000.00) mas
    1122: (  1.4,   2.6) m, (5000.00, 5000.00) mas
    1282: (  2.1,   3.7) m, (5000.00, 5000.00) mas
    1367: (  2.6,   4.4) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
       8: (  0.7,  -4.9) m, (5000.00, 5000.00) mas
      30: (  0.7,  -4.7) m, (5000.00, 5000.00) mas
     170: (  0.5,  -3.5) m, (5000.00, 5000.00) mas
     373: (  0.2,  -2.1) m, (5000.00, 5000.00) mas
     451: (  0.0,  -1.6) m, (5000.00, 5000.00) mas
     785: (  1.2,   0.5) m, (5000.00, 5000.00) mas
     971: ( -0.5,   1.6) m, (5000.00, 5000.00) mas
    1010: ( -0.5,   1.9) m, (5000.00, 5000.00) mas
    1213: ( -0.7,   3.3) m, (5000.00, 5000.00) mas
    1374: ( -0.9,   4.7) m, (5000.00, 5000.00) mas
    1370: ( -2.6,   4.7) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
     314: (  2.8,  -2.6) m, (5000.00, 5000.00) mas
     347: (  2.6,  -2.3) m, (5000.00, 5000.00) mas
     530: (  1.2,  -1.2) m, (5000.00, 5000.00) mas
     529: (  0.9,  -1.2) m, (5000.00, 5000.00) mas
     895: (  0.5,   1.2) m, (5000.00, 5000.00) mas
     851: ( -1.4,   0.9) m, (5000.00, 5000.00) mas
     886: ( -1.6,   1.2) m, (5000.00, 5000.00) mas
    1036: ( -2.8,   2.1) m, (5000.00, 5000.00) mas
    1102: ( -3.3,   2.6) m, (5000.00, 5000.00) mas
    1316: ( -3.0,   4.2) m, (5000.00, 5000.00) mas

[00;00mSetting up powfs 2 PO WFS[00;00m

OTF dimension is 48x48 (calculated)
Generating matched filter for powfs 2
Use sanea to derive neasim
Use sanea to derive neasim

[00;00mSetting up reconstructor[00;00m

Recon NEA: cmf(4995.94) cmf(4995.94) cmf(4995.94) cmf(4995.94) cmf(4995.94) cmf(4995.94) cmf(4995.94) cmf(4995.94) cmf(4995.94) geom(0.31) geom(0.31) geom(0.31) mf(0.14)  mas
Setup or update control matrix parameters.
RRtwfs svd threshold is 1e-10
Replacing HA by HA*fit->actextrap
Adding piston cr to fit matrix
Adding TT cr on upper DMs to fit matrix.
Before assembling fit matrix:	3384.2 MiB.
Building fit->FR
Building fit->FL
Adding tikhonov constraint of 1.0e-07 to FLM
The maximum eigen value is estimated to be around 3.4e-04
DM Fit number of Low rank terms: 16 in LHS
After assemble fit matrix:	4348.5 MiB.
After setup_recon:	4348.5 MiB.
GPU 0: mem used 1898 MB (wfs init)
GPU 0: mem used 2452 MB (recon init)
GPU 0: mem used 2482 MB (perf init)

*** Simulation started at 2025/02/17 14:50:52 in nid001972. ***

Running seed 1
GPU 0: mem used 2482 MB (wfs seeding)
Wind dir: 267.3 261.7 167.0 130.5 300.7  32.3 119.8 139.0 150.8 277.7 203.0 133.1  45.9 265.1 deg
Using /global/homes/b/bpeck/.aos/cache/atm/vonkarman_14_8192x8192_0.0078125_1115374592d.bin
After genatm:	4286.7 MiB.
Step     #  Open Loop  PR TT  On axis  PR TT  Field RMS PR TT     Timing 
Step     0: OL  884.6  248.3  OA  884.6 248.3 CL  884.6 248.3 nm  0.122 s
Step    17: OL  910.7  254.8  OA  727.3 272.3 CL  727.3 272.3 nm  0.038 s
Step    38: OL  942.9  260.3  OA  711.7 272.9 CL  711.7 272.9 nm  0.054 s
Step    59: OL  974.2  261.0  OA  697.1 273.1 CL  697.1 273.1 nm  0.047 s
Step    79: OL 1005.0  259.0  OA  677.1 271.0 CL  677.1 271.0 nm  0.047 s
Step   100: OL 1038.3  257.8  OA  665.7 276.9 CL  665.7 276.9 nm  0.050 s
Step   121: OL 1071.6  259.0  OA  667.7 279.3 CL  667.7 279.3 nm  0.047 s
Step   142: OL 1102.1  264.5  OA  664.1 275.3 CL  664.1 275.3 nm  0.047 s
Step   163: OL 1128.1  274.3  OA  656.0 270.1 CL  656.0 270.1 nm  0.057 s
Step   184: OL 1148.2  287.1  OA  652.5 275.2 CL  652.5 275.2 nm  0.046 s
Step   204: OL 1161.1  299.9  OA  654.5 285.4 CL  654.5 285.4 nm  0.046 s
Step   225: OL 1169.5  313.4  OA  666.1 300.8 CL  666.1 300.8 nm  0.050 s
Step   246: OL 1171.5  327.6  OA  672.0 316.4 CL  672.0 316.4 nm  0.046 s
Step   255 updated high order loop gain: 0.423
Step   267: OL 1164.2  342.6  OA  683.2 333.8 CL  683.2 333.8 nm  0.046 s
Step   288: OL 1147.8  358.3  OA  690.0 349.3 CL  690.0 349.3 nm  0.055 s
Step   309: OL 1126.2  376.7  OA  694.3 362.5 CL  694.3 362.5 nm  0.049 s
Step   330: OL 1099.6  397.5  OA  699.9 370.4 CL  699.9 370.4 nm  0.046 s
Step   351: OL 1071.7  422.6  OA  702.1 379.6 CL  702.1 379.6 nm  0.055 s
Step   370: OL 1047.3  448.9  OA  707.4 390.8 CL  707.4 390.8 nm  0.048 s
Step   391: OL 1022.3  479.2  OA  707.0 405.5 CL  707.0 405.5 nm  0.048 s
Step   412: OL  997.6  509.0  OA  707.9 420.1 CL  707.9 420.1 nm  0.053 s
Step   433: OL  972.4  537.0  OA  707.9 434.5 CL  707.9 434.5 nm  0.047 s
Step   454: OL  949.6  564.4  OA  704.5 447.2 CL  704.5 447.2 nm  0.047 s
Step   475: OL  934.7  591.7  OA  707.2 462.0 CL  707.2 462.0 nm  0.054 s
Step   496: OL  930.6  617.5  OA  717.3 473.0 CL  717.3 473.0 nm  0.047 s
Step   511 updated high order loop gain: 0.425
Step   517: OL  933.4  640.2  OA  732.0 486.9 CL  732.0 486.9 nm  0.047 s
Step   538: OL  941.3  656.9  OA  746.9 495.9 CL  746.9 495.9 nm  0.057 s
Step   559: OL  955.2  666.6  OA  757.5 497.8 CL  757.5 497.8 nm  0.048 s
Step   580: OL  973.8  670.5  OA  764.1 491.9 CL  764.1 491.9 nm  0.048 s
Step   601: OL  996.5  668.8  OA  771.4 483.5 CL  771.4 483.5 nm  0.051 s
Step   621: OL 1019.7  660.4  OA  768.2 469.0 CL  768.2 469.0 nm  0.048 s
Step   642: OL 1043.1  645.6  OA  753.2 445.9 CL  753.2 445.9 nm  0.045 s
Step   663: OL 1063.3  626.3  OA  731.5 424.1 CL  731.5 424.1 nm  0.056 s
Step   682: OL 1079.3  606.6  OA  709.2 403.6 CL  709.2 403.6 nm  0.046 s
Step   703: OL 1094.0  583.5  OA  689.4 383.6 CL  689.4 383.6 nm  0.046 s
Step   724: OL 1102.2  557.9  OA  665.9 356.9 CL  665.9 356.9 nm  0.053 s
Step   745: OL 1102.5  531.9  OA  639.3 330.2 CL  639.3 330.2 nm  0.046 s
Step   766: OL 1095.3  507.1  OA  611.5 309.0 CL  611.5 309.0 nm  0.048 s
Step   767 updated high order loop gain: 0.427
Step   786: OL 1081.2  484.5  OA  590.5 292.1 CL  590.5 292.1 nm  0.058 s
Step   807: OL 1059.1  461.1  OA  566.5 267.7 CL  566.5 267.7 nm  0.049 s
Step   828: OL 1031.0  437.8  OA  552.1 248.1 CL  552.1 248.1 nm  0.046 s
Step   849: OL  998.4  415.9  OA  539.4 217.4 CL  539.4 217.4 nm  0.046 s
Step   870: OL  965.6  396.7  OA  534.4 185.0 CL  534.4 185.0 nm  0.046 s
Step   891: OL  935.2  381.1  OA  539.1 158.2 CL  539.1 158.2 nm  0.051 s
Step   912: OL  903.5  368.6  OA  538.3 138.2 CL  538.3 138.2 nm  0.048 s
Step   933: OL  871.7  358.5  OA  536.6 126.8 CL  536.6 126.8 nm  0.052 s
Step   954: OL  841.7  348.3  OA  536.6 116.4 CL  536.6 116.4 nm  0.057 s
Step   974: OL  817.5  337.2  OA  533.7 108.7 CL  533.7 108.7 nm  0.048 s
Step   995: OL  796.8  323.4  OA  536.2  98.4 CL  536.2  98.4 nm  0.046 s
Step  1015: OL  779.4  308.4  OA  538.7  81.2 CL  538.7  81.2 nm  0.053 s
Step  1023 updated high order loop gain: 0.427
Step  1036: OL  764.7  291.8  OA  534.3  70.8 CL  534.3  70.8 nm  0.049 s
Step  1057: OL  751.5  273.0  OA  525.2  71.5 CL  525.2  71.5 nm  0.048 s
Step  1078: OL  740.4  250.6  OA  519.8  68.1 CL  519.8  68.1 nm  0.048 s
Step  1099: OL  734.7  226.4  OA  521.0  52.4 CL  521.0  52.4 nm  0.046 s
Step  1120: OL  732.9  205.3  OA  521.5  33.2 CL  521.5  33.2 nm  0.048 s
Step  1141: OL  732.9  188.8  OA  527.6  13.3 CL  527.6  13.3 nm  0.053 s
Step  1162: OL  733.5  177.2  OA  532.3  14.3 CL  532.3  14.3 nm  0.046 s
Step  1183: OL  735.2  170.6  OA  537.8  17.3 CL  537.8  17.3 nm  0.049 s
Step  1204: OL  739.9  166.2  OA  550.5  21.3 CL  550.5  21.3 nm  0.048 s
Step  1224: OL  744.9  163.5  OA  570.1  41.2 CL  570.1  41.2 nm  0.046 s
Step  1245: OL  749.2  164.9  OA  590.3  65.4 CL  590.3  65.4 nm  0.046 s
Step  1266: OL  754.4  171.8  OA  604.5  85.1 CL  604.5  85.1 nm  0.046 s
Step  1279 updated high order loop gain: 0.427
Step  1286: OL  761.1  182.5  OA  615.1  99.3 CL  615.1  99.3 nm  0.047 s
Step  1307: OL  769.5  196.7  OA  619.4 107.6 CL  619.4 107.6 nm  0.051 s
Step  1328: OL  776.6  213.5  OA  616.5 112.2 CL  616.5 112.2 nm  0.048 s
Step  1349: OL  785.7  232.5  OA  606.6 110.5 CL  606.6 110.5 nm  0.045 s
Step  1370: OL  798.1  249.8  OA  597.9  95.9 CL  597.9  95.9 nm  0.051 s
Step  1390: OL  811.3  261.9  OA  599.5  85.8 CL  599.5  85.8 nm  0.048 s
Step  1411: OL  827.6  270.2  OA  608.7  81.8 CL  608.7  81.8 nm  0.047 s
Step  1431: OL  844.4  275.3  OA  620.3  77.5 CL  620.3  77.5 nm  0.048 s
Step  1452: OL  860.5  279.0  OA  624.6  71.0 CL  624.6  71.0 nm  0.050 s
Step  1473: OL  872.9  279.4  OA  626.0  73.9 CL  626.0  73.9 nm  0.048 s
Step  1493: OL  877.0  275.6  OA  622.6  74.5 CL  622.6  74.5 nm  0.047 s
Step  1514: OL  874.0  267.3  OA  609.1  77.4 CL  609.1  77.4 nm  0.049 s
Step  1535: OL  866.0  256.2  OA  594.6  63.3 CL  594.6  63.3 nm  0.045 s
Step  1535 updated high order loop gain: 0.428
Step  1555: OL  856.4  243.1  OA  586.4  53.8 CL  586.4  53.8 nm  0.049 s
Step  1575: OL  847.0  230.9  OA  581.7  46.2 CL  581.7  46.2 nm  0.046 s
Step  1596: OL  836.6  221.2  OA  577.9  27.8 CL  577.9  27.8 nm  0.047 s
Step 1599: Output PSF
Step  1599: OL  835.0  220.0  OA  576.7  27.9 CL  576.7  27.9 nm  3.347 s
Mean: 625.90 273.02 563.21  nm.

*** Simulation Finished at 2025/02/17 14:52:23 in nid001972. ***

[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
/global/cfs/cdirs/ulens/vismcao/maos -o studies/reduced_ngs/9_lgs/8mag_lgs/2000count -c master_files/reduced_ngs/9_lgs/8mag_lgs/kola_2000act.conf -O 
Output folder is 'studies/reduced_ngs/9_lgs/8mag_lgs/2000count'.
SRC: /global/homes/b/bpeck/code/maos v2.9 4c88b7c2 2024-11-13 16:45:33 -0800
BUILT: /global/homes/b/bpeck/code/maos/optim by GCC (v12) on 2024/11/18 09:40:03 CPU(F64,+O3) with CUDA(v122,F32)
Launched at 2025/02/17 14:52:24 in nid001972 with PID 1690471.
The web based job monitor can be accessed at http://localhost:10300
Main config file is /global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_2000act.conf
[00;00m[0;36mWarning(path.c:48): Path not found: path=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; abspath=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; Ignored.
[00;00m[0;36mWarning(path.c:48): Path not found: path=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; abspath=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; Ignored.
[00;00m[0;36mWarning(readcfg.c:399): sim.apfsm has been renamed to powfs.apfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.epfsm has been renamed to powfs.epfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.alfsm has been renamed to powfs.alfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.commonfsm has been renamed to powfs.commonfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.idealfsm has been renamed to powfs.idealfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.zetafsm has been renamed to powfs.zetafsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.f0fsm has been renamed to powfs.f0fsm.
[00;00m[0;36mWarning(readcfg.c:399): tsurf has been renamed to ncpa.tsurf.
loaded 132 (132 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_sim.conf'
loaded  19 ( 19 new) records from '/global/cfs/cdirs/ulens/vismcao/./dm_none.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_ASM.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_DM2.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_DM3.conf'
loaded   0 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_dm_multiple.conf'
loaded   7 (  5 new) records from '/global/cfs/cdirs/ulens/vismcao/./atm_mk13n50p_ground_detail.conf'
loaded  76 ( 69 new) records from '/global/homes/b/bpeck/code/maos/config/maos/powfs_common.conf'
loaded  44 ( 38 new) records from '/global/cfs/cdirs/ulens/vismcao/./powfs_none.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_lgs.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_ttf_strap.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_twfs_lbwfs.conf'
loaded   0 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_wfs_lgs_strap_lbwfs.conf'
loaded  71 ( 71 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_recon.conf'
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_smooth has been renamed to powfs0_llt.na_smooth.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_interp has been renamed to powfs0_llt.na_interp.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_thres has been renamed to powfs0_llt.na_thres.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_maxit has been renamed to powfs0_llt.na_fit_maxit.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_svdthres has been renamed to powfs0_llt.na_fit_svdthres.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_dh has been renamed to powfs0_llt.na_fit_dh.
[00;00m[0;36mWarning(readcfg.c:399): dbg.ncpa_preload has been renamed to ncpa.preload.
[00;00m[0;36mWarning(readcfg.c:399): dbg.ncpa_rmsci has been renamed to ncpa.rmsci.
[00;00m[0;36mWarning(readcfg.c:399): dbg.draw_opdmax has been renamed to plot.opdmax.
[00;00m[0;36mWarning(readcfg.c:399): dbg.draw_gmax has been renamed to plot.gmax.
loaded  95 ( 93 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_dbg.conf'
loaded   4 (  4 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_fit_mcao.conf'
[00;00m[0;36mWarning(readcfg.c:399): surf has been renamed to ncpa.surf.
loaded  39 (  7 new) records from '/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_2000act.conf'
loaded   0 (  0 new) records from 'command line'
loaded  24 ( 18 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_llt_CL.conf'
Adjust LGS range by telescope altitude 4145m.
Zenith angle is 30 degree.
    Scaling turbulence height and LGS hs by sec(za).
    Scaling r0 by cos(za)^(3/5).
    Scaling wind speed and LGS signal level by cos(za).
powfs0: Adjusting dx from 0.0078125 to 0.00778571. 
powfs0.llt.fsm: f0=0 Hz, LPF ep=0
powfs0.epfsm is set to 0.517618 (auto)
powfs2: Adjusting dx from 0.03125 to 0.0312778. 
powfs2 is TWFS for powfs0
sim.ephi is set to 0.427717 (auto)
sim.eplo is set to 0.427717 (auto)
[00;00m[0;36mWarning(parms.c:2296): Layer 1 at 17.3205m is very close to layer 0 at 0m (OK).
[00;00m[0;36mWarning(parms.c:2296): Layer 2 at 34.641m is very close to layer 1 at 17.3205m (OK).
[00;00m[0;36mWarning(parms.c:2296): Layer 3 at 51.9615m is very close to layer 2 at 34.641m (OK).
dm 0: stroke=30 um is provided in micron.
dm 0: assume ia stroke=2 um is provided in micron.
dm 1: stroke=7 um is provided in micron.
dm 1: assume ia stroke=2 um is provided in micron.
dm 2: stroke=7 um is provided in micron.
dm 2: assume ia stroke=2 um is provided in micron.
Focus blending is not implemented yet for integrated tomography
parms->sim.mffocus is reset to 0
There are 1 valid simulation seeds:  1
Output PSF for 1 directions
Used 449 of 456 supplied keys
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_flate" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_flatv" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_psx" is not recognized, value is [0 0 0 0]
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_psy" is not recognized, value is [0 0 0 0]
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_pupelong" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_raw" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_side" is not recognized, value is 4
[00;00mAperture[00;00m is 11 m with sampling 1/128 m
[00;00mTurbulence at 30 degree zenith angle:[00;00m r0=0.128424m, L0=30m, 14 layers.
    Greenwood freq is 25.1Hz, anisoplanatic angle is 1.58 as
    Sampled 8192x8192 at 1/128m. wind dir is randomized.
    layer 0: ht=      0 m, wt= 0.302, ws=  4.8 m/s
    layer 1: ht=     17 m, wt= 0.154, ws=  5.0 m/s
    layer 2: ht=     35 m, wt= 0.041, ws=  5.4 m/s
    layer 3: ht=     52 m, wt= 0.002, ws=  6.6 m/s
    layer 4: ht=    139 m, wt= 0.021, ws=  6.1 m/s
    layer 5: ht=    231 m, wt= 0.010, ws=  6.1 m/s
    layer 6: ht=    323 m, wt= 0.008, ws=  6.1 m/s
    layer 7: ht=    416 m, wt= 0.005, ws=  6.1 m/s
    layer 8: ht=    508 m, wt= 0.001, ws=  6.1 m/s
    layer 9: ht=    932 m, wt= 0.107, ws=  5.6 m/s
    layer 10: ht=   5022 m, wt= 0.144, ws= 11.1 m/s
    layer 11: ht=   9238 m, wt= 0.093, ws= 19.1 m/s
    layer 12: ht=  13856 m, wt= 0.075, ws=  8.2 m/s
    layer 13: ht=  22518 m, wt= 0.036, ws=  4.8 m/s
[00;00mReconstruction[00;00m: r0=0.128424m L0=30m. 14 layers. use cone coordinate.
    layer 0: ht=      0 m, wt= 0.302
    layer 1: ht=     17 m, wt= 0.154
    layer 2: ht=     35 m, wt= 0.041
    layer 3: ht=     52 m, wt= 0.002
    layer 4: ht=    139 m, wt= 0.021
    layer 5: ht=    231 m, wt= 0.010
    layer 6: ht=    323 m, wt= 0.008
    layer 7: ht=    416 m, wt= 0.005
    layer 8: ht=    508 m, wt= 0.001
    layer 9: ht=    932 m, wt= 0.107
    layer 10: ht=   5022 m, wt= 0.144
    layer 11: ht=   9238 m, wt= 0.093
    layer 12: ht=  13856 m, wt= 0.075
    layer 13: ht=  22518 m, wt= 0.036
[00;00mThere are 3 powfs[00;00m
  powfs0: Order 51, LGS at 99.1 km. Sampling 1/128.44 m. Thres 30%. [00;00mT/T is removed in right hand side in tomography.[00;00m
    CCD image is 25x25 @ 500x500 mas, blur 27% (sigma), 1500Hz, wvl: [ 5.89e-07]
    Gtilt in reconstruction. Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
  powfs1: Order  2, NGS at inf km. Sampling 1/16 m. Thres 30%. 
    Ztilt in reconstruction. Geomtric optics start at 2 with ztilt [00;00m(noisy)[00;00m
  powfs2: Order 20, NGS at inf km. Sampling 1/31.9716 m. Thres 50%. 
    CCD image is 4x4 @ 1500x1500 mas, blur 0% (sigma), 0.015Hz, wvl: [ 7.2e-07]
    Gtilt in reconstruction. Geomtric optics start at 50 with gtilt Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
[00;00mThere are 13 wfs[00;00m
    wfs 0: type 0, at (  30.00,    0.00) arcsec,  99 km, siglev is 56.9827 bkgrnd is 0.1
    wfs 1: type 0, at (  22.98,   19.28) arcsec,  99 km, siglev is 56.9827 bkgrnd is 0.1
    wfs 2: type 0, at (   5.21,   29.54) arcsec,  99 km, siglev is 56.9827 bkgrnd is 0.1
    wfs 3: type 0, at ( -15.00,   25.98) arcsec,  99 km, siglev is 56.9827 bkgrnd is 0.1
    wfs 4: type 0, at ( -28.19,   10.26) arcsec,  99 km, siglev is 56.9827 bkgrnd is 0.1
    wfs 5: type 0, at ( -28.19,  -10.26) arcsec,  99 km, siglev is 56.9827 bkgrnd is 0.1
    wfs 6: type 0, at ( -15.00,  -25.98) arcsec,  99 km, siglev is 56.9827 bkgrnd is 0.1
    wfs 7: type 0, at (   5.21,  -29.54) arcsec,  99 km, siglev is 56.9827 bkgrnd is 0.1
    wfs 8: type 0, at (  22.98,  -19.28) arcsec,  99 km, siglev is 56.9827 bkgrnd is 0.1
    wfs 9: type 1, at (   5.00,    8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 10: type 1, at ( -10.00,    0.00) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 11: type 1, at (   5.00,   -8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 12: type 2, at (   0.00,    0.00) arcsec, inf km, siglev is 4.1558e+06 bkgrnd is 0.001
[00;00mThere are 3 DMs[00;00m
  DM 0 at -0.1km, actuator pitch 0.218m, offset   0, with 30.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 1 at    6km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 2 at   10km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
[00;00mTomography[00;00m is using CG, with [00;00mFourer Domain[00;00m preconditioner, [00;00m12[00;00m iterations, integrated tomo.
[00;00mDM Fitting [00;00mis using CG, with [00;00mNo[00;00m preconditioner, [00;00m10[00;00m iterations
[00;00mThere are 9 fit directions[00;00m
    Fit 0: weight is 0.444, at (   0.00,    0.00) arcsec
    Fit 1: weight is 0.111, at (  15.00,    0.00) arcsec
    Fit 2: weight is 0.111, at (   0.00,   15.00) arcsec
    Fit 3: weight is 0.111, at ( -15.00,    0.00) arcsec
    Fit 4: weight is 0.111, at (   0.00,  -15.00) arcsec
    Fit 5: weight is 0.028, at (  15.00,   15.00) arcsec
    Fit 6: weight is 0.028, at ( -15.00,   15.00) arcsec
    Fit 7: weight is 0.028, at ( -15.00,  -15.00) arcsec
    Fit 8: weight is 0.028, at (  15.00,  -15.00) arcsec
[00;00mThere are 1 evaluation directions[00;00m at sampling 1/128 m.
    Evl 0: weight is 1.000, at (   0.00,    0.00) arcsec
[00;00mSimulation[00;00m start at step 0, end at step 1600, with time step 1/1500s, [00;00mclose loop[00;00m.
After setup_parms:	120.3 MiB.
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
CUDA: minimum memory requirement is 0.3GB
GPU 0 is NVIDIA A100-SXM4-40GB with arch 8.0, 38.9GB free, 39.3GB total device memory.
Using GPU 0
Use 1 GPUs for WFS Tomo Fit Evl

*** Preparation started at 2025/02/17 14:52:24 in nid001972. ***

Using OpenMP version 201511 with 128 threads
Reading aperture amplitude map from KECK.fits
[00;00m[0;36mWarning(accphi.c:477): 108298 points not covered by input screen
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
 ->maos.c:447->setup.c:148->aper.c:74->utils.c:478->accphi.c:478
iwvl 0: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 1: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 2: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 3: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 4: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 5: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 6: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 7: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 8: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
After setup_aper:	344.6 MiB.

[00;00mSetting up powfs 0 geom[00;00m

There are 28 points in each subaperture of 0.218m.
There are 1584 valid subaperture.

[00;00mSetting up powfs 1 geom[00;00m

There are 88 points in each subaperture of 5.5m.
There are 4 valid subaperture.

[00;00mSetting up powfs 2 geom[00;00m

There are 18 points in each subaperture of 0.563m.
There are 236 valid subaperture.
After setup_powfs_init:	429.9 MiB.

[00;00mSetting up reconstructor geometry.[00;00m

PLOC is 105x105, with sampling of 0.11m (square)
    DM 0: grid is 54 x 54
    DM 1: grid is 75 x 75
    DM 2: grid is 80 x 79
FLOC is 105x105, with sampling of 0.11m (not square)
Tomography grid is square:
    layer 0: xloc grid is 192 x 192, sampling is 0.109 m, 36864 points
    layer 1: xloc grid is 192 x 192, sampling is 0.109 m, 36864 points
    layer 2: xloc grid is 192 x 192, sampling is 0.109 m, 36864 points
    layer 3: xloc grid is 192 x 192, sampling is 0.109 m, 36864 points
    layer 4: xloc grid is 192 x 192, sampling is 0.109 m, 36864 points
    layer 5: xloc grid is 192 x 192, sampling is 0.109 m, 36864 points
    layer 6: xloc grid is 192 x 192, sampling is 0.109 m, 36864 points
    layer 7: xloc grid is 192 x 192, sampling is 0.109 m, 36864 points
    layer 8: xloc grid is 192 x 192, sampling is 0.108 m, 36864 points
    layer 9: xloc grid is 192 x 192, sampling is 0.108 m, 36864 points
    layer 10: xloc grid is 192 x 192, sampling is 0.103 m, 36864 points
    layer 11: xloc grid is 192 x 192, sampling is 0.099 m, 36864 points
    layer 12: xloc grid is 192 x 192, sampling is 0.094 m, 36864 points
    layer 13: xloc grid is 192 x 192, sampling is 0.084 m, 36864 points

[00;00mSetting up powfs 0 PO WFS[00;00m

OTF dimension is 56x56 (calculated)
Uplink FWHM (illt 0, iwvl 0) is 0.577089"
Downlink FWHM (illt 0, iwvl 0) is 0"
Generating matched filter for powfs 0
sa index   location       noise equivalent angle
     771: (  4.9,  -0.3) m, (5000.00, 5000.00) mas
     766: (  3.8,  -0.3) m, (5000.00, 5000.00) mas
     761: (  2.7,  -0.3) m, (5000.00, 5000.00) mas
     756: (  1.6,  -0.3) m, (5000.00, 5000.00) mas
     754: (  1.2,  -0.3) m, (5000.00, 5000.00) mas
     556: ( -0.5,  -1.4) m, (5000.00, 5000.00) mas
     751: ( -1.9,  -0.3) m, (5000.00, 5000.00) mas
     746: ( -2.9,  -0.3) m, (5000.00, 5000.00) mas
     741: ( -4.0,  -0.3) m, (5000.00, 5000.00) mas
     736: ( -5.1,  -0.3) m, (5000.00, 5000.00) mas
     735: ( -5.3,  -0.3) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    1360: (  3.6,   2.9) m, (5000.00, 5000.00) mas
    1207: (  2.5,   2.1) m, (5000.00, 5000.00) mas
     991: (  1.2,   1.0) m, (5000.00, 5000.00) mas
     952: (  1.0,   0.8) m, (5000.00, 5000.00) mas
     560: (  0.3,  -1.4) m, (5000.00, 5000.00) mas
     595: ( -1.4,  -1.2) m, (5000.00, 5000.00) mas
     551: ( -1.6,  -1.4) m, (5000.00, 5000.00) mas
     379: ( -2.7,  -2.3) m, (5000.00, 5000.00) mas
     226: ( -3.8,  -3.2) m, (5000.00, 5000.00) mas
      44: ( -2.9,  -4.5) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    1579: (  0.8,   4.7) m, (5000.00, 5000.00) mas
    1445: (  0.5,   3.6) m, (5000.00, 5000.00) mas
    1271: (  0.3,   2.5) m, (5000.00, 5000.00) mas
    1234: (  0.3,   2.3) m, (5000.00, 5000.00) mas
    1029: (  0.1,   1.2) m, (5000.00, 5000.00) mas
     676: (  1.2,  -0.8) m, (5000.00, 5000.00) mas
     514: ( -0.3,  -1.6) m, (5000.00, 5000.00) mas
     315: ( -0.5,  -2.7) m, (5000.00, 5000.00) mas
     141: ( -0.8,  -3.8) m, (5000.00, 5000.00) mas
       4: ( -1.0,  -4.9) m, (5000.00, 5000.00) mas
       1: ( -2.5,  -4.9) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    1546: ( -2.7,   4.5) m, (5000.00, 5000.00) mas
    1489: ( -2.5,   4.0) m, (5000.00, 5000.00) mas
    1335: ( -1.9,   2.9) m, (5000.00, 5000.00) mas
    1067: ( -1.0,   1.4) m, (5000.00, 5000.00) mas
    1025: ( -0.8,   1.2) m, (5000.00, 5000.00) mas
     834: (  1.2,   0.1) m, (5000.00, 5000.00) mas
     561: (  0.5,  -1.4) m, (5000.00, 5000.00) mas
     519: (  0.8,  -1.6) m, (5000.00, 5000.00) mas
     251: (  1.6,  -3.2) m, (5000.00, 5000.00) mas
      97: (  2.3,  -4.3) m, (5000.00, 5000.00) mas
      40: (  2.5,  -4.7) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    1093: ( -4.7,   1.6) m, (5000.00, 5000.00) mas
    1011: ( -3.8,   1.2) m, (5000.00, 5000.00) mas
     976: ( -3.2,   1.0) m, (5000.00, 5000.00) mas
     943: ( -2.5,   0.8) m, (5000.00, 5000.00) mas
     873: ( -1.4,   0.3) m, (5000.00, 5000.00) mas
     989: (  0.8,   1.0) m, (5000.00, 5000.00) mas
     714: (  1.2,  -0.5) m, (5000.00, 5000.00) mas
     644: (  2.3,  -1.0) m, (5000.00, 5000.00) mas
     610: (  2.9,  -1.2) m, (5000.00, 5000.00) mas
     534: (  4.0,  -1.6) m, (5000.00, 5000.00) mas
     732: (  5.1,  -0.5) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
     451: ( -4.7,  -1.9) m, (5000.00, 5000.00) mas
     541: ( -3.8,  -1.4) m, (5000.00, 5000.00) mas
     587: ( -3.2,  -1.2) m, (5000.00, 5000.00) mas
     629: ( -2.5,  -1.0) m, (5000.00, 5000.00) mas
     713: ( -1.4,  -0.5) m, (5000.00, 5000.00) mas
     600: (  0.8,  -1.2) m, (5000.00, 5000.00) mas
     874: (  1.2,   0.3) m, (5000.00, 5000.00) mas
     958: (  2.3,   0.8) m, (5000.00, 5000.00) mas
     999: (  2.9,   1.0) m, (5000.00, 5000.00) mas
    1090: (  4.0,   1.4) m, (5000.00, 5000.00) mas
     892: (  5.1,   0.3) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
      16: ( -2.7,  -4.7) m, (5000.00, 5000.00) mas
      75: ( -2.5,  -4.3) m, (5000.00, 5000.00) mas
     235: ( -1.9,  -3.2) m, (5000.00, 5000.00) mas
     511: ( -1.0,  -1.6) m, (5000.00, 5000.00) mas
     555: ( -0.8,  -1.4) m, (5000.00, 5000.00) mas
     754: (  1.2,  -0.3) m, (5000.00, 5000.00) mas
    1031: (  0.5,   1.2) m, (5000.00, 5000.00) mas
    1075: (  0.8,   1.4) m, (5000.00, 5000.00) mas
    1351: (  1.6,   2.9) m, (5000.00, 5000.00) mas
    1511: (  2.3,   4.0) m, (5000.00, 5000.00) mas
    1568: (  2.5,   4.5) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
       9: (  0.8,  -4.9) m, (5000.00, 5000.00) mas
     147: (  0.5,  -3.8) m, (5000.00, 5000.00) mas
     319: (  0.3,  -2.7) m, (5000.00, 5000.00) mas
     356: (  0.3,  -2.5) m, (5000.00, 5000.00) mas
     560: (  0.3,  -1.4) m, (5000.00, 5000.00) mas
     914: (  1.2,   0.5) m, (5000.00, 5000.00) mas
    1027: ( -0.3,   1.2) m, (5000.00, 5000.00) mas
    1267: ( -0.5,   2.5) m, (5000.00, 5000.00) mas
    1439: ( -0.8,   3.6) m, (5000.00, 5000.00) mas
    1575: ( -1.0,   4.7) m, (5000.00, 5000.00) mas
    1572: ( -2.5,   4.7) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
     260: (  3.6,  -3.2) m, (5000.00, 5000.00) mas
     403: (  2.5,  -2.3) m, (5000.00, 5000.00) mas
     602: (  1.2,  -1.2) m, (5000.00, 5000.00) mas
     638: (  1.0,  -1.0) m, (5000.00, 5000.00) mas
    1030: (  0.3,   1.2) m, (5000.00, 5000.00) mas
     984: ( -1.4,   1.0) m, (5000.00, 5000.00) mas
    1021: ( -1.6,   1.2) m, (5000.00, 5000.00) mas
    1183: ( -2.7,   2.1) m, (5000.00, 5000.00) mas
    1326: ( -3.8,   2.9) m, (5000.00, 5000.00) mas
    1516: ( -2.9,   4.3) m, (5000.00, 5000.00) mas

[00;00mSetting up powfs 2 PO WFS[00;00m

OTF dimension is 48x48 (calculated)
Generating matched filter for powfs 2
Use sanea to derive neasim
Use sanea to derive neasim

[00;00mSetting up reconstructor[00;00m

Recon NEA: cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) geom(0.31) geom(0.31) geom(0.31) mf(0.14)  mas
Setup or update control matrix parameters.
RRtwfs svd threshold is 1e-10
Replacing HA by HA*fit->actextrap
Adding piston cr to fit matrix
Adding TT cr on upper DMs to fit matrix.
Before assembling fit matrix:	3606.6 MiB.
Building fit->FR
Building fit->FL
Adding tikhonov constraint of 1.0e-07 to FLM
The maximum eigen value is estimated to be around 3.3e-04
DM Fit number of Low rank terms: 16 in LHS
After assemble fit matrix:	4610.9 MiB.
After setup_recon:	4610.9 MiB.
GPU 0: mem used 1834 MB (wfs init)
GPU 0: mem used 2444 MB (recon init)
GPU 0: mem used 2474 MB (perf init)

*** Simulation started at 2025/02/17 14:53:07 in nid001972. ***

Running seed 1
GPU 0: mem used 2476 MB (wfs seeding)
Wind dir: 267.3 261.7 167.0 130.5 300.7  32.3 119.8 139.0 150.8 277.7 203.0 133.1  45.9 265.1 deg
Using /global/homes/b/bpeck/.aos/cache/atm/vonkarman_14_8192x8192_0.0078125_1115374592d.bin
After genatm:	4558.5 MiB.
Step     #  Open Loop  PR TT  On axis  PR TT  Field RMS PR TT     Timing 
Step     0: OL  884.6  248.3  OA  884.6 248.3 CL  884.6 248.3 nm  0.078 s
Step    23: OL  919.9  256.8  OA  707.7 244.5 CL  707.7 244.5 nm  0.049 s
Step    43: OL  950.4  261.0  OA  692.7 240.8 CL  692.7 240.8 nm  0.051 s
Step    62: OL  978.7  260.8  OA  672.8 234.6 CL  672.8 234.6 nm  0.057 s
Step    82: OL 1009.7  258.8  OA  651.5 226.2 CL  651.5 226.2 nm  0.051 s
Step    97: OL 1033.6  257.9  OA  643.4 225.4 CL  643.4 225.4 nm  0.052 s
Step   117: OL 1065.5  258.5  OA  637.1 222.7 CL  637.1 222.7 nm  0.057 s
Step   137: OL 1095.3  262.7  OA  634.0 220.9 CL  634.0 220.9 nm  0.049 s
Step   157: OL 1121.5  271.1  OA  632.8 220.6 CL  632.8 220.6 nm  0.050 s
Step   176: OL 1141.8  282.0  OA  636.7 226.0 CL  636.7 226.0 nm  0.057 s
Step   195: OL 1156.5  294.2  OA  642.5 234.7 CL  642.5 234.7 nm  0.052 s
Step   214: OL 1166.7  306.3  OA  652.1 245.8 CL  652.1 245.8 nm  0.050 s
Step   233: OL 1172.1  318.7  OA  664.9 261.0 CL  664.9 261.0 nm  0.059 s
Step   253: OL 1171.7  332.6  OA  676.1 278.9 CL  676.1 278.9 nm  0.050 s
Step   255 updated high order loop gain: 0.423
Step   273: OL 1161.9  347.0  OA  685.4 298.1 CL  685.4 298.1 nm  0.051 s
Step   293: OL 1144.7  362.5  OA  691.3 316.8 CL  691.3 316.8 nm  0.050 s
Step   313: OL 1123.3  380.4  OA  696.6 333.1 CL  696.6 333.1 nm  0.049 s
Step   333: OL 1097.6  400.8  OA  700.0 350.4 CL  700.0 350.4 nm  0.058 s
Step   353: OL 1071.2  425.3  OA  704.0 371.9 CL  704.0 371.9 nm  0.049 s
Step   373: OL 1045.8  453.2  OA  716.4 396.8 CL  716.4 396.8 nm  0.052 s
Step   391: OL 1024.5  479.2  OA  725.6 415.5 CL  725.6 415.5 nm  0.059 s
Step   411: OL 1001.1  507.7  OA  736.5 435.8 CL  736.5 435.8 nm  0.050 s
Step   431: OL  976.9  534.4  OA  742.6 453.9 CL  742.6 453.9 nm  0.050 s
Step   450: OL  955.5  559.2  OA  746.3 470.8 CL  746.3 470.8 nm  0.049 s
Step   470: OL  939.2  585.3  OA  754.5 489.4 CL  754.5 489.4 nm  0.051 s
Step   490: OL  932.5  610.4  OA  766.5 504.5 CL  766.5 504.5 nm  0.054 s
Step   510: OL  933.4  633.2  OA  782.2 518.4 CL  782.2 518.4 nm  0.052 s
Step   511 updated high order loop gain: 0.426
Step   530: OL  939.2  651.5  OA  799.6 531.2 CL  799.6 531.2 nm  0.050 s
Step   550: OL  949.9  663.3  OA  813.8 535.6 CL  813.8 535.6 nm  0.058 s
Step   569: OL  964.7  669.1  OA  824.3 534.8 CL  824.3 534.8 nm  0.050 s
Step   589: OL  984.2  670.7  OA  831.2 528.6 CL  831.2 528.6 nm  0.049 s
Step   608: OL 1005.4  666.6  OA  838.4 519.0 CL  838.4 519.0 nm  0.066 s
Step   628: OL 1028.4  656.2  OA  834.5 502.6 CL  834.5 502.6 nm  0.049 s
Step   648: OL 1049.7  640.6  OA  824.6 483.4 CL  824.6 483.4 nm  0.050 s
Step   667: OL 1067.0  622.3  OA  807.2 462.4 CL  807.2 462.4 nm  0.058 s
Step   687: OL 1083.1  601.4  OA  788.6 440.7 CL  788.6 440.7 nm  0.050 s
Step   707: OL 1095.7  578.9  OA  769.5 416.8 CL  769.5 416.8 nm  0.056 s
Step   726: OL 1101.7  555.5  OA  746.5 390.7 CL  746.5 390.7 nm  0.051 s
Step   746: OL 1101.0  530.8  OA  721.7 364.9 CL  721.7 364.9 nm  0.051 s
Step   765: OL 1094.1  508.4  OA  695.9 344.6 CL  695.9 344.6 nm  0.056 s
Step   767 updated high order loop gain: 0.427
Step   784: OL 1080.9  486.9  OA  673.4 327.9 CL  673.4 327.9 nm  0.050 s
Step   803: OL 1061.4  465.7  OA  650.6 311.6 CL  650.6 311.6 nm  0.052 s
Step   823: OL 1035.7  443.5  OA  632.7 292.9 CL  632.7 292.9 nm  0.049 s
Step   842: OL 1006.8  423.1  OA  619.5 274.8 CL  619.5 274.8 nm  0.057 s
Step   861: OL  976.9  404.7  OA  609.0 255.7 CL  609.0 255.7 nm  0.050 s
Step   881: OL  947.5  388.3  OA  604.5 239.3 CL  604.5 239.3 nm  0.052 s
Step   900: OL  920.6  375.5  OA  604.4 225.7 CL  604.4 225.7 nm  0.061 s
Step   920: OL  891.0  364.9  OA  598.8 214.1 CL  598.8 214.1 nm  0.049 s
Step   940: OL  862.2  355.4  OA  596.5 204.9 CL  596.5 204.9 nm  0.049 s
Step   959: OL  836.9  345.9  OA  589.6 197.4 CL  589.6 197.4 nm  0.053 s
Step   979: OL  815.2  334.3  OA  585.4 186.6 CL  585.4 186.6 nm  0.052 s
Step   999: OL  797.2  320.7  OA  583.2 174.2 CL  583.2 174.2 nm  0.059 s
Step  1019: OL  781.2  305.5  OA  579.6 164.4 CL  579.6 164.4 nm  0.052 s
Step  1023 updated high order loop gain: 0.427
Step  1039: OL  768.2  289.4  OA  573.6 154.6 CL  573.6 154.6 nm  0.050 s
Step  1058: OL  756.5  272.2  OA  565.6 144.6 CL  565.6 144.6 nm  0.055 s
Step  1078: OL  745.8  250.7  OA  557.8 130.7 CL  557.8 130.7 nm  0.051 s
Step  1098: OL  740.0  227.7  OA  552.1 110.9 CL  552.1 110.9 nm  0.050 s
Step  1117: OL  737.5  208.2  OA  548.8  91.7 CL  548.8  91.7 nm  0.060 s
Step  1136: OL  736.7  192.5  OA  545.3  72.7 CL  545.3  72.7 nm  0.050 s
Step  1155: OL  736.5  180.6  OA  546.8  60.4 CL  546.8  60.4 nm  0.049 s
Step  1175: OL  736.5  172.7  OA  549.9  52.2 CL  549.9  52.2 nm  0.069 s
Step  1194: OL  739.2  168.2  OA  560.4  46.0 CL  560.4  46.0 nm  0.049 s
Step  1214: OL  743.3  164.6  OA  577.4  42.9 CL  577.4  42.9 nm  0.050 s
Step  1233: OL  747.4  163.5  OA  593.6  42.2 CL  593.6  42.2 nm  0.058 s
Step  1252: OL  750.7  166.6  OA  605.2  52.1 CL  605.2  52.1 nm  0.050 s
Step  1272: OL  755.9  174.7  OA  615.7  63.1 CL  615.7  63.1 nm  0.051 s
Step  1279 updated high order loop gain: 0.427
Step  1292: OL  763.5  186.3  OA  623.7  75.0 CL  623.7  75.0 nm  0.056 s
Step  1312: OL  771.2  200.4  OA  627.1  88.3 CL  627.1  88.3 nm  0.050 s
Step  1332: OL  778.3  217.0  OA  625.1 100.7 CL  625.1 100.7 nm  0.053 s
Step  1351: OL  787.3  234.3  OA  618.3 109.5 CL  618.3 109.5 nm  0.052 s
Step  1371: OL  799.6  250.5  OA  617.8 115.1 CL  617.8 115.1 nm  0.050 s
Step  1391: OL  813.3  262.4  OA  622.3 116.7 CL  622.3 116.7 nm  0.057 s
Step  1411: OL  829.2  270.2  OA  629.2 115.7 CL  629.2 115.7 nm  0.052 s
Step  1431: OL  846.2  275.2  OA  637.2 112.4 CL  637.2 112.4 nm  0.050 s
Step  1450: OL  861.1  278.7  OA  640.2 110.3 CL  640.2 110.3 nm  0.058 s
Step  1470: OL  873.9  279.6  OA  637.8 106.6 CL  637.8 106.6 nm  0.051 s
Step  1490: OL  879.2  276.4  OA  633.3 103.6 CL  633.3 103.6 nm  0.050 s
Step  1510: OL  877.2  269.1  OA  620.6 102.9 CL  620.6 102.9 nm  0.050 s
Step  1528: OL  871.2  260.3  OA  609.8 101.7 CL  609.8 101.7 nm  0.051 s
Step  1535 updated high order loop gain: 0.428
Step  1548: OL  861.4  247.8  OA  599.9  97.9 CL  599.9  97.9 nm  0.050 s
Step  1568: OL  851.6  234.9  OA  593.7  91.3 CL  593.7  91.3 nm  0.051 s
Step  1588: OL  841.4  224.5  OA  587.8  89.0 CL  587.8  89.0 nm  0.051 s
Step 1599: Output PSF
Step  1599: OL  835.6  219.9  OA  586.0  88.2 CL  586.0  88.2 nm  1.055 s
Mean: 666.13 300.98 594.26  nm.

*** Simulation Finished at 2025/02/17 14:54:39 in nid001972. ***

[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
/global/cfs/cdirs/ulens/vismcao/maos -o studies/reduced_ngs/9_lgs/8mag_lgs/2250count -c master_files/reduced_ngs/9_lgs/8mag_lgs/kola_2250act.conf -O 
Output folder is 'studies/reduced_ngs/9_lgs/8mag_lgs/2250count'.
SRC: /global/homes/b/bpeck/code/maos v2.9 4c88b7c2 2024-11-13 16:45:33 -0800
BUILT: /global/homes/b/bpeck/code/maos/optim by GCC (v12) on 2024/11/18 09:40:03 CPU(F64,+O3) with CUDA(v122,F32)
Launched at 2025/02/17 14:54:40 in nid001972 with PID 1692070.
The web based job monitor can be accessed at http://localhost:10300
Main config file is /global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_2250act.conf
[00;00m[0;36mWarning(path.c:48): Path not found: path=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; abspath=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; Ignored.
[00;00m[0;36mWarning(path.c:48): Path not found: path=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; abspath=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; Ignored.
[00;00m[0;36mWarning(readcfg.c:399): sim.apfsm has been renamed to powfs.apfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.epfsm has been renamed to powfs.epfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.alfsm has been renamed to powfs.alfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.commonfsm has been renamed to powfs.commonfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.idealfsm has been renamed to powfs.idealfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.zetafsm has been renamed to powfs.zetafsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.f0fsm has been renamed to powfs.f0fsm.
[00;00m[0;36mWarning(readcfg.c:399): tsurf has been renamed to ncpa.tsurf.
loaded 132 (132 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_sim.conf'
loaded  19 ( 19 new) records from '/global/cfs/cdirs/ulens/vismcao/./dm_none.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_ASM.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_DM2.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_DM3.conf'
loaded   0 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_dm_multiple.conf'
loaded   7 (  5 new) records from '/global/cfs/cdirs/ulens/vismcao/./atm_mk13n50p_ground_detail.conf'
loaded  76 ( 69 new) records from '/global/homes/b/bpeck/code/maos/config/maos/powfs_common.conf'
loaded  44 ( 38 new) records from '/global/cfs/cdirs/ulens/vismcao/./powfs_none.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_lgs.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_ttf_strap.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_twfs_lbwfs.conf'
loaded   0 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_wfs_lgs_strap_lbwfs.conf'
loaded  71 ( 71 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_recon.conf'
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_smooth has been renamed to powfs0_llt.na_smooth.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_interp has been renamed to powfs0_llt.na_interp.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_thres has been renamed to powfs0_llt.na_thres.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_maxit has been renamed to powfs0_llt.na_fit_maxit.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_svdthres has been renamed to powfs0_llt.na_fit_svdthres.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_dh has been renamed to powfs0_llt.na_fit_dh.
[00;00m[0;36mWarning(readcfg.c:399): dbg.ncpa_preload has been renamed to ncpa.preload.
[00;00m[0;36mWarning(readcfg.c:399): dbg.ncpa_rmsci has been renamed to ncpa.rmsci.
[00;00m[0;36mWarning(readcfg.c:399): dbg.draw_opdmax has been renamed to plot.opdmax.
[00;00m[0;36mWarning(readcfg.c:399): dbg.draw_gmax has been renamed to plot.gmax.
loaded  95 ( 93 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_dbg.conf'
loaded   4 (  4 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_fit_mcao.conf'
[00;00m[0;36mWarning(readcfg.c:399): surf has been renamed to ncpa.surf.
loaded  39 (  7 new) records from '/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_2250act.conf'
loaded   0 (  0 new) records from 'command line'
loaded  24 ( 18 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_llt_CL.conf'
Adjust LGS range by telescope altitude 4145m.
Zenith angle is 30 degree.
    Scaling turbulence height and LGS hs by sec(za).
    Scaling r0 by cos(za)^(3/5).
    Scaling wind speed and LGS signal level by cos(za).
powfs0: Adjusting dx from 0.0078125 to 0.00792308. 
powfs0.llt.fsm: f0=0 Hz, LPF ep=0
powfs0.epfsm is set to 0.517618 (auto)
powfs2: Adjusting dx from 0.03125 to 0.0312778. 
powfs2 is TWFS for powfs0
sim.ephi is set to 0.427717 (auto)
sim.eplo is set to 0.427717 (auto)
[00;00m[0;36mWarning(parms.c:2296): Layer 1 at 17.3205m is very close to layer 0 at 0m (OK).
[00;00m[0;36mWarning(parms.c:2296): Layer 2 at 34.641m is very close to layer 1 at 17.3205m (OK).
[00;00m[0;36mWarning(parms.c:2296): Layer 3 at 51.9615m is very close to layer 2 at 34.641m (OK).
dm 0: stroke=30 um is provided in micron.
dm 0: assume ia stroke=2 um is provided in micron.
dm 1: stroke=7 um is provided in micron.
dm 1: assume ia stroke=2 um is provided in micron.
dm 2: stroke=7 um is provided in micron.
dm 2: assume ia stroke=2 um is provided in micron.
Focus blending is not implemented yet for integrated tomography
parms->sim.mffocus is reset to 0
There are 1 valid simulation seeds:  1
Output PSF for 1 directions
Used 449 of 456 supplied keys
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_flate" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_flatv" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_psx" is not recognized, value is [0 0 0 0]
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_psy" is not recognized, value is [0 0 0 0]
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_pupelong" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_raw" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_side" is not recognized, value is 4
[00;00mAperture[00;00m is 11 m with sampling 1/128 m
[00;00mTurbulence at 30 degree zenith angle:[00;00m r0=0.128424m, L0=30m, 14 layers.
    Greenwood freq is 25.1Hz, anisoplanatic angle is 1.58 as
    Sampled 8192x8192 at 1/128m. wind dir is randomized.
    layer 0: ht=      0 m, wt= 0.302, ws=  4.8 m/s
    layer 1: ht=     17 m, wt= 0.154, ws=  5.0 m/s
    layer 2: ht=     35 m, wt= 0.041, ws=  5.4 m/s
    layer 3: ht=     52 m, wt= 0.002, ws=  6.6 m/s
    layer 4: ht=    139 m, wt= 0.021, ws=  6.1 m/s
    layer 5: ht=    231 m, wt= 0.010, ws=  6.1 m/s
    layer 6: ht=    323 m, wt= 0.008, ws=  6.1 m/s
    layer 7: ht=    416 m, wt= 0.005, ws=  6.1 m/s
    layer 8: ht=    508 m, wt= 0.001, ws=  6.1 m/s
    layer 9: ht=    932 m, wt= 0.107, ws=  5.6 m/s
    layer 10: ht=   5022 m, wt= 0.144, ws= 11.1 m/s
    layer 11: ht=   9238 m, wt= 0.093, ws= 19.1 m/s
    layer 12: ht=  13856 m, wt= 0.075, ws=  8.2 m/s
    layer 13: ht=  22518 m, wt= 0.036, ws=  4.8 m/s
[00;00mReconstruction[00;00m: r0=0.128424m L0=30m. 14 layers. use cone coordinate.
    layer 0: ht=      0 m, wt= 0.302
    layer 1: ht=     17 m, wt= 0.154
    layer 2: ht=     35 m, wt= 0.041
    layer 3: ht=     52 m, wt= 0.002
    layer 4: ht=    139 m, wt= 0.021
    layer 5: ht=    231 m, wt= 0.010
    layer 6: ht=    323 m, wt= 0.008
    layer 7: ht=    416 m, wt= 0.005
    layer 8: ht=    508 m, wt= 0.001
    layer 9: ht=    932 m, wt= 0.107
    layer 10: ht=   5022 m, wt= 0.144
    layer 11: ht=   9238 m, wt= 0.093
    layer 12: ht=  13856 m, wt= 0.075
    layer 13: ht=  22518 m, wt= 0.036
[00;00mThere are 3 powfs[00;00m
  powfs0: Order 54, LGS at 99.1 km. Sampling 1/126.214 m. Thres 30%. [00;00mT/T is removed in right hand side in tomography.[00;00m
    CCD image is 25x25 @ 500x500 mas, blur 27% (sigma), 1500Hz, wvl: [ 5.89e-07]
    Gtilt in reconstruction. Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
  powfs1: Order  2, NGS at inf km. Sampling 1/16 m. Thres 30%. 
    Ztilt in reconstruction. Geomtric optics start at 2 with ztilt [00;00m(noisy)[00;00m
  powfs2: Order 20, NGS at inf km. Sampling 1/31.9716 m. Thres 50%. 
    CCD image is 4x4 @ 1500x1500 mas, blur 0% (sigma), 0.015Hz, wvl: [ 7.2e-07]
    Gtilt in reconstruction. Geomtric optics start at 50 with gtilt Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
[00;00mThere are 13 wfs[00;00m
    wfs 0: type 0, at (  30.00,    0.00) arcsec,  99 km, siglev is 50.8825 bkgrnd is 0.1
    wfs 1: type 0, at (  22.98,   19.28) arcsec,  99 km, siglev is 50.8825 bkgrnd is 0.1
    wfs 2: type 0, at (   5.21,   29.54) arcsec,  99 km, siglev is 50.8825 bkgrnd is 0.1
    wfs 3: type 0, at ( -15.00,   25.98) arcsec,  99 km, siglev is 50.8825 bkgrnd is 0.1
    wfs 4: type 0, at ( -28.19,   10.26) arcsec,  99 km, siglev is 50.8825 bkgrnd is 0.1
    wfs 5: type 0, at ( -28.19,  -10.26) arcsec,  99 km, siglev is 50.8825 bkgrnd is 0.1
    wfs 6: type 0, at ( -15.00,  -25.98) arcsec,  99 km, siglev is 50.8825 bkgrnd is 0.1
    wfs 7: type 0, at (   5.21,  -29.54) arcsec,  99 km, siglev is 50.8825 bkgrnd is 0.1
    wfs 8: type 0, at (  22.98,  -19.28) arcsec,  99 km, siglev is 50.8825 bkgrnd is 0.1
    wfs 9: type 1, at (   5.00,    8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 10: type 1, at ( -10.00,    0.00) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 11: type 1, at (   5.00,   -8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 12: type 2, at (   0.00,    0.00) arcsec, inf km, siglev is 4.1558e+06 bkgrnd is 0.001
[00;00mThere are 3 DMs[00;00m
  DM 0 at -0.1km, actuator pitch 0.206m, offset   0, with 30.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 1 at    6km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 2 at   10km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
[00;00mTomography[00;00m is using CG, with [00;00mFourer Domain[00;00m preconditioner, [00;00m12[00;00m iterations, integrated tomo.
[00;00mDM Fitting [00;00mis using CG, with [00;00mNo[00;00m preconditioner, [00;00m10[00;00m iterations
[00;00mThere are 9 fit directions[00;00m
    Fit 0: weight is 0.444, at (   0.00,    0.00) arcsec
    Fit 1: weight is 0.111, at (  15.00,    0.00) arcsec
    Fit 2: weight is 0.111, at (   0.00,   15.00) arcsec
    Fit 3: weight is 0.111, at ( -15.00,    0.00) arcsec
    Fit 4: weight is 0.111, at (   0.00,  -15.00) arcsec
    Fit 5: weight is 0.028, at (  15.00,   15.00) arcsec
    Fit 6: weight is 0.028, at ( -15.00,   15.00) arcsec
    Fit 7: weight is 0.028, at ( -15.00,  -15.00) arcsec
    Fit 8: weight is 0.028, at (  15.00,  -15.00) arcsec
[00;00mThere are 1 evaluation directions[00;00m at sampling 1/128 m.
    Evl 0: weight is 1.000, at (   0.00,    0.00) arcsec
[00;00mSimulation[00;00m start at step 0, end at step 1600, with time step 1/1500s, [00;00mclose loop[00;00m.
After setup_parms:	120.5 MiB.
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
CUDA: minimum memory requirement is 0.3GB
GPU 0 is NVIDIA A100-SXM4-40GB with arch 8.0, 38.9GB free, 39.3GB total device memory.
Using GPU 0
Use 1 GPUs for WFS Tomo Fit Evl

*** Preparation started at 2025/02/17 14:54:40 in nid001972. ***

Using OpenMP version 201511 with 128 threads
Reading aperture amplitude map from KECK.fits
[00;00m[0;36mWarning(accphi.c:477): 108454 points not covered by input screen
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
 ->maos.c:447->setup.c:148->aper.c:74->utils.c:478->accphi.c:478
iwvl 0: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 1: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 2: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 3: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 4: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 5: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 6: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 7: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 8: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
After setup_aper:	344.8 MiB.

[00;00mSetting up powfs 0 geom[00;00m

There are 26 points in each subaperture of 0.206m.
There are 1760 valid subaperture.

[00;00mSetting up powfs 1 geom[00;00m

There are 88 points in each subaperture of 5.5m.
There are 4 valid subaperture.

[00;00mSetting up powfs 2 geom[00;00m

There are 18 points in each subaperture of 0.563m.
There are 236 valid subaperture.
After setup_powfs_init:	416.2 MiB.

[00;00mSetting up reconstructor geometry.[00;00m

PLOC is 111x111, with sampling of 0.10m (square)
    DM 0: grid is 57 x 57
    DM 1: grid is 75 x 75
    DM 2: grid is 80 x 79
FLOC is 111x111, with sampling of 0.10m (not square)
Tomography grid is square:
    layer 0: xloc grid is 192 x 192, sampling is 0.103 m, 36864 points
    layer 1: xloc grid is 192 x 192, sampling is 0.103 m, 36864 points
    layer 2: xloc grid is 192 x 192, sampling is 0.103 m, 36864 points
    layer 3: xloc grid is 192 x 192, sampling is 0.103 m, 36864 points
    layer 4: xloc grid is 192 x 192, sampling is 0.103 m, 36864 points
    layer 5: xloc grid is 192 x 192, sampling is 0.103 m, 36864 points
    layer 6: xloc grid is 192 x 192, sampling is 0.103 m, 36864 points
    layer 7: xloc grid is 192 x 192, sampling is 0.103 m, 36864 points
    layer 8: xloc grid is 192 x 192, sampling is 0.102 m, 36864 points
    layer 9: xloc grid is 192 x 192, sampling is 0.102 m, 36864 points
    layer 10: xloc grid is 192 x 192, sampling is 0.098 m, 36864 points
    layer 11: xloc grid is 192 x 192, sampling is 0.093 m, 36864 points
    layer 12: xloc grid is 192 x 192, sampling is 0.089 m, 36864 points
[00;00m[0;36mWarning(map.c:195): ninx=192 is too small. need 193
[00;00m[0;36mWarning(map.c:200): niny=192 is too small. need 193
    layer 13: xloc grid is 192 x 192, sampling is 0.080 m, 36864 points

[00;00mSetting up powfs 0 PO WFS[00;00m

OTF dimension is 54x54 (calculated)
Uplink FWHM (illt 0, iwvl 0) is 0.577752"
Downlink FWHM (illt 0, iwvl 0) is 0"
Generating matched filter for powfs 0
sa index   location       noise equivalent angle
     878: (  4.9,  -0.2) m, (5000.00, 5000.00) mas
     872: (  3.7,  -0.2) m, (5000.00, 5000.00) mas
     867: (  2.7,  -0.2) m, (5000.00, 5000.00) mas
     862: (  1.6,  -0.2) m, (5000.00, 5000.00) mas
     860: (  1.2,  -0.2) m, (5000.00, 5000.00) mas
     609: ( -0.6,  -1.4) m, (5000.00, 5000.00) mas
     858: ( -1.6,  -0.2) m, (5000.00, 5000.00) mas
     852: ( -2.9,  -0.2) m, (5000.00, 5000.00) mas
     847: ( -3.9,  -0.2) m, (5000.00, 5000.00) mas
     841: ( -5.1,  -0.2) m, (5000.00, 5000.00) mas
     840: ( -5.4,  -0.2) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    1499: (  3.5,   2.9) m, (5000.00, 5000.00) mas
    1298: (  2.3,   1.9) m, (5000.00, 5000.00) mas
    1110: (  1.2,   1.0) m, (5000.00, 5000.00) mas
    1067: (  1.0,   0.8) m, (5000.00, 5000.00) mas
     614: (  0.4,  -1.4) m, (5000.00, 5000.00) mas
     694: ( -1.2,  -1.0) m, (5000.00, 5000.00) mas
     651: ( -1.4,  -1.2) m, (5000.00, 5000.00) mas
     463: ( -2.5,  -2.1) m, (5000.00, 5000.00) mas
     262: ( -3.7,  -3.1) m, (5000.00, 5000.00) mas
      67: ( -3.1,  -4.3) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    1683: (  0.6,   4.1) m, (5000.00, 5000.00) mas
    1484: (  0.4,   2.9) m, (5000.00, 5000.00) mas
    1243: (  0.2,   1.6) m, (5000.00, 5000.00) mas
    1151: (  0.2,   1.2) m, (5000.00, 5000.00) mas
     817: ( -1.4,  -0.4) m, (5000.00, 5000.00) mas
     518: ( -0.4,  -1.9) m, (5000.00, 5000.00) mas
     315: ( -0.6,  -2.9) m, (5000.00, 5000.00) mas
     277: ( -0.6,  -3.1) m, (5000.00, 5000.00) mas
      78: ( -0.8,  -4.3) m, (5000.00, 5000.00) mas
       1: ( -2.5,  -4.9) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    1697: ( -2.7,   4.3) m, (5000.00, 5000.00) mas
    1546: ( -2.1,   3.3) m, (5000.00, 5000.00) mas
    1361: ( -1.4,   2.3) m, (5000.00, 5000.00) mas
    1281: ( -1.2,   1.9) m, (5000.00, 5000.00) mas
    1146: ( -0.8,   1.2) m, (5000.00, 5000.00) mas
     944: (  1.2,   0.2) m, (5000.00, 5000.00) mas
     615: (  0.6,  -1.4) m, (5000.00, 5000.00) mas
     480: (  1.0,  -2.1) m, (5000.00, 5000.00) mas
     215: (  1.9,  -3.5) m, (5000.00, 5000.00) mas
     152: (  2.1,  -3.9) m, (5000.00, 5000.00) mas
      64: (  2.5,  -4.5) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    1175: ( -4.3,   1.4) m, (5000.00, 5000.00) mas
    1057: ( -2.7,   0.8) m, (5000.00, 5000.00) mas
    1022: ( -2.1,   0.6) m, (5000.00, 5000.00) mas
     984: ( -1.4,   0.4) m, (5000.00, 5000.00) mas
    1107: (  0.6,   1.0) m, (5000.00, 5000.00) mas
     777: (  1.2,  -0.6) m, (5000.00, 5000.00) mas
     704: (  2.5,  -1.0) m, (5000.00, 5000.00) mas
     669: (  3.1,  -1.2) m, (5000.00, 5000.00) mas
     586: (  4.1,  -1.6) m, (5000.00, 5000.00) mas
     837: (  5.1,  -0.4) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
     545: ( -4.3,  -1.6) m, (5000.00, 5000.00) mas
     687: ( -2.7,  -1.0) m, (5000.00, 5000.00) mas
     730: ( -2.1,  -0.8) m, (5000.00, 5000.00) mas
     774: ( -1.4,  -0.6) m, (5000.00, 5000.00) mas
    1149: ( -0.2,   1.2) m, (5000.00, 5000.00) mas
     987: (  1.2,   0.4) m, (5000.00, 5000.00) mas
    1074: (  2.5,   0.8) m, (5000.00, 5000.00) mas
    1119: (  3.1,   1.0) m, (5000.00, 5000.00) mas
    1216: (  4.1,   1.4) m, (5000.00, 5000.00) mas
     963: (  5.1,   0.2) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
      39: ( -2.7,  -4.5) m, (5000.00, 5000.00) mas
     196: ( -2.1,  -3.5) m, (5000.00, 5000.00) mas
     387: ( -1.4,  -2.5) m, (5000.00, 5000.00) mas
     469: ( -1.2,  -2.1) m, (5000.00, 5000.00) mas
     608: ( -0.8,  -1.4) m, (5000.00, 5000.00) mas
     818: (  1.2,  -0.4) m, (5000.00, 5000.00) mas
    1153: (  0.6,   1.2) m, (5000.00, 5000.00) mas
    1292: (  1.0,   1.9) m, (5000.00, 5000.00) mas
    1565: (  1.9,   3.3) m, (5000.00, 5000.00) mas
    1630: (  2.1,   3.7) m, (5000.00, 5000.00) mas
    1722: (  2.5,   4.3) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
      85: (  0.6,  -4.3) m, (5000.00, 5000.00) mas
     282: (  0.4,  -3.1) m, (5000.00, 5000.00) mas
     521: (  0.2,  -1.9) m, (5000.00, 5000.00) mas
     613: (  0.2,  -1.4) m, (5000.00, 5000.00) mas
     943: ( -1.4,   0.2) m, (5000.00, 5000.00) mas
    1240: ( -0.4,   1.6) m, (5000.00, 5000.00) mas
    1441: ( -0.6,   2.7) m, (5000.00, 5000.00) mas
    1479: ( -0.6,   2.9) m, (5000.00, 5000.00) mas
    1676: ( -0.8,   4.1) m, (5000.00, 5000.00) mas
    1726: ( -2.7,   4.5) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
     297: (  3.5,  -3.1) m, (5000.00, 5000.00) mas
     486: (  2.3,  -2.1) m, (5000.00, 5000.00) mas
     660: (  1.2,  -1.2) m, (5000.00, 5000.00) mas
     697: (  1.0,  -1.0) m, (5000.00, 5000.00) mas
    1152: (  0.4,   1.2) m, (5000.00, 5000.00) mas
    1064: ( -1.2,   0.8) m, (5000.00, 5000.00) mas
    1101: ( -1.4,   1.0) m, (5000.00, 5000.00) mas
    1275: ( -2.5,   1.9) m, (5000.00, 5000.00) mas
    1464: ( -3.7,   2.9) m, (5000.00, 5000.00) mas
    1665: ( -3.1,   4.1) m, (5000.00, 5000.00) mas

[00;00mSetting up powfs 2 PO WFS[00;00m

OTF dimension is 48x48 (calculated)
Generating matched filter for powfs 2
Use sanea to derive neasim
Use sanea to derive neasim

[00;00mSetting up reconstructor[00;00m

Recon NEA: cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) geom(0.31) geom(0.31) geom(0.31) mf(0.14)  mas
Setup or update control matrix parameters.
RRtwfs svd threshold is 1e-10
Replacing HA by HA*fit->actextrap
Adding piston cr to fit matrix
Adding TT cr on upper DMs to fit matrix.
Before assembling fit matrix:	3730.6 MiB.
Building fit->FR
Building fit->FL
Adding tikhonov constraint of 1.0e-07 to FLM
The maximum eigen value is estimated to be around 3.2e-04
DM Fit number of Low rank terms: 16 in LHS
After assemble fit matrix:	4917.4 MiB.
After setup_recon:	4917.4 MiB.
GPU 0: mem used 2052 MB (wfs init)
GPU 0: mem used 2712 MB (recon init)
GPU 0: mem used 2744 MB (perf init)

*** Simulation started at 2025/02/17 14:55:24 in nid001972. ***

Running seed 1
GPU 0: mem used 2744 MB (wfs seeding)
Wind dir: 267.3 261.7 167.0 130.5 300.7  32.3 119.8 139.0 150.8 277.7 203.0 133.1  45.9 265.1 deg
Using /global/homes/b/bpeck/.aos/cache/atm/vonkarman_14_8192x8192_0.0078125_1115374592d.bin
After genatm:	4841.5 MiB.
Step     #  Open Loop  PR TT  On axis  PR TT  Field RMS PR TT     Timing 
Step     0: OL  884.6  248.3  OA  884.6 248.3 CL  884.6 248.3 nm  0.095 s
Step    20: OL  915.3  255.8  OA  719.6 244.8 CL  719.6 244.8 nm  0.055 s
Step    38: OL  942.9  260.3  OA  705.5 242.2 CL  705.5 242.2 nm  0.066 s
Step    56: OL  969.7  261.2  OA  687.5 235.8 CL  687.5 235.8 nm  0.056 s
Step    73: OL  995.6  259.7  OA  672.2 230.2 CL  672.2 230.2 nm  0.056 s
Step    90: OL 1022.6  258.2  OA  659.9 224.2 CL  659.9 224.2 nm  0.066 s
Step   108: OL 1051.3  257.9  OA  650.1 220.9 CL  650.1 220.9 nm  0.055 s
Step   126: OL 1079.4  259.8  OA  646.0 217.8 CL  646.0 217.8 nm  0.059 s
Step   144: OL 1105.2  265.3  OA  643.8 216.8 CL  643.8 216.8 nm  0.057 s
Step   162: OL 1127.5  273.7  OA  644.4 217.5 CL  644.4 217.5 nm  0.058 s
Step   179: OL 1144.7  283.9  OA  648.1 223.2 CL  648.1 223.2 nm  0.067 s
Step   196: OL 1157.4  294.9  OA  652.7 230.3 CL  652.7 230.3 nm  0.057 s
Step   214: OL 1167.0  306.3  OA  661.7 239.3 CL  661.7 239.3 nm  0.054 s
Step   232: OL 1172.3  318.0  OA  673.0 252.5 CL  673.0 252.5 nm  0.108 s
Step   250: OL 1172.7  330.5  OA  681.6 267.4 CL  681.6 267.4 nm  0.055 s
Step   255 updated high order loop gain: 0.423
Step   268: OL 1165.7  343.4  OA  691.4 283.3 CL  691.4 283.3 nm  0.060 s
Step   285: OL 1152.7  355.9  OA  696.7 299.1 CL  696.7 299.1 nm  0.055 s
Step   303: OL 1135.3  371.3  OA  699.4 315.6 CL  699.4 315.6 nm  0.056 s
Step   320: OL 1115.3  387.1  OA  703.2 331.4 CL  703.2 331.4 nm  0.069 s
Step   337: OL 1093.0  405.4  OA  706.5 346.8 CL  706.5 346.8 nm  0.056 s
Step   355: OL 1069.2  428.0  OA  711.7 368.3 CL  711.7 368.3 nm  0.057 s
Step   372: OL 1047.7  451.8  OA  721.9 391.2 CL  721.9 391.2 nm  0.066 s
Step   390: OL 1026.2  477.8  OA  732.1 412.1 CL  732.1 412.1 nm  0.058 s
Step   408: OL 1005.1  503.5  OA  742.7 432.9 CL  742.7 432.9 nm  0.057 s
Step   425: OL  984.4  526.5  OA  749.0 450.8 CL  749.0 450.8 nm  0.067 s
Step   443: OL  963.4  550.2  OA  754.2 468.6 CL  754.2 468.6 nm  0.055 s
Step   461: OL  945.8  573.7  OA  759.0 485.9 CL  759.0 485.9 nm  0.055 s
Step   478: OL  935.5  595.5  OA  768.8 501.8 CL  768.8 501.8 nm  0.072 s
Step   496: OL  932.5  617.6  OA  784.7 517.8 CL  784.7 517.8 nm  0.055 s
Step   511 updated high order loop gain: 0.426
Step   514: OL  934.3  637.3  OA  800.8 532.5 CL  800.8 532.5 nm  0.061 s
Step   531: OL  939.6  652.2  OA  817.0 543.4 CL  817.0 543.4 nm  0.055 s
Step   549: OL  949.3  662.8  OA  832.8 548.2 CL  832.8 548.2 nm  0.058 s
Step   567: OL  963.0  668.7  OA  844.3 549.4 CL  844.3 549.4 nm  0.068 s
Step   584: OL  978.9  670.8  OA  852.0 545.8 CL  852.0 545.8 nm  0.054 s
Step   602: OL  998.6  668.5  OA  859.9 537.5 CL  859.9 537.5 nm  0.056 s
Step   619: OL 1018.2  661.5  OA  861.4 525.3 CL  861.4 525.3 nm  0.064 s
Step   637: OL 1038.4  649.7  OA  857.5 509.4 CL  857.5 509.4 nm  0.057 s
Step   654: OL 1055.5  635.1  OA  845.7 491.6 CL  845.7 491.6 nm  0.055 s
Step   671: OL 1070.4  618.1  OA  832.7 473.6 CL  832.7 473.6 nm  0.071 s
Step   688: OL 1083.9  600.4  OA  817.8 452.7 CL  817.8 452.7 nm  0.055 s
Step   706: OL 1095.2  580.1  OA  801.0 430.2 CL  801.0 430.2 nm  0.056 s
Step   723: OL 1101.1  559.2  OA  781.2 405.2 CL  781.2 405.2 nm  0.066 s
Step   740: OL 1101.9  538.3  OA  761.8 382.1 CL  761.8 382.1 nm  0.085 s
Step   758: OL 1097.2  516.6  OA  737.6 359.9 CL  737.6 359.9 nm  0.056 s
Step   767 updated high order loop gain: 0.427
Step   775: OL 1087.8  497.0  OA  713.4 340.6 CL  713.4 340.6 nm  0.069 s
Step   792: OL 1073.0  478.0  OA  691.8 325.3 CL  691.8 325.3 nm  0.055 s
Step   810: OL 1052.7  457.9  OA  670.4 309.1 CL  670.4 309.1 nm  0.053 s
Step   826: OL 1030.9  440.2  OA  655.0 291.4 CL  655.0 291.4 nm  0.066 s
Step   843: OL 1004.9  422.2  OA  641.7 274.9 CL  641.7 274.9 nm  0.057 s
Step   860: OL  978.1  405.6  OA  630.3 258.4 CL  630.3 258.4 nm  0.057 s
Step   878: OL  951.4  390.6  OA  624.8 244.5 CL  624.8 244.5 nm  0.066 s
Step   896: OL  926.2  378.0  OA  622.3 232.2 CL  622.3 232.2 nm  0.054 s
Step   914: OL  899.9  367.9  OA  617.9 222.3 CL  617.9 222.3 nm  0.055 s
Step   931: OL  875.3  359.7  OA  612.5 215.6 CL  612.5 215.6 nm  0.067 s
Step   949: OL  850.4  351.0  OA  606.9 210.1 CL  606.9 210.1 nm  0.055 s
Step   967: OL  828.4  341.5  OA  600.6 204.0 CL  600.6 204.0 nm  0.066 s
Step   985: OL  810.5  330.5  OA  597.5 196.6 CL  597.5 196.6 nm  0.058 s
Step  1003: OL  794.8  317.7  OA  595.8 188.3 CL  595.8 188.3 nm  0.056 s
Step  1021: OL  781.0  304.0  OA  590.4 179.1 CL  590.4 179.1 nm  0.067 s
Step  1023 updated high order loop gain: 0.427
Step  1038: OL  770.0  290.2  OA  585.0 171.4 CL  585.0 171.4 nm  0.057 s
Step  1056: OL  758.8  274.2  OA  575.6 161.3 CL  575.6 161.3 nm  0.057 s
Step  1074: OL  748.6  255.3  OA  568.8 148.6 CL  568.8 148.6 nm  0.058 s
Step  1090: OL  742.5  236.7  OA  562.3 133.8 CL  562.3 133.8 nm  0.055 s
Step  1108: OL  738.8  217.1  OA  556.7 114.2 CL  556.7 114.2 nm  0.055 s
Step  1125: OL  737.2  201.0  OA  553.3  97.0 CL  553.3  97.0 nm  0.064 s
Step  1143: OL  736.5  187.6  OA  551.6  82.1 CL  551.6  82.1 nm  0.058 s
Step  1160: OL  736.2  178.1  OA  551.9  72.2 CL  551.9  72.2 nm  0.056 s
Step  1177: OL  736.2  172.1  OA  557.3  65.5 CL  557.3  65.5 nm  0.070 s
Step  1193: OL  738.5  168.4  OA  565.5  60.0 CL  565.5  60.0 nm  0.058 s
Step  1210: OL  742.0  165.2  OA  579.9  55.1 CL  579.9  55.1 nm  0.064 s
Step  1227: OL  745.9  163.5  OA  594.7  54.3 CL  594.7  54.3 nm  0.057 s
Step  1245: OL  749.2  164.9  OA  606.0  58.3 CL  606.0  58.3 nm  0.096 s
Step  1263: OL  753.6  170.5  OA  615.8  67.1 CL  615.8  67.1 nm  0.066 s
Step  1279 updated high order loop gain: 0.427
Step  1281: OL  759.3  179.6  OA  622.3  76.9 CL  622.3  76.9 nm  0.057 s
Step  1299: OL  767.0  190.9  OA  629.9  86.7 CL  629.9  86.7 nm  0.063 s
Step  1317: OL  773.9  204.3  OA  630.0  96.4 CL  630.0  96.4 nm  0.054 s
Step  1333: OL  779.9  217.8  OA  628.4 107.5 CL  628.4 107.5 nm  0.058 s
Step  1351: OL  788.7  234.3  OA  621.6 115.0 CL  621.6 115.0 nm  0.054 s
Step  1365: OL  797.4  246.1  OA  622.1 119.5 CL  622.1 119.5 nm  0.064 s
Step  1383: OL  809.3  258.1  OA  623.3 122.9 CL  623.3 122.9 nm  0.056 s
Step  1400: OL  821.9  266.3  OA  628.2 120.8 CL  628.2 120.8 nm  0.064 s
Step  1418: OL  836.9  272.1  OA  634.9 120.6 CL  634.9 120.6 nm  0.054 s
Step  1436: OL  852.1  276.2  OA  640.2 116.8 CL  640.2 116.8 nm  0.055 s
Step  1453: OL  865.0  279.0  OA  643.1 113.8 CL  643.1 113.8 nm  0.065 s
Step  1470: OL  875.5  279.5  OA  640.5 110.8 CL  640.5 110.8 nm  0.055 s
Step  1488: OL  880.5  276.8  OA  637.8 107.3 CL  637.8 107.3 nm  0.059 s
Step  1506: OL  879.3  270.8  OA  626.0 106.5 CL  626.0 106.5 nm  0.063 s
Step  1524: OL  874.0  262.4  OA  614.3 105.4 CL  614.3 105.4 nm  0.054 s
Step  1535 updated high order loop gain: 0.428
Step  1541: OL  865.9  252.3  OA  604.3 102.2 CL  604.3 102.2 nm  0.055 s
Step  1558: OL  857.1  241.1  OA  597.8  95.2 CL  597.8  95.2 nm  0.066 s
Step  1576: OL  848.1  230.3  OA  594.6  91.9 CL  594.6  91.9 nm  0.053 s
Step  1593: OL  839.2  222.4  OA  589.4  91.4 CL  589.4  91.4 nm  0.055 s
Step 1599: Output PSF
Step  1599: OL  835.9  219.9  OA  589.5  92.1 CL  589.5  92.1 nm  1.966 s
Mean: 679.09 307.45 605.51  nm.

*** Simulation Finished at 2025/02/17 14:57:07 in nid001972. ***

[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
/global/cfs/cdirs/ulens/vismcao/maos -o studies/reduced_ngs/9_lgs/8mag_lgs/2500count -c master_files/reduced_ngs/9_lgs/8mag_lgs/kola_2500act.conf -O 
Output folder is 'studies/reduced_ngs/9_lgs/8mag_lgs/2500count'.
SRC: /global/homes/b/bpeck/code/maos v2.9 4c88b7c2 2024-11-13 16:45:33 -0800
BUILT: /global/homes/b/bpeck/code/maos/optim by GCC (v12) on 2024/11/18 09:40:03 CPU(F64,+O3) with CUDA(v122,F32)
Launched at 2025/02/17 14:57:07 in nid001972 with PID 1692417.
The web based job monitor can be accessed at http://localhost:10300
Main config file is /global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_2500act.conf
[00;00m[0;36mWarning(path.c:48): Path not found: path=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; abspath=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; Ignored.
[00;00m[0;36mWarning(path.c:48): Path not found: path=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; abspath=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; Ignored.
[00;00m[0;36mWarning(readcfg.c:399): sim.apfsm has been renamed to powfs.apfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.epfsm has been renamed to powfs.epfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.alfsm has been renamed to powfs.alfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.commonfsm has been renamed to powfs.commonfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.idealfsm has been renamed to powfs.idealfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.zetafsm has been renamed to powfs.zetafsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.f0fsm has been renamed to powfs.f0fsm.
[00;00m[0;36mWarning(readcfg.c:399): tsurf has been renamed to ncpa.tsurf.
loaded 132 (132 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_sim.conf'
loaded  19 ( 19 new) records from '/global/cfs/cdirs/ulens/vismcao/./dm_none.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_ASM.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_DM2.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_DM3.conf'
loaded   0 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_dm_multiple.conf'
loaded   7 (  5 new) records from '/global/cfs/cdirs/ulens/vismcao/./atm_mk13n50p_ground_detail.conf'
loaded  76 ( 69 new) records from '/global/homes/b/bpeck/code/maos/config/maos/powfs_common.conf'
loaded  44 ( 38 new) records from '/global/cfs/cdirs/ulens/vismcao/./powfs_none.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_lgs.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_ttf_strap.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_twfs_lbwfs.conf'
loaded   0 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_wfs_lgs_strap_lbwfs.conf'
loaded  71 ( 71 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_recon.conf'
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_smooth has been renamed to powfs0_llt.na_smooth.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_interp has been renamed to powfs0_llt.na_interp.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_thres has been renamed to powfs0_llt.na_thres.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_maxit has been renamed to powfs0_llt.na_fit_maxit.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_svdthres has been renamed to powfs0_llt.na_fit_svdthres.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_dh has been renamed to powfs0_llt.na_fit_dh.
[00;00m[0;36mWarning(readcfg.c:399): dbg.ncpa_preload has been renamed to ncpa.preload.
[00;00m[0;36mWarning(readcfg.c:399): dbg.ncpa_rmsci has been renamed to ncpa.rmsci.
[00;00m[0;36mWarning(readcfg.c:399): dbg.draw_opdmax has been renamed to plot.opdmax.
[00;00m[0;36mWarning(readcfg.c:399): dbg.draw_gmax has been renamed to plot.gmax.
loaded  95 ( 93 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_dbg.conf'
loaded   4 (  4 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_fit_mcao.conf'
[00;00m[0;36mWarning(readcfg.c:399): surf has been renamed to ncpa.surf.
loaded  39 (  7 new) records from '/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_2500act.conf'
loaded   0 (  0 new) records from 'command line'
loaded  24 ( 18 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_llt_CL.conf'
Adjust LGS range by telescope altitude 4145m.
Zenith angle is 30 degree.
    Scaling turbulence height and LGS hs by sec(za).
    Scaling r0 by cos(za)^(3/5).
    Scaling wind speed and LGS signal level by cos(za).
powfs0: Adjusting dx from 0.0078125 to 0.008125. 
powfs0.llt.fsm: f0=0 Hz, LPF ep=0
powfs0.epfsm is set to 0.517618 (auto)
powfs2: Adjusting dx from 0.03125 to 0.0312778. 
powfs2 is TWFS for powfs0
sim.ephi is set to 0.427717 (auto)
sim.eplo is set to 0.427717 (auto)
[00;00m[0;36mWarning(parms.c:2296): Layer 1 at 17.3205m is very close to layer 0 at 0m (OK).
[00;00m[0;36mWarning(parms.c:2296): Layer 2 at 34.641m is very close to layer 1 at 17.3205m (OK).
[00;00m[0;36mWarning(parms.c:2296): Layer 3 at 51.9615m is very close to layer 2 at 34.641m (OK).
dm 0: stroke=30 um is provided in micron.
dm 0: assume ia stroke=2 um is provided in micron.
dm 1: stroke=7 um is provided in micron.
dm 1: assume ia stroke=2 um is provided in micron.
dm 2: stroke=7 um is provided in micron.
dm 2: assume ia stroke=2 um is provided in micron.
Focus blending is not implemented yet for integrated tomography
parms->sim.mffocus is reset to 0
There are 1 valid simulation seeds:  1
Output PSF for 1 directions
Used 449 of 456 supplied keys
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_flate" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_flatv" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_psx" is not recognized, value is [0 0 0 0]
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_psy" is not recognized, value is [0 0 0 0]
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_pupelong" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_raw" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_side" is not recognized, value is 4
[00;00mAperture[00;00m is 11 m with sampling 1/128 m
[00;00mTurbulence at 30 degree zenith angle:[00;00m r0=0.128424m, L0=30m, 14 layers.
    Greenwood freq is 25.1Hz, anisoplanatic angle is 1.58 as
    Sampled 8192x8192 at 1/128m. wind dir is randomized.
    layer 0: ht=      0 m, wt= 0.302, ws=  4.8 m/s
    layer 1: ht=     17 m, wt= 0.154, ws=  5.0 m/s
    layer 2: ht=     35 m, wt= 0.041, ws=  5.4 m/s
    layer 3: ht=     52 m, wt= 0.002, ws=  6.6 m/s
    layer 4: ht=    139 m, wt= 0.021, ws=  6.1 m/s
    layer 5: ht=    231 m, wt= 0.010, ws=  6.1 m/s
    layer 6: ht=    323 m, wt= 0.008, ws=  6.1 m/s
    layer 7: ht=    416 m, wt= 0.005, ws=  6.1 m/s
    layer 8: ht=    508 m, wt= 0.001, ws=  6.1 m/s
    layer 9: ht=    932 m, wt= 0.107, ws=  5.6 m/s
    layer 10: ht=   5022 m, wt= 0.144, ws= 11.1 m/s
    layer 11: ht=   9238 m, wt= 0.093, ws= 19.1 m/s
    layer 12: ht=  13856 m, wt= 0.075, ws=  8.2 m/s
    layer 13: ht=  22518 m, wt= 0.036, ws=  4.8 m/s
[00;00mReconstruction[00;00m: r0=0.128424m L0=30m. 14 layers. use cone coordinate.
    layer 0: ht=      0 m, wt= 0.302
    layer 1: ht=     17 m, wt= 0.154
    layer 2: ht=     35 m, wt= 0.041
    layer 3: ht=     52 m, wt= 0.002
    layer 4: ht=    139 m, wt= 0.021
    layer 5: ht=    231 m, wt= 0.010
    layer 6: ht=    323 m, wt= 0.008
    layer 7: ht=    416 m, wt= 0.005
    layer 8: ht=    508 m, wt= 0.001
    layer 9: ht=    932 m, wt= 0.107
    layer 10: ht=   5022 m, wt= 0.144
    layer 11: ht=   9238 m, wt= 0.093
    layer 12: ht=  13856 m, wt= 0.075
    layer 13: ht=  22518 m, wt= 0.036
[00;00mThere are 3 powfs[00;00m
  powfs0: Order 57, LGS at 99.1 km. Sampling 1/123.077 m. Thres 30%. [00;00mT/T is removed in right hand side in tomography.[00;00m
    CCD image is 25x25 @ 500x500 mas, blur 27% (sigma), 1500Hz, wvl: [ 5.89e-07]
    Gtilt in reconstruction. Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
  powfs1: Order  2, NGS at inf km. Sampling 1/16 m. Thres 30%. 
    Ztilt in reconstruction. Geomtric optics start at 2 with ztilt [00;00m(noisy)[00;00m
  powfs2: Order 20, NGS at inf km. Sampling 1/31.9716 m. Thres 50%. 
    CCD image is 4x4 @ 1500x1500 mas, blur 0% (sigma), 0.015Hz, wvl: [ 7.2e-07]
    Gtilt in reconstruction. Geomtric optics start at 50 with gtilt Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
[00;00mThere are 13 wfs[00;00m
    wfs 0: type 0, at (  30.00,    0.00) arcsec,  99 km, siglev is 45.5936 bkgrnd is 0.1
    wfs 1: type 0, at (  22.98,   19.28) arcsec,  99 km, siglev is 45.5936 bkgrnd is 0.1
    wfs 2: type 0, at (   5.21,   29.54) arcsec,  99 km, siglev is 45.5936 bkgrnd is 0.1
    wfs 3: type 0, at ( -15.00,   25.98) arcsec,  99 km, siglev is 45.5936 bkgrnd is 0.1
    wfs 4: type 0, at ( -28.19,   10.26) arcsec,  99 km, siglev is 45.5936 bkgrnd is 0.1
    wfs 5: type 0, at ( -28.19,  -10.26) arcsec,  99 km, siglev is 45.5936 bkgrnd is 0.1
    wfs 6: type 0, at ( -15.00,  -25.98) arcsec,  99 km, siglev is 45.5936 bkgrnd is 0.1
    wfs 7: type 0, at (   5.21,  -29.54) arcsec,  99 km, siglev is 45.5936 bkgrnd is 0.1
    wfs 8: type 0, at (  22.98,  -19.28) arcsec,  99 km, siglev is 45.5936 bkgrnd is 0.1
    wfs 9: type 1, at (   5.00,    8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 10: type 1, at ( -10.00,    0.00) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 11: type 1, at (   5.00,   -8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 12: type 2, at (   0.00,    0.00) arcsec, inf km, siglev is 4.1558e+06 bkgrnd is 0.001
[00;00mThere are 3 DMs[00;00m
  DM 0 at -0.1km, actuator pitch 0.195m, offset   0, with 30.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 1 at    6km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 2 at   10km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
[00;00mTomography[00;00m is using CG, with [00;00mFourer Domain[00;00m preconditioner, [00;00m12[00;00m iterations, integrated tomo.
[00;00mDM Fitting [00;00mis using CG, with [00;00mNo[00;00m preconditioner, [00;00m10[00;00m iterations
[00;00mThere are 9 fit directions[00;00m
    Fit 0: weight is 0.444, at (   0.00,    0.00) arcsec
    Fit 1: weight is 0.111, at (  15.00,    0.00) arcsec
    Fit 2: weight is 0.111, at (   0.00,   15.00) arcsec
    Fit 3: weight is 0.111, at ( -15.00,    0.00) arcsec
    Fit 4: weight is 0.111, at (   0.00,  -15.00) arcsec
    Fit 5: weight is 0.028, at (  15.00,   15.00) arcsec
    Fit 6: weight is 0.028, at ( -15.00,   15.00) arcsec
    Fit 7: weight is 0.028, at ( -15.00,  -15.00) arcsec
    Fit 8: weight is 0.028, at (  15.00,  -15.00) arcsec
[00;00mThere are 1 evaluation directions[00;00m at sampling 1/128 m.
    Evl 0: weight is 1.000, at (   0.00,    0.00) arcsec
[00;00mSimulation[00;00m start at step 0, end at step 1600, with time step 1/1500s, [00;00mclose loop[00;00m.
After setup_parms:	120.5 MiB.
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
CUDA: minimum memory requirement is 0.3GB
GPU 0 is NVIDIA A100-SXM4-40GB with arch 8.0, 38.9GB free, 39.3GB total device memory.
Using GPU 0
Use 1 GPUs for WFS Tomo Fit Evl

*** Preparation started at 2025/02/17 14:57:08 in nid001972. ***

Using OpenMP version 201511 with 128 threads
Reading aperture amplitude map from KECK.fits
[00;00m[0;36mWarning(accphi.c:477): 108650 points not covered by input screen
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
 ->maos.c:447->setup.c:148->aper.c:74->utils.c:478->accphi.c:478
iwvl 0: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 1: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 2: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 3: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 4: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 5: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 6: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 7: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 8: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
After setup_aper:	343.0 MiB.

[00;00mSetting up powfs 0 geom[00;00m

There are 24 points in each subaperture of 0.195m.
There are 1993 valid subaperture.

[00;00mSetting up powfs 1 geom[00;00m

There are 88 points in each subaperture of 5.5m.
There are 4 valid subaperture.

[00;00mSetting up powfs 2 geom[00;00m

There are 18 points in each subaperture of 0.563m.
There are 236 valid subaperture.
After setup_powfs_init:	408.7 MiB.

[00;00mSetting up reconstructor geometry.[00;00m

PLOC is 117x117, with sampling of 0.10m (square)
    DM 0: grid is 60 x 60
    DM 1: grid is 75 x 75
    DM 2: grid is 80 x 79
FLOC is 117x117, with sampling of 0.10m (not square)
Tomography grid is square:
    layer 0: xloc grid is 216 x 216, sampling is 0.098 m, 46656 points
    layer 1: xloc grid is 216 x 216, sampling is 0.097 m, 46656 points
    layer 2: xloc grid is 216 x 216, sampling is 0.097 m, 46656 points
    layer 3: xloc grid is 216 x 216, sampling is 0.097 m, 46656 points
    layer 4: xloc grid is 216 x 216, sampling is 0.097 m, 46656 points
    layer 5: xloc grid is 216 x 216, sampling is 0.097 m, 46656 points
    layer 6: xloc grid is 216 x 216, sampling is 0.097 m, 46656 points
    layer 7: xloc grid is 216 x 216, sampling is 0.097 m, 46656 points
    layer 8: xloc grid is 216 x 216, sampling is 0.097 m, 46656 points
    layer 9: xloc grid is 216 x 216, sampling is 0.097 m, 46656 points
    layer 10: xloc grid is 216 x 216, sampling is 0.093 m, 46656 points
    layer 11: xloc grid is 216 x 216, sampling is 0.088 m, 46656 points
    layer 12: xloc grid is 216 x 216, sampling is 0.084 m, 46656 points
    layer 13: xloc grid is 216 x 216, sampling is 0.075 m, 46656 points

[00;00mSetting up powfs 0 PO WFS[00;00m

OTF dimension is 48x48 (calculated)
Uplink FWHM (illt 0, iwvl 0) is 0.581676"
Downlink FWHM (illt 0, iwvl 0) is 0"
Generating matched filter for powfs 0
sa index   location       noise equivalent angle
     972: (  4.8,  -0.3) m, (5000.00, 5000.00) mas
     967: (  3.8,  -0.3) m, (5000.00, 5000.00) mas
     961: (  2.6,  -0.3) m, (5000.00, 5000.00) mas
     955: (  1.5,  -0.3) m, (5000.00, 5000.00) mas
     954: (  1.3,  -0.3) m, (5000.00, 5000.00) mas
     685: ( -0.5,  -1.5) m, (5000.00, 5000.00) mas
     952: ( -1.7,  -0.3) m, (5000.00, 5000.00) mas
     946: ( -2.8,  -0.3) m, (5000.00, 5000.00) mas
     940: ( -4.0,  -0.3) m, (5000.00, 5000.00) mas
     935: ( -5.0,  -0.3) m, (5000.00, 5000.00) mas
     933: ( -5.4,  -0.3) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    1681: (  3.4,   2.8) m, (5000.00, 5000.00) mas
    1466: (  2.2,   1.9) m, (5000.00, 5000.00) mas
    1266: (  1.3,   1.1) m, (5000.00, 5000.00) mas
    1219: (  1.1,   0.9) m, (5000.00, 5000.00) mas
    1173: ( -1.3,   0.7) m, (5000.00, 5000.00) mas
     776: ( -1.3,  -1.1) m, (5000.00, 5000.00) mas
     578: ( -2.2,  -1.9) m, (5000.00, 5000.00) mas
     529: ( -2.4,  -2.0) m, (5000.00, 5000.00) mas
     313: ( -3.6,  -3.0) m, (5000.00, 5000.00) mas
      66: ( -3.0,  -4.4) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    1949: (  0.7,   4.4) m, (5000.00, 5000.00) mas
    1746: (  0.5,   3.2) m, (5000.00, 5000.00) mas
    1542: (  0.3,   2.2) m, (5000.00, 5000.00) mas
    1309: (  0.1,   1.3) m, (5000.00, 5000.00) mas
     953: ( -1.5,  -0.3) m, (5000.00, 5000.00) mas
     686: ( -0.3,  -1.5) m, (5000.00, 5000.00) mas
     452: ( -0.5,  -2.4) m, (5000.00, 5000.00) mas
     248: ( -0.7,  -3.4) m, (5000.00, 5000.00) mas
      44: ( -0.9,  -4.6) m, (5000.00, 5000.00) mas
      14: ( -2.4,  -4.8) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    1932: ( -2.6,   4.4) m, (5000.00, 5000.00) mas
    1802: ( -2.2,   3.6) m, (5000.00, 5000.00) mas
    1614: ( -1.7,   2.6) m, (5000.00, 5000.00) mas
    1401: ( -1.1,   1.7) m, (5000.00, 5000.00) mas
    1304: ( -0.9,   1.3) m, (5000.00, 5000.00) mas
    1042: (  1.3,   0.1) m, (5000.00, 5000.00) mas
     691: (  0.7,  -1.5) m, (5000.00, 5000.00) mas
     461: (  1.3,  -2.4) m, (5000.00, 5000.00) mas
     380: (  1.5,  -2.8) m, (5000.00, 5000.00) mas
     126: (  2.2,  -4.2) m, (5000.00, 5000.00) mas
      61: (  2.4,  -4.6) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    1335: ( -4.4,   1.5) m, (5000.00, 5000.00) mas
    1206: ( -2.8,   0.9) m, (5000.00, 5000.00) mas
    1168: ( -2.2,   0.7) m, (5000.00, 5000.00) mas
    1130: ( -1.5,   0.5) m, (5000.00, 5000.00) mas
     686: ( -0.3,  -1.5) m, (5000.00, 5000.00) mas
     866: (  1.5,  -0.7) m, (5000.00, 5000.00) mas
     827: (  2.0,  -0.9) m, (5000.00, 5000.00) mas
     789: (  2.6,  -1.1) m, (5000.00, 5000.00) mas
     660: (  4.2,  -1.7) m, (5000.00, 5000.00) mas
     930: (  5.2,  -0.5) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
     616: ( -4.4,  -1.7) m, (5000.00, 5000.00) mas
     768: ( -2.8,  -1.1) m, (5000.00, 5000.00) mas
     814: ( -2.2,  -0.9) m, (5000.00, 5000.00) mas
     862: ( -1.5,  -0.7) m, (5000.00, 5000.00) mas
    1307: ( -0.3,   1.3) m, (5000.00, 5000.00) mas
    1134: (  1.5,   0.5) m, (5000.00, 5000.00) mas
    1181: (  2.0,   0.7) m, (5000.00, 5000.00) mas
    1227: (  2.6,   0.9) m, (5000.00, 5000.00) mas
    1379: (  4.2,   1.5) m, (5000.00, 5000.00) mas
    1108: (  5.2,   0.3) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
      35: ( -2.6,  -4.6) m, (5000.00, 5000.00) mas
     169: ( -2.2,  -3.8) m, (5000.00, 5000.00) mas
     364: ( -1.7,  -2.8) m, (5000.00, 5000.00) mas
     584: ( -1.1,  -1.9) m, (5000.00, 5000.00) mas
     683: ( -0.9,  -1.5) m, (5000.00, 5000.00) mas
     954: (  1.3,  -0.3) m, (5000.00, 5000.00) mas
    1312: (  0.7,   1.3) m, (5000.00, 5000.00) mas
    1547: (  1.3,   2.2) m, (5000.00, 5000.00) mas
    1630: (  1.5,   2.6) m, (5000.00, 5000.00) mas
    1891: (  2.2,   4.0) m, (5000.00, 5000.00) mas
    1958: (  2.4,   4.4) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
      52: (  0.7,  -4.6) m, (5000.00, 5000.00) mas
     254: (  0.5,  -3.4) m, (5000.00, 5000.00) mas
     456: (  0.3,  -2.4) m, (5000.00, 5000.00) mas
     688: (  0.1,  -1.5) m, (5000.00, 5000.00) mas
    1041: ( -1.5,   0.1) m, (5000.00, 5000.00) mas
    1307: ( -0.3,   1.3) m, (5000.00, 5000.00) mas
    1538: ( -0.5,   2.2) m, (5000.00, 5000.00) mas
    1740: ( -0.7,   3.2) m, (5000.00, 5000.00) mas
    1941: ( -0.9,   4.4) m, (5000.00, 5000.00) mas
    1964: ( -2.4,   4.6) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
     349: (  3.4,  -3.0) m, (5000.00, 5000.00) mas
     553: (  2.2,  -2.0) m, (5000.00, 5000.00) mas
     740: (  1.3,  -1.3) m, (5000.00, 5000.00) mas
     781: (  1.1,  -1.1) m, (5000.00, 5000.00) mas
     819: ( -1.3,  -0.9) m, (5000.00, 5000.00) mas
    1214: ( -1.3,   0.9) m, (5000.00, 5000.00) mas
    1395: ( -2.2,   1.7) m, (5000.00, 5000.00) mas
    1442: ( -2.4,   1.9) m, (5000.00, 5000.00) mas
    1645: ( -3.6,   2.8) m, (5000.00, 5000.00) mas
    1897: ( -3.0,   4.2) m, (5000.00, 5000.00) mas

[00;00mSetting up powfs 2 PO WFS[00;00m

OTF dimension is 48x48 (calculated)
Generating matched filter for powfs 2
Use sanea to derive neasim
Use sanea to derive neasim

[00;00mSetting up reconstructor[00;00m

Recon NEA: cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) geom(0.31) geom(0.31) geom(0.31) mf(0.14)  mas
Setup or update control matrix parameters.
RRtwfs svd threshold is 1e-10
Replacing HA by HA*fit->actextrap
Adding piston cr to fit matrix
Adding TT cr on upper DMs to fit matrix.
Before assembling fit matrix:	3878.4 MiB.
Building fit->FR
Building fit->FL
Adding tikhonov constraint of 1.0e-07 to FLM
The maximum eigen value is estimated to be around 3.1e-04
DM Fit number of Low rank terms: 16 in LHS
After assemble fit matrix:	5074.3 MiB.
After setup_recon:	5074.3 MiB.
GPU 0: mem used 1638 MB (wfs init)
GPU 0: mem used 2384 MB (recon init)
GPU 0: mem used 2414 MB (perf init)

*** Simulation started at 2025/02/17 14:58:10 in nid001972. ***

Running seed 1
GPU 0: mem used 2416 MB (wfs seeding)
Wind dir: 267.3 261.7 167.0 130.5 300.7  32.3 119.8 139.0 150.8 277.7 203.0 133.1  45.9 265.1 deg
Using /global/homes/b/bpeck/.aos/cache/atm/vonkarman_14_8192x8192_0.0078125_1115374592d.bin
After genatm:	5036.4 MiB.
Step     #  Open Loop  PR TT  On axis  PR TT  Field RMS PR TT     Timing 
Step     0: OL  884.6  248.3  OA  884.6 248.3 CL  884.6 248.3 nm  0.088 s
Step    20: OL  915.2  255.8  OA  729.3 251.5 CL  729.3 251.5 nm  0.092 s
Step    37: OL  941.4  260.2  OA  716.0 249.0 CL  716.0 249.0 nm  0.054 s
Step    55: OL  968.2  261.3  OA  698.5 242.8 CL  698.5 242.8 nm  0.054 s
Step    73: OL  995.7  259.7  OA  682.4 237.3 CL  682.4 237.3 nm  0.056 s
Step    91: OL 1024.2  258.2  OA  669.5 232.0 CL  669.5 232.0 nm  0.065 s
Step   109: OL 1053.1  257.9  OA  660.2 228.1 CL  660.2 228.1 nm  0.054 s
Step   127: OL 1081.1  260.0  OA  656.3 223.7 CL  656.3 223.7 nm  0.056 s
Step   145: OL 1106.8  265.7  OA  653.6 221.1 CL  653.6 221.1 nm  0.061 s
Step   163: OL 1128.9  274.3  OA  652.5 219.9 CL  652.5 219.9 nm  0.056 s
Step   180: OL 1146.1  284.5  OA  655.2 223.9 CL  655.2 223.9 nm  0.056 s
Step   198: OL 1159.3  296.2  OA  660.4 229.7 CL  660.4 229.7 nm  0.057 s
Step   216: OL 1168.8  307.6  OA  669.4 239.5 CL  669.4 239.5 nm  0.059 s
Step   234: OL 1174.0  319.4  OA  681.9 251.6 CL  681.9 251.6 nm  0.056 s
Step   252: OL 1174.2  332.0  OA  690.5 266.0 CL  690.5 266.0 nm  0.055 s
Step   255 updated high order loop gain: 0.423
Step   270: OL 1166.9  344.9  OA  699.1 281.5 CL  699.1 281.5 nm  0.056 s
Step   288: OL 1153.2  358.4  OA  704.2 297.6 CL  704.2 297.6 nm  0.063 s
Step   305: OL 1136.9  373.2  OA  707.6 312.8 CL  707.6 312.8 nm  0.054 s
Step   323: OL 1115.9  390.2  OA  710.5 327.4 CL  710.5 327.4 nm  0.055 s
Step   341: OL 1093.0  410.2  OA  714.1 346.2 CL  714.1 346.2 nm  0.061 s
Step   359: OL 1069.7  433.5  OA  719.7 366.8 CL  719.7 366.8 nm  0.054 s
Step   377: OL 1047.7  459.1  OA  727.4 388.0 CL  727.4 388.0 nm  0.057 s
Step   394: OL 1027.9  483.7  OA  736.0 407.9 CL  736.0 407.9 nm  0.062 s
Step   412: OL 1006.6  509.2  OA  742.8 426.5 CL  742.8 426.5 nm  0.057 s
Step   430: OL  984.5  533.2  OA  748.8 444.9 CL  748.8 444.9 nm  0.055 s
Step   448: OL  963.7  556.7  OA  752.5 463.5 CL  752.5 463.5 nm  0.055 s
Step   466: OL  947.3  580.3  OA  756.6 480.1 CL  756.6 480.1 nm  0.055 s
Step   484: OL  938.2  603.2  OA  767.7 496.9 CL  767.7 496.9 nm  0.062 s
Step   502: OL  936.4  624.6  OA  782.4 512.6 CL  782.4 512.6 nm  0.056 s
Step   511 updated high order loop gain: 0.426
Step   520: OL  938.8  643.2  OA  798.0 526.6 CL  798.0 526.6 nm  0.055 s
Step   537: OL  944.6  656.4  OA  811.7 534.6 CL  811.7 534.6 nm  0.079 s
Step   554: OL  954.5  664.9  OA  823.8 539.3 CL  823.8 539.3 nm  0.056 s
Step   572: OL  968.7  669.7  OA  835.0 538.9 CL  835.0 538.9 nm  0.056 s
Step   590: OL  986.2  670.7  OA  841.6 532.1 CL  841.6 532.1 nm  0.064 s
Step   608: OL 1006.1  666.6  OA  849.7 523.5 CL  849.7 523.5 nm  0.056 s
Step   626: OL 1026.6  657.5  OA  848.0 508.6 CL  848.0 508.6 nm  0.055 s
Step   644: OL 1046.0  644.1  OA  840.4 491.1 CL  840.4 491.1 nm  0.063 s
Step   662: OL 1062.9  627.4  OA  826.3 471.5 CL  826.3 471.5 nm  0.057 s
Step   680: OL 1077.8  608.7  OA  811.0 449.4 CL  811.0 449.4 nm  0.058 s
Step   696: OL 1089.5  591.7  OA  796.0 429.2 CL  796.0 429.2 nm  0.055 s
Step   714: OL 1098.7  570.4  OA  777.3 403.3 CL  777.3 403.3 nm  0.056 s
Step   732: OL 1102.3  548.1  OA  757.9 377.5 CL  757.9 377.5 nm  0.057 s
Step   750: OL 1100.1  526.0  OA  735.3 352.8 CL  735.3 352.8 nm  0.056 s
Step   767 updated high order loop gain: 0.427
Step   768: OL 1092.5  504.9  OA  710.3 330.3 CL  710.3 330.3 nm  0.068 s
Step   786: OL 1079.3  484.7  OA  685.9 309.9 CL  685.9 309.9 nm  0.056 s
Step   804: OL 1060.4  464.6  OA  662.5 290.9 CL  662.5 290.9 nm  0.055 s
Step   821: OL 1038.7  445.7  OA  645.4 273.1 CL  645.4 273.1 nm  0.064 s
Step   839: OL 1011.7  426.2  OA  629.3 253.6 CL  629.3 253.6 nm  0.056 s
Step   857: OL  983.3  408.3  OA  617.3 234.6 CL  617.3 234.6 nm  0.058 s
Step   875: OL  956.0  392.8  OA  609.6 218.0 CL  609.6 218.0 nm  0.066 s
Step   893: OL  930.7  380.0  OA  607.8 203.9 CL  607.8 203.9 nm  0.057 s
Step   911: OL  904.3  369.3  OA  602.9 194.0 CL  602.9 194.0 nm  0.057 s
Step   929: OL  877.9  360.6  OA  597.0 186.6 CL  597.0 186.6 nm  0.056 s
Step   947: OL  852.7  352.0  OA  589.3 180.9 CL  589.3 180.9 nm  0.055 s
Step   965: OL  830.1  342.6  OA  583.2 175.2 CL  583.2 175.2 nm  0.061 s
Step   983: OL  811.7  331.8  OA  583.0 169.0 CL  583.0 169.0 nm  0.056 s
Step  1001: OL  795.9  319.2  OA  583.6 162.1 CL  583.6 162.1 nm  0.057 s
Step  1019: OL  782.1  305.5  OA  580.6 155.3 CL  580.6 155.3 nm  0.062 s
Step  1023 updated high order loop gain: 0.427
Step  1036: OL  771.3  291.9  OA  576.7 149.5 CL  576.7 149.5 nm  0.056 s
Step  1047: OL  764.9  282.4  OA  574.7 145.7 CL  574.7 145.7 nm  0.056 s
Step  1064: OL  754.8  266.2  OA  567.2 135.6 CL  567.2 135.6 nm  0.065 s
Step  1082: OL  746.5  246.1  OA  562.8 122.5 CL  562.8 122.5 nm  0.055 s
Step  1100: OL  742.0  225.5  OA  556.4 103.6 CL  556.4 103.6 nm  0.055 s
Step  1118: OL  739.8  207.3  OA  553.9  85.8 CL  553.9  85.8 nm  0.063 s
Step  1136: OL  738.9  192.5  OA  551.8  66.9 CL  551.8  66.9 nm  0.055 s
Step  1154: OL  738.6  181.2  OA  553.3  53.2 CL  553.3  53.2 nm  0.055 s
Step  1172: OL  738.2  173.7  OA  554.4  44.0 CL  554.4  44.0 nm  0.056 s
Step  1190: OL  740.0  169.1  OA  565.4  38.2 CL  565.4  38.2 nm  0.055 s
Step  1206: OL  742.9  166.0  OA  578.3  34.5 CL  578.3  34.5 nm  0.056 s
Step  1224: OL  746.5  163.7  OA  592.3  35.9 CL  592.3  35.9 nm  0.056 s
Step  1242: OL  749.4  164.5  OA  603.6  43.5 CL  603.6  43.5 nm  0.056 s
Step  1260: OL  752.8  169.4  OA  612.6  55.3 CL  612.6  55.3 nm  0.056 s
Step  1278: OL  757.5  178.0  OA  620.6  67.4 CL  620.6  67.4 nm  0.065 s
Step  1279 updated high order loop gain: 0.427
Step  1296: OL  764.4  189.0  OA  626.3  77.3 CL  626.3  77.3 nm  0.056 s
Step  1314: OL  770.7  202.0  OA  628.1  84.8 CL  628.1  84.8 nm  0.054 s
Step  1331: OL  776.4  216.2  OA  625.9  93.3 CL  625.9  93.3 nm  0.061 s
Step  1349: OL  784.4  232.5  OA  620.9  99.7 CL  620.9  99.7 nm  0.055 s
Step  1367: OL  795.1  247.7  OA  621.5 103.0 CL  621.5 103.0 nm  0.055 s
Step  1381: OL  804.1  257.0  OA  622.3 103.8 CL  622.3 103.8 nm  0.070 s
Step  1399: OL  817.2  266.0  OA  628.9  99.7 CL  628.9  99.7 nm  0.056 s
Step  1417: OL  832.2  271.9  OA  636.4  96.0 CL  636.4  96.0 nm  0.055 s
Step  1435: OL  847.5  276.1  OA  642.4  90.2 CL  642.4  90.2 nm  0.056 s
Step  1453: OL  861.4  279.1  OA  646.3  83.3 CL  646.3  83.3 nm  0.055 s
Step  1471: OL  872.6  279.5  OA  646.4  77.5 CL  646.4  77.5 nm  0.059 s
Step  1489: OL  877.5  276.6  OA  642.2  72.4 CL  642.2  72.4 nm  0.055 s
Step  1507: OL  876.6  270.4  OA  631.9  70.9 CL  631.9  70.9 nm  0.056 s
Step  1525: OL  871.5  261.9  OA  621.0  68.9 CL  621.0  68.9 nm  0.065 s
Step  1535 updated high order loop gain: 0.428
Step  1542: OL  863.8  251.7  OA  612.6  65.2 CL  612.6  65.2 nm  0.055 s
Step  1559: OL  855.5  240.5  OA  606.7  58.7 CL  606.7  58.7 nm  0.057 s
Step  1577: OL  846.9  229.8  OA  603.2  55.8 CL  603.2  55.8 nm  0.061 s
Step  1595: OL  837.7  221.6  OA  598.1  56.9 CL  598.1  56.9 nm  0.055 s
Step 1599: Output PSF
Step  1599: OL  835.6  219.9  OA  597.9  58.0 CL  597.9  58.0 nm  1.961 s
Mean: 673.54 294.47 605.76  nm.

*** Simulation Finished at 2025/02/17 14:59:53 in nid001972. ***

[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
/global/cfs/cdirs/ulens/vismcao/maos -o studies/reduced_ngs/9_lgs/8mag_lgs/2750count -c master_files/reduced_ngs/9_lgs/8mag_lgs/kola_2750act.conf -O 
Output folder is 'studies/reduced_ngs/9_lgs/8mag_lgs/2750count'.
SRC: /global/homes/b/bpeck/code/maos v2.9 4c88b7c2 2024-11-13 16:45:33 -0800
BUILT: /global/homes/b/bpeck/code/maos/optim by GCC (v12) on 2024/11/18 09:40:03 CPU(F64,+O3) with CUDA(v122,F32)
Launched at 2025/02/17 14:59:54 in nid001972 with PID 1692794.
The web based job monitor can be accessed at http://localhost:10300
Main config file is /global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_2750act.conf
[00;00m[0;36mWarning(path.c:48): Path not found: path=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; abspath=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; Ignored.
[00;00m[0;36mWarning(path.c:48): Path not found: path=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; abspath=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; Ignored.
[00;00m[0;36mWarning(readcfg.c:399): sim.apfsm has been renamed to powfs.apfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.epfsm has been renamed to powfs.epfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.alfsm has been renamed to powfs.alfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.commonfsm has been renamed to powfs.commonfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.idealfsm has been renamed to powfs.idealfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.zetafsm has been renamed to powfs.zetafsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.f0fsm has been renamed to powfs.f0fsm.
[00;00m[0;36mWarning(readcfg.c:399): tsurf has been renamed to ncpa.tsurf.
loaded 132 (132 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_sim.conf'
loaded  19 ( 19 new) records from '/global/cfs/cdirs/ulens/vismcao/./dm_none.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_ASM.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_DM2.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_DM3.conf'
loaded   0 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_dm_multiple.conf'
loaded   7 (  5 new) records from '/global/cfs/cdirs/ulens/vismcao/./atm_mk13n50p_ground_detail.conf'
loaded  76 ( 69 new) records from '/global/homes/b/bpeck/code/maos/config/maos/powfs_common.conf'
loaded  44 ( 38 new) records from '/global/cfs/cdirs/ulens/vismcao/./powfs_none.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_lgs.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_ttf_strap.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_twfs_lbwfs.conf'
loaded   0 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_wfs_lgs_strap_lbwfs.conf'
loaded  71 ( 71 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_recon.conf'
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_smooth has been renamed to powfs0_llt.na_smooth.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_interp has been renamed to powfs0_llt.na_interp.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_thres has been renamed to powfs0_llt.na_thres.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_maxit has been renamed to powfs0_llt.na_fit_maxit.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_svdthres has been renamed to powfs0_llt.na_fit_svdthres.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_dh has been renamed to powfs0_llt.na_fit_dh.
[00;00m[0;36mWarning(readcfg.c:399): dbg.ncpa_preload has been renamed to ncpa.preload.
[00;00m[0;36mWarning(readcfg.c:399): dbg.ncpa_rmsci has been renamed to ncpa.rmsci.
[00;00m[0;36mWarning(readcfg.c:399): dbg.draw_opdmax has been renamed to plot.opdmax.
[00;00m[0;36mWarning(readcfg.c:399): dbg.draw_gmax has been renamed to plot.gmax.
loaded  95 ( 93 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_dbg.conf'
loaded   4 (  4 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_fit_mcao.conf'
[00;00m[0;36mWarning(readcfg.c:399): surf has been renamed to ncpa.surf.
loaded  39 (  7 new) records from '/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_2750act.conf'
loaded   0 (  0 new) records from 'command line'
loaded  24 ( 18 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_llt_CL.conf'
Adjust LGS range by telescope altitude 4145m.
Zenith angle is 30 degree.
    Scaling turbulence height and LGS hs by sec(za).
    Scaling r0 by cos(za)^(3/5).
    Scaling wind speed and LGS signal level by cos(za).
powfs0: Adjusting dx from 0.0078125 to 0.00775. 
powfs0.llt.fsm: f0=0 Hz, LPF ep=0
powfs0.epfsm is set to 0.517618 (auto)
powfs2: Adjusting dx from 0.03125 to 0.0312778. 
powfs2 is TWFS for powfs0
sim.ephi is set to 0.427717 (auto)
sim.eplo is set to 0.427717 (auto)
[00;00m[0;36mWarning(parms.c:2296): Layer 1 at 17.3205m is very close to layer 0 at 0m (OK).
[00;00m[0;36mWarning(parms.c:2296): Layer 2 at 34.641m is very close to layer 1 at 17.3205m (OK).
[00;00m[0;36mWarning(parms.c:2296): Layer 3 at 51.9615m is very close to layer 2 at 34.641m (OK).
dm 0: stroke=30 um is provided in micron.
dm 0: assume ia stroke=2 um is provided in micron.
dm 1: stroke=7 um is provided in micron.
dm 1: assume ia stroke=2 um is provided in micron.
dm 2: stroke=7 um is provided in micron.
dm 2: assume ia stroke=2 um is provided in micron.
Focus blending is not implemented yet for integrated tomography
parms->sim.mffocus is reset to 0
There are 1 valid simulation seeds:  1
Output PSF for 1 directions
Used 449 of 456 supplied keys
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_flate" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_flatv" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_psx" is not recognized, value is [0 0 0 0]
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_psy" is not recognized, value is [0 0 0 0]
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_pupelong" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_raw" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_side" is not recognized, value is 4
[00;00mAperture[00;00m is 11 m with sampling 1/128 m
[00;00mTurbulence at 30 degree zenith angle:[00;00m r0=0.128424m, L0=30m, 14 layers.
    Greenwood freq is 25.1Hz, anisoplanatic angle is 1.58 as
    Sampled 8192x8192 at 1/128m. wind dir is randomized.
    layer 0: ht=      0 m, wt= 0.302, ws=  4.8 m/s
    layer 1: ht=     17 m, wt= 0.154, ws=  5.0 m/s
    layer 2: ht=     35 m, wt= 0.041, ws=  5.4 m/s
    layer 3: ht=     52 m, wt= 0.002, ws=  6.6 m/s
    layer 4: ht=    139 m, wt= 0.021, ws=  6.1 m/s
    layer 5: ht=    231 m, wt= 0.010, ws=  6.1 m/s
    layer 6: ht=    323 m, wt= 0.008, ws=  6.1 m/s
    layer 7: ht=    416 m, wt= 0.005, ws=  6.1 m/s
    layer 8: ht=    508 m, wt= 0.001, ws=  6.1 m/s
    layer 9: ht=    932 m, wt= 0.107, ws=  5.6 m/s
    layer 10: ht=   5022 m, wt= 0.144, ws= 11.1 m/s
    layer 11: ht=   9238 m, wt= 0.093, ws= 19.1 m/s
    layer 12: ht=  13856 m, wt= 0.075, ws=  8.2 m/s
    layer 13: ht=  22518 m, wt= 0.036, ws=  4.8 m/s
[00;00mReconstruction[00;00m: r0=0.128424m L0=30m. 14 layers. use cone coordinate.
    layer 0: ht=      0 m, wt= 0.302
    layer 1: ht=     17 m, wt= 0.154
    layer 2: ht=     35 m, wt= 0.041
    layer 3: ht=     52 m, wt= 0.002
    layer 4: ht=    139 m, wt= 0.021
    layer 5: ht=    231 m, wt= 0.010
    layer 6: ht=    323 m, wt= 0.008
    layer 7: ht=    416 m, wt= 0.005
    layer 8: ht=    508 m, wt= 0.001
    layer 9: ht=    932 m, wt= 0.107
    layer 10: ht=   5022 m, wt= 0.144
    layer 11: ht=   9238 m, wt= 0.093
    layer 12: ht=  13856 m, wt= 0.075
    layer 13: ht=  22518 m, wt= 0.036
[00;00mThere are 3 powfs[00;00m
  powfs0: Order 60, LGS at 99.1 km. Sampling 1/129.032 m. Thres 30%. [00;00mT/T is removed in right hand side in tomography.[00;00m
    CCD image is 25x25 @ 500x500 mas, blur 27% (sigma), 1500Hz, wvl: [ 5.89e-07]
    Gtilt in reconstruction. Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
  powfs1: Order  2, NGS at inf km. Sampling 1/16 m. Thres 30%. 
    Ztilt in reconstruction. Geomtric optics start at 2 with ztilt [00;00m(noisy)[00;00m
  powfs2: Order 20, NGS at inf km. Sampling 1/31.9716 m. Thres 50%. 
    CCD image is 4x4 @ 1500x1500 mas, blur 0% (sigma), 0.015Hz, wvl: [ 7.2e-07]
    Gtilt in reconstruction. Geomtric optics start at 50 with gtilt Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
[00;00mThere are 13 wfs[00;00m
    wfs 0: type 0, at (  30.00,    0.00) arcsec,  99 km, siglev is 41.4818 bkgrnd is 0.1
    wfs 1: type 0, at (  22.98,   19.28) arcsec,  99 km, siglev is 41.4818 bkgrnd is 0.1
    wfs 2: type 0, at (   5.21,   29.54) arcsec,  99 km, siglev is 41.4818 bkgrnd is 0.1
    wfs 3: type 0, at ( -15.00,   25.98) arcsec,  99 km, siglev is 41.4818 bkgrnd is 0.1
    wfs 4: type 0, at ( -28.19,   10.26) arcsec,  99 km, siglev is 41.4818 bkgrnd is 0.1
    wfs 5: type 0, at ( -28.19,  -10.26) arcsec,  99 km, siglev is 41.4818 bkgrnd is 0.1
    wfs 6: type 0, at ( -15.00,  -25.98) arcsec,  99 km, siglev is 41.4818 bkgrnd is 0.1
    wfs 7: type 0, at (   5.21,  -29.54) arcsec,  99 km, siglev is 41.4818 bkgrnd is 0.1
    wfs 8: type 0, at (  22.98,  -19.28) arcsec,  99 km, siglev is 41.4818 bkgrnd is 0.1
    wfs 9: type 1, at (   5.00,    8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 10: type 1, at ( -10.00,    0.00) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 11: type 1, at (   5.00,   -8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 12: type 2, at (   0.00,    0.00) arcsec, inf km, siglev is 4.1558e+06 bkgrnd is 0.001
[00;00mThere are 3 DMs[00;00m
  DM 0 at -0.1km, actuator pitch 0.186m, offset   0, with 30.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 1 at    6km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 2 at   10km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
[00;00mTomography[00;00m is using CG, with [00;00mFourer Domain[00;00m preconditioner, [00;00m12[00;00m iterations, integrated tomo.
[00;00mDM Fitting [00;00mis using CG, with [00;00mNo[00;00m preconditioner, [00;00m10[00;00m iterations
[00;00mThere are 9 fit directions[00;00m
    Fit 0: weight is 0.444, at (   0.00,    0.00) arcsec
    Fit 1: weight is 0.111, at (  15.00,    0.00) arcsec
    Fit 2: weight is 0.111, at (   0.00,   15.00) arcsec
    Fit 3: weight is 0.111, at ( -15.00,    0.00) arcsec
    Fit 4: weight is 0.111, at (   0.00,  -15.00) arcsec
    Fit 5: weight is 0.028, at (  15.00,   15.00) arcsec
    Fit 6: weight is 0.028, at ( -15.00,   15.00) arcsec
    Fit 7: weight is 0.028, at ( -15.00,  -15.00) arcsec
    Fit 8: weight is 0.028, at (  15.00,  -15.00) arcsec
[00;00mThere are 1 evaluation directions[00;00m at sampling 1/128 m.
    Evl 0: weight is 1.000, at (   0.00,    0.00) arcsec
[00;00mSimulation[00;00m start at step 0, end at step 1600, with time step 1/1500s, [00;00mclose loop[00;00m.
After setup_parms:	120.4 MiB.
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
CUDA: minimum memory requirement is 0.3GB
GPU 0 is NVIDIA A100-SXM4-40GB with arch 8.0, 38.9GB free, 39.3GB total device memory.
Using GPU 0
Use 1 GPUs for WFS Tomo Fit Evl

*** Preparation started at 2025/02/17 14:59:54 in nid001972. ***

Using OpenMP version 201511 with 128 threads
Reading aperture amplitude map from KECK.fits
[00;00m[0;36mWarning(accphi.c:477): 108243 points not covered by input screen
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
 ->maos.c:447->setup.c:148->aper.c:74->utils.c:478->accphi.c:478
iwvl 0: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 1: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 2: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 3: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 4: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 5: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 6: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 7: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 8: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
After setup_aper:	342.8 MiB.

[00;00mSetting up powfs 0 geom[00;00m

There are 24 points in each subaperture of 0.186m.
There are 2160 valid subaperture.

[00;00mSetting up powfs 1 geom[00;00m

There are 88 points in each subaperture of 5.5m.
There are 4 valid subaperture.

[00;00mSetting up powfs 2 geom[00;00m

There are 18 points in each subaperture of 0.563m.
There are 236 valid subaperture.
After setup_powfs_init:	437.5 MiB.

[00;00mSetting up reconstructor geometry.[00;00m

PLOC is 123x123, with sampling of 0.09m (square)
    DM 0: grid is 63 x 63
    DM 1: grid is 75 x 75
    DM 2: grid is 80 x 79
FLOC is 123x123, with sampling of 0.09m (not square)
Tomography grid is square:
    layer 0: xloc grid is 216 x 216, sampling is 0.093 m, 46656 points
    layer 1: xloc grid is 216 x 216, sampling is 0.093 m, 46656 points
    layer 2: xloc grid is 216 x 216, sampling is 0.093 m, 46656 points
    layer 3: xloc grid is 216 x 216, sampling is 0.093 m, 46656 points
    layer 4: xloc grid is 216 x 216, sampling is 0.093 m, 46656 points
    layer 5: xloc grid is 216 x 216, sampling is 0.093 m, 46656 points
    layer 6: xloc grid is 216 x 216, sampling is 0.093 m, 46656 points
    layer 7: xloc grid is 216 x 216, sampling is 0.093 m, 46656 points
    layer 8: xloc grid is 216 x 216, sampling is 0.093 m, 46656 points
    layer 9: xloc grid is 216 x 216, sampling is 0.092 m, 46656 points
    layer 10: xloc grid is 216 x 216, sampling is 0.088 m, 46656 points
    layer 11: xloc grid is 216 x 216, sampling is 0.084 m, 46656 points
    layer 12: xloc grid is 216 x 216, sampling is 0.080 m, 46656 points
    layer 13: xloc grid is 216 x 216, sampling is 0.072 m, 46656 points

[00;00mSetting up powfs 0 PO WFS[00;00m

OTF dimension is 48x48 (calculated)
Uplink FWHM (illt 0, iwvl 0) is 0.578423"
Downlink FWHM (illt 0, iwvl 0) is 0"
Generating matched filter for powfs 0
sa index   location       noise equivalent angle
    1076: (  4.8,  -0.2) m, (5000.00, 5000.00) mas
    1070: (  3.7,  -0.2) m, (5000.00, 5000.00) mas
    1064: (  2.6,  -0.2) m, (5000.00, 5000.00) mas
    1058: (  1.5,  -0.2) m, (5000.00, 5000.00) mas
    1057: (  1.3,  -0.2) m, (5000.00, 5000.00) mas
     732: ( -0.6,  -1.5) m, (5000.00, 5000.00) mas
    1053: ( -1.7,  -0.2) m, (5000.00, 5000.00) mas
    1047: ( -2.8,  -0.2) m, (5000.00, 5000.00) mas
    1041: ( -3.9,  -0.2) m, (5000.00, 5000.00) mas
    1035: ( -5.0,  -0.2) m, (5000.00, 5000.00) mas
    1033: ( -5.4,  -0.2) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    1854: (  3.7,   3.0) m, (5000.00, 5000.00) mas
    1767: (  3.2,   2.6) m, (5000.00, 5000.00) mas
    1539: (  2.0,   1.7) m, (5000.00, 5000.00) mas
    1334: (  1.1,   0.9) m, (5000.00, 5000.00) mas
    1288: (  0.9,   0.7) m, (5000.00, 5000.00) mas
    1287: ( -1.1,   0.7) m, (5000.00, 5000.00) mas
     872: ( -1.1,  -0.9) m, (5000.00, 5000.00) mas
     623: ( -2.2,  -1.9) m, (5000.00, 5000.00) mas
     573: ( -2.4,  -2.0) m, (5000.00, 5000.00) mas
     395: ( -3.3,  -2.8) m, (5000.00, 5000.00) mas
      60: ( -3.0,  -4.5) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    2149: (  0.7,   4.7) m, (5000.00, 5000.00) mas
    1987: (  0.6,   3.7) m, (5000.00, 5000.00) mas
    1752: (  0.4,   2.6) m, (5000.00, 5000.00) mas
    1479: (  0.2,   1.5) m, (5000.00, 5000.00) mas
    1429: (  0.2,   1.3) m, (5000.00, 5000.00) mas
    1006: ( -1.5,  -0.4) m, (5000.00, 5000.00) mas
     683: ( -0.4,  -1.7) m, (5000.00, 5000.00) mas
     410: ( -0.6,  -2.8) m, (5000.00, 5000.00) mas
     174: ( -0.7,  -3.9) m, (5000.00, 5000.00) mas
      12: ( -0.9,  -4.8) m, (5000.00, 5000.00) mas
       8: ( -2.2,  -4.8) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    2072: ( -2.6,   4.3) m, (5000.00, 5000.00) mas
    1903: ( -2.0,   3.3) m, (5000.00, 5000.00) mas
    1824: ( -1.9,   3.0) m, (5000.00, 5000.00) mas
    1522: ( -1.1,   1.7) m, (5000.00, 5000.00) mas
    1374: ( -0.7,   1.1) m, (5000.00, 5000.00) mas
     829: ( -0.9,  -1.1) m, (5000.00, 5000.00) mas
     739: (  0.7,  -1.5) m, (5000.00, 5000.00) mas
     640: (  0.9,  -1.9) m, (5000.00, 5000.00) mas
     338: (  1.7,  -3.2) m, (5000.00, 5000.00) mas
     258: (  1.9,  -3.5) m, (5000.00, 5000.00) mas
      89: (  2.4,  -4.5) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    1503: ( -4.7,   1.7) m, (5000.00, 5000.00) mas
    1454: ( -4.5,   1.5) m, (5000.00, 5000.00) mas
    1318: ( -3.0,   0.9) m, (5000.00, 5000.00) mas
    1280: ( -2.4,   0.7) m, (5000.00, 5000.00) mas
    1197: ( -1.5,   0.4) m, (5000.00, 5000.00) mas
    1332: (  0.7,   0.9) m, (5000.00, 5000.00) mas
     962: (  1.3,  -0.6) m, (5000.00, 5000.00) mas
     880: (  2.2,  -0.9) m, (5000.00, 5000.00) mas
     842: (  2.8,  -1.1) m, (5000.00, 5000.00) mas
     708: (  4.3,  -1.7) m, (5000.00, 5000.00) mas
    1030: (  5.2,  -0.4) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
     610: ( -4.7,  -1.9) m, (5000.00, 5000.00) mas
     661: ( -4.5,  -1.7) m, (5000.00, 5000.00) mas
     818: ( -3.0,  -1.1) m, (5000.00, 5000.00) mas
     865: ( -2.4,  -0.9) m, (5000.00, 5000.00) mas
     959: ( -1.5,  -0.6) m, (5000.00, 5000.00) mas
     831: (  0.7,  -1.1) m, (5000.00, 5000.00) mas
    1200: (  1.3,   0.4) m, (5000.00, 5000.00) mas
    1295: (  2.2,   0.7) m, (5000.00, 5000.00) mas
    1343: (  2.8,   0.9) m, (5000.00, 5000.00) mas
    1501: (  4.3,   1.5) m, (5000.00, 5000.00) mas
    1174: (  5.2,   0.2) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
      62: ( -2.6,  -4.5) m, (5000.00, 5000.00) mas
     237: ( -2.0,  -3.5) m, (5000.00, 5000.00) mas
     319: ( -1.9,  -3.2) m, (5000.00, 5000.00) mas
     629: ( -1.1,  -1.9) m, (5000.00, 5000.00) mas
     781: ( -0.7,  -1.3) m, (5000.00, 5000.00) mas
    1329: ( -0.9,   0.9) m, (5000.00, 5000.00) mas
    1432: (  0.7,   1.3) m, (5000.00, 5000.00) mas
    1533: (  0.9,   1.7) m, (5000.00, 5000.00) mas
    1843: (  1.7,   3.0) m, (5000.00, 5000.00) mas
    1924: (  1.9,   3.3) m, (5000.00, 5000.00) mas
    2099: (  2.4,   4.3) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
      17: (  0.7,  -4.8) m, (5000.00, 5000.00) mas
     181: (  0.6,  -3.9) m, (5000.00, 5000.00) mas
     415: (  0.4,  -2.8) m, (5000.00, 5000.00) mas
     686: (  0.2,  -1.7) m, (5000.00, 5000.00) mas
     736: (  0.2,  -1.5) m, (5000.00, 5000.00) mas
    1150: ( -1.5,   0.2) m, (5000.00, 5000.00) mas
    1476: ( -0.4,   1.5) m, (5000.00, 5000.00) mas
    1747: ( -0.6,   2.6) m, (5000.00, 5000.00) mas
    1980: ( -0.7,   3.7) m, (5000.00, 5000.00) mas
    2144: ( -0.9,   4.7) m, (5000.00, 5000.00) mas
    2140: ( -2.2,   4.7) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
     349: (  3.7,  -3.2) m, (5000.00, 5000.00) mas
     430: (  3.2,  -2.8) m, (5000.00, 5000.00) mas
     646: (  2.0,  -1.9) m, (5000.00, 5000.00) mas
     833: (  1.1,  -1.1) m, (5000.00, 5000.00) mas
     873: (  0.9,  -0.9) m, (5000.00, 5000.00) mas
     872: ( -1.1,  -0.9) m, (5000.00, 5000.00) mas
    1287: ( -1.1,   0.7) m, (5000.00, 5000.00) mas
    1516: ( -2.2,   1.7) m, (5000.00, 5000.00) mas
    1564: ( -2.4,   1.9) m, (5000.00, 5000.00) mas
    1732: ( -3.3,   2.6) m, (5000.00, 5000.00) mas
    2070: ( -3.0,   4.3) m, (5000.00, 5000.00) mas

[00;00mSetting up powfs 2 PO WFS[00;00m

OTF dimension is 48x48 (calculated)
Generating matched filter for powfs 2
Use sanea to derive neasim
Use sanea to derive neasim

[00;00mSetting up reconstructor[00;00m

Recon NEA: cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) geom(0.31) geom(0.31) geom(0.31) mf(0.14)  mas
Setup or update control matrix parameters.
RRtwfs svd threshold is 1e-10
Replacing HA by HA*fit->actextrap
Adding piston cr to fit matrix
Adding TT cr on upper DMs to fit matrix.
Before assembling fit matrix:	4066.1 MiB.
Building fit->FR
Building fit->FL
Adding tikhonov constraint of 1.0e-07 to FLM
The maximum eigen value is estimated to be around 3.1e-04
DM Fit number of Low rank terms: 16 in LHS
After assemble fit matrix:	5400.0 MiB.
After setup_recon:	5400.0 MiB.
GPU 0: mem used 1680 MB (wfs init)
GPU 0: mem used 2466 MB (recon init)
GPU 0: mem used 2496 MB (perf init)

*** Simulation started at 2025/02/17 15:00:57 in nid001972. ***

Running seed 1
GPU 0: mem used 2496 MB (wfs seeding)
Wind dir: 267.3 261.7 167.0 130.5 300.7  32.3 119.8 139.0 150.8 277.7 203.0 133.1  45.9 265.1 deg
Using /global/homes/b/bpeck/.aos/cache/atm/vonkarman_14_8192x8192_0.0078125_1115374592d.bin
After genatm:	5337.2 MiB.
Step     #  Open Loop  PR TT  On axis  PR TT  Field RMS PR TT     Timing 
Step     0: OL  884.6  248.3  OA  884.6 248.3 CL  884.6 248.3 nm  0.107 s
Step    19: OL  913.7  255.5  OA  735.0 249.1 CL  735.0 249.1 nm  0.050 s
Step    36: OL  939.8  260.0  OA  722.5 247.3 CL  722.5 247.3 nm  0.070 s
Step    52: OL  963.7  261.3  OA  707.5 242.1 CL  707.5 242.1 nm  0.061 s
Step    68: OL  987.9  260.2  OA  692.1 235.5 CL  692.1 235.5 nm  0.060 s
Step    84: OL 1013.1  258.6  OA  678.3 229.7 CL  678.3 229.7 nm  0.065 s
Step   100: OL 1038.7  257.8  OA  669.2 226.4 CL  669.2 226.4 nm  0.061 s
Step   117: OL 1065.9  258.5  OA  665.5 222.4 CL  665.5 222.4 nm  0.062 s
Step   134: OL 1091.4  261.8  OA  660.8 217.6 CL  660.8 217.6 nm  0.060 s
Step   151: OL 1114.8  268.3  OA  659.5 214.7 CL  659.5 214.7 nm  0.062 s
Step   167: OL 1133.5  276.6  OA  658.2 214.3 CL  658.2 214.3 nm  0.060 s
Step   184: OL 1149.8  287.1  OA  660.9 218.0 CL  660.9 218.0 nm  0.063 s
Step   201: OL 1161.5  298.1  OA  665.5 223.6 CL  665.5 223.6 nm  0.061 s
Step   217: OL 1169.7  308.3  OA  674.3 232.7 CL  674.3 232.7 nm  0.066 s
Step   234: OL 1174.7  319.4  OA  685.8 243.3 CL  685.8 243.3 nm  0.060 s
Step   250: OL 1175.4  330.5  OA  692.8 255.5 CL  692.8 255.5 nm  0.059 s
Step   255 updated high order loop gain: 0.423
Step   266: OL 1170.1  342.0  OA  701.2 269.0 CL  701.2 269.0 nm  0.068 s
Step   283: OL 1158.7  354.5  OA  706.2 283.1 CL  706.2 283.1 nm  0.060 s
Step   300: OL 1143.5  368.7  OA  708.8 298.9 CL  708.8 298.9 nm  0.060 s
Step   317: OL 1125.0  384.4  OA  712.7 315.0 CL  712.7 315.0 nm  0.059 s
Step   333: OL 1105.1  401.0  OA  716.0 330.4 CL  716.0 330.4 nm  0.061 s
Step   349: OL 1084.6  420.3  OA  720.4 348.2 CL  720.4 348.2 nm  0.068 s
Step   365: OL 1064.3  442.0  OA  725.4 369.1 CL  725.4 369.1 nm  0.061 s
Step   382: OL 1043.9  466.3  OA  733.6 390.9 CL  733.6 390.9 nm  0.061 s
Step   398: OL 1025.3  489.4  OA  740.3 410.0 CL  740.3 410.0 nm  0.069 s
Step   415: OL 1004.9  513.3  OA  748.9 428.6 CL  748.9 428.6 nm  0.059 s
Step   432: OL  984.1  535.9  OA  754.9 447.0 CL  754.9 447.0 nm  0.059 s
Step   448: OL  965.5  556.8  OA  758.5 464.5 CL  758.5 464.5 nm  0.061 s
Step   465: OL  949.8  579.0  OA  763.3 481.4 CL  763.3 481.4 nm  0.061 s
Step   482: OL  940.4  600.7  OA  773.9 498.9 CL  773.9 498.9 nm  0.068 s
Step   493: OL  938.1  614.2  OA  782.6 509.2 CL  782.6 509.2 nm  0.065 s
Step   509: OL  938.1  632.3  OA  797.1 522.8 CL  797.1 522.8 nm  0.059 s
Step   511 updated high order loop gain: 0.426
Step   525: OL  941.3  647.6  OA  811.8 534.9 CL  811.8 534.9 nm  0.064 s
Step   541: OL  947.5  658.8  OA  824.4 542.7 CL  824.4 542.7 nm  0.069 s
Step   557: OL  957.4  666.0  OA  836.8 545.6 CL  836.8 545.6 nm  0.062 s
Step   573: OL  970.3  669.8  OA  848.1 546.9 CL  848.1 546.9 nm  0.060 s
Step   590: OL  986.8  670.7  OA  854.7 540.8 CL  854.7 540.8 nm  0.067 s
Step   606: OL 1004.3  667.4  OA  863.7 534.4 CL  863.7 534.4 nm  0.060 s
Step   623: OL 1023.6  659.4  OA  863.0 521.3 CL  863.0 521.3 nm  0.059 s
Step   639: OL 1041.1  648.2  OA  858.4 506.0 CL  858.4 506.0 nm  0.066 s
Step   656: OL 1057.7  633.3  OA  847.2 487.5 CL  847.2 487.5 nm  0.059 s
Step   673: OL 1072.2  616.0  OA  832.9 468.0 CL  832.9 468.0 nm  0.072 s
Step   690: OL 1085.4  598.3  OA  819.3 447.1 CL  819.3 447.1 nm  0.061 s
Step   707: OL 1095.6  578.9  OA  803.6 423.7 CL  803.6 423.7 nm  0.061 s
Step   723: OL 1101.1  559.2  OA  785.2 398.9 CL  785.2 398.9 nm  0.068 s
Step   740: OL 1101.8  538.3  OA  765.7 373.6 CL  765.7 373.6 nm  0.058 s
Step   757: OL 1097.5  517.7  OA  742.7 349.9 CL  742.7 349.9 nm  0.062 s
Step   767 updated high order loop gain: 0.427
Step   773: OL 1089.2  499.3  OA  720.4 328.5 CL  720.4 328.5 nm  0.062 s
Step   790: OL 1075.1  480.2  OA  698.0 310.6 CL  698.0 310.6 nm  0.061 s
Step   806: OL 1057.7  462.4  OA  677.8 292.4 CL  677.8 292.4 nm  0.066 s
Step   822: OL 1036.9  444.6  OA  659.8 275.1 CL  659.8 275.1 nm  0.060 s
Step   839: OL 1011.3  426.3  OA  644.1 256.7 CL  644.1 256.7 nm  0.061 s
Step   855: OL  986.1  410.2  OA  632.8 238.9 CL  632.8 238.9 nm  0.068 s
Step   871: OL  961.5  396.1  OA  624.1 223.6 CL  624.1 223.6 nm  0.059 s
Step   888: OL  937.6  383.4  OA  620.2 212.2 CL  620.2 212.2 nm  0.061 s
Step   904: OL  914.7  373.1  OA  616.5 202.3 CL  616.5 202.3 nm  0.068 s
Step   921: OL  889.6  364.5  OA  609.9 196.1 CL  609.9 196.1 nm  0.062 s
Step   938: OL  865.4  356.4  OA  604.5 191.6 CL  604.5 191.6 nm  0.061 s
Step   954: OL  843.9  348.5  OA  596.5 186.9 CL  596.5 186.9 nm  0.066 s
Step   969: OL  826.4  340.4  OA  592.7 184.0 CL  592.7 184.0 nm  0.061 s
Step   986: OL  809.9  329.8  OA  590.6 179.6 CL  590.6 179.6 nm  0.059 s
Step  1002: OL  796.1  318.5  OA  590.9 173.8 CL  590.9 173.8 nm  0.058 s
Step  1018: OL  783.9  306.3  OA  588.2 167.4 CL  588.2 167.4 nm  0.064 s
Step  1023 updated high order loop gain: 0.427
Step  1034: OL  773.5  293.6  OA  583.5 162.6 CL  583.5 162.6 nm  0.060 s
Step  1050: OL  764.2  279.8  OA  579.3 155.4 CL  579.3 155.4 nm  0.077 s
Step  1067: OL  754.1  263.1  OA  572.5 146.6 CL  572.5 146.6 nm  0.061 s
Step  1084: OL  746.7  243.7  OA  567.3 130.4 CL  567.3 130.4 nm  0.062 s
Step  1100: OL  742.6  225.6  OA  561.0 113.8 CL  561.0 113.8 nm  0.062 s
Step  1116: OL  740.4  209.2  OA  558.9  97.3 CL  558.9  97.3 nm  0.060 s
Step  1132: OL  739.3  195.5  OA  556.2  82.4 CL  556.2  82.4 nm  0.058 s
Step  1148: OL  738.8  184.6  OA  555.1  68.4 CL  555.1  68.4 nm  0.071 s
Step  1164: OL  738.3  176.5  OA  557.2  58.4 CL  557.2  58.4 nm  0.062 s
Step  1181: OL  738.6  171.2  OA  562.1  52.3 CL  562.1  52.3 nm  0.061 s
Step  1197: OL  741.0  167.7  OA  572.5  46.7 CL  572.5  46.7 nm  0.066 s
Step  1214: OL  744.1  164.6  OA  586.0  46.0 CL  586.0  46.0 nm  0.060 s
Step  1231: OL  747.6  163.5  OA  600.1  47.2 CL  600.1  47.2 nm  0.060 s
Step  1248: OL  750.2  165.6  OA  609.7  55.2 CL  609.7  55.2 nm  0.062 s
Step  1265: OL  754.0  171.5  OA  616.9  63.8 CL  616.9  63.8 nm  0.060 s
Step  1279 updated high order loop gain: 0.427
Step  1280: OL  758.4  179.1  OA  622.1  72.7 CL  622.1  72.7 nm  0.074 s
Step  1297: OL  765.1  189.6  OA  628.0  82.1 CL  628.0  82.1 nm  0.062 s
Step  1314: OL  771.2  202.0  OA  629.2  89.2 CL  629.2  89.2 nm  0.062 s
Step  1330: OL  776.7  215.3  OA  627.1  96.7 CL  627.1  96.7 nm  0.064 s
Step  1347: OL  784.2  230.7  OA  622.7 103.8 CL  622.7 103.8 nm  0.061 s
Step  1364: OL  794.1  245.4  OA  622.8 107.7 CL  622.8 107.7 nm  0.069 s
Step  1380: OL  804.3  256.4  OA  624.2 108.4 CL  624.2 108.4 nm  0.061 s
Step  1397: OL  816.6  265.1  OA  630.2 106.4 CL  630.2 106.4 nm  0.061 s
Step  1414: OL  830.6  271.1  OA  637.7 101.2 CL  637.7 101.2 nm  0.067 s
Step  1431: OL  845.2  275.2  OA  646.3  96.9 CL  646.3  96.9 nm  0.061 s
Step  1446: OL  857.1  278.1  OA  649.6  92.0 CL  649.6  92.0 nm  0.059 s
Step  1462: OL  868.5  279.7  OA  652.2  87.7 CL  652.2  87.7 nm  0.067 s
Step  1479: OL  876.4  278.6  OA  651.1  82.4 CL  651.1  82.4 nm  0.061 s
Step  1496: OL  878.5  274.6  OA  645.2  80.5 CL  645.2  80.5 nm  0.062 s
Step  1512: OL  876.1  268.2  OA  635.6  80.0 CL  635.6  80.0 nm  0.067 s
Step  1529: OL  870.5  259.7  OA  625.7  77.5 CL  625.7  77.5 nm  0.062 s
Step  1535 updated high order loop gain: 0.428
Step  1545: OL  862.8  249.7  OA  617.7  74.1 CL  617.7  74.1 nm  0.067 s
Step  1561: OL  855.0  239.2  OA  613.2  70.2 CL  613.2  70.2 nm  0.061 s
Step  1578: OL  846.7  229.2  OA  609.3  67.0 CL  609.3  67.0 nm  0.061 s
Step  1594: OL  838.5  222.0  OA  605.4  69.3 CL  605.4  69.3 nm  0.068 s
Step 1599: Output PSF
Step  1599: OL  835.8  219.9  OA  605.2  70.7 CL  605.2  70.7 nm  1.437 s
Mean: 681.84 298.99 612.79  nm.

*** Simulation Finished at 2025/02/17 15:02:46 in nid001972. ***

[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
/global/cfs/cdirs/ulens/vismcao/maos -o studies/reduced_ngs/9_lgs/8mag_lgs/3000count -c master_files/reduced_ngs/9_lgs/8mag_lgs/kola_3000act.conf -O 
Output folder is 'studies/reduced_ngs/9_lgs/8mag_lgs/3000count'.
SRC: /global/homes/b/bpeck/code/maos v2.9 4c88b7c2 2024-11-13 16:45:33 -0800
BUILT: /global/homes/b/bpeck/code/maos/optim by GCC (v12) on 2024/11/18 09:40:03 CPU(F64,+O3) with CUDA(v122,F32)
Launched at 2025/02/17 15:02:46 in nid001972 with PID 1693178.
The web based job monitor can be accessed at http://localhost:10300
Main config file is /global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_3000act.conf
[00;00m[0;36mWarning(path.c:48): Path not found: path=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; abspath=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; Ignored.
[00;00m[0;36mWarning(path.c:48): Path not found: path=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; abspath=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; Ignored.
[00;00m[0;36mWarning(readcfg.c:399): sim.apfsm has been renamed to powfs.apfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.epfsm has been renamed to powfs.epfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.alfsm has been renamed to powfs.alfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.commonfsm has been renamed to powfs.commonfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.idealfsm has been renamed to powfs.idealfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.zetafsm has been renamed to powfs.zetafsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.f0fsm has been renamed to powfs.f0fsm.
[00;00m[0;36mWarning(readcfg.c:399): tsurf has been renamed to ncpa.tsurf.
loaded 132 (132 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_sim.conf'
loaded  19 ( 19 new) records from '/global/cfs/cdirs/ulens/vismcao/./dm_none.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_ASM.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_DM2.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_DM3.conf'
loaded   0 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_dm_multiple.conf'
loaded   7 (  5 new) records from '/global/cfs/cdirs/ulens/vismcao/./atm_mk13n50p_ground_detail.conf'
loaded  76 ( 69 new) records from '/global/homes/b/bpeck/code/maos/config/maos/powfs_common.conf'
loaded  44 ( 38 new) records from '/global/cfs/cdirs/ulens/vismcao/./powfs_none.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_lgs.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_ttf_strap.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_twfs_lbwfs.conf'
loaded   0 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_wfs_lgs_strap_lbwfs.conf'
loaded  71 ( 71 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_recon.conf'
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_smooth has been renamed to powfs0_llt.na_smooth.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_interp has been renamed to powfs0_llt.na_interp.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_thres has been renamed to powfs0_llt.na_thres.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_maxit has been renamed to powfs0_llt.na_fit_maxit.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_svdthres has been renamed to powfs0_llt.na_fit_svdthres.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_dh has been renamed to powfs0_llt.na_fit_dh.
[00;00m[0;36mWarning(readcfg.c:399): dbg.ncpa_preload has been renamed to ncpa.preload.
[00;00m[0;36mWarning(readcfg.c:399): dbg.ncpa_rmsci has been renamed to ncpa.rmsci.
[00;00m[0;36mWarning(readcfg.c:399): dbg.draw_opdmax has been renamed to plot.opdmax.
[00;00m[0;36mWarning(readcfg.c:399): dbg.draw_gmax has been renamed to plot.gmax.
loaded  95 ( 93 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_dbg.conf'
loaded   4 (  4 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_fit_mcao.conf'
[00;00m[0;36mWarning(readcfg.c:399): surf has been renamed to ncpa.surf.
loaded  39 (  7 new) records from '/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_3000act.conf'
loaded   0 (  0 new) records from 'command line'
loaded  24 ( 18 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_llt_CL.conf'
Adjust LGS range by telescope altitude 4145m.
Zenith angle is 30 degree.
    Scaling turbulence height and LGS hs by sec(za).
    Scaling r0 by cos(za)^(3/5).
    Scaling wind speed and LGS signal level by cos(za).
powfs0: Adjusting dx from 0.0078125 to 0.00809091. 
powfs0.llt.fsm: f0=0 Hz, LPF ep=0
powfs0.epfsm is set to 0.517618 (auto)
powfs2: Adjusting dx from 0.03125 to 0.0312778. 
powfs2 is TWFS for powfs0
sim.ephi is set to 0.427717 (auto)
sim.eplo is set to 0.427717 (auto)
[00;00m[0;36mWarning(parms.c:2296): Layer 1 at 17.3205m is very close to layer 0 at 0m (OK).
[00;00m[0;36mWarning(parms.c:2296): Layer 2 at 34.641m is very close to layer 1 at 17.3205m (OK).
[00;00m[0;36mWarning(parms.c:2296): Layer 3 at 51.9615m is very close to layer 2 at 34.641m (OK).
dm 0: stroke=30 um is provided in micron.
dm 0: assume ia stroke=2 um is provided in micron.
dm 1: stroke=7 um is provided in micron.
dm 1: assume ia stroke=2 um is provided in micron.
dm 2: stroke=7 um is provided in micron.
dm 2: assume ia stroke=2 um is provided in micron.
Focus blending is not implemented yet for integrated tomography
parms->sim.mffocus is reset to 0
There are 1 valid simulation seeds:  1
Output PSF for 1 directions
Used 449 of 456 supplied keys
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_flate" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_flatv" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_psx" is not recognized, value is [0 0 0 0]
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_psy" is not recognized, value is [0 0 0 0]
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_pupelong" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_raw" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_side" is not recognized, value is 4
[00;00mAperture[00;00m is 11 m with sampling 1/128 m
[00;00mTurbulence at 30 degree zenith angle:[00;00m r0=0.128424m, L0=30m, 14 layers.
    Greenwood freq is 25.1Hz, anisoplanatic angle is 1.58 as
    Sampled 8192x8192 at 1/128m. wind dir is randomized.
    layer 0: ht=      0 m, wt= 0.302, ws=  4.8 m/s
    layer 1: ht=     17 m, wt= 0.154, ws=  5.0 m/s
    layer 2: ht=     35 m, wt= 0.041, ws=  5.4 m/s
    layer 3: ht=     52 m, wt= 0.002, ws=  6.6 m/s
    layer 4: ht=    139 m, wt= 0.021, ws=  6.1 m/s
    layer 5: ht=    231 m, wt= 0.010, ws=  6.1 m/s
    layer 6: ht=    323 m, wt= 0.008, ws=  6.1 m/s
    layer 7: ht=    416 m, wt= 0.005, ws=  6.1 m/s
    layer 8: ht=    508 m, wt= 0.001, ws=  6.1 m/s
    layer 9: ht=    932 m, wt= 0.107, ws=  5.6 m/s
    layer 10: ht=   5022 m, wt= 0.144, ws= 11.1 m/s
    layer 11: ht=   9238 m, wt= 0.093, ws= 19.1 m/s
    layer 12: ht=  13856 m, wt= 0.075, ws=  8.2 m/s
    layer 13: ht=  22518 m, wt= 0.036, ws=  4.8 m/s
[00;00mReconstruction[00;00m: r0=0.128424m L0=30m. 14 layers. use cone coordinate.
    layer 0: ht=      0 m, wt= 0.302
    layer 1: ht=     17 m, wt= 0.154
    layer 2: ht=     35 m, wt= 0.041
    layer 3: ht=     52 m, wt= 0.002
    layer 4: ht=    139 m, wt= 0.021
    layer 5: ht=    231 m, wt= 0.010
    layer 6: ht=    323 m, wt= 0.008
    layer 7: ht=    416 m, wt= 0.005
    layer 8: ht=    508 m, wt= 0.001
    layer 9: ht=    932 m, wt= 0.107
    layer 10: ht=   5022 m, wt= 0.144
    layer 11: ht=   9238 m, wt= 0.093
    layer 12: ht=  13856 m, wt= 0.075
    layer 13: ht=  22518 m, wt= 0.036
[00;00mThere are 3 powfs[00;00m
  powfs0: Order 62, LGS at 99.1 km. Sampling 1/123.596 m. Thres 30%. [00;00mT/T is removed in right hand side in tomography.[00;00m
    CCD image is 25x25 @ 500x500 mas, blur 27% (sigma), 1500Hz, wvl: [ 5.89e-07]
    Gtilt in reconstruction. Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
  powfs1: Order  2, NGS at inf km. Sampling 1/16 m. Thres 30%. 
    Ztilt in reconstruction. Geomtric optics start at 2 with ztilt [00;00m(noisy)[00;00m
  powfs2: Order 20, NGS at inf km. Sampling 1/31.9716 m. Thres 50%. 
    CCD image is 4x4 @ 1500x1500 mas, blur 0% (sigma), 0.015Hz, wvl: [ 7.2e-07]
    Gtilt in reconstruction. Geomtric optics start at 50 with gtilt Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
[00;00mThere are 13 wfs[00;00m
    wfs 0: type 0, at (  30.00,    0.00) arcsec,  99 km, siglev is 37.9899 bkgrnd is 0.1
    wfs 1: type 0, at (  22.98,   19.28) arcsec,  99 km, siglev is 37.9899 bkgrnd is 0.1
    wfs 2: type 0, at (   5.21,   29.54) arcsec,  99 km, siglev is 37.9899 bkgrnd is 0.1
    wfs 3: type 0, at ( -15.00,   25.98) arcsec,  99 km, siglev is 37.9899 bkgrnd is 0.1
    wfs 4: type 0, at ( -28.19,   10.26) arcsec,  99 km, siglev is 37.9899 bkgrnd is 0.1
    wfs 5: type 0, at ( -28.19,  -10.26) arcsec,  99 km, siglev is 37.9899 bkgrnd is 0.1
    wfs 6: type 0, at ( -15.00,  -25.98) arcsec,  99 km, siglev is 37.9899 bkgrnd is 0.1
    wfs 7: type 0, at (   5.21,  -29.54) arcsec,  99 km, siglev is 37.9899 bkgrnd is 0.1
    wfs 8: type 0, at (  22.98,  -19.28) arcsec,  99 km, siglev is 37.9899 bkgrnd is 0.1
    wfs 9: type 1, at (   5.00,    8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 10: type 1, at ( -10.00,    0.00) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 11: type 1, at (   5.00,   -8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 12: type 2, at (   0.00,    0.00) arcsec, inf km, siglev is 4.1558e+06 bkgrnd is 0.001
[00;00mThere are 3 DMs[00;00m
  DM 0 at -0.1km, actuator pitch 0.178m, offset   0, with 30.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 1 at    6km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 2 at   10km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
[00;00mTomography[00;00m is using CG, with [00;00mFourer Domain[00;00m preconditioner, [00;00m12[00;00m iterations, integrated tomo.
[00;00mDM Fitting [00;00mis using CG, with [00;00mNo[00;00m preconditioner, [00;00m10[00;00m iterations
[00;00mThere are 9 fit directions[00;00m
    Fit 0: weight is 0.444, at (   0.00,    0.00) arcsec
    Fit 1: weight is 0.111, at (  15.00,    0.00) arcsec
    Fit 2: weight is 0.111, at (   0.00,   15.00) arcsec
    Fit 3: weight is 0.111, at ( -15.00,    0.00) arcsec
    Fit 4: weight is 0.111, at (   0.00,  -15.00) arcsec
    Fit 5: weight is 0.028, at (  15.00,   15.00) arcsec
    Fit 6: weight is 0.028, at ( -15.00,   15.00) arcsec
    Fit 7: weight is 0.028, at ( -15.00,  -15.00) arcsec
    Fit 8: weight is 0.028, at (  15.00,  -15.00) arcsec
[00;00mThere are 1 evaluation directions[00;00m at sampling 1/128 m.
    Evl 0: weight is 1.000, at (   0.00,    0.00) arcsec
[00;00mSimulation[00;00m start at step 0, end at step 1600, with time step 1/1500s, [00;00mclose loop[00;00m.
After setup_parms:	120.5 MiB.
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
CUDA: minimum memory requirement is 0.3GB
GPU 0 is NVIDIA A100-SXM4-40GB with arch 8.0, 38.9GB free, 39.3GB total device memory.
Using GPU 0
Use 1 GPUs for WFS Tomo Fit Evl

*** Preparation started at 2025/02/17 15:02:47 in nid001972. ***

Using OpenMP version 201511 with 128 threads
Reading aperture amplitude map from KECK.fits
[00;00m[0;36mWarning(accphi.c:477): 108390 points not covered by input screen
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
 ->maos.c:447->setup.c:148->aper.c:74->utils.c:478->accphi.c:478
iwvl 0: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 1: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 2: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 3: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 4: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 5: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 6: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 7: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 8: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
After setup_aper:	344.7 MiB.

[00;00mSetting up powfs 0 geom[00;00m

There are 22 points in each subaperture of 0.178m.
There are 2360 valid subaperture.

[00;00mSetting up powfs 1 geom[00;00m

There are 88 points in each subaperture of 5.5m.
There are 4 valid subaperture.

[00;00mSetting up powfs 2 geom[00;00m

There are 18 points in each subaperture of 0.563m.
There are 236 valid subaperture.
After setup_powfs_init:	416.7 MiB.

[00;00mSetting up reconstructor geometry.[00;00m

PLOC is 127x127, with sampling of 0.09m (square)
    DM 0: grid is 67 x 67
    DM 1: grid is 75 x 75
    DM 2: grid is 80 x 79
FLOC is 127x127, with sampling of 0.09m (not square)
Tomography grid is square:
    layer 0: xloc grid is 224 x 224, sampling is 0.089 m, 50176 points
    layer 1: xloc grid is 224 x 224, sampling is 0.089 m, 50176 points
    layer 2: xloc grid is 224 x 224, sampling is 0.089 m, 50176 points
    layer 3: xloc grid is 224 x 224, sampling is 0.089 m, 50176 points
    layer 4: xloc grid is 224 x 224, sampling is 0.089 m, 50176 points
    layer 5: xloc grid is 224 x 224, sampling is 0.089 m, 50176 points
    layer 6: xloc grid is 224 x 224, sampling is 0.089 m, 50176 points
    layer 7: xloc grid is 224 x 224, sampling is 0.089 m, 50176 points
    layer 8: xloc grid is 224 x 224, sampling is 0.089 m, 50176 points
    layer 9: xloc grid is 224 x 224, sampling is 0.088 m, 50176 points
    layer 10: xloc grid is 224 x 224, sampling is 0.084 m, 50176 points
    layer 11: xloc grid is 224 x 224, sampling is 0.081 m, 50176 points
    layer 12: xloc grid is 224 x 224, sampling is 0.077 m, 50176 points
    layer 13: xloc grid is 224 x 224, sampling is 0.069 m, 50176 points

[00;00mSetting up powfs 0 PO WFS[00;00m

OTF dimension is 48x48 (calculated)
There is no bias
Uplink FWHM (illt 0, iwvl 0) is 0.577526"
Downlink FWHM (illt 0, iwvl 0) is 1.12996"
Generating matched filter for powfs 0
sa index   location       noise equivalent angle
    1178: (  4.8,  -0.2) m, (113.97, 110.64) mas
    1172: (  3.7,  -0.2) m, (120.83, 111.85) mas
    1166: (  2.7,  -0.2) m, (132.43, 113.30) mas
    1160: (  1.6,  -0.2) m, (148.73, 114.57) mas
    1158: (  1.2,  -0.2) m, (154.61, 114.94) mas
     821: ( -0.5,  -1.4) m, (181.16, 119.19) mas
    1155: ( -1.8,  -0.2) m, (194.50, 117.62) mas
    1149: ( -2.8,  -0.2) m, (208.51, 118.57) mas
    1143: ( -3.9,  -0.2) m, (224.71, 119.54) mas
    1137: ( -5.0,  -0.2) m, (242.50, 120.51) mas
    1135: ( -5.3,  -0.2) m, (248.25, 120.83) mas
sa index   location       noise equivalent angle
    1901: (  3.0,   2.5) m, (116.63, 115.22) mas
    1711: (  2.1,   1.8) m, (124.13, 120.88) mas
    1658: (  2.0,   1.6) m, (126.53, 122.87) mas
    1445: (  1.1,   0.9) m, (137.29, 130.23) mas
     826: (  0.4,  -1.4) m, (146.18, 159.48) mas
     919: ( -1.2,  -1.1) m, (168.52, 153.88) mas
     706: ( -2.1,  -1.8) m, (180.41, 163.87) mas
     652: ( -2.3,  -2.0) m, (182.61, 166.27) mas
     461: ( -3.2,  -2.7) m, (193.80, 175.83) mas
      66: ( -3.0,  -4.5) m, (191.20, 198.68) mas
sa index   location       noise equivalent angle
    2319: (  0.7,   4.5) m, (110.98, 115.14) mas
    1886: (  0.4,   2.5) m, (114.15, 133.51) mas
    1595: (  0.2,   1.4) m, (115.78, 149.84) mas
    1542: (  0.2,   1.2) m, (115.94, 152.78) mas
    1109: ( -1.4,  -0.4) m, (125.13, 178.35) mas
     769: ( -0.4,  -1.6) m, (120.11, 192.83) mas
     476: ( -0.5,  -2.7) m, (121.86, 207.53) mas
     223: ( -0.7,  -3.7) m, (123.70, 224.34) mas
      43: ( -0.9,  -4.6) m, (125.45, 239.87) mas
      11: ( -2.3,  -4.8) m, (136.48, 243.77) mas
sa index   location       noise equivalent angle
    2300: ( -2.7,   4.5) m, (111.12, 112.30) mas
    2230: ( -2.5,   4.1) m, (111.63, 113.42) mas
    1962: ( -1.8,   2.8) m, (116.36, 123.02) mas
    1641: ( -1.1,   1.6) m, (122.29, 137.47) mas
    1536: ( -0.9,   1.2) m, (123.96, 142.95) mas
    1254: (  1.2,   0.2) m, (146.55, 157.95) mas
     828: (  0.7,  -1.4) m, (140.62, 181.94) mas
     723: (  0.9,  -1.8) m, (143.23, 186.85) mas
     400: (  1.6,  -3.0) m, (152.74, 202.16) mas
     132: (  2.3,  -4.3) m, (162.63, 219.64) mas
      62: (  2.5,  -4.6) m, (165.05, 224.94) mas
sa index   location       noise equivalent angle
    1570: ( -4.3,   1.4) m, (116.20, 111.87) mas
    1431: ( -2.8,   0.9) m, (127.89, 115.35) mas
    1389: ( -2.3,   0.7) m, (135.60, 117.02) mas
    1301: ( -1.4,   0.4) m, (149.24, 119.65) mas
     824: (  0.0,  -1.4) m, (174.74, 137.21) mas
    1062: (  1.2,  -0.5) m, (189.63, 127.42) mas
     974: (  2.1,  -0.9) m, (201.17, 131.14) mas
     844: (  3.6,  -1.4) m, (221.78, 137.60) mas
     794: (  4.1,  -1.6) m, (230.07, 139.89) mas
    1084: (  5.2,  -0.5) m, (248.64, 130.93) mas
sa index   location       noise equivalent angle
     747: ( -4.3,  -1.6) m, (116.20, 111.87) mas
     910: ( -2.8,  -1.1) m, (127.89, 115.35) mas
     959: ( -2.3,  -0.9) m, (135.60, 117.02) mas
    1059: ( -1.4,  -0.5) m, (149.24, 119.65) mas
    1541: (  0.0,   1.2) m, (174.74, 137.21) mas
    1304: (  1.2,   0.4) m, (189.63, 127.42) mas
    1404: (  2.1,   0.7) m, (201.17, 131.14) mas
    1561: (  3.6,   1.2) m, (221.78, 137.60) mas
    1617: (  4.1,   1.4) m, (230.07, 139.89) mas
    1326: (  5.2,   0.4) m, (249.48, 131.60) mas
sa index   location       noise equivalent angle
      33: ( -2.7,  -4.6) m, (111.12, 112.30) mas
     105: ( -2.5,  -4.3) m, (111.63, 113.42) mas
     381: ( -1.8,  -3.0) m, (116.36, 123.02) mas
     712: ( -1.1,  -1.8) m, (122.29, 137.47) mas
     819: ( -0.9,  -1.4) m, (123.96, 142.95) mas
    1110: (  1.2,  -0.4) m, (146.55, 157.95) mas
    1545: (  0.7,   1.2) m, (140.62, 181.94) mas
    1652: (  0.9,   1.6) m, (143.23, 186.85) mas
    1981: (  1.6,   2.8) m, (152.74, 202.16) mas
    2257: (  2.3,   4.1) m, (162.63, 219.64) mas
    2329: (  2.5,   4.5) m, (165.05, 224.94) mas
sa index   location       noise equivalent angle
      52: (  0.7,  -4.6) m, (110.98, 115.14) mas
     481: (  0.4,  -2.7) m, (114.15, 133.51) mas
     772: (  0.2,  -1.6) m, (115.78, 149.84) mas
     825: (  0.2,  -1.4) m, (115.94, 152.78) mas
    1253: ( -1.4,   0.2) m, (125.13, 178.35) mas
    1592: ( -0.4,   1.4) m, (120.11, 192.82) mas
    1881: ( -0.5,   2.5) m, (121.86, 207.52) mas
    2132: ( -0.7,   3.6) m, (123.70, 224.34) mas
    2310: ( -0.9,   4.5) m, (125.45, 239.86) mas
    2335: ( -2.3,   4.6) m, (136.48, 243.76) mas
sa index   location       noise equivalent angle
     496: (  3.0,  -2.7) m, (116.63, 115.22) mas
     677: (  2.1,  -2.0) m, (124.13, 120.88) mas
     729: (  2.0,  -1.8) m, (126.53, 122.87) mas
     924: (  1.1,  -1.1) m, (137.29, 130.23) mas
    1543: (  0.4,   1.2) m, (146.18, 159.48) mas
    1440: ( -1.2,   0.9) m, (168.52, 153.88) mas
    1635: ( -2.1,   1.6) m, (180.41, 163.87) mas
    1686: ( -2.3,   1.8) m, (182.61, 166.27) mas
    1866: ( -3.2,   2.5) m, (193.80, 175.83) mas
    2263: ( -3.0,   4.3) m, (191.20, 198.68) mas

[00;00mSetting up powfs 2 PO WFS[00;00m

OTF dimension is 48x48 (calculated)
Generating matched filter for powfs 2
Use sanea to derive neasim
Use sanea to derive neasim

[00;00mSetting up reconstructor[00;00m

Recon NEA: cmf(156.09) cmf(156.53) cmf(155.79) cmf(156.45) cmf(156.13) cmf(156.10) cmf(156.39) cmf(155.72) cmf(156.48) geom(0.31) geom(0.31) geom(0.31) mf(0.14)  mas
Setup or update control matrix parameters.
RRtwfs svd threshold is 1e-10
Replacing HA by HA*fit->actextrap
Adding piston cr to fit matrix
Adding TT cr on upper DMs to fit matrix.
Before assembling fit matrix:	4383.5 MiB.
Building fit->FR
Building fit->FL
Adding tikhonov constraint of 1.0e-07 to FLM
The maximum eigen value is estimated to be around 3.0e-04
DM Fit number of Low rank terms: 16 in LHS
After assemble fit matrix:	5725.0 MiB.
After setup_recon:	5725.0 MiB.
GPU 0: mem used 1994 MB (wfs init)
GPU 0: mem used 2836 MB (recon init)
GPU 0: mem used 2868 MB (perf init)

*** Simulation started at 2025/02/17 15:04:08 in nid001972. ***

Running seed 1
GPU 0: mem used 2868 MB (wfs seeding)
Wind dir: 267.3 261.7 167.0 130.5 300.7  32.3 119.8 139.0 150.8 277.7 203.0 133.1  45.9 265.1 deg
Using /global/homes/b/bpeck/.aos/cache/atm/vonkarman_14_8192x8192_0.0078125_1115374592d.bin
After genatm:	5676.0 MiB.
Step     #  Open Loop  PR TT  On axis  PR TT  Field RMS PR TT     Timing 
Step     0: OL  884.6  248.3  OA  884.6 248.3 CL  884.6 248.3 nm  0.110 s
Step    17: OL  911.1  254.8  OA  112.6  16.5 CL  112.6  16.5 nm  0.056 s
Step    33: OL  936.1  259.4  OA  111.4  23.2 CL  111.4  23.2 nm  0.065 s
Step    48: OL  958.6  261.1  OA  108.8  19.7 CL  108.8  19.7 nm  0.068 s
Step    63: OL  980.8  260.5  OA  112.0   9.4 CL  112.0   9.4 nm  0.065 s
Step    78: OL 1003.4  258.9  OA  109.5   5.2 CL  109.5   5.2 nm  0.072 s
Step    93: OL 1026.5  257.8  OA  113.3  25.0 CL  113.3  25.0 nm  0.065 s
Step   108: OL 1049.5  257.5  OA  108.7   8.4 CL  108.7   8.4 nm  0.068 s
Step   123: OL 1072.1  258.9  OA  109.3  13.9 CL  109.3  13.9 nm  0.064 s
Step   139: OL 1094.5  263.0  OA  106.9  11.9 CL  106.9  11.9 nm  0.063 s
Step   154: OL 1113.4  269.2  OA  110.1  29.6 CL  110.1  29.6 nm  0.075 s
Step   169: OL 1129.4  277.3  OA  108.9  17.5 CL  108.9  17.5 nm  0.066 s
Step   184: OL 1142.3  286.6  OA  109.5  13.2 CL  109.5  13.2 nm  0.075 s
Step   199: OL 1151.5  296.3  OA  110.1  16.6 CL  110.1  16.6 nm  0.067 s
Step   215: OL 1158.4  306.4  OA  102.3  22.6 CL  102.3  22.6 nm  0.065 s
Step   230: OL 1161.5  316.2  OA  108.6  17.9 CL  108.6  17.9 nm  0.066 s
Step   245: OL 1161.4  326.3  OA  104.6  17.3 CL  104.6  17.3 nm  0.072 s
Step   255 updated high order loop gain: 0.371
Step   260: OL 1156.3  337.1  OA  105.8   7.6 CL  105.8   7.6 nm  0.066 s
Step   276: OL 1145.3  348.6  OA  107.6  14.7 CL  107.6  14.7 nm  0.066 s
Step   291: OL 1131.1  360.3  OA  104.5  15.4 CL  104.5  15.4 nm  0.065 s
Step   306: OL 1115.0  373.5  OA  104.7  11.5 CL  104.7  11.5 nm  0.065 s
Step   322: OL 1095.1  388.6  OA  107.4  22.1 CL  107.4  22.1 nm  0.064 s
Step   337: OL 1075.2  404.9  OA  104.8   4.0 CL  104.8   4.0 nm  0.065 s
Step   351: OL 1056.7  422.2  OA  105.7   6.2 CL  105.7   6.2 nm  0.065 s
Step   366: OL 1037.7  442.8  OA  105.5   7.9 CL  105.5   7.9 nm  0.071 s
Step   381: OL 1020.0  464.3  OA  111.7  22.2 CL  111.7  22.2 nm  0.065 s
Step   397: OL 1002.2  487.5  OA  109.9   9.5 CL  109.9   9.5 nm  0.072 s
Step   412: OL  985.3  508.7  OA  113.2  27.7 CL  113.2  27.7 nm  0.066 s
Step   428: OL  966.9  530.1  OA  109.5  20.8 CL  109.5  20.8 nm  0.066 s
Step   443: OL  950.6  549.9  OA  110.1  21.5 CL  110.1  21.5 nm  0.072 s
Step   458: OL  936.8  569.4  OA  108.5  19.4 CL  108.5  19.4 nm  0.066 s
Step   473: OL  927.5  588.9  OA  108.8  11.2 CL  108.8  11.2 nm  0.072 s
Step   488: OL  923.9  607.7  OA  109.7  21.8 CL  109.7  21.8 nm  0.068 s
Step   502: OL  924.7  624.3  OA  109.3  10.9 CL  109.3  10.9 nm  0.070 s
Step   511 updated high order loop gain: 0.366
Step   516: OL  927.8  639.1  OA  109.5   5.9 CL  109.5   5.9 nm  0.073 s
Step 528, DM 2: 1 actuators over ia limit. trials=2: success.
Step 529, DM 2: 1 actuators over ia limit. trials=2: success.
Step   531: OL  933.5  652.0  OA  110.9  20.0 CL  110.9  20.0 nm  0.074 s
Step   546: OL  942.1  661.2  OA  109.9  10.7 CL  109.9  10.7 nm  0.066 s
Step   561: OL  953.7  667.0  OA  110.4  11.2 CL  110.4  11.2 nm  0.065 s
Step   576: OL  967.5  670.0  OA  112.2  20.8 CL  112.2  20.8 nm  0.072 s
Step   591: OL  983.6  670.4  OA  104.8   3.2 CL  104.8   3.2 nm  0.064 s
Step   605: OL  999.8  667.4  OA  108.9   1.5 CL  108.9   1.5 nm  0.066 s
Step   620: OL 1017.7  660.7  OA  113.1  23.0 CL  113.1  23.0 nm  0.065 s
Step   635: OL 1035.1  651.0  OA  106.9  11.6 CL  106.9  11.6 nm  0.076 s
Step   650: OL 1051.2  638.5  OA  108.4  14.4 CL  108.4  14.4 nm  0.065 s
Step   665: OL 1065.6  624.0  OA  108.3   9.6 CL  108.3   9.6 nm  0.064 s
Step   680: OL 1078.8  608.4  OA  110.3  10.8 CL  110.3  10.8 nm  0.065 s
Step   696: OL 1091.7  591.3  OA  113.2  15.9 CL  113.2  15.9 nm  0.065 s
Step   711: OL 1100.8  573.7  OA  111.6  11.6 CL  111.6  11.6 nm  0.074 s
Step   726: OL 1106.2  555.1  OA  113.3  16.4 CL  113.3  16.4 nm  0.065 s
Step   742: OL 1107.5  535.4  OA  113.8  18.9 CL  113.8  18.9 nm  0.066 s
Step   757: OL 1104.6  517.3  OA  109.9   8.7 CL  109.9   8.7 nm  0.072 s
Step   767 updated high order loop gain: 0.376
Step   772: OL 1097.8  500.0  OA  107.4  12.1 CL  107.4  12.1 nm  0.074 s
Step   787: OL 1086.7  483.1  OA  108.5   6.2 CL  108.5   6.2 nm  0.063 s
Step   803: OL 1070.6  465.2  OA  111.2  17.7 CL  111.2  17.7 nm  0.064 s
Step   818: OL 1052.5  448.5  OA  107.1   6.4 CL  107.1   6.4 nm  0.066 s
Step   834: OL 1029.6  431.0  OA  111.0  19.5 CL  111.0  19.5 nm  0.063 s
Step   849: OL 1006.4  415.5  OA  106.0   5.9 CL  106.0   5.9 nm  0.071 s
Step   865: OL  981.1  400.6  OA  105.3  14.3 CL  105.3  14.3 nm  0.066 s
Step   881: OL  956.9  387.7  OA  111.2  16.8 CL  111.2  16.8 nm  0.077 s
Step   893: OL  939.0  379.4  OA  110.4  12.9 CL  110.4  12.9 nm  0.065 s
Step   908: OL  915.3  370.3  OA  107.8   2.8 CL  107.8   2.8 nm  0.072 s
Step   923: OL  890.9  362.9  OA  106.1   8.6 CL  106.1   8.6 nm  0.068 s
Step   938: OL  867.0  355.8  OA  109.8   8.1 CL  109.8   8.1 nm  0.066 s
Step   953: OL  844.1  348.5  OA  107.1  10.1 CL  107.1  10.1 nm  0.066 s
Step   968: OL  823.7  340.5  OA  109.4   8.4 CL  109.4   8.4 nm  0.071 s
Step   983: OL  806.3  331.4  OA  109.5  14.3 CL  109.5  14.3 nm  0.067 s
Step   999: OL  790.1  320.3  OA  108.3   6.3 CL  108.3   6.3 nm  0.065 s
Step  1014: OL  776.5  309.0  OA  109.6   4.0 CL  109.6   4.0 nm  0.076 s
Step  1023 updated high order loop gain: 0.370
Step  1029: OL  765.3  297.4  OA  113.2  19.5 CL  113.2  19.5 nm  0.065 s
Step  1043: OL  756.5  285.7  OA  106.4  11.5 CL  106.4  11.5 nm  0.065 s
Step  1058: OL  747.4  272.0  OA  106.5   6.3 CL  106.5   6.3 nm  0.067 s
Step  1073: OL  739.7  256.2  OA  108.8   9.4 CL  108.8   9.4 nm  0.072 s
Step  1088: OL  734.8  238.8  OA  108.4  19.2 CL  108.4  19.2 nm  0.064 s
Step  1103: OL  732.5  222.1  OA  107.6  18.4 CL  107.6  18.4 nm  0.065 s
Step  1118: OL  731.8  207.1  OA  107.1  17.2 CL  107.1  17.2 nm  0.066 s
Step  1133: OL  732.2  194.5  OA  102.2  15.3 CL  102.2  15.3 nm  0.066 s
Step  1149: OL  733.0  183.8  OA  104.6  12.9 CL  104.6  12.9 nm  0.075 s
Step  1164: OL  733.7  176.3  OA  105.2  17.9 CL  105.2  17.9 nm  0.065 s
Step  1179: OL  734.9  171.5  OA  105.3  16.2 CL  105.3  16.2 nm  0.068 s
Step  1192: OL  737.5  168.6  OA  103.9  14.7 CL  103.9  14.7 nm  0.064 s
Step  1207: OL  741.1  165.7  OA  104.1  17.5 CL  104.1  17.5 nm  0.065 s
Step  1222: OL  744.8  163.7  OA  107.4  11.5 CL  107.4  11.5 nm  0.075 s
Step  1237: OL  748.1  163.8  OA  109.1  27.9 CL  109.1  27.9 nm  0.066 s
Step  1253: OL  751.0  166.9  OA  108.4  22.0 CL  108.4  22.0 nm  0.070 s
Step  1268: OL  754.8  172.8  OA  105.2  15.0 CL  105.2  15.0 nm  0.065 s
Step  1279 updated high order loop gain: 0.367
Step  1284: OL  760.1  181.4  OA  107.6  17.6 CL  107.6  17.6 nm  0.072 s
Step  1299: OL  766.3  191.0  OA  108.0  22.5 CL  108.0  22.5 nm  0.064 s
Step  1314: OL  772.2  201.9  OA  107.0  19.5 CL  107.0  19.5 nm  0.065 s
Step  1329: OL  778.2  214.3  OA  108.6  20.4 CL  108.6  20.4 nm  0.065 s
Step  1344: OL  785.8  227.8  OA  106.1  25.0 CL  106.1  25.0 nm  0.065 s
Step  1359: OL  795.5  241.2  OA  104.9  19.3 CL  104.9  19.3 nm  0.063 s
Step  1374: OL  806.7  252.5  OA  101.7  14.5 CL  101.7  14.5 nm  0.065 s
Step  1390: OL  820.0  261.7  OA  104.5  22.7 CL  104.5  22.7 nm  0.101 s
Step  1405: OL  834.0  268.1  OA  103.2  11.0 CL  103.2  11.0 nm  0.069 s
Step  1421: OL  850.3  272.7  OA  104.7  14.8 CL  104.7  14.8 nm  0.071 s
Step  1436: OL  865.5  276.0  OA  103.5  12.4 CL  103.5  12.4 nm  0.064 s
Step  1451: OL  879.9  278.5  OA  104.3   0.5 CL  104.3   0.5 nm  0.064 s
Step  1466: OL  892.4  279.3  OA  106.3  17.8 CL  106.3  17.8 nm  0.076 s
Step  1481: OL  900.8  277.9  OA  106.5  18.0 CL  106.5  18.0 nm  0.066 s
Step  1497: OL  904.6  273.8  OA  103.0  11.0 CL  103.0  11.0 nm  0.064 s
Step  1512: OL  903.7  267.7  OA  104.2   6.5 CL  104.2   6.5 nm  0.065 s
Step  1527: OL  899.8  260.3  OA  104.4   2.6 CL  104.4   2.6 nm  0.077 s
Step  1535 updated high order loop gain: 0.366
Step  1542: OL  892.5  251.1  OA  108.0  21.5 CL  108.0  21.5 nm  0.066 s
Step  1557: OL  884.2  241.1  OA  104.4   1.6 CL  104.4   1.6 nm  0.063 s
Step  1572: OL  875.3  231.9  OA  106.6  17.8 CL  106.6  17.8 nm  0.066 s
Step  1587: OL  865.5  224.3  OA  109.6  19.1 CL  109.6  19.1 nm  0.065 s
Step 1599: Output PSF
Step  1599: OL  857.0  219.2  OA  110.5  21.5 CL  110.5  21.5 nm  1.164 s
Mean: 107.87 15.14 106.80  nm.

*** Simulation Finished at 2025/02/17 15:06:04 in nid001972. ***

[00;00m>>>>>>>>>>>>>>>>[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
/global/cfs/cdirs/ulens/vismcao/maos -o studies/reduced_ngs/9_lgs/8mag_lgs/3250count -c master_files/reduced_ngs/9_lgs/8mag_lgs/kola_3250act.conf -O 
Output folder is 'studies/reduced_ngs/9_lgs/8mag_lgs/3250count'.
SRC: /global/homes/b/bpeck/code/maos v2.9 4c88b7c2 2024-11-13 16:45:33 -0800
BUILT: /global/homes/b/bpeck/code/maos/optim by GCC (v12) on 2024/11/18 09:40:03 CPU(F64,+O3) with CUDA(v122,F32)
Launched at 2025/02/17 15:06:04 in nid001972 with PID 1693576.
The web based job monitor can be accessed at http://localhost:10300
Main config file is /global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_3250act.conf
[00;00m[0;36mWarning(path.c:48): Path not found: path=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; abspath=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; Ignored.
[00;00m[0;36mWarning(path.c:48): Path not found: path=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; abspath=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; Ignored.
[00;00m[0;36mWarning(readcfg.c:399): sim.apfsm has been renamed to powfs.apfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.epfsm has been renamed to powfs.epfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.alfsm has been renamed to powfs.alfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.commonfsm has been renamed to powfs.commonfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.idealfsm has been renamed to powfs.idealfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.zetafsm has been renamed to powfs.zetafsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.f0fsm has been renamed to powfs.f0fsm.
[00;00m[0;36mWarning(readcfg.c:399): tsurf has been renamed to ncpa.tsurf.
loaded 132 (132 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_sim.conf'
loaded  19 ( 19 new) records from '/global/cfs/cdirs/ulens/vismcao/./dm_none.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_ASM.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_DM2.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_DM3.conf'
loaded   0 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_dm_multiple.conf'
loaded   7 (  5 new) records from '/global/cfs/cdirs/ulens/vismcao/./atm_mk13n50p_ground_detail.conf'
loaded  76 ( 69 new) records from '/global/homes/b/bpeck/code/maos/config/maos/powfs_common.conf'
loaded  44 ( 38 new) records from '/global/cfs/cdirs/ulens/vismcao/./powfs_none.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_lgs.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_ttf_strap.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_twfs_lbwfs.conf'
loaded   0 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_wfs_lgs_strap_lbwfs.conf'
loaded  71 ( 71 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_recon.conf'
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_smooth has been renamed to powfs0_llt.na_smooth.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_interp has been renamed to powfs0_llt.na_interp.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_thres has been renamed to powfs0_llt.na_thres.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_maxit has been renamed to powfs0_llt.na_fit_maxit.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_svdthres has been renamed to powfs0_llt.na_fit_svdthres.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_dh has been renamed to powfs0_llt.na_fit_dh.
[00;00m[0;36mWarning(readcfg.c:399): dbg.ncpa_preload has been renamed to ncpa.preload.
[00;00m[0;36mWarning(readcfg.c:399): dbg.ncpa_rmsci has been renamed to ncpa.rmsci.
[00;00m[0;36mWarning(readcfg.c:399): dbg.draw_opdmax has been renamed to plot.opdmax.
[00;00m[0;36mWarning(readcfg.c:399): dbg.draw_gmax has been renamed to plot.gmax.
loaded  95 ( 93 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_dbg.conf'
loaded   4 (  4 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_fit_mcao.conf'
[00;00m[0;36mWarning(readcfg.c:399): surf has been renamed to ncpa.surf.
loaded  39 (  7 new) records from '/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_3250act.conf'
loaded   0 (  0 new) records from 'command line'
loaded  24 ( 18 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_llt_CL.conf'
Adjust LGS range by telescope altitude 4145m.
Zenith angle is 30 degree.
    Scaling turbulence height and LGS hs by sec(za).
    Scaling r0 by cos(za)^(3/5).
    Scaling wind speed and LGS signal level by cos(za).
powfs0: Adjusting dx from 0.0078125 to 0.00777273. 
powfs0.llt.fsm: f0=0 Hz, LPF ep=0
powfs0.epfsm is set to 0.517618 (auto)
powfs2: Adjusting dx from 0.03125 to 0.0312778. 
powfs2 is TWFS for powfs0
sim.ephi is set to 0.427717 (auto)
sim.eplo is set to 0.427717 (auto)
[00;00m[0;36mWarning(parms.c:2296): Layer 1 at 17.3205m is very close to layer 0 at 0m (OK).
[00;00m[0;36mWarning(parms.c:2296): Layer 2 at 34.641m is very close to layer 1 at 17.3205m (OK).
[00;00m[0;36mWarning(parms.c:2296): Layer 3 at 51.9615m is very close to layer 2 at 34.641m (OK).
dm 0: stroke=30 um is provided in micron.
dm 0: assume ia stroke=2 um is provided in micron.
dm 1: stroke=7 um is provided in micron.
dm 1: assume ia stroke=2 um is provided in micron.
dm 2: stroke=7 um is provided in micron.
dm 2: assume ia stroke=2 um is provided in micron.
Focus blending is not implemented yet for integrated tomography
parms->sim.mffocus is reset to 0
There are 1 valid simulation seeds:  1
Output PSF for 1 directions
Used 449 of 456 supplied keys
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_flate" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_flatv" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_psx" is not recognized, value is [0 0 0 0]
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_psy" is not recognized, value is [0 0 0 0]
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_pupelong" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_raw" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_side" is not recognized, value is 4
[00;00mAperture[00;00m is 11 m with sampling 1/128 m
[00;00mTurbulence at 30 degree zenith angle:[00;00m r0=0.128424m, L0=30m, 14 layers.
    Greenwood freq is 25.1Hz, anisoplanatic angle is 1.58 as
    Sampled 8192x8192 at 1/128m. wind dir is randomized.
    layer 0: ht=      0 m, wt= 0.302, ws=  4.8 m/s
    layer 1: ht=     17 m, wt= 0.154, ws=  5.0 m/s
    layer 2: ht=     35 m, wt= 0.041, ws=  5.4 m/s
    layer 3: ht=     52 m, wt= 0.002, ws=  6.6 m/s
    layer 4: ht=    139 m, wt= 0.021, ws=  6.1 m/s
    layer 5: ht=    231 m, wt= 0.010, ws=  6.1 m/s
    layer 6: ht=    323 m, wt= 0.008, ws=  6.1 m/s
    layer 7: ht=    416 m, wt= 0.005, ws=  6.1 m/s
    layer 8: ht=    508 m, wt= 0.001, ws=  6.1 m/s
    layer 9: ht=    932 m, wt= 0.107, ws=  5.6 m/s
    layer 10: ht=   5022 m, wt= 0.144, ws= 11.1 m/s
    layer 11: ht=   9238 m, wt= 0.093, ws= 19.1 m/s
    layer 12: ht=  13856 m, wt= 0.075, ws=  8.2 m/s
    layer 13: ht=  22518 m, wt= 0.036, ws=  4.8 m/s
[00;00mReconstruction[00;00m: r0=0.128424m L0=30m. 14 layers. use cone coordinate.
    layer 0: ht=      0 m, wt= 0.302
    layer 1: ht=     17 m, wt= 0.154
    layer 2: ht=     35 m, wt= 0.041
    layer 3: ht=     52 m, wt= 0.002
    layer 4: ht=    139 m, wt= 0.021
    layer 5: ht=    231 m, wt= 0.010
    layer 6: ht=    323 m, wt= 0.008
    layer 7: ht=    416 m, wt= 0.005
    layer 8: ht=    508 m, wt= 0.001
    layer 9: ht=    932 m, wt= 0.107
    layer 10: ht=   5022 m, wt= 0.144
    layer 11: ht=   9238 m, wt= 0.093
    layer 12: ht=  13856 m, wt= 0.075
    layer 13: ht=  22518 m, wt= 0.036
[00;00mThere are 3 powfs[00;00m
  powfs0: Order 65, LGS at 99.1 km. Sampling 1/128.655 m. Thres 30%. [00;00mT/T is removed in right hand side in tomography.[00;00m
    CCD image is 25x25 @ 500x500 mas, blur 27% (sigma), 1500Hz, wvl: [ 5.89e-07]
    Gtilt in reconstruction. Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
  powfs1: Order  2, NGS at inf km. Sampling 1/16 m. Thres 30%. 
    Ztilt in reconstruction. Geomtric optics start at 2 with ztilt [00;00m(noisy)[00;00m
  powfs2: Order 20, NGS at inf km. Sampling 1/31.9716 m. Thres 50%. 
    CCD image is 4x4 @ 1500x1500 mas, blur 0% (sigma), 0.015Hz, wvl: [ 7.2e-07]
    Gtilt in reconstruction. Geomtric optics start at 50 with gtilt Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
[00;00mThere are 13 wfs[00;00m
    wfs 0: type 0, at (  30.00,    0.00) arcsec,  99 km, siglev is 35.061 bkgrnd is 0.1
    wfs 1: type 0, at (  22.98,   19.28) arcsec,  99 km, siglev is 35.061 bkgrnd is 0.1
    wfs 2: type 0, at (   5.21,   29.54) arcsec,  99 km, siglev is 35.061 bkgrnd is 0.1
    wfs 3: type 0, at ( -15.00,   25.98) arcsec,  99 km, siglev is 35.061 bkgrnd is 0.1
    wfs 4: type 0, at ( -28.19,   10.26) arcsec,  99 km, siglev is 35.061 bkgrnd is 0.1
    wfs 5: type 0, at ( -28.19,  -10.26) arcsec,  99 km, siglev is 35.061 bkgrnd is 0.1
    wfs 6: type 0, at ( -15.00,  -25.98) arcsec,  99 km, siglev is 35.061 bkgrnd is 0.1
    wfs 7: type 0, at (   5.21,  -29.54) arcsec,  99 km, siglev is 35.061 bkgrnd is 0.1
    wfs 8: type 0, at (  22.98,  -19.28) arcsec,  99 km, siglev is 35.061 bkgrnd is 0.1
    wfs 9: type 1, at (   5.00,    8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 10: type 1, at ( -10.00,    0.00) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 11: type 1, at (   5.00,   -8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 12: type 2, at (   0.00,    0.00) arcsec, inf km, siglev is 4.1558e+06 bkgrnd is 0.001
[00;00mThere are 3 DMs[00;00m
  DM 0 at -0.1km, actuator pitch 0.171m, offset   0, with 30.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 1 at    6km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 2 at   10km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
[00;00mTomography[00;00m is using CG, with [00;00mFourer Domain[00;00m preconditioner, [00;00m12[00;00m iterations, integrated tomo.
[00;00mDM Fitting [00;00mis using CG, with [00;00mNo[00;00m preconditioner, [00;00m10[00;00m iterations
[00;00mThere are 9 fit directions[00;00m
    Fit 0: weight is 0.444, at (   0.00,    0.00) arcsec
    Fit 1: weight is 0.111, at (  15.00,    0.00) arcsec
    Fit 2: weight is 0.111, at (   0.00,   15.00) arcsec
    Fit 3: weight is 0.111, at ( -15.00,    0.00) arcsec
    Fit 4: weight is 0.111, at (   0.00,  -15.00) arcsec
    Fit 5: weight is 0.028, at (  15.00,   15.00) arcsec
    Fit 6: weight is 0.028, at ( -15.00,   15.00) arcsec
    Fit 7: weight is 0.028, at ( -15.00,  -15.00) arcsec
    Fit 8: weight is 0.028, at (  15.00,  -15.00) arcsec
[00;00mThere are 1 evaluation directions[00;00m at sampling 1/128 m.
    Evl 0: weight is 1.000, at (   0.00,    0.00) arcsec
[00;00mSimulation[00;00m start at step 0, end at step 1600, with time step 1/1500s, [00;00mclose loop[00;00m.
After setup_parms:	120.6 MiB.
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
CUDA: minimum memory requirement is 0.3GB
GPU 0 is NVIDIA A100-SXM4-40GB with arch 8.0, 38.9GB free, 39.3GB total device memory.
Using GPU 0
Use 1 GPUs for WFS Tomo Fit Evl

*** Preparation started at 2025/02/17 15:06:05 in nid001972. ***

Using OpenMP version 201511 with 128 threads
Reading aperture amplitude map from KECK.fits
[00;00m[0;36mWarning(accphi.c:477): 108331 points not covered by input screen
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
 ->maos.c:447->setup.c:148->aper.c:74->utils.c:478->accphi.c:478
iwvl 0: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 1: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 2: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 3: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 4: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 5: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 6: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 7: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 8: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
After setup_aper:	344.9 MiB.

[00;00mSetting up powfs 0 geom[00;00m

There are 22 points in each subaperture of 0.171m.
There are 2565 valid subaperture.

[00;00mSetting up powfs 1 geom[00;00m

There are 88 points in each subaperture of 5.5m.
There are 4 valid subaperture.

[00;00mSetting up powfs 2 geom[00;00m

There are 18 points in each subaperture of 0.563m.
There are 236 valid subaperture.
After setup_powfs_init:	436.9 MiB.

[00;00mSetting up reconstructor geometry.[00;00m

PLOC is 133x133, with sampling of 0.09m (square)
    DM 0: grid is 68 x 68
    DM 1: grid is 75 x 75
    DM 2: grid is 80 x 79
FLOC is 133x133, with sampling of 0.09m (not square)
Tomography grid is square:
    layer 0: xloc grid is 240 x 240, sampling is 0.086 m, 57600 points
    layer 1: xloc grid is 240 x 240, sampling is 0.085 m, 57600 points
    layer 2: xloc grid is 240 x 240, sampling is 0.085 m, 57600 points
    layer 3: xloc grid is 240 x 240, sampling is 0.085 m, 57600 points
    layer 4: xloc grid is 240 x 240, sampling is 0.085 m, 57600 points
    layer 5: xloc grid is 240 x 240, sampling is 0.085 m, 57600 points
    layer 6: xloc grid is 240 x 240, sampling is 0.085 m, 57600 points
    layer 7: xloc grid is 240 x 240, sampling is 0.085 m, 57600 points
    layer 8: xloc grid is 240 x 240, sampling is 0.085 m, 57600 points
    layer 9: xloc grid is 240 x 240, sampling is 0.085 m, 57600 points
    layer 10: xloc grid is 240 x 240, sampling is 0.081 m, 57600 points
    layer 11: xloc grid is 240 x 240, sampling is 0.078 m, 57600 points
    layer 12: xloc grid is 240 x 240, sampling is 0.074 m, 57600 points
    layer 13: xloc grid is 240 x 240, sampling is 0.066 m, 57600 points

[00;00mSetting up powfs 0 PO WFS[00;00m

OTF dimension is 48x48 (calculated)
There is no bias
Uplink FWHM (illt 0, iwvl 0) is 0.577524"
Downlink FWHM (illt 0, iwvl 0) is 1.14505"
Generating matched filter for powfs 0
sa index   location       noise equivalent angle
    1254: (  4.9,  -0.3) m, (120.74, 117.26) mas
    1247: (  3.7,  -0.3) m, (128.72, 118.71) mas
    1241: (  2.7,  -0.3) m, (139.48, 120.35) mas
    1235: (  1.6,  -0.3) m, (152.87, 121.95) mas
    1233: (  1.3,  -0.3) m, (158.24, 122.46) mas
     879: ( -0.6,  -1.5) m, (191.41, 127.60) mas
    1229: ( -1.8,  -0.3) m, (208.29, 126.08) mas
    1223: ( -2.8,  -0.3) m, (221.09, 127.17) mas
    1216: ( -4.0,  -0.3) m, (236.76, 128.51) mas
    1210: ( -5.0,  -0.3) m, (252.42, 129.65) mas
    1208: ( -5.4,  -0.3) m, (258.50, 130.03) mas
sa index   location       noise equivalent angle
    2207: (  3.7,   3.0) m, (119.54, 119.01) mas
    2062: (  3.0,   2.5) m, (123.99, 122.33) mas
    1807: (  2.0,   1.6) m, (133.86, 130.05) mas
    1751: (  1.8,   1.5) m, (136.15, 132.03) mas
    1533: (  0.9,   0.8) m, (147.86, 140.78) mas
    1531: ( -1.1,   0.8) m, (178.43, 142.86) mas
    1032: ( -1.1,  -0.9) m, (179.92, 164.88) mas
     760: ( -2.1,  -1.8) m, (191.25, 172.83) mas
     552: ( -3.0,  -2.5) m, (203.82, 183.08) mas
     504: ( -3.2,  -2.7) m, (206.77, 186.14) mas
      88: ( -3.0,  -4.4) m, (204.06, 211.69) mas
sa index   location       noise equivalent angle
    2559: (  0.8,   4.7) m, (117.64, 121.21) mas
    2391: (  0.6,   3.8) m, (118.64, 126.80) mas
    2141: (  0.4,   2.8) m, (120.50, 136.47) mas
    1903: (  0.3,   2.0) m, (129.69, 155.32) mas
    1686: (  0.1,   1.3) m, (123.77, 156.96) mas
    1231: ( -1.5,  -0.3) m, (133.90, 184.57) mas
     770: ( -0.4,  -1.8) m, (129.00, 208.84) mas
     663: ( -0.4,  -2.1) m, (137.87, 229.01) mas
     425: ( -0.6,  -3.0) m, (131.04, 225.91) mas
     175: ( -0.8,  -4.0) m, (133.00, 240.40) mas
       4: ( -2.3,  -4.9) m, (148.27, 260.97) mas
sa index   location       noise equivalent angle
    2483: ( -2.7,   4.4) m, (117.84, 119.38) mas
    2301: ( -2.1,   3.5) m, (120.51, 124.56) mas
    1989: ( -1.5,   2.3) m, (126.07, 135.86) mas
    1894: ( -1.3,   2.0) m, (135.52, 149.88) mas
    1627: ( -0.8,   1.1) m, (133.21, 152.10) mas
     984: ( -0.9,  -1.1) m, (136.80, 191.06) mas
     938: (  0.6,  -1.3) m, (148.13, 190.41) mas
     577: (  1.3,  -2.5) m, (156.68, 208.81) mas
     346: (  1.8,  -3.3) m, (163.77, 220.67) mas
     265: (  2.0,  -3.7) m, (166.64, 225.93) mas
      83: (  2.5,  -4.5) m, (174.26, 237.50) mas
sa index   location       noise equivalent angle
    1768: ( -4.7,   1.6) m, (128.37, 123.79) mas
    1663: ( -3.8,   1.3) m, (126.32, 119.52) mas
    1612: ( -3.3,   1.1) m, (131.19, 120.96) mas
    1479: ( -2.0,   0.6) m, (154.89, 133.55) mas
    1434: ( -1.5,   0.4) m, (154.43, 127.05) mas
    1581: (  0.8,   0.9) m, (191.02, 127.59) mas
    1131: (  1.3,  -0.6) m, (201.53, 136.68) mas
    1086: (  1.8,  -0.8) m, (222.25, 148.17) mas
     953: (  3.2,  -1.3) m, (230.16, 144.61) mas
     852: (  4.2,  -1.6) m, (244.62, 149.11) mas
    1153: (  5.0,  -0.6) m, (257.89, 140.36) mas
sa index   location       noise equivalent angle
     745: ( -4.7,  -1.8) m, (128.37, 123.79) mas
     860: ( -3.8,  -1.5) m, (126.32, 119.52) mas
     918: ( -3.3,  -1.3) m, (131.19, 120.96) mas
    1075: ( -2.0,  -0.8) m, (154.49, 132.51) mas
    1128: ( -1.5,  -0.6) m, (154.43, 127.05) mas
     987: (  0.8,  -1.1) m, (192.23, 128.58) mas
    1437: (  1.3,   0.4) m, (201.53, 136.68) mas
    1490: (  1.8,   0.6) m, (222.87, 149.30) mas
    1649: (  3.2,   1.1) m, (230.16, 144.61) mas
    1765: (  4.2,   1.5) m, (244.62, 149.11) mas
    1459: (  5.0,   0.4) m, (258.13, 140.56) mas
sa index   location       noise equivalent angle
      53: ( -2.7,  -4.5) m, (117.84, 119.38) mas
     241: ( -2.1,  -3.7) m, (120.51, 124.56) mas
     561: ( -1.5,  -2.5) m, (126.07, 135.86) mas
     658: ( -1.3,  -2.1) m, (135.78, 151.15) mas
     933: ( -0.8,  -1.3) m, (133.21, 152.10) mas
    1578: ( -0.9,   0.9) m, (135.23, 189.08) mas
    1634: (  0.6,   1.1) m, (148.13, 190.41) mas
    2005: (  1.3,   2.3) m, (156.68, 208.81) mas
    2242: (  1.8,   3.2) m, (163.77, 220.67) mas
    2325: (  2.0,   3.5) m, (166.64, 225.92) mas
    2513: (  2.5,   4.4) m, (174.26, 237.50) mas
sa index   location       noise equivalent angle
      12: (  0.8,  -4.9) m, (117.39, 120.94) mas
     183: (  0.6,  -4.0) m, (118.64, 126.80) mas
     431: (  0.4,  -3.0) m, (120.50, 136.47) mas
     667: (  0.3,  -2.1) m, (130.46, 157.39) mas
     883: (  0.1,  -1.5) m, (123.77, 156.96) mas
    1436: (  1.1,   0.4) m, (134.24, 200.28) mas
    1793: ( -0.4,   1.6) m, (129.00, 208.84) mas
    1899: ( -0.4,   2.0) m, (136.95, 225.95) mas
    2135: ( -0.6,   2.8) m, (131.04, 225.91) mas
    2383: ( -0.8,   3.8) m, (133.00, 240.39) mas
    2551: ( -2.3,   4.7) m, (151.13, 265.36) mas
sa index   location       noise equivalent angle
     403: (  3.7,  -3.2) m, (119.54, 119.01) mas
     540: (  3.0,  -2.7) m, (123.99, 122.33) mas
     784: (  2.0,  -1.8) m, (133.86, 130.05) mas
     838: (  1.8,  -1.6) m, (136.15, 132.03) mas
    1033: (  0.9,  -0.9) m, (148.87, 141.78) mas
    1633: (  0.4,   1.1) m, (165.17, 177.75) mas
    1531: ( -1.1,   0.8) m, (178.17, 163.19) mas
    1783: ( -2.1,   1.6) m, (191.25, 172.83) mas
    1980: ( -3.0,   2.3) m, (203.82, 183.08) mas
    2026: ( -3.2,   2.5) m, (206.77, 186.14) mas
    2444: ( -3.0,   4.2) m, (204.06, 211.69) mas

[00;00mSetting up powfs 2 PO WFS[00;00m

OTF dimension is 48x48 (calculated)
Generating matched filter for powfs 2
Use sanea to derive neasim
Use sanea to derive neasim

[00;00mSetting up reconstructor[00;00m

Recon NEA: cmf(165.48) cmf(165.98) cmf(164.97) cmf(165.53) cmf(165.15) cmf(165.12) cmf(165.47) cmf(164.91) cmf(165.94) geom(0.31) geom(0.31) geom(0.31) mf(0.14)  mas
Setup or update control matrix parameters.
RRtwfs svd threshold is 1e-10
Replacing HA by HA*fit->actextrap
Adding piston cr to fit matrix
Adding TT cr on upper DMs to fit matrix.
Before assembling fit matrix:	4810.2 MiB.
Building fit->FR
Building fit->FL
Adding tikhonov constraint of 1.0e-07 to FLM
The maximum eigen value is estimated to be around 3.0e-04
DM Fit number of Low rank terms: 16 in LHS
After assemble fit matrix:	6270.9 MiB.
After setup_recon:	6270.9 MiB.
GPU 0: mem used 1956 MB (wfs init)
GPU 0: mem used 2872 MB (recon init)
GPU 0: mem used 2904 MB (perf init)

*** Simulation started at 2025/02/17 15:07:50 in nid001972. ***

Running seed 1
GPU 0: mem used 2904 MB (wfs seeding)
Wind dir: 267.3 261.7 167.0 130.5 300.7  32.3 119.8 139.0 150.8 277.7 203.0 133.1  45.9 265.1 deg
Using /global/homes/b/bpeck/.aos/cache/atm/vonkarman_14_8192x8192_0.0078125_1115374592d.bin
After genatm:	6231.5 MiB.
Step     #  Open Loop  PR TT  On axis  PR TT  Field RMS PR TT     Timing 
Step     0: OL  884.6  248.3  OA  884.6 248.3 CL  884.6 248.3 nm  0.106 s
Step    16: OL  909.8  254.4  OA  109.4  22.0 CL  109.4  22.0 nm  0.063 s
Step    31: OL  933.7  258.9  OA  106.4   7.7 CL  106.4   7.7 nm  0.077 s
Step    46: OL  956.6  261.0  OA  103.7   9.5 CL  103.7   9.5 nm  0.068 s
Step    60: OL  977.2  260.7  OA  101.8   9.9 CL  101.8   9.9 nm  0.082 s
Step    74: OL  998.1  259.2  OA  102.6  12.0 CL  102.6  12.0 nm  0.071 s
Step    88: OL 1019.5  258.0  OA  102.9   5.7 CL  102.9   5.7 nm  0.070 s
Step   102: OL 1040.7  257.3  OA  101.6   9.4 CL  101.6   9.4 nm  0.099 s
Step   116: OL 1062.0  257.9  OA  108.8  25.4 CL  108.8  25.4 nm  0.069 s
Step   130: OL 1082.1  260.1  OA  103.3   5.0 CL  103.3   5.0 nm  0.076 s
Step   144: OL 1101.0  264.7  OA  101.0  10.5 CL  101.0  10.5 nm  0.074 s
Step   158: OL 1117.6  271.0  OA  103.5  13.4 CL  103.5  13.4 nm  0.073 s
Step   172: OL 1131.9  278.9  OA  108.2  30.2 CL  108.2  30.2 nm  0.069 s
Step   186: OL 1143.1  287.7  OA  104.2  28.5 CL  104.2  28.5 nm  0.074 s
Step   200: OL 1151.2  296.8  OA  103.9  18.8 CL  103.9  18.8 nm  0.068 s
Step   214: OL 1157.1  305.7  OA  102.1  21.3 CL  102.1  21.3 nm  0.069 s
Step   228: OL 1160.3  314.7  OA  100.9  21.5 CL  100.9  21.5 nm  0.073 s
Step   242: OL 1160.7  324.1  OA  103.5  32.5 CL  103.5  32.5 nm  0.076 s
Step   255 updated high order loop gain: 0.367
Step   256: OL 1157.1  334.1  OA  102.5  18.5 CL  102.5  18.5 nm  0.076 s
Step   270: OL 1149.1  344.2  OA   99.2  15.4 CL   99.2  15.4 nm  0.074 s
Step   282: OL 1139.2  353.0  OA  100.8  17.0 CL  100.8  17.0 nm  0.069 s
Step   295: OL 1126.5  363.7  OA   98.9  14.6 CL   98.9  14.6 nm  0.075 s
Step   309: OL 1111.4  376.2  OA  102.7  11.6 CL  102.7  11.6 nm  0.071 s
Step   323: OL 1094.1  389.7  OA  103.3  28.9 CL  103.3  28.9 nm  0.078 s
Step   337: OL 1076.0  404.9  OA  103.7  25.1 CL  103.7  25.1 nm  0.070 s
Step   351: OL 1058.0  422.3  OA  103.2  14.0 CL  103.2  14.0 nm  0.070 s
Step   365: OL 1040.6  441.4  OA  102.7   6.1 CL  102.7   6.1 nm  0.079 s
Step   379: OL 1024.6  461.5  OA  106.5  14.0 CL  106.5  14.0 nm  0.072 s
Step   393: OL 1009.3  481.8  OA  105.6   8.9 CL  105.6   8.9 nm  0.073 s
Step   407: OL  994.0  501.8  OA  104.6  11.2 CL  104.6  11.2 nm  0.077 s
Step   421: OL  978.4  520.9  OA  101.8  13.1 CL  101.8  13.1 nm  0.069 s
Step   435: OL  962.9  539.5  OA  101.5  16.5 CL  101.5  16.5 nm  0.074 s
Step   449: OL  948.2  557.7  OA  101.8  10.2 CL  101.8  10.2 nm  0.080 s
Step   463: OL  936.6  576.1  OA  103.0   7.8 CL  103.0   7.8 nm  0.073 s
Step   477: OL  929.4  594.1  OA  103.6   3.3 CL  103.6   3.3 nm  0.070 s
Step   491: OL  927.2  611.5  OA  103.7  10.0 CL  103.7  10.0 nm  0.070 s
Step   505: OL  928.1  627.7  OA  101.1   8.5 CL  101.1   8.5 nm  0.070 s
Step   511 updated high order loop gain: 0.341
Step   518: OL  931.0  641.1  OA  100.4  15.2 CL  100.4  15.2 nm  0.076 s
Step   532: OL  936.4  652.8  OA  101.4   6.7 CL  101.4   6.7 nm  0.074 s
Step   546: OL  944.1  661.3  OA  106.1  17.4 CL  106.1  17.4 nm  0.069 s
Step   560: OL  954.6  666.8  OA  102.2  10.0 CL  102.2  10.0 nm  0.070 s
Step   574: OL  966.9  669.8  OA  104.2  16.2 CL  104.2  16.2 nm  0.078 s
Step   588: OL  981.2  670.7  OA  104.7  16.5 CL  104.7  16.5 nm  0.070 s
Step   602: OL  997.0  668.4  OA  102.2   7.2 CL  102.2   7.2 nm  0.074 s
Step   616: OL 1013.3  662.9  OA  104.4  21.2 CL  104.4  21.2 nm  0.078 s
Step   630: OL 1029.5  654.7  OA   98.0   1.3 CL   98.0   1.3 nm  0.072 s
Step   644: OL 1044.9  643.9  OA   98.2   3.8 CL   98.2   3.8 nm  0.070 s
Step   658: OL 1058.7  631.1  OA   99.9   4.7 CL   99.9   4.7 nm  0.073 s
Step   672: OL 1071.4  616.8  OA  101.1  14.4 CL  101.1  14.4 nm  0.071 s
Step   686: OL 1083.2  602.2  OA  104.7  14.9 CL  104.7  14.9 nm  0.071 s
Step   700: OL 1093.5  586.9  OA  104.1   8.6 CL  104.1   8.6 nm  0.080 s
Step   713: OL 1100.7  571.3  OA  105.6   5.3 CL  105.6   5.3 nm  0.074 s
Step   727: OL 1105.1  554.0  OA  101.4  14.8 CL  101.4  14.8 nm  0.072 s
Step   741: OL 1106.0  536.7  OA  101.6   5.4 CL  101.6   5.4 nm  0.069 s
Step   755: OL 1103.5  519.7  OA  103.4  14.5 CL  103.4  14.5 nm  0.069 s
Step   767 updated high order loop gain: 0.329
Step   769: OL 1097.6  503.4  OA  101.0   7.3 CL  101.0   7.3 nm  0.069 s
Step   783: OL 1088.2  487.6  OA   99.4   2.9 CL   99.4   2.9 nm  0.070 s
Step   797: OL 1075.0  472.0  OA  105.1   7.9 CL  105.1   7.9 nm  0.070 s
Step   811: OL 1059.1  456.4  OA  104.1  11.6 CL  104.1  11.6 nm  0.072 s
Step   825: OL 1040.4  440.8  OA  101.3   8.2 CL  101.3   8.2 nm  0.081 s
Step   839: OL 1019.4  425.8  OA  103.3   4.6 CL  103.3   4.6 nm  0.068 s
Step   853: OL  997.5  411.7  OA  101.8  12.2 CL  101.8  12.2 nm  0.073 s
Step   867: OL  975.4  398.9  OA  102.9  15.4 CL  102.9  15.4 nm  0.070 s
Step   881: OL  954.5  387.8  OA  106.9  18.1 CL  106.9  18.1 nm  0.071 s
Step   895: OL  933.6  378.2  OA  103.3  10.4 CL  103.3  10.4 nm  0.070 s
Step   909: OL  911.5  369.9  OA  104.1   9.6 CL  104.1   9.6 nm  0.073 s
Step   922: OL  890.6  363.5  OA  103.4   2.6 CL  103.4   2.6 nm  0.078 s
Step   936: OL  868.6  356.9  OA  105.6  13.4 CL  105.6  13.4 nm  0.072 s
Step   950: OL  847.5  350.1  OA  106.1  13.3 CL  106.1  13.3 nm  0.071 s
Step   964: OL  828.3  342.9  OA  106.0   4.3 CL  106.0   4.3 nm  0.073 s
Step   978: OL  811.9  334.6  OA   99.4  11.2 CL   99.4  11.2 nm  0.069 s
Step   992: OL  797.8  325.4  OA   98.7  11.5 CL   98.7  11.5 nm  0.070 s
Step  1006: OL  784.8  315.2  OA  106.8  24.7 CL  106.8  24.7 nm  0.069 s
Step  1020: OL  773.6  304.5  OA  106.1  10.6 CL  106.1  10.6 nm  0.072 s
Step  1023 updated high order loop gain: 0.324
Step  1034: OL  764.3  293.4  OA  102.9  14.0 CL  102.9  14.0 nm  0.072 s
Step  1048: OL  756.3  281.3  OA  109.0  27.8 CL  109.0  27.8 nm  0.071 s
Step  1062: OL  748.2  268.1  OA  105.0  15.2 CL  105.0  15.2 nm  0.071 s
Step  1076: OL  741.8  252.9  OA  102.7  16.6 CL  102.7  16.6 nm  0.074 s
Step  1090: OL  738.0  236.6  OA  103.6  24.3 CL  103.6  24.3 nm  0.072 s
Step  1104: OL  736.4  221.2  OA  110.0  32.8 CL  110.0  32.8 nm  0.071 s
Step  1117: OL  736.0  208.2  OA  105.4  27.5 CL  105.4  27.5 nm  0.073 s
Step  1131: OL  736.6  196.2  OA   97.6   6.7 CL   97.6   6.7 nm  0.077 s
Step  1145: OL  737.3  186.4  OA  101.9  28.7 CL  101.9  28.7 nm  0.071 s
Step  1159: OL  738.0  178.7  OA  101.5  20.6 CL  101.5  20.6 nm  0.072 s
Step  1173: OL  738.4  173.3  OA  103.8  23.6 CL  103.8  23.6 nm  0.080 s
Step  1187: OL  740.3  169.8  OA  101.0  20.6 CL  101.0  20.6 nm  0.070 s
Step  1201: OL  743.3  166.9  OA  101.2  20.4 CL  101.2  20.4 nm  0.070 s
Step  1215: OL  746.3  164.6  OA  104.4  28.7 CL  104.4  28.7 nm  0.074 s
Step  1229: OL  749.3  163.7  OA  104.6  25.0 CL  104.6  25.0 nm  0.070 s
Step  1242: OL  750.9  164.6  OA  100.3  15.9 CL  100.3  15.9 nm  0.070 s
Step  1256: OL  752.9  168.1  OA  105.1  29.9 CL  105.1  29.9 nm  0.071 s
Step  1270: OL  755.6  173.9  OA  106.2  38.9 CL  106.2  38.9 nm  0.076 s
Step  1279 updated high order loop gain: 0.320
Step  1282: OL  758.6  180.4  OA  100.1  19.9 CL  100.1  19.9 nm  0.072 s
Step  1296: OL  763.2  189.1  OA  101.2  23.5 CL  101.2  23.5 nm  0.075 s
Step  1310: OL  767.5  199.1  OA  103.7  21.9 CL  103.7  21.9 nm  0.070 s
Step  1324: OL  771.6  210.2  OA  100.3  17.6 CL  100.3  17.6 nm  0.071 s
Step  1338: OL  776.7  222.5  OA  101.9  24.1 CL  101.9  24.1 nm  0.080 s
Step  1352: OL  783.5  235.3  OA   99.4  21.0 CL   99.4  21.0 nm  0.071 s
Step  1366: OL  792.2  247.0  OA   98.0  22.4 CL   98.0  22.4 nm  0.070 s
Step  1379: OL  801.3  255.8  OA   98.0  17.7 CL   98.0  17.7 nm  0.070 s
Step  1393: OL  812.2  263.4  OA  100.0  22.7 CL  100.0  22.7 nm  0.070 s
Step  1407: OL  824.6  268.9  OA  102.9  28.2 CL  102.9  28.2 nm  0.077 s
Step  1421: OL  838.3  272.9  OA   99.7  12.3 CL   99.7  12.3 nm  0.069 s
Step  1435: OL  852.3  276.0  OA  101.6  21.1 CL  101.6  21.1 nm  0.072 s
Step  1449: OL  865.5  278.4  OA   98.0  13.8 CL   98.0  13.8 nm  0.081 s
Step  1463: OL  877.5  279.5  OA  103.2  23.6 CL  103.2  23.6 nm  0.071 s
Step  1477: OL  886.7  278.7  OA  102.7  17.2 CL  102.7  17.2 nm  0.070 s
Step  1491: OL  892.0  275.8  OA   97.2   4.3 CL   97.2   4.3 nm  0.081 s
Step  1505: OL  893.4  270.9  OA  100.2  10.0 CL  100.2  10.0 nm  0.068 s
Step  1518: OL  892.1  265.1  OA   98.8  12.8 CL   98.8  12.8 nm  0.072 s
Step  1532: OL  888.4  257.5  OA   98.5  14.7 CL   98.5  14.7 nm  0.073 s
Step  1535 updated high order loop gain: 0.316
Step  1546: OL  882.5  248.6  OA  101.5   8.5 CL  101.5   8.5 nm  0.073 s
Step  1560: OL  875.9  239.3  OA  101.9   8.2 CL  101.9   8.2 nm  0.072 s
Step  1574: OL  869.0  230.8  OA  104.3  14.7 CL  104.3  14.7 nm  0.072 s
Step  1588: OL  860.6  223.9  OA  105.8  18.9 CL  105.8  18.9 nm  0.071 s
Step 1599: Output PSF
Step  1599: OL  853.4  219.3  OA  103.2   9.4 CL  103.2   9.4 nm  1.418 s
Mean: 102.65 17.79 101.10  nm.

*** Simulation Finished at 2025/02/17 15:09:56 in nid001972. ***

[00;00m>>>>>>>>>>>>>>>>[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
/global/cfs/cdirs/ulens/vismcao/maos -o studies/reduced_ngs/9_lgs/8mag_lgs/3500count -c master_files/reduced_ngs/9_lgs/8mag_lgs/kola_3500act.conf -O 
Output folder is 'studies/reduced_ngs/9_lgs/8mag_lgs/3500count'.
SRC: /global/homes/b/bpeck/code/maos v2.9 4c88b7c2 2024-11-13 16:45:33 -0800
BUILT: /global/homes/b/bpeck/code/maos/optim by GCC (v12) on 2024/11/18 09:40:03 CPU(F64,+O3) with CUDA(v122,F32)
Launched at 2025/02/17 15:09:57 in nid001972 with PID 1694015.
The web based job monitor can be accessed at http://localhost:10300
Main config file is /global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_3500act.conf
[00;00m[0;36mWarning(path.c:48): Path not found: path=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; abspath=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; Ignored.
[00;00m[0;36mWarning(path.c:48): Path not found: path=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; abspath=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; Ignored.
[00;00m[0;36mWarning(readcfg.c:399): sim.apfsm has been renamed to powfs.apfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.epfsm has been renamed to powfs.epfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.alfsm has been renamed to powfs.alfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.commonfsm has been renamed to powfs.commonfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.idealfsm has been renamed to powfs.idealfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.zetafsm has been renamed to powfs.zetafsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.f0fsm has been renamed to powfs.f0fsm.
[00;00m[0;36mWarning(readcfg.c:399): tsurf has been renamed to ncpa.tsurf.
loaded 132 (132 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_sim.conf'
loaded  19 ( 19 new) records from '/global/cfs/cdirs/ulens/vismcao/./dm_none.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_ASM.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_DM2.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_DM3.conf'
loaded   0 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_dm_multiple.conf'
loaded   7 (  5 new) records from '/global/cfs/cdirs/ulens/vismcao/./atm_mk13n50p_ground_detail.conf'
loaded  76 ( 69 new) records from '/global/homes/b/bpeck/code/maos/config/maos/powfs_common.conf'
loaded  44 ( 38 new) records from '/global/cfs/cdirs/ulens/vismcao/./powfs_none.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_lgs.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_ttf_strap.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_twfs_lbwfs.conf'
loaded   0 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_wfs_lgs_strap_lbwfs.conf'
loaded  71 ( 71 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_recon.conf'
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_smooth has been renamed to powfs0_llt.na_smooth.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_interp has been renamed to powfs0_llt.na_interp.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_thres has been renamed to powfs0_llt.na_thres.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_maxit has been renamed to powfs0_llt.na_fit_maxit.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_svdthres has been renamed to powfs0_llt.na_fit_svdthres.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_dh has been renamed to powfs0_llt.na_fit_dh.
[00;00m[0;36mWarning(readcfg.c:399): dbg.ncpa_preload has been renamed to ncpa.preload.
[00;00m[0;36mWarning(readcfg.c:399): dbg.ncpa_rmsci has been renamed to ncpa.rmsci.
[00;00m[0;36mWarning(readcfg.c:399): dbg.draw_opdmax has been renamed to plot.opdmax.
[00;00m[0;36mWarning(readcfg.c:399): dbg.draw_gmax has been renamed to plot.gmax.
loaded  95 ( 93 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_dbg.conf'
loaded   4 (  4 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_fit_mcao.conf'
[00;00m[0;36mWarning(readcfg.c:399): surf has been renamed to ncpa.surf.
loaded  39 (  7 new) records from '/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_3500act.conf'
loaded   0 (  0 new) records from 'command line'
loaded  24 ( 18 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_llt_CL.conf'
Adjust LGS range by telescope altitude 4145m.
Zenith angle is 30 degree.
    Scaling turbulence height and LGS hs by sec(za).
    Scaling r0 by cos(za)^(3/5).
    Scaling wind speed and LGS signal level by cos(za).
powfs0: Adjusting dx from 0.0078125 to 0.0075. 
powfs0.llt.fsm: f0=0 Hz, LPF ep=0
powfs0.epfsm is set to 0.517618 (auto)
powfs2: Adjusting dx from 0.03125 to 0.0312778. 
powfs2 is TWFS for powfs0
sim.ephi is set to 0.427717 (auto)
sim.eplo is set to 0.427717 (auto)
[00;00m[0;36mWarning(parms.c:2296): Layer 1 at 17.3205m is very close to layer 0 at 0m (OK).
[00;00m[0;36mWarning(parms.c:2296): Layer 2 at 34.641m is very close to layer 1 at 17.3205m (OK).
[00;00m[0;36mWarning(parms.c:2296): Layer 3 at 51.9615m is very close to layer 2 at 34.641m (OK).
dm 0: stroke=30 um is provided in micron.
dm 0: assume ia stroke=2 um is provided in micron.
dm 1: stroke=7 um is provided in micron.
dm 1: assume ia stroke=2 um is provided in micron.
dm 2: stroke=7 um is provided in micron.
dm 2: assume ia stroke=2 um is provided in micron.
Focus blending is not implemented yet for integrated tomography
parms->sim.mffocus is reset to 0
There are 1 valid simulation seeds:  1
Output PSF for 1 directions
Used 449 of 456 supplied keys
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_flate" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_flatv" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_psx" is not recognized, value is [0 0 0 0]
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_psy" is not recognized, value is [0 0 0 0]
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_pupelong" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_raw" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_side" is not recognized, value is 4
[00;00mAperture[00;00m is 11 m with sampling 1/128 m
[00;00mTurbulence at 30 degree zenith angle:[00;00m r0=0.128424m, L0=30m, 14 layers.
    Greenwood freq is 25.1Hz, anisoplanatic angle is 1.58 as
    Sampled 8192x8192 at 1/128m. wind dir is randomized.
    layer 0: ht=      0 m, wt= 0.302, ws=  4.8 m/s
    layer 1: ht=     17 m, wt= 0.154, ws=  5.0 m/s
    layer 2: ht=     35 m, wt= 0.041, ws=  5.4 m/s
    layer 3: ht=     52 m, wt= 0.002, ws=  6.6 m/s
    layer 4: ht=    139 m, wt= 0.021, ws=  6.1 m/s
    layer 5: ht=    231 m, wt= 0.010, ws=  6.1 m/s
    layer 6: ht=    323 m, wt= 0.008, ws=  6.1 m/s
    layer 7: ht=    416 m, wt= 0.005, ws=  6.1 m/s
    layer 8: ht=    508 m, wt= 0.001, ws=  6.1 m/s
    layer 9: ht=    932 m, wt= 0.107, ws=  5.6 m/s
    layer 10: ht=   5022 m, wt= 0.144, ws= 11.1 m/s
    layer 11: ht=   9238 m, wt= 0.093, ws= 19.1 m/s
    layer 12: ht=  13856 m, wt= 0.075, ws=  8.2 m/s
    layer 13: ht=  22518 m, wt= 0.036, ws=  4.8 m/s
[00;00mReconstruction[00;00m: r0=0.128424m L0=30m. 14 layers. use cone coordinate.
    layer 0: ht=      0 m, wt= 0.302
    layer 1: ht=     17 m, wt= 0.154
    layer 2: ht=     35 m, wt= 0.041
    layer 3: ht=     52 m, wt= 0.002
    layer 4: ht=    139 m, wt= 0.021
    layer 5: ht=    231 m, wt= 0.010
    layer 6: ht=    323 m, wt= 0.008
    layer 7: ht=    416 m, wt= 0.005
    layer 8: ht=    508 m, wt= 0.001
    layer 9: ht=    932 m, wt= 0.107
    layer 10: ht=   5022 m, wt= 0.144
    layer 11: ht=   9238 m, wt= 0.093
    layer 12: ht=  13856 m, wt= 0.075
    layer 13: ht=  22518 m, wt= 0.036
[00;00mThere are 3 powfs[00;00m
  powfs0: Order 67, LGS at 99.1 km. Sampling 1/133.333 m. Thres 30%. [00;00mT/T is removed in right hand side in tomography.[00;00m
    CCD image is 25x25 @ 500x500 mas, blur 27% (sigma), 1500Hz, wvl: [ 5.89e-07]
    Gtilt in reconstruction. Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
  powfs1: Order  2, NGS at inf km. Sampling 1/16 m. Thres 30%. 
    Ztilt in reconstruction. Geomtric optics start at 2 with ztilt [00;00m(noisy)[00;00m
  powfs2: Order 20, NGS at inf km. Sampling 1/31.9716 m. Thres 50%. 
    CCD image is 4x4 @ 1500x1500 mas, blur 0% (sigma), 0.015Hz, wvl: [ 7.2e-07]
    Gtilt in reconstruction. Geomtric optics start at 50 with gtilt Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
[00;00mThere are 13 wfs[00;00m
    wfs 0: type 0, at (  30.00,    0.00) arcsec,  99 km, siglev is 32.644 bkgrnd is 0.1
    wfs 1: type 0, at (  22.98,   19.28) arcsec,  99 km, siglev is 32.644 bkgrnd is 0.1
    wfs 2: type 0, at (   5.21,   29.54) arcsec,  99 km, siglev is 32.644 bkgrnd is 0.1
    wfs 3: type 0, at ( -15.00,   25.98) arcsec,  99 km, siglev is 32.644 bkgrnd is 0.1
    wfs 4: type 0, at ( -28.19,   10.26) arcsec,  99 km, siglev is 32.644 bkgrnd is 0.1
    wfs 5: type 0, at ( -28.19,  -10.26) arcsec,  99 km, siglev is 32.644 bkgrnd is 0.1
    wfs 6: type 0, at ( -15.00,  -25.98) arcsec,  99 km, siglev is 32.644 bkgrnd is 0.1
    wfs 7: type 0, at (   5.21,  -29.54) arcsec,  99 km, siglev is 32.644 bkgrnd is 0.1
    wfs 8: type 0, at (  22.98,  -19.28) arcsec,  99 km, siglev is 32.644 bkgrnd is 0.1
    wfs 9: type 1, at (   5.00,    8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 10: type 1, at ( -10.00,    0.00) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 11: type 1, at (   5.00,   -8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 12: type 2, at (   0.00,    0.00) arcsec, inf km, siglev is 4.1558e+06 bkgrnd is 0.001
[00;00mThere are 3 DMs[00;00m
  DM 0 at -0.1km, actuator pitch 0.165m, offset   0, with 30.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 1 at    6km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 2 at   10km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
[00;00mTomography[00;00m is using CG, with [00;00mFourer Domain[00;00m preconditioner, [00;00m12[00;00m iterations, integrated tomo.
[00;00mDM Fitting [00;00mis using CG, with [00;00mNo[00;00m preconditioner, [00;00m10[00;00m iterations
[00;00mThere are 9 fit directions[00;00m
    Fit 0: weight is 0.444, at (   0.00,    0.00) arcsec
    Fit 1: weight is 0.111, at (  15.00,    0.00) arcsec
    Fit 2: weight is 0.111, at (   0.00,   15.00) arcsec
    Fit 3: weight is 0.111, at ( -15.00,    0.00) arcsec
    Fit 4: weight is 0.111, at (   0.00,  -15.00) arcsec
    Fit 5: weight is 0.028, at (  15.00,   15.00) arcsec
    Fit 6: weight is 0.028, at ( -15.00,   15.00) arcsec
    Fit 7: weight is 0.028, at ( -15.00,  -15.00) arcsec
    Fit 8: weight is 0.028, at (  15.00,  -15.00) arcsec
[00;00mThere are 1 evaluation directions[00;00m at sampling 1/128 m.
    Evl 0: weight is 1.000, at (   0.00,    0.00) arcsec
[00;00mSimulation[00;00m start at step 0, end at step 1600, with time step 1/1500s, [00;00mclose loop[00;00m.
After setup_parms:	120.6 MiB.
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
CUDA: minimum memory requirement is 0.4GB
GPU 0 is NVIDIA A100-SXM4-40GB with arch 8.0, 38.9GB free, 39.3GB total device memory.
Using GPU 0
Use 1 GPUs for WFS Tomo Fit Evl

*** Preparation started at 2025/02/17 15:09:58 in nid001972. ***

Using OpenMP version 201511 with 128 threads
Reading aperture amplitude map from KECK.fits
[00;00m[0;36mWarning(accphi.c:477): 108646 points not covered by input screen
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
 ->maos.c:447->setup.c:148->aper.c:74->utils.c:478->accphi.c:478
iwvl 0: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 1: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 2: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 3: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 4: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 5: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 6: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 7: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 8: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
After setup_aper:	343.1 MiB.

[00;00mSetting up powfs 0 geom[00;00m

There are 22 points in each subaperture of 0.165m.
There are 2734 valid subaperture.

[00;00mSetting up powfs 1 geom[00;00m

There are 88 points in each subaperture of 5.5m.
There are 4 valid subaperture.

[00;00mSetting up powfs 2 geom[00;00m

There are 18 points in each subaperture of 0.563m.
There are 236 valid subaperture.
After setup_powfs_init:	427.9 MiB.

[00;00mSetting up reconstructor geometry.[00;00m

PLOC is 137x137, with sampling of 0.08m (square)
    DM 0: grid is 70 x 70
    DM 1: grid is 75 x 75
    DM 2: grid is 80 x 79
FLOC is 137x137, with sampling of 0.08m (not square)
Tomography grid is square:
    layer 0: xloc grid is 240 x 240, sampling is 0.083 m, 57600 points
    layer 1: xloc grid is 240 x 240, sampling is 0.082 m, 57600 points
    layer 2: xloc grid is 240 x 240, sampling is 0.082 m, 57600 points
    layer 3: xloc grid is 240 x 240, sampling is 0.082 m, 57600 points
    layer 4: xloc grid is 240 x 240, sampling is 0.082 m, 57600 points
    layer 5: xloc grid is 240 x 240, sampling is 0.082 m, 57600 points
    layer 6: xloc grid is 240 x 240, sampling is 0.082 m, 57600 points
    layer 7: xloc grid is 240 x 240, sampling is 0.082 m, 57600 points
    layer 8: xloc grid is 240 x 240, sampling is 0.082 m, 57600 points
    layer 9: xloc grid is 240 x 240, sampling is 0.082 m, 57600 points
    layer 10: xloc grid is 240 x 240, sampling is 0.078 m, 57600 points
    layer 11: xloc grid is 240 x 240, sampling is 0.075 m, 57600 points
    layer 12: xloc grid is 240 x 240, sampling is 0.071 m, 57600 points
[00;00m[0;36mWarning(map.c:195): ninx=240 is too small. need 241
[00;00m[0;36mWarning(map.c:200): niny=240 is too small. need 241
    layer 13: xloc grid is 240 x 240, sampling is 0.064 m, 57600 points

[00;00mSetting up powfs 0 PO WFS[00;00m

OTF dimension is 48x48 (calculated)
Uplink FWHM (illt 0, iwvl 0) is 0.576822"
Downlink FWHM (illt 0, iwvl 0) is 0"
Generating matched filter for powfs 0
sa index   location       noise equivalent angle
    1338: (  4.9,  -0.2) m, (5000.00, 5000.00) mas
    1331: (  3.7,  -0.2) m, (5000.00, 5000.00) mas
    1325: (  2.7,  -0.2) m, (5000.00, 5000.00) mas
    1318: (  1.6,  -0.2) m, (5000.00, 5000.00) mas
    1316: (  1.2,  -0.2) m, (5000.00, 5000.00) mas
     956: ( -0.6,  -1.4) m, (5000.00, 5000.00) mas
    1313: ( -1.7,  -0.2) m, (5000.00, 5000.00) mas
    1306: ( -2.9,  -0.2) m, (5000.00, 5000.00) mas
    1300: ( -3.9,  -0.2) m, (5000.00, 5000.00) mas
    1293: ( -5.0,  -0.2) m, (5000.00, 5000.00) mas
    1291: ( -5.4,  -0.2) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    2361: (  3.7,   3.1) m, (5000.00, 5000.00) mas
    2168: (  2.9,   2.4) m, (5000.00, 5000.00) mas
    2120: (  2.7,   2.2) m, (5000.00, 5000.00) mas
    1902: (  1.9,   1.6) m, (5000.00, 5000.00) mas
    1674: (  1.1,   0.9) m, (5000.00, 5000.00) mas
     962: (  0.4,  -1.4) m, (5000.00, 5000.00) mas
    1061: ( -1.2,  -1.1) m, (5000.00, 5000.00) mas
     833: ( -2.1,  -1.7) m, (5000.00, 5000.00) mas
     567: ( -3.1,  -2.6) m, (5000.00, 5000.00) mas
     374: ( -3.9,  -3.2) m, (5000.00, 5000.00) mas
      94: ( -3.1,  -4.4) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    2724: (  0.7,   4.7) m, (5000.00, 5000.00) mas
    2510: (  0.6,   3.7) m, (5000.00, 5000.00) mas
    2247: (  0.4,   2.7) m, (5000.00, 5000.00) mas
    2004: (  0.2,   1.9) m, (5000.00, 5000.00) mas
    1777: (  0.1,   1.2) m, (5000.00, 5000.00) mas
    1263: ( -1.4,  -0.4) m, (5000.00, 5000.00) mas
     843: ( -0.4,  -1.7) m, (5000.00, 5000.00) mas
     488: ( -0.6,  -2.9) m, (5000.00, 5000.00) mas
     225: ( -0.7,  -3.9) m, (5000.00, 5000.00) mas
      10: ( -0.9,  -4.9) m, (5000.00, 5000.00) mas
       6: ( -2.4,  -4.9) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    2608: ( -2.6,   4.2) m, (5000.00, 5000.00) mas
    2415: ( -2.1,   3.4) m, (5000.00, 5000.00) mas
    2327: ( -1.9,   3.1) m, (5000.00, 5000.00) mas
    2095: ( -1.4,   2.2) m, (5000.00, 5000.00) mas
    1720: ( -0.7,   1.1) m, (5000.00, 5000.00) mas
    1420: (  1.2,   0.1) m, (5000.00, 5000.00) mas
    1015: (  0.6,  -1.2) m, (5000.00, 5000.00) mas
     640: (  1.2,  -2.4) m, (5000.00, 5000.00) mas
     408: (  1.7,  -3.2) m, (5000.00, 5000.00) mas
     127: (  2.4,  -4.4) m, (5000.00, 5000.00) mas
      51: (  2.6,  -4.7) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    1862: ( -4.7,   1.6) m, (5000.00, 5000.00) mas
    1754: ( -3.7,   1.2) m, (5000.00, 5000.00) mas
    1705: ( -3.2,   1.1) m, (5000.00, 5000.00) mas
    1570: ( -1.9,   0.6) m, (5000.00, 5000.00) mas
    1522: ( -1.4,   0.4) m, (5000.00, 5000.00) mas
     958: ( -0.2,  -1.4) m, (5000.00, 5000.00) mas
    1213: (  1.2,  -0.6) m, (5000.00, 5000.00) mas
    1165: (  1.7,  -0.7) m, (5000.00, 5000.00) mas
     981: (  3.5,  -1.4) m, (5000.00, 5000.00) mas
     927: (  4.0,  -1.6) m, (5000.00, 5000.00) mas
    1288: (  5.2,  -0.4) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
     817: ( -4.7,  -1.7) m, (5000.00, 5000.00) mas
     937: ( -3.7,  -1.4) m, (5000.00, 5000.00) mas
     997: ( -3.2,  -1.2) m, (5000.00, 5000.00) mas
    1156: ( -1.9,  -0.7) m, (5000.00, 5000.00) mas
    1210: ( -1.4,  -0.6) m, (5000.00, 5000.00) mas
    1775: ( -0.2,   1.2) m, (5000.00, 5000.00) mas
    1525: (  1.2,   0.4) m, (5000.00, 5000.00) mas
    1579: (  1.7,   0.6) m, (5000.00, 5000.00) mas
    1798: (  3.5,   1.2) m, (5000.00, 5000.00) mas
    1858: (  4.0,   1.4) m, (5000.00, 5000.00) mas
    1496: (  5.2,   0.2) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
      97: ( -2.6,  -4.4) m, (5000.00, 5000.00) mas
     296: ( -2.1,  -3.5) m, (5000.00, 5000.00) mas
     386: ( -1.9,  -3.2) m, (5000.00, 5000.00) mas
     624: ( -1.4,  -2.4) m, (5000.00, 5000.00) mas
    1012: ( -0.7,  -1.2) m, (5000.00, 5000.00) mas
    1316: (  1.2,  -0.2) m, (5000.00, 5000.00) mas
    1723: (  0.6,   1.1) m, (5000.00, 5000.00) mas
    2111: (  1.2,   2.2) m, (5000.00, 5000.00) mas
    2349: (  1.7,   3.1) m, (5000.00, 5000.00) mas
    2638: (  2.4,   4.2) m, (5000.00, 5000.00) mas
    2711: (  2.6,   4.5) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
      15: (  0.7,  -4.9) m, (5000.00, 5000.00) mas
     233: (  0.6,  -3.9) m, (5000.00, 5000.00) mas
     494: (  0.4,  -2.9) m, (5000.00, 5000.00) mas
     735: (  0.2,  -2.1) m, (5000.00, 5000.00) mas
     960: (  0.1,  -1.4) m, (5000.00, 5000.00) mas
    1471: ( -1.4,   0.2) m, (5000.00, 5000.00) mas
    1888: ( -0.4,   1.6) m, (5000.00, 5000.00) mas
    2241: ( -0.6,   2.7) m, (5000.00, 5000.00) mas
    2502: ( -0.7,   3.7) m, (5000.00, 5000.00) mas
    2719: ( -0.9,   4.7) m, (5000.00, 5000.00) mas
    2716: ( -2.4,   4.7) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
     420: (  3.7,  -3.2) m, (5000.00, 5000.00) mas
     603: (  2.9,  -2.6) m, (5000.00, 5000.00) mas
     649: (  2.7,  -2.4) m, (5000.00, 5000.00) mas
     857: (  1.9,  -1.7) m, (5000.00, 5000.00) mas
    1066: (  1.1,  -1.1) m, (5000.00, 5000.00) mas
    1779: (  0.4,   1.2) m, (5000.00, 5000.00) mas
    1669: ( -1.2,   0.9) m, (5000.00, 5000.00) mas
    1878: ( -2.1,   1.6) m, (5000.00, 5000.00) mas
    2132: ( -3.1,   2.4) m, (5000.00, 5000.00) mas
    2315: ( -3.9,   3.1) m, (5000.00, 5000.00) mas
    2605: ( -3.1,   4.2) m, (5000.00, 5000.00) mas

[00;00mSetting up powfs 2 PO WFS[00;00m

OTF dimension is 48x48 (calculated)
Generating matched filter for powfs 2
Use sanea to derive neasim
Use sanea to derive neasim

[00;00mSetting up reconstructor[00;00m

Recon NEA: cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) geom(0.31) geom(0.31) geom(0.31) mf(0.14)  mas
Setup or update control matrix parameters.
RRtwfs svd threshold is 1e-10
Replacing HA by HA*fit->actextrap
Adding piston cr to fit matrix
Adding TT cr on upper DMs to fit matrix.
Before assembling fit matrix:	5010.5 MiB.
Building fit->FR
Building fit->FL
Adding tikhonov constraint of 1.0e-07 to FLM
The maximum eigen value is estimated to be around 2.9e-04
DM Fit number of Low rank terms: 16 in LHS
After assemble fit matrix:	6546.7 MiB.
After setup_recon:	6546.7 MiB.
GPU 0: mem used 1902 MB (wfs init)
GPU 0: mem used 2856 MB (recon init)
GPU 0: mem used 2888 MB (perf init)

*** Simulation started at 2025/02/17 15:10:57 in nid001972. ***

Running seed 1
GPU 0: mem used 2888 MB (wfs seeding)
Wind dir: 267.3 261.7 167.0 130.5 300.7  32.3 119.8 139.0 150.8 277.7 203.0 133.1  45.9 265.1 deg
Using /global/homes/b/bpeck/.aos/cache/atm/vonkarman_14_8192x8192_0.0078125_1115374592d.bin
After genatm:	6465.7 MiB.
Step     #  Open Loop  PR TT  On axis  PR TT  Field RMS PR TT     Timing 
Step     0: OL  884.6  248.3  OA  884.6 248.3 CL  884.6 248.3 nm  0.103 s
Step    15: OL  907.5  254.1  OA  756.3 234.0 CL  756.3 234.0 nm  0.066 s
Step    29: OL  929.1  258.5  OA  752.7 234.4 CL  752.7 234.4 nm  0.076 s
Step    43: OL  950.3  261.0  OA  744.5 230.5 CL  744.5 230.5 nm  0.085 s
Step    56: OL  969.6  261.2  OA  731.2 225.4 CL  731.2 225.4 nm  0.073 s
Step    69: OL  989.6  260.2  OA  720.2 219.8 CL  720.2 219.8 nm  0.078 s
Step    83: OL 1011.7  258.7  OA  708.9 213.9 CL  708.9 213.9 nm  0.081 s
Step    97: OL 1034.2  257.9  OA  703.8 210.9 CL  703.8 210.9 nm  0.071 s
Step   111: OL 1056.8  258.1  OA  697.1 205.9 CL  697.1 205.9 nm  0.076 s
Step   125: OL 1078.8  259.7  OA  694.6 201.4 CL  694.6 201.4 nm  0.075 s
Step   138: OL 1097.9  263.2  OA  694.6 197.3 CL  694.6 197.3 nm  0.085 s
Step   152: OL 1116.9  268.8  OA  691.1 193.2 CL  691.1 193.2 nm  0.078 s
Step   166: OL 1133.5  276.1  OA  688.8 191.5 CL  688.8 191.5 nm  0.074 s
Step   180: OL 1147.6  284.6  OA  689.1 192.4 CL  689.1 192.4 nm  0.083 s
Step   193: OL 1157.9  293.0  OA  689.4 194.4 CL  689.4 194.4 nm  0.076 s
Step   206: OL 1166.2  301.4  OA  691.6 198.2 CL  691.6 198.2 nm  0.075 s
Step   220: OL 1173.0  310.3  OA  696.8 204.0 CL  696.8 204.0 nm  0.076 s
Step   234: OL 1177.1  319.5  OA  704.4 211.7 CL  704.4 211.7 nm  0.073 s
Step   248: OL 1178.3  329.2  OA  707.1 220.6 CL  707.1 220.6 nm  0.076 s
Step   255 updated high order loop gain: 0.424
Step   261: OL 1175.5  338.5  OA  712.4 231.9 CL  712.4 231.9 nm  0.080 s
Step   275: OL 1168.1  348.6  OA  713.7 243.9 CL  713.7 243.9 nm  0.073 s
Step   289: OL 1157.2  359.4  OA  716.5 256.8 CL  716.5 256.8 nm  0.088 s
Step   303: OL 1144.4  371.5  OA  717.2 269.5 CL  717.2 269.5 nm  0.073 s
Step   317: OL 1129.1  384.5  OA  718.3 283.3 CL  718.3 283.3 nm  0.077 s
Step   330: OL 1113.0  397.7  OA  720.9 297.5 CL  720.9 297.5 nm  0.079 s
Step   344: OL 1095.1  414.0  OA  722.9 312.5 CL  722.9 312.5 nm  0.076 s
Step   358: OL 1076.9  432.3  OA  727.3 331.2 CL  727.3 331.2 nm  0.083 s
Step   372: OL 1059.4  452.0  OA  730.7 350.9 CL  730.7 350.9 nm  0.077 s
Step   386: OL 1042.5  472.2  OA  736.2 369.7 CL  736.2 369.7 nm  0.080 s
Step   397: OL 1029.4  488.1  OA  739.7 384.0 CL  739.7 384.0 nm  0.078 s
Step   410: OL 1013.5  506.5  OA  746.2 400.2 CL  746.2 400.2 nm  0.073 s
Step   424: OL  995.9  525.3  OA  750.3 418.5 CL  750.3 418.5 nm  0.071 s
Step   437: OL  979.8  542.6  OA  753.5 434.6 CL  753.5 434.6 nm  0.073 s
Step   451: OL  963.7  560.7  OA  754.7 449.7 CL  754.7 449.7 nm  0.078 s
Step   464: OL  951.8  577.7  OA  757.1 464.1 CL  757.1 464.1 nm  0.078 s
Step   478: OL  942.9  595.7  OA  763.1 480.1 CL  763.1 480.1 nm  0.076 s
Step   492: OL  939.1  613.0  OA  774.7 495.2 CL  774.7 495.2 nm  0.081 s
Step   506: OL  938.6  629.1  OA  788.0 509.8 CL  788.0 509.8 nm  0.075 s
Step   511 updated high order loop gain: 0.426
Step   519: OL  940.4  642.3  OA  799.9 520.8 CL  799.9 520.8 nm  0.076 s
Step   532: OL  944.2  653.1  OA  810.1 528.8 CL  810.1 528.8 nm  0.084 s
Step   546: OL  950.7  661.5  OA  820.7 533.3 CL  820.7 533.3 nm  0.074 s
Step   560: OL  960.0  667.0  OA  830.2 535.8 CL  830.2 535.8 nm  0.082 s
Step   573: OL  970.6  669.9  OA  837.9 536.0 CL  837.9 536.0 nm  0.080 s
Step   586: OL  982.9  670.9  OA  843.8 532.8 CL  843.8 532.8 nm  0.078 s
Step   599: OL  996.7  669.4  OA  847.3 527.1 CL  847.3 527.1 nm  0.076 s
Step   613: OL 1012.4  664.6  OA  849.6 518.4 CL  849.6 518.4 nm  0.078 s
Step   627: OL 1028.2  656.9  OA  848.2 506.6 CL  848.2 506.6 nm  0.073 s
Step   641: OL 1043.4  646.6  OA  842.5 493.0 CL  842.5 493.0 nm  0.077 s
Step   654: OL 1055.9  635.2  OA  832.6 478.2 CL  832.6 478.2 nm  0.078 s
Step   668: OL 1068.2  621.3  OA  821.2 461.4 CL  821.2 461.4 nm  0.085 s
Step   682: OL 1079.5  606.7  OA  809.9 444.4 CL  809.9 444.4 nm  0.073 s
Step   695: OL 1088.9  592.8  OA  798.1 426.3 CL  798.1 426.3 nm  0.076 s
Step   708: OL 1096.1  577.7  OA  787.6 407.6 CL  787.6 407.6 nm  0.081 s
Step   722: OL 1100.8  560.5  OA  772.9 384.4 CL  772.9 384.4 nm  0.075 s
Step   736: OL 1101.9  543.2  OA  758.2 362.2 CL  758.2 362.2 nm  0.077 s
Step   749: OL 1099.8  527.3  OA  744.6 342.2 CL  744.6 342.2 nm  0.084 s
Step   762: OL 1094.9  511.9  OA  728.8 323.2 CL  728.8 323.2 nm  0.075 s
Step   767 updated high order loop gain: 0.427
Step   776: OL 1086.6  496.0  OA  711.4 304.9 CL  711.4 304.9 nm  0.086 s
Step   787: OL 1077.4  483.6  OA  699.8 292.8 CL  699.8 292.8 nm  0.138 s
Step   791: OL 1073.5  479.2  OA  694.7 288.3 CL  694.7 288.3 nm  0.547 s
Step   805: OL 1058.1  463.6  OA  678.7 272.1 CL  678.7 272.1 nm  0.077 s
Step   819: OL 1040.2  448.0  OA  664.9 256.5 CL  664.9 256.5 nm  0.076 s
Step   833: OL 1019.6  432.7  OA  652.3 240.5 CL  652.3 240.5 nm  0.080 s
Step   847: OL  997.8  418.2  OA  641.2 224.5 CL  641.2 224.5 nm  0.073 s
Step   861: OL  975.9  404.8  OA  634.8 212.2 CL  634.8 212.2 nm  0.080 s
Step   875: OL  955.1  393.0  OA  631.0 201.9 CL  631.0 201.9 nm  0.075 s
Step   889: OL  935.9  382.8  OA  630.4 194.6 CL  630.4 194.6 nm  0.074 s
Step   902: OL  917.7  374.4  OA  629.3 189.3 CL  629.3 189.3 nm  0.082 s
Step   916: OL  897.5  367.0  OA  624.4 186.8 CL  624.4 186.8 nm  0.072 s
Step   930: OL  877.8  360.3  OA  618.1 185.4 CL  618.1 185.4 nm  0.073 s
Step   944: OL  858.7  353.6  OA  610.6 185.2 CL  610.6 185.2 nm  0.075 s
Step   958: OL  840.8  346.6  OA  604.9 184.4 CL  604.9 184.4 nm  0.074 s
Step   971: OL  826.5  339.3  OA  599.7 183.1 CL  599.7 183.1 nm  0.081 s
Step   985: OL  813.3  330.6  OA  595.8 182.1 CL  595.8 182.1 nm  0.074 s
Step   999: OL  801.3  320.8  OA  594.3 178.2 CL  594.3 178.2 nm  0.074 s
Step  1013: OL  790.1  310.2  OA  591.0 174.5 CL  591.0 174.5 nm  0.077 s
Step  1023 updated high order loop gain: 0.427
Step  1026: OL  781.0  300.1  OA  587.0 171.0 CL  587.0 171.0 nm  0.073 s
Step  1040: OL  772.2  288.6  OA  583.5 165.5 CL  583.5 165.5 nm  0.085 s
Step  1054: OL  763.4  276.1  OA  578.0 159.7 CL  578.0 159.7 nm  0.074 s
Step  1068: OL  754.7  262.0  OA  573.9 152.0 CL  573.9 152.0 nm  0.074 s
Step  1081: OL  748.4  247.3  OA  570.9 140.5 CL  570.9 140.5 nm  0.083 s
Step  1095: OL  743.7  231.1  OA  568.7 126.5 CL  568.7 126.5 nm  0.076 s
Step  1108: OL  740.9  217.2  OA  567.3 113.5 CL  567.3 113.5 nm  0.074 s
Step  1122: OL  739.0  203.7  OA  568.3 100.2 CL  568.3 100.2 nm  0.072 s
Step  1136: OL  737.9  192.5  OA  570.3  88.8 CL  570.3  88.8 nm  0.073 s
Step  1150: OL  737.2  183.4  OA  572.2  80.4 CL  572.2  80.4 nm  0.080 s
Step  1164: OL  736.6  176.4  OA  576.6  74.9 CL  576.6  74.9 nm  0.075 s
Step  1177: OL  736.5  172.1  OA  581.8  72.1 CL  581.8  72.1 nm  0.072 s
Step  1190: OL  738.0  169.0  OA  588.2  69.7 CL  588.2  69.7 nm  0.081 s
Step  1204: OL  740.7  166.2  OA  598.2  67.5 CL  598.2  67.5 nm  0.074 s
Step  1218: OL  743.7  164.1  OA  608.2  66.2 CL  608.2  66.2 nm  0.076 s
Step  1232: OL  746.9  163.5  OA  618.2  66.4 CL  618.2  66.4 nm  0.075 s
Step  1246: OL  749.4  165.1  OA  625.7  70.5 CL  625.7  70.5 nm  0.074 s
Step  1259: OL  752.5  168.9  OA  631.8  75.4 CL  631.8  75.4 nm  0.079 s
Step  1273: OL  756.5  175.2  OA  637.9  81.4 CL  637.9  81.4 nm  0.076 s
Step  1279 updated high order loop gain: 0.427
Step  1287: OL  761.8  183.1  OA  642.2  88.0 CL  642.2  88.0 nm  0.083 s
Step  1300: OL  767.2  191.6  OA  645.8  93.4 CL  645.8  93.4 nm  0.074 s
Step  1314: OL  772.3  201.9  OA  644.9  99.1 CL  644.9  99.1 nm  0.073 s
Step  1328: OL  777.1  213.5  OA  642.5 104.6 CL  642.5 104.6 nm  0.077 s
Step  1342: OL  782.7  226.0  OA  638.9 111.6 CL  638.9 111.6 nm  0.072 s
Step  1355: OL  789.4  237.9  OA  637.2 115.6 CL  637.2 115.6 nm  0.084 s
Step  1369: OL  797.8  249.1  OA  639.2 118.3 CL  639.2 118.3 nm  0.071 s
Step  1383: OL  806.7  258.1  OA  641.3 119.4 CL  641.3 119.4 nm  0.074 s
Step  1396: OL  815.8  264.7  OA  647.0 118.2 CL  647.0 118.2 nm  0.082 s
Step  1410: OL  826.8  269.9  OA  655.0 116.1 CL  655.0 116.1 nm  0.074 s
Step  1423: OL  837.7  273.4  OA  661.1 113.3 CL  661.1 113.3 nm  0.071 s
Step  1437: OL  849.0  276.5  OA  665.8 110.9 CL  665.8 110.9 nm  0.076 s
Step  1451: OL  859.4  278.8  OA  670.3 108.9 CL  670.3 108.9 nm  0.073 s
Step  1465: OL  868.5  279.7  OA  669.7 106.2 CL  669.7 106.2 nm  0.080 s
Step  1479: OL  874.4  278.7  OA  669.1 103.6 CL  669.1 103.6 nm  0.078 s
Step  1493: OL  876.4  275.6  OA  666.5 105.0 CL  666.5 105.0 nm  0.077 s
Step  1507: OL  875.1  270.5  OA  658.0 105.5 CL  658.0 105.5 nm  0.072 s
Step  1521: OL  871.4  264.0  OA  647.6 105.7 CL  647.6 105.7 nm  0.077 s
Step  1535: OL  865.7  256.2  OA  641.1 105.5 CL  641.1 105.5 nm  0.074 s
Step  1535 updated high order loop gain: 0.428
Step  1548: OL  859.5  247.8  OA  636.0 103.9 CL  636.0 103.9 nm  0.075 s
Step  1561: OL  853.4  239.2  OA  632.8 101.8 CL  632.8 101.8 nm  0.082 s
Step  1575: OL  847.0  230.9  OA  630.9 102.4 CL  630.9 102.4 nm  0.072 s
Step  1589: OL  840.2  224.1  OA  629.4 104.7 CL  629.4 104.7 nm  0.072 s
Step 1599: Output PSF
Step  1599: OL  835.1  220.0  OA  630.4 108.1 CL  630.4 108.1 nm  1.445 s
Mean: 685.97 290.76 621.30  nm.

*** Simulation Finished at 2025/02/17 15:13:09 in nid001972. ***

[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
/global/cfs/cdirs/ulens/vismcao/maos -o studies/reduced_ngs/9_lgs/8mag_lgs/3750count -c master_files/reduced_ngs/9_lgs/8mag_lgs/kola_3750act.conf -O 
Output folder is 'studies/reduced_ngs/9_lgs/8mag_lgs/3750count'.
SRC: /global/homes/b/bpeck/code/maos v2.9 4c88b7c2 2024-11-13 16:45:33 -0800
BUILT: /global/homes/b/bpeck/code/maos/optim by GCC (v12) on 2024/11/18 09:40:03 CPU(F64,+O3) with CUDA(v122,F32)
Launched at 2025/02/17 15:13:09 in nid001972 with PID 1695391.
The web based job monitor can be accessed at http://localhost:10300
Main config file is /global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_3750act.conf
[00;00m[0;36mWarning(path.c:48): Path not found: path=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; abspath=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; Ignored.
[00;00m[0;36mWarning(path.c:48): Path not found: path=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; abspath=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; Ignored.
[00;00m[0;36mWarning(readcfg.c:399): sim.apfsm has been renamed to powfs.apfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.epfsm has been renamed to powfs.epfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.alfsm has been renamed to powfs.alfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.commonfsm has been renamed to powfs.commonfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.idealfsm has been renamed to powfs.idealfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.zetafsm has been renamed to powfs.zetafsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.f0fsm has been renamed to powfs.f0fsm.
[00;00m[0;36mWarning(readcfg.c:399): tsurf has been renamed to ncpa.tsurf.
loaded 132 (132 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_sim.conf'
loaded  19 ( 19 new) records from '/global/cfs/cdirs/ulens/vismcao/./dm_none.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_ASM.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_DM2.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_DM3.conf'
loaded   0 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_dm_multiple.conf'
loaded   7 (  5 new) records from '/global/cfs/cdirs/ulens/vismcao/./atm_mk13n50p_ground_detail.conf'
loaded  76 ( 69 new) records from '/global/homes/b/bpeck/code/maos/config/maos/powfs_common.conf'
loaded  44 ( 38 new) records from '/global/cfs/cdirs/ulens/vismcao/./powfs_none.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_lgs.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_ttf_strap.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_twfs_lbwfs.conf'
loaded   0 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_wfs_lgs_strap_lbwfs.conf'
loaded  71 ( 71 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_recon.conf'
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_smooth has been renamed to powfs0_llt.na_smooth.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_interp has been renamed to powfs0_llt.na_interp.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_thres has been renamed to powfs0_llt.na_thres.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_maxit has been renamed to powfs0_llt.na_fit_maxit.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_svdthres has been renamed to powfs0_llt.na_fit_svdthres.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_dh has been renamed to powfs0_llt.na_fit_dh.
[00;00m[0;36mWarning(readcfg.c:399): dbg.ncpa_preload has been renamed to ncpa.preload.
[00;00m[0;36mWarning(readcfg.c:399): dbg.ncpa_rmsci has been renamed to ncpa.rmsci.
[00;00m[0;36mWarning(readcfg.c:399): dbg.draw_opdmax has been renamed to plot.opdmax.
[00;00m[0;36mWarning(readcfg.c:399): dbg.draw_gmax has been renamed to plot.gmax.
loaded  95 ( 93 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_dbg.conf'
loaded   4 (  4 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_fit_mcao.conf'
[00;00m[0;36mWarning(readcfg.c:399): surf has been renamed to ncpa.surf.
loaded  39 (  7 new) records from '/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_3750act.conf'
loaded   0 (  0 new) records from 'command line'
loaded  24 ( 18 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_llt_CL.conf'
Adjust LGS range by telescope altitude 4145m.
Zenith angle is 30 degree.
    Scaling turbulence height and LGS hs by sec(za).
    Scaling r0 by cos(za)^(3/5).
    Scaling wind speed and LGS signal level by cos(za).
powfs0: Adjusting dx from 0.0078125 to 0.00795. 
powfs0.llt.fsm: f0=0 Hz, LPF ep=0
powfs0.epfsm is set to 0.517618 (auto)
powfs2: Adjusting dx from 0.03125 to 0.0312778. 
powfs2 is TWFS for powfs0
sim.ephi is set to 0.427717 (auto)
sim.eplo is set to 0.427717 (auto)
[00;00m[0;36mWarning(parms.c:2296): Layer 1 at 17.3205m is very close to layer 0 at 0m (OK).
[00;00m[0;36mWarning(parms.c:2296): Layer 2 at 34.641m is very close to layer 1 at 17.3205m (OK).
[00;00m[0;36mWarning(parms.c:2296): Layer 3 at 51.9615m is very close to layer 2 at 34.641m (OK).
dm 0: stroke=30 um is provided in micron.
dm 0: assume ia stroke=2 um is provided in micron.
dm 1: stroke=7 um is provided in micron.
dm 1: assume ia stroke=2 um is provided in micron.
dm 2: stroke=7 um is provided in micron.
dm 2: assume ia stroke=2 um is provided in micron.
Focus blending is not implemented yet for integrated tomography
parms->sim.mffocus is reset to 0
There are 1 valid simulation seeds:  1
Output PSF for 1 directions
Used 449 of 456 supplied keys
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_flate" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_flatv" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_psx" is not recognized, value is [0 0 0 0]
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_psy" is not recognized, value is [0 0 0 0]
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_pupelong" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_raw" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_side" is not recognized, value is 4
[00;00mAperture[00;00m is 11 m with sampling 1/128 m
[00;00mTurbulence at 30 degree zenith angle:[00;00m r0=0.128424m, L0=30m, 14 layers.
    Greenwood freq is 25.1Hz, anisoplanatic angle is 1.58 as
    Sampled 8192x8192 at 1/128m. wind dir is randomized.
    layer 0: ht=      0 m, wt= 0.302, ws=  4.8 m/s
    layer 1: ht=     17 m, wt= 0.154, ws=  5.0 m/s
    layer 2: ht=     35 m, wt= 0.041, ws=  5.4 m/s
    layer 3: ht=     52 m, wt= 0.002, ws=  6.6 m/s
    layer 4: ht=    139 m, wt= 0.021, ws=  6.1 m/s
    layer 5: ht=    231 m, wt= 0.010, ws=  6.1 m/s
    layer 6: ht=    323 m, wt= 0.008, ws=  6.1 m/s
    layer 7: ht=    416 m, wt= 0.005, ws=  6.1 m/s
    layer 8: ht=    508 m, wt= 0.001, ws=  6.1 m/s
    layer 9: ht=    932 m, wt= 0.107, ws=  5.6 m/s
    layer 10: ht=   5022 m, wt= 0.144, ws= 11.1 m/s
    layer 11: ht=   9238 m, wt= 0.093, ws= 19.1 m/s
    layer 12: ht=  13856 m, wt= 0.075, ws=  8.2 m/s
    layer 13: ht=  22518 m, wt= 0.036, ws=  4.8 m/s
[00;00mReconstruction[00;00m: r0=0.128424m L0=30m. 14 layers. use cone coordinate.
    layer 0: ht=      0 m, wt= 0.302
    layer 1: ht=     17 m, wt= 0.154
    layer 2: ht=     35 m, wt= 0.041
    layer 3: ht=     52 m, wt= 0.002
    layer 4: ht=    139 m, wt= 0.021
    layer 5: ht=    231 m, wt= 0.010
    layer 6: ht=    323 m, wt= 0.008
    layer 7: ht=    416 m, wt= 0.005
    layer 8: ht=    508 m, wt= 0.001
    layer 9: ht=    932 m, wt= 0.107
    layer 10: ht=   5022 m, wt= 0.144
    layer 11: ht=   9238 m, wt= 0.093
    layer 12: ht=  13856 m, wt= 0.075
    layer 13: ht=  22518 m, wt= 0.036
[00;00mThere are 3 powfs[00;00m
  powfs0: Order 70, LGS at 99.1 km. Sampling 1/125.786 m. Thres 30%. [00;00mT/T is removed in right hand side in tomography.[00;00m
    CCD image is 25x25 @ 500x500 mas, blur 27% (sigma), 1500Hz, wvl: [ 5.89e-07]
    Gtilt in reconstruction. Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
  powfs1: Order  2, NGS at inf km. Sampling 1/16 m. Thres 30%. 
    Ztilt in reconstruction. Geomtric optics start at 2 with ztilt [00;00m(noisy)[00;00m
  powfs2: Order 20, NGS at inf km. Sampling 1/31.9716 m. Thres 50%. 
    CCD image is 4x4 @ 1500x1500 mas, blur 0% (sigma), 0.015Hz, wvl: [ 7.2e-07]
    Gtilt in reconstruction. Geomtric optics start at 50 with gtilt Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
[00;00mThere are 13 wfs[00;00m
    wfs 0: type 0, at (  30.00,    0.00) arcsec,  99 km, siglev is 30.3126 bkgrnd is 0.1
    wfs 1: type 0, at (  22.98,   19.28) arcsec,  99 km, siglev is 30.3126 bkgrnd is 0.1
    wfs 2: type 0, at (   5.21,   29.54) arcsec,  99 km, siglev is 30.3126 bkgrnd is 0.1
    wfs 3: type 0, at ( -15.00,   25.98) arcsec,  99 km, siglev is 30.3126 bkgrnd is 0.1
    wfs 4: type 0, at ( -28.19,   10.26) arcsec,  99 km, siglev is 30.3126 bkgrnd is 0.1
    wfs 5: type 0, at ( -28.19,  -10.26) arcsec,  99 km, siglev is 30.3126 bkgrnd is 0.1
    wfs 6: type 0, at ( -15.00,  -25.98) arcsec,  99 km, siglev is 30.3126 bkgrnd is 0.1
    wfs 7: type 0, at (   5.21,  -29.54) arcsec,  99 km, siglev is 30.3126 bkgrnd is 0.1
    wfs 8: type 0, at (  22.98,  -19.28) arcsec,  99 km, siglev is 30.3126 bkgrnd is 0.1
    wfs 9: type 1, at (   5.00,    8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 10: type 1, at ( -10.00,    0.00) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 11: type 1, at (   5.00,   -8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 12: type 2, at (   0.00,    0.00) arcsec, inf km, siglev is 4.1558e+06 bkgrnd is 0.001
[00;00mThere are 3 DMs[00;00m
  DM 0 at -0.1km, actuator pitch 0.159m, offset   0, with 30.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 1 at    6km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 2 at   10km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
[00;00mTomography[00;00m is using CG, with [00;00mFourer Domain[00;00m preconditioner, [00;00m12[00;00m iterations, integrated tomo.
[00;00mDM Fitting [00;00mis using CG, with [00;00mNo[00;00m preconditioner, [00;00m10[00;00m iterations
[00;00mThere are 9 fit directions[00;00m
    Fit 0: weight is 0.444, at (   0.00,    0.00) arcsec
    Fit 1: weight is 0.111, at (  15.00,    0.00) arcsec
    Fit 2: weight is 0.111, at (   0.00,   15.00) arcsec
    Fit 3: weight is 0.111, at ( -15.00,    0.00) arcsec
    Fit 4: weight is 0.111, at (   0.00,  -15.00) arcsec
    Fit 5: weight is 0.028, at (  15.00,   15.00) arcsec
    Fit 6: weight is 0.028, at ( -15.00,   15.00) arcsec
    Fit 7: weight is 0.028, at ( -15.00,  -15.00) arcsec
    Fit 8: weight is 0.028, at (  15.00,  -15.00) arcsec
[00;00mThere are 1 evaluation directions[00;00m at sampling 1/128 m.
    Evl 0: weight is 1.000, at (   0.00,    0.00) arcsec
[00;00mSimulation[00;00m start at step 0, end at step 1600, with time step 1/1500s, [00;00mclose loop[00;00m.
After setup_parms:	120.4 MiB.
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
CUDA: minimum memory requirement is 0.3GB
GPU 0 is NVIDIA A100-SXM4-40GB with arch 8.0, 38.9GB free, 39.3GB total device memory.
Using GPU 0
Use 1 GPUs for WFS Tomo Fit Evl

*** Preparation started at 2025/02/17 15:13:10 in nid001972. ***

Using OpenMP version 201511 with 128 threads
Reading aperture amplitude map from KECK.fits
[00;00m[0;36mWarning(accphi.c:477): 108267 points not covered by input screen
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
 ->maos.c:447->setup.c:148->aper.c:74->utils.c:478->accphi.c:478
iwvl 0: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 1: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 2: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 3: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 4: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 5: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 6: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 7: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 8: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
After setup_aper:	340.8 MiB.

[00;00mSetting up powfs 0 geom[00;00m

There are 20 points in each subaperture of 0.159m.
There are 2972 valid subaperture.

[00;00mSetting up powfs 1 geom[00;00m

There are 88 points in each subaperture of 5.5m.
There are 4 valid subaperture.

[00;00mSetting up powfs 2 geom[00;00m

There are 18 points in each subaperture of 0.563m.
There are 236 valid subaperture.
After setup_powfs_init:	417.5 MiB.

[00;00mSetting up reconstructor geometry.[00;00m

PLOC is 143x143, with sampling of 0.08m (square)
    DM 0: grid is 73 x 73
    DM 1: grid is 75 x 75
    DM 2: grid is 80 x 79
FLOC is 143x143, with sampling of 0.08m (not square)
Tomography grid is square:
    layer 0: xloc grid is 252 x 252, sampling is 0.080 m, 63504 points
    layer 1: xloc grid is 252 x 252, sampling is 0.079 m, 63504 points
    layer 2: xloc grid is 252 x 252, sampling is 0.079 m, 63504 points
    layer 3: xloc grid is 252 x 252, sampling is 0.079 m, 63504 points
    layer 4: xloc grid is 252 x 252, sampling is 0.079 m, 63504 points
    layer 5: xloc grid is 252 x 252, sampling is 0.079 m, 63504 points
    layer 6: xloc grid is 252 x 252, sampling is 0.079 m, 63504 points
    layer 7: xloc grid is 252 x 252, sampling is 0.079 m, 63504 points
    layer 8: xloc grid is 252 x 252, sampling is 0.079 m, 63504 points
    layer 9: xloc grid is 252 x 252, sampling is 0.079 m, 63504 points
    layer 10: xloc grid is 252 x 252, sampling is 0.075 m, 63504 points
    layer 11: xloc grid is 252 x 252, sampling is 0.072 m, 63504 points
    layer 12: xloc grid is 252 x 252, sampling is 0.068 m, 63504 points
    layer 13: xloc grid is 252 x 252, sampling is 0.061 m, 63504 points

[00;00mSetting up powfs 0 PO WFS[00;00m

OTF dimension is 40x40 (calculated)
There is no bias
Uplink FWHM (illt 0, iwvl 0) is 0.576805"
Downlink FWHM (illt 0, iwvl 0) is 1.30857"
Generating matched filter for powfs 0
sa index   location       noise equivalent angle
    1483: (  4.9,  -0.2) m, (136.09, 132.28) mas
    1476: (  3.8,  -0.2) m, (143.85, 133.86) mas
    1469: (  2.7,  -0.2) m, (154.70, 135.98) mas
    1462: (  1.6,  -0.2) m, (167.56, 138.21) mas
    1460: (  1.3,  -0.2) m, (171.73, 138.85) mas
    1024: ( -0.5,  -1.4) m, (200.15, 145.23) mas
    1457: ( -1.7,  -0.2) m, (226.26, 144.35) mas
    1450: ( -2.9,  -0.2) m, (253.73, 146.08) mas
    1443: ( -4.0,  -0.2) m, (278.58, 147.71) mas
    1436: ( -5.1,  -0.2) m, (298.09, 149.31) mas
    1434: ( -5.4,  -0.2) m, (302.10, 149.71) mas
sa index   location       noise equivalent angle
    2562: (  3.7,   3.0) m, (135.08, 134.29) mas
    2306: (  2.7,   2.2) m, (141.79, 139.66) mas
    2019: (  1.7,   1.4) m, (152.12, 147.95) mas
    1784: (  1.0,   0.8) m, (162.28, 155.75) mas
    1087: (  0.5,  -1.3) m, (178.19, 189.58) mas
    1189: ( -1.1,  -1.0) m, (193.89, 179.95) mas
     955: ( -1.9,  -1.6) m, (207.26, 188.92) mas
     668: ( -2.9,  -2.4) m, (224.25, 201.00) mas
     412: ( -3.8,  -3.2) m, (242.19, 214.73) mas
      80: ( -3.0,  -4.5) m, (226.63, 237.52) mas
sa index   location       noise equivalent angle
    2800: (  0.6,   4.0) m, (133.72, 141.79) mas
    2591: (  0.5,   3.2) m, (144.51, 161.16) mas
    2291: (  0.3,   2.2) m, (137.60, 158.76) mas
    1949: (  0.2,   1.3) m, (139.98, 170.56) mas
    1404: ( -1.4,  -0.3) m, (151.77, 197.94) mas
    1025: ( -0.3,  -1.4) m, (146.37, 216.95) mas
     683: ( -0.5,  -2.4) m, (148.35, 240.21) mas
     383: ( -0.6,  -3.3) m, (160.78, 282.02) mas
     174: ( -0.8,  -4.1) m, (152.21, 282.45) mas
       1: ( -2.4,  -4.9) m, (169.94, 308.37) mas
sa index   location       noise equivalent angle
    2899: ( -2.7,   4.5) m, (132.67, 134.17) mas
    2702: ( -2.2,   3.7) m, (135.21, 139.00) mas
    2379: ( -1.6,   2.5) m, (140.70, 149.52) mas
    2002: ( -1.0,   1.4) m, (147.39, 162.59) mas
    1885: ( -0.8,   1.1) m, (149.26, 166.76) mas
    1138: ( -1.0,  -1.1) m, (151.47, 200.00) mas
    1088: (  0.6,  -1.3) m, (166.69, 205.71) mas
     972: (  0.8,  -1.6) m, (168.84, 212.32) mas
     595: (  1.4,  -2.7) m, (176.91, 234.90) mas
     272: (  2.1,  -3.8) m, (185.93, 257.99) mas
      75: (  2.5,  -4.6) m, (193.52, 273.70) mas
sa index   location       noise equivalent angle
    1924: ( -3.8,   1.3) m, (142.39, 134.98) mas
    1869: ( -3.3,   1.1) m, (146.19, 136.22) mas
    1725: ( -2.1,   0.6) m, (168.42, 146.76) mas
    1678: ( -1.4,   0.5) m, (168.42, 143.15) mas
    1027: (  0.0,  -1.4) m, (199.02, 165.77) mas
    1297: (  1.4,  -0.6) m, (218.64, 155.32) mas
    1248: (  1.9,  -0.8) m, (241.70, 165.08) mas
    1104: (  3.2,  -1.3) m, (259.00, 162.46) mas
    1050: (  3.7,  -1.4) m, (270.59, 164.71) mas
    1375: (  5.1,  -0.5) m, (300.80, 158.26) mas
sa index   location       noise equivalent angle
     819: ( -4.6,  -1.9) m, (145.86, 142.65) mas
    1003: ( -3.8,  -1.4) m, (142.39, 134.98) mas
    1066: ( -3.3,  -1.3) m, (146.19, 136.22) mas
    1235: ( -2.1,  -0.8) m, (170.30, 148.76) mas
    1293: ( -1.4,  -0.6) m, (168.42, 143.15) mas
    1948: (  0.0,   1.3) m, (199.02, 165.77) mas
    1682: (  1.4,   0.5) m, (218.64, 155.32) mas
    1738: (  1.9,   0.6) m, (238.69, 162.79) mas
    1908: (  3.2,   1.1) m, (259.00, 162.46) mas
    1971: (  3.7,   1.3) m, (270.59, 164.71) mas
    1650: (  5.1,   0.3) m, (300.80, 158.26) mas
sa index   location       noise equivalent angle
      42: ( -2.7,  -4.6) m, (132.67, 134.17) mas
     245: ( -2.2,  -3.8) m, (135.21, 139.00) mas
     576: ( -1.6,  -2.7) m, (140.70, 149.52) mas
     961: ( -1.0,  -1.6) m, (147.39, 162.59) mas
    1082: ( -0.8,  -1.3) m, (149.26, 166.76) mas
    1832: ( -1.0,   1.0) m, (151.37, 199.92) mas
    1892: (  0.6,   1.1) m, (166.69, 205.71) mas
    2013: (  0.8,   1.4) m, (168.84, 212.32) mas
    2398: (  1.4,   2.5) m, (176.91, 234.90) mas
    2729: (  2.1,   3.7) m, (185.93, 257.99) mas
    2932: (  2.5,   4.5) m, (193.52, 273.70) mas
sa index   location       noise equivalent angle
       8: (  0.6,  -4.9) m, (138.27, 142.49) mas
     183: (  0.6,  -4.1) m, (133.72, 141.79) mas
     390: (  0.5,  -3.3) m, (144.29, 159.65) mas
     688: (  0.3,  -2.4) m, (137.60, 158.76) mas
    1028: (  0.2,  -1.4) m, (139.98, 170.56) mas
    1567: ( -1.4,   0.2) m, (151.77, 197.94) mas
    1946: ( -0.3,   1.3) m, (146.37, 216.95) mas
    2286: ( -0.5,   2.2) m, (148.35, 240.21) mas
    2584: ( -0.6,   3.2) m, (161.19, 284.82) mas
    2791: ( -0.8,   4.0) m, (152.21, 282.45) mas
    2961: ( -2.4,   4.8) m, (174.32, 315.70) mas
sa index   location       noise equivalent angle
     459: (  3.7,  -3.2) m, (135.08, 134.29) mas
     703: (  2.7,  -2.4) m, (141.79, 139.66) mas
     978: (  1.7,  -1.6) m, (152.12, 147.95) mas
    1192: (  1.0,  -1.0) m, (162.28, 155.75) mas
    1891: (  0.5,   1.1) m, (174.47, 185.77) mas
    1781: ( -1.1,   0.8) m, (193.75, 179.82) mas
    1996: ( -1.9,   1.4) m, (207.26, 188.92) mas
    2271: ( -2.9,   2.2) m, (224.25, 201.00) mas
    2515: ( -3.8,   3.0) m, (242.19, 214.73) mas
    2857: ( -3.0,   4.3) m, (226.63, 237.52) mas

[00;00mSetting up powfs 2 PO WFS[00;00m

OTF dimension is 48x48 (calculated)
Generating matched filter for powfs 2
Use sanea to derive neasim
Use sanea to derive neasim

[00;00mSetting up reconstructor[00;00m

Recon NEA: cmf(184.79) cmf(183.38) cmf(184.31) cmf(183.88) cmf(184.17) cmf(184.15) cmf(183.81) cmf(184.24) cmf(183.33) geom(0.31) geom(0.31) geom(0.31) mf(0.14)  mas
Setup or update control matrix parameters.
RRtwfs svd threshold is 1e-10
Replacing HA by HA*fit->actextrap
Adding piston cr to fit matrix
Adding TT cr on upper DMs to fit matrix.
Before assembling fit matrix:	4805.4 MiB.
Building fit->FR
Building fit->FL
Adding tikhonov constraint of 1.0e-07 to FLM
The maximum eigen value is estimated to be around 2.8e-04
DM Fit number of Low rank terms: 16 in LHS
After assemble fit matrix:	6537.2 MiB.
After setup_recon:	6537.2 MiB.
GPU 0: mem used 1758 MB (wfs init)
GPU 0: mem used 2784 MB (recon init)
GPU 0: mem used 2814 MB (perf init)

*** Simulation started at 2025/02/17 15:14:59 in nid001972. ***

Running seed 1
GPU 0: mem used 2814 MB (wfs seeding)
Wind dir: 267.3 261.7 167.0 130.5 300.7  32.3 119.8 139.0 150.8 277.7 203.0 133.1  45.9 265.1 deg
Using /global/homes/b/bpeck/.aos/cache/atm/vonkarman_14_8192x8192_0.0078125_1115374592d.bin
After genatm:	6326.4 MiB.
Step     #  Open Loop  PR TT  On axis  PR TT  Field RMS PR TT     Timing 
Step     0: OL  884.6  248.3  OA  884.6 248.3 CL  884.6 248.3 nm  0.320 s
Step    15: OL  908.2  254.1  OA  122.1  54.1 CL  122.1  54.1 nm  0.065 s
Step    29: OL  930.5  258.4  OA  106.8  18.8 CL  106.8  18.8 nm  0.075 s
Step    42: OL  950.5  260.7  OA  103.5  11.6 CL  103.5  11.6 nm  0.079 s
Step    56: OL  971.2  261.0  OA  104.8   5.4 CL  104.8   5.4 nm  0.074 s
Step    69: OL  990.6  259.8  OA  102.4  17.3 CL  102.4  17.3 nm  0.084 s
Step    83: OL 1011.7  258.3  OA  104.6  21.4 CL  104.6  21.4 nm  0.074 s
Step    97: OL 1033.0  257.4  OA  111.5  19.6 CL  111.5  19.6 nm  0.081 s
Step   111: OL 1054.3  257.6  OA  107.9  28.5 CL  107.9  28.5 nm  0.074 s
Step   124: OL 1073.6  258.9  OA  107.4  16.5 CL  107.4  16.5 nm  0.082 s
Step   137: OL 1091.7  262.2  OA  103.6   7.0 CL  103.6   7.0 nm  0.076 s
Step   151: OL 1109.6  267.7  OA  112.1  29.9 CL  112.1  29.9 nm  0.075 s
Step   165: OL 1125.0  274.8  OA  106.3  17.3 CL  106.3  17.3 nm  0.075 s
Step   178: OL 1137.1  282.6  OA  104.9  18.1 CL  104.9  18.1 nm  0.075 s
Step   192: OL 1146.9  291.6  OA  103.0  12.1 CL  103.0  12.1 nm  0.083 s
Step   206: OL 1154.1  300.6  OA  103.5   6.1 CL  103.5   6.1 nm  0.074 s
Step   220: OL 1158.9  309.5  OA  100.6  12.0 CL  100.6  12.0 nm  0.084 s
Step   234: OL 1160.9  318.7  OA  100.4  12.7 CL  100.4  12.7 nm  0.075 s
Step   248: OL 1159.8  328.4  OA  101.9  12.6 CL  101.9  12.6 nm  0.081 s
Step   255 updated high order loop gain: 0.364
Step   259: OL 1155.8  336.3  OA   98.8   8.2 CL   98.8   8.2 nm  0.074 s
Step   272: OL 1147.7  345.7  OA   99.4  10.1 CL   99.4  10.1 nm  0.085 s
Step   286: OL 1135.6  356.2  OA  104.3  26.0 CL  104.3  26.0 nm  0.074 s
Step   300: OL 1121.6  368.1  OA  101.1   1.4 CL  101.1   1.4 nm  0.080 s
Step   314: OL 1105.6  380.9  OA  101.1   7.0 CL  101.1   7.0 nm  0.075 s
Step   328: OL 1088.0  394.9  OA  101.7  11.5 CL  101.7  11.5 nm  0.081 s
Step   342: OL 1070.0  410.9  OA  102.1   2.8 CL  102.1   2.8 nm  0.074 s
Step   356: OL 1051.9  428.9  OA  104.7  10.0 CL  104.7  10.0 nm  0.074 s
Step   370: OL 1035.1  448.6  OA  101.8  13.3 CL  101.8  13.3 nm  0.078 s
Step   383: OL 1020.3  467.3  OA  105.9   5.1 CL  105.9   5.1 nm  0.073 s
Step   396: OL 1006.0  486.1  OA  109.7  15.3 CL  109.7  15.3 nm  0.079 s
Step   410: OL  990.8  506.0  OA  104.7  10.1 CL  104.7  10.1 nm  0.074 s
Step   424: OL  974.7  524.9  OA  100.6   9.7 CL  100.6   9.7 nm  0.079 s
Step   438: OL  959.1  543.4  OA  104.4  19.8 CL  104.4  19.8 nm  0.073 s
Step   452: OL  944.8  561.6  OA  102.6  10.4 CL  102.6  10.4 nm  0.075 s
Step   466: OL  934.2  580.0  OA   99.2  11.2 CL   99.2  11.2 nm  0.072 s
Step   480: OL  928.0  597.9  OA  106.1  17.4 CL  106.1  17.4 nm  0.073 s
Step   494: OL  926.7  615.1  OA  102.2   5.4 CL  102.2   5.4 nm  0.075 s
Step   507: OL  928.0  629.9  OA  106.9  17.1 CL  106.9  17.1 nm  0.075 s
Step   511 updated high order loop gain: 0.330
Step   521: OL  931.7  643.9  OA  101.9   7.3 CL  101.9   7.3 nm  0.075 s
Step   535: OL  937.6  654.9  OA  106.7   4.6 CL  106.7   4.6 nm  0.072 s
Step   548: OL  945.3  662.2  OA  104.7  18.5 CL  104.7  18.5 nm  0.082 s
Step   562: OL  956.0  667.3  OA  103.5  21.7 CL  103.5  21.7 nm  0.110 s
Step   576: OL  968.6  670.0  OA  102.1   6.4 CL  102.1   6.4 nm  0.075 s
Step   590: OL  983.2  670.5  OA  100.4   5.4 CL  100.4   5.4 nm  0.075 s
Step   604: OL  999.1  667.8  OA  105.3  14.4 CL  105.3  14.4 nm  0.081 s
Step   618: OL 1015.5  661.9  OA   99.1  11.8 CL   99.1  11.8 nm  0.073 s
Step   632: OL 1031.7  653.3  OA   99.4  12.6 CL   99.4  12.6 nm  0.078 s
Step   645: OL 1046.0  643.0  OA   97.7  11.1 CL   97.7  11.1 nm  0.076 s
Step   659: OL 1059.7  630.1  OA  102.7  15.1 CL  102.7  15.1 nm  0.079 s
Step   673: OL 1072.4  615.8  OA  103.6  19.2 CL  103.6  19.2 nm  0.077 s
Step   687: OL 1084.2  601.2  OA  105.1  13.9 CL  105.1  13.9 nm  0.074 s
Step   701: OL 1094.3  585.7  OA  103.6   5.2 CL  103.6   5.2 nm  0.075 s
Step   715: OL 1101.6  568.9  OA  105.0  18.2 CL  105.0  18.2 nm  0.075 s
Step   729: OL 1105.5  551.5  OA  106.3  19.0 CL  106.3  19.0 nm  0.081 s
Step   743: OL 1105.7  534.2  OA  102.1  13.3 CL  102.1  13.3 nm  0.073 s
Step   756: OL 1102.9  518.6  OA  101.9  12.3 CL  101.9  12.3 nm  0.081 s
Step   767 updated high order loop gain: 0.316
Step   770: OL 1096.7  502.3  OA  105.5  23.4 CL  105.5  23.4 nm  0.107 s
Step   784: OL 1087.0  486.5  OA  107.8  15.6 CL  107.8  15.6 nm  0.074 s
Step   798: OL 1073.5  470.9  OA  103.5   5.2 CL  103.5   5.2 nm  0.076 s
Step   812: OL 1057.4  455.3  OA  106.4  22.4 CL  106.4  22.4 nm  0.073 s
Step   826: OL 1038.6  439.8  OA  103.2  15.2 CL  103.2  15.2 nm  0.075 s
Step   840: OL 1017.3  424.8  OA  102.2  12.0 CL  102.2  12.0 nm  0.084 s
Step   854: OL  995.1  410.8  OA  106.3  19.2 CL  106.3  19.2 nm  0.075 s
Step   867: OL  974.5  399.0  OA  103.6  12.4 CL  103.6  12.4 nm  0.075 s
Step   881: OL  953.7  387.9  OA  103.0  11.6 CL  103.0  11.6 nm  0.079 s
Step   894: OL  934.5  378.9  OA  105.6  12.9 CL  105.6  12.9 nm  0.075 s
Step   908: OL  912.6  370.5  OA  105.0  20.0 CL  105.0  20.0 nm  0.073 s
Step   922: OL  890.3  363.5  OA  108.4  17.6 CL  108.4  17.6 nm  0.076 s
Step   936: OL  868.4  356.9  OA  105.2  10.4 CL  105.2  10.4 nm  0.076 s
Step   950: OL  847.4  350.2  OA  105.1  10.6 CL  105.1  10.6 nm  0.075 s
Step   962: OL  830.8  344.0  OA  105.1  12.0 CL  105.1  12.0 nm  0.095 s
Step   976: OL  814.1  335.8  OA  102.2   5.7 CL  102.2   5.7 nm  0.074 s
Step   990: OL  799.8  326.8  OA  100.4  13.4 CL  100.4  13.4 nm  0.075 s
Step  1003: OL  787.6  317.4  OA  104.2   5.1 CL  104.2   5.1 nm  0.076 s
Step  1017: OL  775.9  306.8  OA  105.5  13.1 CL  105.5  13.1 nm  0.083 s
Step  1023 updated high order loop gain: 0.307
Step  1031: OL  766.2  295.8  OA  105.2  22.5 CL  105.2  22.5 nm  0.084 s
Step  1045: OL  758.2  284.0  OA  103.0   9.1 CL  103.0   9.1 nm  0.077 s
Step  1058: OL  750.6  272.1  OA  105.7   9.1 CL  105.7   9.1 nm  0.075 s
Step  1072: OL  743.6  257.5  OA  102.5  15.4 CL  102.5  15.4 nm  0.075 s
Step  1086: OL  739.0  241.3  OA  103.2   3.7 CL  103.2   3.7 nm  0.082 s
Step  1100: OL  736.7  225.4  OA  107.0  26.9 CL  107.0  26.9 nm  0.074 s
Step  1114: OL  735.9  211.1  OA  103.8  21.2 CL  103.8  21.2 nm  0.080 s
Step  1128: OL  736.1  198.5  OA   99.6   7.8 CL   99.6   7.8 nm  0.074 s
Step  1142: OL  736.7  188.3  OA  105.0  21.3 CL  105.0  21.3 nm  0.076 s
Step  1156: OL  737.5  180.1  OA  103.6  10.8 CL  103.6  10.8 nm  0.074 s
Step  1169: OL  737.9  174.6  OA   99.9  14.6 CL   99.9  14.6 nm  0.082 s
Step  1182: OL  739.3  171.0  OA  101.9  29.0 CL  101.9  29.0 nm  0.076 s
Step  1195: OL  741.8  168.1  OA   99.0  15.9 CL   99.0  15.9 nm  0.076 s
Step  1209: OL  744.9  165.5  OA   98.6   7.5 CL   98.6   7.5 nm  0.083 s
Step  1222: OL  747.7  163.9  OA   99.4   7.7 CL   99.4   7.7 nm  0.077 s
Step  1236: OL  750.2  163.9  OA   99.8  18.5 CL   99.8  18.5 nm  0.075 s
Step  1249: OL  751.8  166.0  OA  100.3  22.5 CL  100.3  22.5 nm  0.077 s
Step  1263: OL  754.2  170.8  OA  102.1  28.9 CL  102.1  28.9 nm  0.077 s
Step  1277: OL  757.2  177.6  OA  103.8  31.4 CL  103.8  31.4 nm  0.074 s
Step  1279 updated high order loop gain: 0.300
Step  1290: OL  761.2  185.2  OA  107.9  32.6 CL  107.9  32.6 nm  0.074 s
Step  1304: OL  765.7  194.7  OA  102.4  17.1 CL  102.4  17.1 nm  0.079 s
Step  1317: OL  769.5  204.5  OA  104.8  19.2 CL  104.8  19.2 nm  0.077 s
Step  1331: OL  773.9  216.3  OA  102.7  14.2 CL  102.7  14.2 nm  0.074 s
Step  1345: OL  779.9  228.9  OA  100.5  30.4 CL  100.5  30.4 nm  0.112 s
Step  1359: OL  787.8  241.4  OA  101.9  36.4 CL  101.9  36.4 nm  0.074 s
Step  1373: OL  797.0  252.0  OA   95.7  10.0 CL   95.7  10.0 nm  0.075 s
Step  1386: OL  806.5  259.8  OA  107.5  38.0 CL  107.5  38.0 nm  0.082 s
Step  1400: OL  818.1  266.4  OA  101.5  30.5 CL  101.5  30.5 nm  0.073 s
Step  1413: OL  830.2  270.8  OA   99.5  17.9 CL   99.5  17.9 nm  0.079 s
Step  1427: OL  844.2  274.3  OA  100.7  18.5 CL  100.7  18.5 nm  0.076 s
Step  1441: OL  857.8  277.1  OA  100.7  22.7 CL  100.7  22.7 nm  0.075 s
Step  1455: OL  870.6  279.1  OA  103.9  30.8 CL  103.9  30.8 nm  0.075 s
Step  1469: OL  881.6  279.5  OA  101.0  16.7 CL  101.0  16.7 nm  0.074 s
Step  1483: OL  889.1  277.7  OA   99.6   9.6 CL   99.6   9.6 nm  0.075 s
Step  1497: OL  892.6  274.0  OA  100.1  13.1 CL  100.1  13.1 nm  0.081 s
Step  1511: OL  892.7  268.3  OA   99.3  15.1 CL   99.3  15.1 nm  0.073 s
Step  1524: OL  890.6  262.1  OA   98.1  11.8 CL   98.1  11.8 nm  0.082 s
Step  1535 updated high order loop gain: 0.301
Step  1538: OL  885.6  253.8  OA   98.8  10.3 CL   98.8  10.3 nm  0.079 s
Step  1552: OL  879.1  244.6  OA  102.3  11.3 CL  102.3  11.3 nm  0.076 s
Step  1565: OL  872.8  236.2  OA  103.9  12.0 CL  103.9  12.0 nm  0.075 s
Step  1579: OL  865.1  228.2  OA  101.7   8.7 CL  101.7   8.7 nm  0.078 s
Step  1593: OL  856.3  221.8  OA  105.2  19.7 CL  105.2  19.7 nm  0.082 s
Step 1599: Output PSF
Step  1599: OL  852.3  219.3  OA  102.9  20.8 CL  102.9  20.8 nm  1.283 s
Mean: 102.96 17.25 101.50  nm.

*** Simulation Finished at 2025/02/17 15:17:09 in nid001972. ***

[00;00m>>>>>>>>>>>>>>>>[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
/global/cfs/cdirs/ulens/vismcao/maos -o studies/reduced_ngs/9_lgs/8mag_lgs/4000count -c master_files/reduced_ngs/9_lgs/8mag_lgs/kola_4000act.conf -O 
Output folder is 'studies/reduced_ngs/9_lgs/8mag_lgs/4000count'.
SRC: /global/homes/b/bpeck/code/maos v2.9 4c88b7c2 2024-11-13 16:45:33 -0800
BUILT: /global/homes/b/bpeck/code/maos/optim by GCC (v12) on 2024/11/18 09:40:03 CPU(F64,+O3) with CUDA(v122,F32)
Launched at 2025/02/17 15:17:10 in nid001972 with PID 1695880.
The web based job monitor can be accessed at http://localhost:10300
Main config file is /global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_4000act.conf
[00;00m[0;36mWarning(path.c:48): Path not found: path=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; abspath=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; Ignored.
[00;00m[0;36mWarning(path.c:48): Path not found: path=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; abspath=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; Ignored.
[00;00m[0;36mWarning(readcfg.c:399): sim.apfsm has been renamed to powfs.apfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.epfsm has been renamed to powfs.epfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.alfsm has been renamed to powfs.alfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.commonfsm has been renamed to powfs.commonfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.idealfsm has been renamed to powfs.idealfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.zetafsm has been renamed to powfs.zetafsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.f0fsm has been renamed to powfs.f0fsm.
[00;00m[0;36mWarning(readcfg.c:399): tsurf has been renamed to ncpa.tsurf.
loaded 132 (132 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_sim.conf'
loaded  19 ( 19 new) records from '/global/cfs/cdirs/ulens/vismcao/./dm_none.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_ASM.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_DM2.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_DM3.conf'
loaded   0 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_dm_multiple.conf'
loaded   7 (  5 new) records from '/global/cfs/cdirs/ulens/vismcao/./atm_mk13n50p_ground_detail.conf'
loaded  76 ( 69 new) records from '/global/homes/b/bpeck/code/maos/config/maos/powfs_common.conf'
loaded  44 ( 38 new) records from '/global/cfs/cdirs/ulens/vismcao/./powfs_none.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_lgs.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_ttf_strap.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_twfs_lbwfs.conf'
loaded   0 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_wfs_lgs_strap_lbwfs.conf'
loaded  71 ( 71 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_recon.conf'
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_smooth has been renamed to powfs0_llt.na_smooth.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_interp has been renamed to powfs0_llt.na_interp.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_thres has been renamed to powfs0_llt.na_thres.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_maxit has been renamed to powfs0_llt.na_fit_maxit.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_svdthres has been renamed to powfs0_llt.na_fit_svdthres.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_dh has been renamed to powfs0_llt.na_fit_dh.
[00;00m[0;36mWarning(readcfg.c:399): dbg.ncpa_preload has been renamed to ncpa.preload.
[00;00m[0;36mWarning(readcfg.c:399): dbg.ncpa_rmsci has been renamed to ncpa.rmsci.
[00;00m[0;36mWarning(readcfg.c:399): dbg.draw_opdmax has been renamed to plot.opdmax.
[00;00m[0;36mWarning(readcfg.c:399): dbg.draw_gmax has been renamed to plot.gmax.
loaded  95 ( 93 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_dbg.conf'
loaded   4 (  4 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_fit_mcao.conf'
[00;00m[0;36mWarning(readcfg.c:399): surf has been renamed to ncpa.surf.
loaded  39 (  7 new) records from '/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_4000act.conf'
loaded   0 (  0 new) records from 'command line'
loaded  24 ( 18 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_llt_CL.conf'
Adjust LGS range by telescope altitude 4145m.
Zenith angle is 30 degree.
    Scaling turbulence height and LGS hs by sec(za).
    Scaling r0 by cos(za)^(3/5).
    Scaling wind speed and LGS signal level by cos(za).
powfs0: Adjusting dx from 0.0078125 to 0.0077. 
powfs0.llt.fsm: f0=0 Hz, LPF ep=0
powfs0.epfsm is set to 0.517618 (auto)
powfs2: Adjusting dx from 0.03125 to 0.0312778. 
powfs2 is TWFS for powfs0
sim.ephi is set to 0.427717 (auto)
sim.eplo is set to 0.427717 (auto)
[00;00m[0;36mWarning(parms.c:2296): Layer 1 at 17.3205m is very close to layer 0 at 0m (OK).
[00;00m[0;36mWarning(parms.c:2296): Layer 2 at 34.641m is very close to layer 1 at 17.3205m (OK).
[00;00m[0;36mWarning(parms.c:2296): Layer 3 at 51.9615m is very close to layer 2 at 34.641m (OK).
dm 0: stroke=30 um is provided in micron.
dm 0: assume ia stroke=2 um is provided in micron.
dm 1: stroke=7 um is provided in micron.
dm 1: assume ia stroke=2 um is provided in micron.
dm 2: stroke=7 um is provided in micron.
dm 2: assume ia stroke=2 um is provided in micron.
Focus blending is not implemented yet for integrated tomography
parms->sim.mffocus is reset to 0
There are 1 valid simulation seeds:  1
Output PSF for 1 directions
Used 449 of 456 supplied keys
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_flate" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_flatv" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_psx" is not recognized, value is [0 0 0 0]
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_psy" is not recognized, value is [0 0 0 0]
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_pupelong" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_raw" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_side" is not recognized, value is 4
[00;00mAperture[00;00m is 11 m with sampling 1/128 m
[00;00mTurbulence at 30 degree zenith angle:[00;00m r0=0.128424m, L0=30m, 14 layers.
    Greenwood freq is 25.1Hz, anisoplanatic angle is 1.58 as
    Sampled 8192x8192 at 1/128m. wind dir is randomized.
    layer 0: ht=      0 m, wt= 0.302, ws=  4.8 m/s
    layer 1: ht=     17 m, wt= 0.154, ws=  5.0 m/s
    layer 2: ht=     35 m, wt= 0.041, ws=  5.4 m/s
    layer 3: ht=     52 m, wt= 0.002, ws=  6.6 m/s
    layer 4: ht=    139 m, wt= 0.021, ws=  6.1 m/s
    layer 5: ht=    231 m, wt= 0.010, ws=  6.1 m/s
    layer 6: ht=    323 m, wt= 0.008, ws=  6.1 m/s
    layer 7: ht=    416 m, wt= 0.005, ws=  6.1 m/s
    layer 8: ht=    508 m, wt= 0.001, ws=  6.1 m/s
    layer 9: ht=    932 m, wt= 0.107, ws=  5.6 m/s
    layer 10: ht=   5022 m, wt= 0.144, ws= 11.1 m/s
    layer 11: ht=   9238 m, wt= 0.093, ws= 19.1 m/s
    layer 12: ht=  13856 m, wt= 0.075, ws=  8.2 m/s
    layer 13: ht=  22518 m, wt= 0.036, ws=  4.8 m/s
[00;00mReconstruction[00;00m: r0=0.128424m L0=30m. 14 layers. use cone coordinate.
    layer 0: ht=      0 m, wt= 0.302
    layer 1: ht=     17 m, wt= 0.154
    layer 2: ht=     35 m, wt= 0.041
    layer 3: ht=     52 m, wt= 0.002
    layer 4: ht=    139 m, wt= 0.021
    layer 5: ht=    231 m, wt= 0.010
    layer 6: ht=    323 m, wt= 0.008
    layer 7: ht=    416 m, wt= 0.005
    layer 8: ht=    508 m, wt= 0.001
    layer 9: ht=    932 m, wt= 0.107
    layer 10: ht=   5022 m, wt= 0.144
    layer 11: ht=   9238 m, wt= 0.093
    layer 12: ht=  13856 m, wt= 0.075
    layer 13: ht=  22518 m, wt= 0.036
[00;00mThere are 3 powfs[00;00m
  powfs0: Order 72, LGS at 99.1 km. Sampling 1/129.87 m. Thres 30%. [00;00mT/T is removed in right hand side in tomography.[00;00m
    CCD image is 25x25 @ 500x500 mas, blur 27% (sigma), 1500Hz, wvl: [ 5.89e-07]
    Gtilt in reconstruction. Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
  powfs1: Order  2, NGS at inf km. Sampling 1/16 m. Thres 30%. 
    Ztilt in reconstruction. Geomtric optics start at 2 with ztilt [00;00m(noisy)[00;00m
  powfs2: Order 20, NGS at inf km. Sampling 1/31.9716 m. Thres 50%. 
    CCD image is 4x4 @ 1500x1500 mas, blur 0% (sigma), 0.015Hz, wvl: [ 7.2e-07]
    Gtilt in reconstruction. Geomtric optics start at 50 with gtilt Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
[00;00mThere are 13 wfs[00;00m
    wfs 0: type 0, at (  30.00,    0.00) arcsec,  99 km, siglev is 28.4359 bkgrnd is 0.1
    wfs 1: type 0, at (  22.98,   19.28) arcsec,  99 km, siglev is 28.4359 bkgrnd is 0.1
    wfs 2: type 0, at (   5.21,   29.54) arcsec,  99 km, siglev is 28.4359 bkgrnd is 0.1
    wfs 3: type 0, at ( -15.00,   25.98) arcsec,  99 km, siglev is 28.4359 bkgrnd is 0.1
    wfs 4: type 0, at ( -28.19,   10.26) arcsec,  99 km, siglev is 28.4359 bkgrnd is 0.1
    wfs 5: type 0, at ( -28.19,  -10.26) arcsec,  99 km, siglev is 28.4359 bkgrnd is 0.1
    wfs 6: type 0, at ( -15.00,  -25.98) arcsec,  99 km, siglev is 28.4359 bkgrnd is 0.1
    wfs 7: type 0, at (   5.21,  -29.54) arcsec,  99 km, siglev is 28.4359 bkgrnd is 0.1
    wfs 8: type 0, at (  22.98,  -19.28) arcsec,  99 km, siglev is 28.4359 bkgrnd is 0.1
    wfs 9: type 1, at (   5.00,    8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 10: type 1, at ( -10.00,    0.00) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 11: type 1, at (   5.00,   -8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 12: type 2, at (   0.00,    0.00) arcsec, inf km, siglev is 4.1558e+06 bkgrnd is 0.001
[00;00mThere are 3 DMs[00;00m
  DM 0 at -0.1km, actuator pitch 0.154m, offset   0, with 30.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 1 at    6km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 2 at   10km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
[00;00mTomography[00;00m is using CG, with [00;00mFourer Domain[00;00m preconditioner, [00;00m12[00;00m iterations, integrated tomo.
[00;00mDM Fitting [00;00mis using CG, with [00;00mNo[00;00m preconditioner, [00;00m10[00;00m iterations
[00;00mThere are 9 fit directions[00;00m
    Fit 0: weight is 0.444, at (   0.00,    0.00) arcsec
    Fit 1: weight is 0.111, at (  15.00,    0.00) arcsec
    Fit 2: weight is 0.111, at (   0.00,   15.00) arcsec
    Fit 3: weight is 0.111, at ( -15.00,    0.00) arcsec
    Fit 4: weight is 0.111, at (   0.00,  -15.00) arcsec
    Fit 5: weight is 0.028, at (  15.00,   15.00) arcsec
    Fit 6: weight is 0.028, at ( -15.00,   15.00) arcsec
    Fit 7: weight is 0.028, at ( -15.00,  -15.00) arcsec
    Fit 8: weight is 0.028, at (  15.00,  -15.00) arcsec
[00;00mThere are 1 evaluation directions[00;00m at sampling 1/128 m.
    Evl 0: weight is 1.000, at (   0.00,    0.00) arcsec
[00;00mSimulation[00;00m start at step 0, end at step 1600, with time step 1/1500s, [00;00mclose loop[00;00m.
After setup_parms:	120.5 MiB.
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
CUDA: minimum memory requirement is 0.3GB
GPU 0 is NVIDIA A100-SXM4-40GB with arch 8.0, 38.9GB free, 39.3GB total device memory.
Using GPU 0
Use 1 GPUs for WFS Tomo Fit Evl

*** Preparation started at 2025/02/17 15:17:10 in nid001972. ***

Using OpenMP version 201511 with 128 threads
Reading aperture amplitude map from KECK.fits
[00;00m[0;36mWarning(accphi.c:477): 108139 points not covered by input screen
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
 ->maos.c:447->setup.c:148->aper.c:74->utils.c:478->accphi.c:478
iwvl 0: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 1: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 2: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 3: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 4: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 5: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 6: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 7: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 8: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
After setup_aper:	344.7 MiB.

[00;00mSetting up powfs 0 geom[00;00m

There are 20 points in each subaperture of 0.154m.
There are 3162 valid subaperture.

[00;00mSetting up powfs 1 geom[00;00m

There are 88 points in each subaperture of 5.5m.
There are 4 valid subaperture.

[00;00mSetting up powfs 2 geom[00;00m

There are 18 points in each subaperture of 0.563m.
There are 236 valid subaperture.
After setup_powfs_init:	441.3 MiB.

[00;00mSetting up reconstructor geometry.[00;00m

PLOC is 147x147, with sampling of 0.08m (square)
    DM 0: grid is 75 x 75
    DM 1: grid is 75 x 75
    DM 2: grid is 80 x 79
FLOC is 147x147, with sampling of 0.08m (not square)
Tomography grid is square:
    layer 0: xloc grid is 256 x 256, sampling is 0.077 m, 65536 points
    layer 1: xloc grid is 256 x 256, sampling is 0.077 m, 65536 points
    layer 2: xloc grid is 256 x 256, sampling is 0.077 m, 65536 points
    layer 3: xloc grid is 256 x 256, sampling is 0.077 m, 65536 points
    layer 4: xloc grid is 256 x 256, sampling is 0.077 m, 65536 points
    layer 5: xloc grid is 256 x 256, sampling is 0.077 m, 65536 points
    layer 6: xloc grid is 256 x 256, sampling is 0.077 m, 65536 points
    layer 7: xloc grid is 256 x 256, sampling is 0.077 m, 65536 points
    layer 8: xloc grid is 256 x 256, sampling is 0.077 m, 65536 points
    layer 9: xloc grid is 256 x 256, sampling is 0.076 m, 65536 points
    layer 10: xloc grid is 256 x 256, sampling is 0.073 m, 65536 points
    layer 11: xloc grid is 256 x 256, sampling is 0.070 m, 65536 points
    layer 12: xloc grid is 256 x 256, sampling is 0.066 m, 65536 points
[00;00m[0;36mWarning(map.c:195): ninx=256 is too small. need 257
[00;00m[0;36mWarning(map.c:200): niny=256 is too small. need 257
    layer 13: xloc grid is 256 x 256, sampling is 0.060 m, 65536 points

[00;00mSetting up powfs 0 PO WFS[00;00m

OTF dimension is 40x40 (calculated)
There is no bias
Uplink FWHM (illt 0, iwvl 0) is 0.580135"
Downlink FWHM (illt 0, iwvl 0) is 1.31876"
Generating matched filter for powfs 0
sa index   location       noise equivalent angle
    1577: (  4.9,  -0.2) m, (144.86, 140.48) mas
    1569: (  3.7,  -0.2) m, (154.59, 142.40) mas
    1562: (  2.6,  -0.2) m, (165.77, 144.60) mas
    1555: (  1.5,  -0.2) m, (178.53, 146.97) mas
    1553: (  1.2,  -0.2) m, (181.66, 147.53) mas
    1109: ( -0.5,  -1.4) m, (209.06, 154.45) mas
    1550: ( -1.7,  -0.2) m, (227.84, 153.78) mas
    1542: ( -2.9,  -0.2) m, (253.72, 156.07) mas
    1535: ( -4.0,  -0.2) m, (284.94, 158.05) mas
    1528: ( -5.1,  -0.2) m, (313.51, 159.87) mas
    1526: ( -5.4,  -0.2) m, (321.69, 160.41) mas
sa index   location       noise equivalent angle
    2693: (  3.5,   2.9) m, (144.18, 143.17) mas
    2427: (  2.6,   2.2) m, (151.51, 149.01) mas
    2127: (  1.7,   1.4) m, (162.10, 157.55) mas
    1886: (  0.9,   0.8) m, (175.34, 168.58) mas
    1885: ( -1.1,   0.8) m, (208.53, 176.71) mas
    1277: ( -1.1,  -0.9) m, (216.36, 201.85) mas
    1038: ( -1.8,  -1.5) m, (216.65, 199.32) mas
     737: ( -2.8,  -2.3) m, (232.76, 211.29) mas
     471: ( -3.7,  -3.1) m, (249.56, 223.66) mas
     122: ( -3.1,  -4.3) m, (238.44, 245.46) mas
sa index   location       noise equivalent angle
    2946: (  0.6,   3.9) m, (142.26, 152.14) mas
    2724: (  0.5,   3.1) m, (143.99, 159.47) mas
    2412: (  0.3,   2.2) m, (146.34, 169.66) mas
    2055: (  0.2,   1.2) m, (148.76, 180.64) mas
    1496: ( -1.4,  -0.3) m, (161.53, 207.86) mas
    1110: ( -0.3,  -1.4) m, (156.38, 223.12) mas
     752: ( -0.5,  -2.3) m, (158.29, 240.69) mas
     440: ( -0.6,  -3.2) m, (160.43, 262.59) mas
       4: ( -0.9,  -4.9) m, (171.88, 321.72) mas
      18: ( -2.3,  -4.8) m, (174.53, 306.48) mas
sa index   location       noise equivalent angle
    3048: ( -2.6,   4.3) m, (141.45, 143.65) mas
    2845: ( -2.2,   3.5) m, (144.24, 149.04) mas
    2504: ( -1.5,   2.5) m, (149.91, 159.89) mas
    2110: ( -0.9,   1.4) m, (156.72, 172.85) mas
    1991: ( -0.8,   1.1) m, (158.33, 176.25) mas
    1225: ( -0.9,  -1.1) m, (173.07, 220.55) mas
    1055: (  0.8,  -1.5) m, (178.66, 219.57) mas
     932: (  0.9,  -1.8) m, (181.09, 225.94) mas
     660: (  1.4,  -2.6) m, (187.35, 240.60) mas
     319: (  2.0,  -3.7) m, (196.22, 263.26) mas
     117: (  2.5,  -4.5) m, (203.17, 280.12) mas
sa index   location       noise equivalent angle
    2210: ( -4.6,   1.7) m, (145.37, 141.27) mas
    2030: ( -3.7,   1.2) m, (152.74, 143.74) mas
    1975: ( -3.2,   1.1) m, (156.61, 144.99) mas
    1827: ( -2.0,   0.6) m, (183.79, 165.34) mas
    1777: ( -1.4,   0.5) m, (178.57, 152.15) mas
    1939: (  0.8,   0.9) m, (213.97, 158.30) mas
    1386: (  1.4,  -0.6) m, (224.50, 165.22) mas
    1335: (  1.8,  -0.8) m, (251.81, 184.92) mas
    1135: (  3.5,  -1.4) m, (270.87, 174.51) mas
    1076: (  4.0,  -1.5) m, (283.97, 176.81) mas
    1410: (  5.1,  -0.6) m, (317.44, 173.71) mas
sa index   location       noise equivalent angle
     896: ( -4.6,  -1.8) m, (145.17, 140.96) mas
    1088: ( -3.7,  -1.4) m, (152.74, 143.74) mas
    1153: ( -3.2,  -1.2) m, (156.61, 144.99) mas
    1323: ( -2.0,  -0.8) m, (183.80, 164.98) mas
    1382: ( -1.4,  -0.6) m, (178.57, 152.15) mas
    2054: (  0.0,   1.2) m, (208.26, 175.22) mas
    1781: (  1.4,   0.5) m, (224.50, 165.22) mas
    1840: (  1.8,   0.6) m, (251.72, 184.73) mas
    2077: (  3.5,   1.2) m, (270.87, 174.51) mas
    2142: (  4.0,   1.4) m, (283.97, 176.81) mas
    1805: (  5.1,   0.5) m, (324.16, 178.25) mas
sa index   location       noise equivalent angle
      84: ( -2.6,  -4.5) m, (141.45, 143.65) mas
     292: ( -2.2,  -3.7) m, (144.24, 149.04) mas
     641: ( -1.5,  -2.6) m, (149.91, 159.89) mas
    1044: ( -0.9,  -1.5) m, (156.72, 172.85) mas
    1169: ( -0.8,  -1.2) m, (158.53, 176.55) mas
    1936: ( -0.9,   0.9) m, (168.57, 215.67) mas
    2121: (  0.8,   1.4) m, (178.66, 219.57) mas
    2246: (  0.9,   1.7) m, (181.09, 225.94) mas
    2523: (  1.4,   2.5) m, (187.35, 240.60) mas
    2872: (  2.0,   3.5) m, (196.22, 263.26) mas
    3081: (  2.5,   4.3) m, (203.17, 280.12) mas
sa index   location       noise equivalent angle
       9: (  0.8,  -4.9) m, (148.88, 154.22) mas
     228: (  0.6,  -4.0) m, (142.26, 152.14) mas
     447: (  0.5,  -3.2) m, (143.99, 159.47) mas
     757: (  0.3,  -2.3) m, (146.34, 169.66) mas
    1113: (  0.2,  -1.4) m, (148.83, 180.71) mas
    1664: ( -1.4,   0.2) m, (161.18, 207.48) mas
    2052: ( -0.3,   1.2) m, (156.02, 222.58) mas
    2407: ( -0.5,   2.2) m, (158.29, 240.69) mas
    2717: ( -0.6,   3.1) m, (160.43, 262.59) mas
    2937: ( -0.8,   3.9) m, (162.30, 283.82) mas
    3129: ( -2.3,   4.6) m, (174.53, 306.48) mas
sa index   location       noise equivalent angle
     468: (  3.7,  -3.2) m, (149.45, 149.36) mas
     518: (  3.5,  -3.1) m, (144.18, 143.17) mas
     772: (  2.6,  -2.3) m, (151.51, 149.01) mas
    1061: (  1.7,  -1.5) m, (162.10, 157.55) mas
    1278: (  0.9,  -0.9) m, (178.15, 171.35) mas
    1277: ( -1.1,  -0.9) m, (212.97, 180.96) mas
    1885: ( -1.1,   0.8) m, (211.96, 197.64) mas
    2104: ( -1.8,   1.4) m, (216.65, 199.32) mas
    2392: ( -2.8,   2.2) m, (232.76, 211.29) mas
    2646: ( -3.7,   2.9) m, (249.56, 223.66) mas
    3004: ( -3.1,   4.2) m, (238.44, 245.46) mas

[00;00mSetting up powfs 2 PO WFS[00;00m

OTF dimension is 48x48 (calculated)
Generating matched filter for powfs 2
Use sanea to derive neasim
Use sanea to derive neasim

[00;00mSetting up reconstructor[00;00m

Recon NEA: cmf(192.81) cmf(192.45) cmf(192.42) cmf(192.61) cmf(192.50) cmf(192.46) cmf(192.52) cmf(192.31) cmf(192.38) geom(0.31) geom(0.31) geom(0.31) mf(0.14)  mas
Setup or update control matrix parameters.
RRtwfs svd threshold is 1e-10
Replacing HA by HA*fit->actextrap
Adding piston cr to fit matrix
Adding TT cr on upper DMs to fit matrix.
Before assembling fit matrix:	5052.6 MiB.
Building fit->FR
Building fit->FL
Adding tikhonov constraint of 1.0e-07 to FLM
The maximum eigen value is estimated to be around 2.8e-04
DM Fit number of Low rank terms: 16 in LHS
After assemble fit matrix:	6807.9 MiB.
After setup_recon:	6807.9 MiB.
GPU 0: mem used 1776 MB (wfs init)
GPU 0: mem used 2844 MB (recon init)
GPU 0: mem used 2874 MB (perf init)

*** Simulation started at 2025/02/17 15:19:20 in nid001972. ***

Running seed 1
GPU 0: mem used 2874 MB (wfs seeding)
Wind dir: 267.3 261.7 167.0 130.5 300.7  32.3 119.8 139.0 150.8 277.7 203.0 133.1  45.9 265.1 deg
Using /global/homes/b/bpeck/.aos/cache/atm/vonkarman_14_8192x8192_0.0078125_1115374592d.bin
After genatm:	6707.5 MiB.
Step     #  Open Loop  PR TT  On axis  PR TT  Field RMS PR TT     Timing 
Step     0: OL  884.6  248.3  OA  884.6 248.3 CL  884.6 248.3 nm  0.103 s
Step    15: OL  908.1  254.1  OA  136.8  71.0 CL  136.8  71.0 nm  0.069 s
Step    29: OL  930.4  258.4  OA  105.7   8.1 CL  105.7   8.1 nm  0.079 s
Step    42: OL  950.5  260.7  OA  105.1  11.9 CL  105.1  11.9 nm  0.078 s
Step    55: OL  969.7  261.0  OA  103.2  16.5 CL  103.2  16.5 nm  0.085 s
Step    68: OL  989.1  259.9  OA  103.8  15.7 CL  103.8  15.7 nm  0.077 s
Step    81: OL 1008.7  258.5  OA  108.7  17.7 CL  108.7  17.7 nm  0.078 s
Step    94: OL 1028.6  257.6  OA  104.0  15.9 CL  104.0  15.9 nm  0.085 s
Step   107: OL 1048.3  257.4  OA  108.1   4.6 CL  108.1   4.6 nm  0.077 s
Step   120: OL 1067.9  258.4  OA  102.1  16.3 CL  102.1  16.3 nm  0.084 s
Step   133: OL 1086.2  261.0  OA  103.1  10.2 CL  103.1  10.2 nm  0.078 s
Step   146: OL 1103.5  265.5  OA  106.1  14.9 CL  106.1  14.9 nm  0.079 s
Step   159: OL 1118.7  271.5  OA  102.7  10.1 CL  102.7  10.1 nm  0.083 s
Step   172: OL 1131.9  278.9  OA  103.3  20.0 CL  103.3  20.0 nm  0.078 s
Step   185: OL 1142.4  287.1  OA  103.5  14.5 CL  103.5  14.5 nm  0.082 s
Step   198: OL 1150.2  295.5  OA  106.5  15.4 CL  106.5  15.4 nm  0.078 s
Step   211: OL 1156.1  303.8  OA  105.9  26.8 CL  105.9  26.8 nm  0.080 s
Step   224: OL 1159.6  312.1  OA  101.1  18.1 CL  101.1  18.1 nm  0.087 s
Step   237: OL 1160.8  320.7  OA  106.4   3.0 CL  106.4   3.0 nm  0.077 s
Step   250: OL 1159.0  329.8  OA  103.7  14.5 CL  103.7  14.5 nm  0.079 s
Step   255 updated high order loop gain: 0.358
Step   263: OL 1153.5  339.2  OA  105.5  13.7 CL  105.5  13.7 nm  0.077 s
Step   276: OL 1144.2  348.5  OA  101.5  18.3 CL  101.5  18.3 nm  0.081 s
Step   288: OL 1133.2  357.8  OA   99.3  13.8 CL   99.3  13.8 nm  0.084 s
Step   301: OL 1120.0  369.0  OA  106.0  31.5 CL  106.0  31.5 nm  0.076 s
Step   314: OL 1105.1  380.9  OA  103.5  24.5 CL  103.5  24.5 nm  0.081 s
Step   327: OL 1088.7  393.8  OA  102.0  17.9 CL  102.0  17.9 nm  0.086 s
Step   340: OL 1071.9  408.5  OA  104.3  21.9 CL  104.3  21.9 nm  0.080 s
Step   353: OL 1055.0  424.9  OA  103.9  16.3 CL  103.9  16.3 nm  0.089 s
Step   366: OL 1038.9  442.8  OA  104.6  16.3 CL  104.6  16.3 nm  0.078 s
Step   379: OL 1023.8  461.5  OA  111.6  20.0 CL  111.6  20.0 nm  0.078 s
Step   392: OL 1009.4  480.3  OA  112.2   9.6 CL  112.2   9.6 nm  0.078 s
Step   405: OL  995.2  498.9  OA  104.5  15.3 CL  104.5  15.3 nm  0.081 s
Step   418: OL  980.4  516.9  OA  105.8  19.7 CL  105.8  19.7 nm  0.082 s
Step   431: OL  965.5  534.2  OA  106.7  23.3 CL  106.7  23.3 nm  0.079 s
Step   444: OL  951.4  551.2  OA  103.3   7.1 CL  103.3   7.1 nm  0.088 s
Step   457: OL  939.5  568.2  OA  104.3  13.4 CL  104.3  13.4 nm  0.077 s
Step   470: OL  930.8  585.1  OA  106.1  26.2 CL  106.1  26.2 nm  0.076 s
Step   483: OL  926.2  601.6  OA  107.5  24.1 CL  107.5  24.1 nm  0.080 s
Step   496: OL  925.8  617.4  OA  106.2  18.4 CL  106.2  18.4 nm  0.080 s
Step   509: OL  927.6  632.0  OA  102.9  11.9 CL  102.9  11.9 nm  0.097 s
Step   511 updated high order loop gain: 0.315
Step   522: OL  931.5  644.8  OA  107.4   7.2 CL  107.4   7.2 nm  0.076 s
Step   535: OL  937.1  654.9  OA  102.6   4.9 CL  102.6   4.9 nm  0.081 s
Step   548: OL  944.9  662.2  OA  105.9   8.2 CL  105.9   8.2 nm  0.080 s
Step   561: OL  954.9  667.1  OA  104.1  15.8 CL  104.1  15.8 nm  0.077 s
Step   574: OL  966.5  669.8  OA  101.8   1.3 CL  101.8   1.3 nm  0.087 s
Step   587: OL  979.8  670.7  OA  101.5   8.1 CL  101.5   8.1 nm  0.076 s
Step   600: OL  994.4  668.9  OA  102.7  10.2 CL  102.7  10.2 nm  0.081 s
Step   613: OL 1009.5  664.3  OA  103.6  11.2 CL  103.6  11.2 nm  0.081 s
Step   626: OL 1024.8  657.3  OA  101.0  10.7 CL  101.0  10.7 nm  0.078 s
Step   639: OL 1039.5  647.9  OA  102.9  11.7 CL  102.9  11.7 nm  0.087 s
Step   652: OL 1053.0  636.7  OA   98.4  13.8 CL   98.4  13.8 nm  0.085 s
Step   665: OL 1065.3  624.1  OA  100.4  11.6 CL  100.4  11.6 nm  0.088 s
Step   678: OL 1076.7  610.5  OA  103.6   5.9 CL  103.6   5.9 nm  0.080 s
Step   691: OL 1087.3  596.9  OA  108.2  18.0 CL  108.2  18.0 nm  0.078 s
Step   704: OL 1096.2  582.2  OA  103.5  12.0 CL  103.5  12.0 nm  0.080 s
Step   717: OL 1102.4  566.4  OA  108.5  18.5 CL  108.5  18.5 nm  0.078 s
Step   730: OL 1105.8  550.2  OA  104.1  21.2 CL  104.1  21.2 nm  0.088 s
Step   743: OL 1106.0  534.2  OA  105.2  17.7 CL  105.2  17.7 nm  0.083 s
Step   756: OL 1103.3  518.5  OA  109.2  19.2 CL  109.2  19.2 nm  0.090 s
Step   767 updated high order loop gain: 0.296
Step   769: OL 1097.7  503.4  OA  108.2  20.6 CL  108.2  20.6 nm  0.078 s
Step   782: OL 1089.1  488.8  OA  107.6   8.0 CL  107.6   8.0 nm  0.078 s
Step   795: OL 1077.1  474.2  OA  101.4   6.1 CL  101.4   6.1 nm  0.083 s
Step   808: OL 1062.7  459.7  OA  104.4  17.1 CL  104.4  17.1 nm  0.077 s
Step   821: OL 1046.0  445.2  OA  105.4  17.9 CL  105.4  17.9 nm  0.084 s
Step   834: OL 1026.9  431.1  OA  105.2  11.7 CL  105.2  11.7 nm  0.076 s
Step   846: OL 1008.2  418.7  OA  109.1  16.3 CL  109.1  16.3 nm  0.080 s
Step   859: OL  987.5  406.0  OA  103.3   5.8 CL  103.3   5.8 nm  0.079 s
Step   869: OL  971.8  397.3  OA  104.7  19.7 CL  104.7  19.7 nm  0.079 s
Step   882: OL  952.4  387.1  OA  105.3   9.2 CL  105.3   9.2 nm  0.085 s
Step   895: OL  933.1  378.2  OA  108.0  22.3 CL  108.0  22.3 nm  0.078 s
Step   908: OL  912.8  370.5  OA  106.0  15.9 CL  106.0  15.9 nm  0.076 s
Step   921: OL  892.0  364.0  OA  100.6   7.7 CL  100.6   7.7 nm  0.079 s
Step   934: OL  871.6  357.8  OA  109.1   3.6 CL  109.1   3.6 nm  0.081 s
Step   947: OL  851.8  351.6  OA  105.2   7.6 CL  105.2   7.6 nm  0.088 s
Step   960: OL  833.4  345.0  OA  106.2  21.8 CL  106.2  21.8 nm  0.074 s
Step   973: OL  817.5  337.6  OA  103.0  14.9 CL  103.0  14.9 nm  0.081 s
Step   986: OL  803.6  329.5  OA  103.1   8.8 CL  103.1   8.8 nm  0.078 s
Step   999: OL  791.1  320.4  OA  103.7  12.3 CL  103.7  12.3 nm  0.079 s
Step  1012: OL  779.7  310.6  OA  101.7  15.3 CL  101.7  15.3 nm  0.125 s
Step  1023 updated high order loop gain: 0.290
Step  1025: OL  769.9  300.6  OA  101.6  11.8 CL  101.6  11.8 nm  0.079 s
Step  1038: OL  761.6  290.0  OA  102.4   3.4 CL  102.4   3.4 nm  0.088 s
Step  1051: OL  753.9  278.6  OA  105.5   6.8 CL  105.5   6.8 nm  0.079 s
Step  1064: OL  746.4  266.0  OA  104.2  21.7 CL  104.2  21.7 nm  0.079 s
Step  1077: OL  740.5  251.8  OA  107.2  29.6 CL  107.2  29.6 nm  0.085 s
Step  1090: OL  736.9  236.6  OA  102.2   9.3 CL  102.2   9.3 nm  0.081 s
Step  1103: OL  735.1  222.2  OA  107.3  16.1 CL  107.3  16.1 nm  0.084 s
Step  1114: OL  734.5  211.0  OA  104.2  26.2 CL  104.2  26.2 nm  0.077 s
Step  1127: OL  734.6  199.3  OA  101.0  15.3 CL  101.0  15.3 nm  0.081 s
Step  1140: OL  735.1  189.6  OA  105.5  28.0 CL  105.5  28.0 nm  0.078 s
Step  1153: OL  736.0  181.6  OA   99.0  11.2 CL   99.0  11.2 nm  0.080 s
Step  1166: OL  736.5  175.7  OA   99.1  19.3 CL   99.1  19.3 nm  0.083 s
Step  1179: OL  737.6  171.7  OA   98.5  21.4 CL   98.5  21.4 nm  0.076 s
Step  1192: OL  740.1  168.7  OA  102.5   9.6 CL  102.5   9.6 nm  0.078 s
Step  1205: OL  743.1  166.2  OA  101.7  20.0 CL  101.7  20.0 nm  0.093 s
Step  1218: OL  746.1  164.2  OA  103.7  16.0 CL  103.7  16.0 nm  0.078 s
Step  1231: OL  748.8  163.6  OA  100.8  11.5 CL  100.8  11.5 nm  0.087 s
Step  1244: OL  750.6  164.9  OA   98.9   7.4 CL   98.9   7.4 nm  0.076 s
Step  1257: OL  752.8  168.4  OA  103.6  12.9 CL  103.6  12.9 nm  0.078 s
Step  1270: OL  755.4  173.9  OA  104.4  14.4 CL  104.4  14.4 nm  0.080 s
Step  1279 updated high order loop gain: 0.282
Step  1283: OL  758.9  180.9  OA   99.2   6.0 CL   99.2   6.0 nm  0.081 s
Step  1296: OL  763.3  189.1  OA   99.2   0.9 CL   99.2   0.9 nm  0.083 s
Step  1309: OL  767.6  198.3  OA  102.3  15.8 CL  102.3  15.8 nm  0.078 s
Step  1322: OL  771.4  208.5  OA  101.0   7.7 CL  101.0   7.7 nm  0.080 s
Step  1335: OL  776.1  219.8  OA  100.2   9.6 CL  100.2   9.6 nm  0.076 s
Step  1348: OL  782.0  231.7  OA   95.2   7.3 CL   95.2   7.3 nm  0.078 s
Step  1361: OL  789.7  243.1  OA   97.5  18.6 CL   97.5  18.6 nm  0.087 s
Step  1374: OL  798.4  252.6  OA   97.0   7.4 CL   97.0   7.4 nm  0.079 s
Step  1387: OL  808.0  260.4  OA   96.6   0.9 CL   96.6   0.9 nm  0.083 s
Step  1399: OL  818.1  266.0  OA  101.9  21.6 CL  101.9  21.6 nm  0.080 s
Step  1412: OL  830.3  270.5  OA   99.9   2.0 CL   99.9   2.0 nm  0.080 s
Step  1425: OL  843.2  273.8  OA  100.6   7.7 CL  100.6   7.7 nm  0.089 s
Step  1438: OL  855.7  276.6  OA  103.1  21.7 CL  103.1  21.7 nm  0.078 s
Step  1451: OL  867.9  278.7  OA  101.0  13.1 CL  101.0  13.1 nm  0.080 s
Step  1464: OL  879.0  279.5  OA   99.3  10.9 CL   99.3  10.9 nm  0.080 s
Step  1477: OL  887.4  278.7  OA   95.9   1.0 CL   95.9   1.0 nm  0.078 s
Step  1490: OL  892.2  276.1  OA  103.3   5.4 CL  103.3   5.4 nm  0.086 s
Step  1503: OL  893.5  271.7  OA   98.8  16.1 CL   98.8  16.1 nm  0.081 s
Step  1516: OL  892.2  266.0  OA  100.6   8.3 CL  100.6   8.3 nm  0.079 s
Step  1529: OL  889.0  259.3  OA  100.5   5.1 CL  100.5   5.1 nm  0.084 s
Step  1535 updated high order loop gain: 0.280
Step  1542: OL  883.4  251.2  OA   97.7   6.9 CL   97.7   6.9 nm  0.077 s
Step  1555: OL  877.1  242.6  OA  103.0  17.7 CL  103.0  17.7 nm  0.087 s
Step  1568: OL  870.7  234.4  OA  101.1  10.3 CL  101.1  10.3 nm  0.079 s
Step  1581: OL  863.3  227.2  OA   99.6   5.9 CL   99.6   5.9 nm  0.076 s
Step  1594: OL  855.5  221.4  OA  102.6   9.2 CL  102.6   9.2 nm  0.086 s
Step 1599: Output PSF
Step  1599: OL  852.2  219.3  OA  103.9   9.5 CL  103.9   9.5 nm  1.229 s
Mean: 103.01 13.90 102.07  nm.

*** Simulation Finished at 2025/02/17 15:21:37 in nid001972. ***

[00;00m>>>>>>>>>>>>>>>>[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
/global/cfs/cdirs/ulens/vismcao/maos -o studies/reduced_ngs/9_lgs/8mag_lgs/4250count -c master_files/reduced_ngs/9_lgs/8mag_lgs/kola_4250act.conf -O 
Output folder is 'studies/reduced_ngs/9_lgs/8mag_lgs/4250count'.
SRC: /global/homes/b/bpeck/code/maos v2.9 4c88b7c2 2024-11-13 16:45:33 -0800
BUILT: /global/homes/b/bpeck/code/maos/optim by GCC (v12) on 2024/11/18 09:40:03 CPU(F64,+O3) with CUDA(v122,F32)
Launched at 2025/02/17 15:21:38 in nid001972 with PID 1696341.
The web based job monitor can be accessed at http://localhost:10300
Main config file is /global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_4250act.conf
[00;00m[0;36mWarning(path.c:48): Path not found: path=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; abspath=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; Ignored.
[00;00m[0;36mWarning(path.c:48): Path not found: path=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; abspath=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; Ignored.
[00;00m[0;36mWarning(readcfg.c:399): sim.apfsm has been renamed to powfs.apfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.epfsm has been renamed to powfs.epfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.alfsm has been renamed to powfs.alfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.commonfsm has been renamed to powfs.commonfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.idealfsm has been renamed to powfs.idealfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.zetafsm has been renamed to powfs.zetafsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.f0fsm has been renamed to powfs.f0fsm.
[00;00m[0;36mWarning(readcfg.c:399): tsurf has been renamed to ncpa.tsurf.
loaded 132 (132 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_sim.conf'
loaded  19 ( 19 new) records from '/global/cfs/cdirs/ulens/vismcao/./dm_none.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_ASM.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_DM2.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_DM3.conf'
loaded   0 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_dm_multiple.conf'
loaded   7 (  5 new) records from '/global/cfs/cdirs/ulens/vismcao/./atm_mk13n50p_ground_detail.conf'
loaded  76 ( 69 new) records from '/global/homes/b/bpeck/code/maos/config/maos/powfs_common.conf'
loaded  44 ( 38 new) records from '/global/cfs/cdirs/ulens/vismcao/./powfs_none.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_lgs.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_ttf_strap.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_twfs_lbwfs.conf'
loaded   0 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_wfs_lgs_strap_lbwfs.conf'
loaded  71 ( 71 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_recon.conf'
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_smooth has been renamed to powfs0_llt.na_smooth.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_interp has been renamed to powfs0_llt.na_interp.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_thres has been renamed to powfs0_llt.na_thres.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_maxit has been renamed to powfs0_llt.na_fit_maxit.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_svdthres has been renamed to powfs0_llt.na_fit_svdthres.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_dh has been renamed to powfs0_llt.na_fit_dh.
[00;00m[0;36mWarning(readcfg.c:399): dbg.ncpa_preload has been renamed to ncpa.preload.
[00;00m[0;36mWarning(readcfg.c:399): dbg.ncpa_rmsci has been renamed to ncpa.rmsci.
[00;00m[0;36mWarning(readcfg.c:399): dbg.draw_opdmax has been renamed to plot.opdmax.
[00;00m[0;36mWarning(readcfg.c:399): dbg.draw_gmax has been renamed to plot.gmax.
loaded  95 ( 93 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_dbg.conf'
loaded   4 (  4 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_fit_mcao.conf'
[00;00m[0;36mWarning(readcfg.c:399): surf has been renamed to ncpa.surf.
loaded  39 (  7 new) records from '/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_4250act.conf'
loaded   0 (  0 new) records from 'command line'
loaded  24 ( 18 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_llt_CL.conf'
Adjust LGS range by telescope altitude 4145m.
Zenith angle is 30 degree.
    Scaling turbulence height and LGS hs by sec(za).
    Scaling r0 by cos(za)^(3/5).
    Scaling wind speed and LGS signal level by cos(za).
powfs0: Adjusting dx from 0.0078125 to 0.0075. 
powfs0.llt.fsm: f0=0 Hz, LPF ep=0
powfs0.epfsm is set to 0.517618 (auto)
powfs2: Adjusting dx from 0.03125 to 0.0312778. 
powfs2 is TWFS for powfs0
sim.ephi is set to 0.427717 (auto)
sim.eplo is set to 0.427717 (auto)
[00;00m[0;36mWarning(parms.c:2296): Layer 1 at 17.3205m is very close to layer 0 at 0m (OK).
[00;00m[0;36mWarning(parms.c:2296): Layer 2 at 34.641m is very close to layer 1 at 17.3205m (OK).
[00;00m[0;36mWarning(parms.c:2296): Layer 3 at 51.9615m is very close to layer 2 at 34.641m (OK).
dm 0: stroke=30 um is provided in micron.
dm 0: assume ia stroke=2 um is provided in micron.
dm 1: stroke=7 um is provided in micron.
dm 1: assume ia stroke=2 um is provided in micron.
dm 2: stroke=7 um is provided in micron.
dm 2: assume ia stroke=2 um is provided in micron.
Focus blending is not implemented yet for integrated tomography
parms->sim.mffocus is reset to 0
There are 1 valid simulation seeds:  1
Output PSF for 1 directions
Used 449 of 456 supplied keys
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_flate" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_flatv" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_psx" is not recognized, value is [0 0 0 0]
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_psy" is not recognized, value is [0 0 0 0]
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_pupelong" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_raw" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_side" is not recognized, value is 4
[00;00mAperture[00;00m is 11 m with sampling 1/128 m
[00;00mTurbulence at 30 degree zenith angle:[00;00m r0=0.128424m, L0=30m, 14 layers.
    Greenwood freq is 25.1Hz, anisoplanatic angle is 1.58 as
    Sampled 8192x8192 at 1/128m. wind dir is randomized.
    layer 0: ht=      0 m, wt= 0.302, ws=  4.8 m/s
    layer 1: ht=     17 m, wt= 0.154, ws=  5.0 m/s
    layer 2: ht=     35 m, wt= 0.041, ws=  5.4 m/s
    layer 3: ht=     52 m, wt= 0.002, ws=  6.6 m/s
    layer 4: ht=    139 m, wt= 0.021, ws=  6.1 m/s
    layer 5: ht=    231 m, wt= 0.010, ws=  6.1 m/s
    layer 6: ht=    323 m, wt= 0.008, ws=  6.1 m/s
    layer 7: ht=    416 m, wt= 0.005, ws=  6.1 m/s
    layer 8: ht=    508 m, wt= 0.001, ws=  6.1 m/s
    layer 9: ht=    932 m, wt= 0.107, ws=  5.6 m/s
    layer 10: ht=   5022 m, wt= 0.144, ws= 11.1 m/s
    layer 11: ht=   9238 m, wt= 0.093, ws= 19.1 m/s
    layer 12: ht=  13856 m, wt= 0.075, ws=  8.2 m/s
    layer 13: ht=  22518 m, wt= 0.036, ws=  4.8 m/s
[00;00mReconstruction[00;00m: r0=0.128424m L0=30m. 14 layers. use cone coordinate.
    layer 0: ht=      0 m, wt= 0.302
    layer 1: ht=     17 m, wt= 0.154
    layer 2: ht=     35 m, wt= 0.041
    layer 3: ht=     52 m, wt= 0.002
    layer 4: ht=    139 m, wt= 0.021
    layer 5: ht=    231 m, wt= 0.010
    layer 6: ht=    323 m, wt= 0.008
    layer 7: ht=    416 m, wt= 0.005
    layer 8: ht=    508 m, wt= 0.001
    layer 9: ht=    932 m, wt= 0.107
    layer 10: ht=   5022 m, wt= 0.144
    layer 11: ht=   9238 m, wt= 0.093
    layer 12: ht=  13856 m, wt= 0.075
    layer 13: ht=  22518 m, wt= 0.036
[00;00mThere are 3 powfs[00;00m
  powfs0: Order 74, LGS at 99.1 km. Sampling 1/133.333 m. Thres 30%. [00;00mT/T is removed in right hand side in tomography.[00;00m
    CCD image is 25x25 @ 500x500 mas, blur 27% (sigma), 1500Hz, wvl: [ 5.89e-07]
    Gtilt in reconstruction. Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
  powfs1: Order  2, NGS at inf km. Sampling 1/16 m. Thres 30%. 
    Ztilt in reconstruction. Geomtric optics start at 2 with ztilt [00;00m(noisy)[00;00m
  powfs2: Order 20, NGS at inf km. Sampling 1/31.9716 m. Thres 50%. 
    CCD image is 4x4 @ 1500x1500 mas, blur 0% (sigma), 0.015Hz, wvl: [ 7.2e-07]
    Gtilt in reconstruction. Geomtric optics start at 50 with gtilt Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
[00;00mThere are 13 wfs[00;00m
    wfs 0: type 0, at (  30.00,    0.00) arcsec,  99 km, siglev is 26.9784 bkgrnd is 0.1
    wfs 1: type 0, at (  22.98,   19.28) arcsec,  99 km, siglev is 26.9784 bkgrnd is 0.1
    wfs 2: type 0, at (   5.21,   29.54) arcsec,  99 km, siglev is 26.9784 bkgrnd is 0.1
    wfs 3: type 0, at ( -15.00,   25.98) arcsec,  99 km, siglev is 26.9784 bkgrnd is 0.1
    wfs 4: type 0, at ( -28.19,   10.26) arcsec,  99 km, siglev is 26.9784 bkgrnd is 0.1
    wfs 5: type 0, at ( -28.19,  -10.26) arcsec,  99 km, siglev is 26.9784 bkgrnd is 0.1
    wfs 6: type 0, at ( -15.00,  -25.98) arcsec,  99 km, siglev is 26.9784 bkgrnd is 0.1
    wfs 7: type 0, at (   5.21,  -29.54) arcsec,  99 km, siglev is 26.9784 bkgrnd is 0.1
    wfs 8: type 0, at (  22.98,  -19.28) arcsec,  99 km, siglev is 26.9784 bkgrnd is 0.1
    wfs 9: type 1, at (   5.00,    8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 10: type 1, at ( -10.00,    0.00) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 11: type 1, at (   5.00,   -8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 12: type 2, at (   0.00,    0.00) arcsec, inf km, siglev is 4.1558e+06 bkgrnd is 0.001
[00;00mThere are 3 DMs[00;00m
  DM 0 at -0.1km, actuator pitch 0.15m, offset   0, with 30.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 1 at    6km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 2 at   10km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
[00;00mTomography[00;00m is using CG, with [00;00mFourer Domain[00;00m preconditioner, [00;00m12[00;00m iterations, integrated tomo.
[00;00mDM Fitting [00;00mis using CG, with [00;00mNo[00;00m preconditioner, [00;00m10[00;00m iterations
[00;00mThere are 9 fit directions[00;00m
    Fit 0: weight is 0.444, at (   0.00,    0.00) arcsec
    Fit 1: weight is 0.111, at (  15.00,    0.00) arcsec
    Fit 2: weight is 0.111, at (   0.00,   15.00) arcsec
    Fit 3: weight is 0.111, at ( -15.00,    0.00) arcsec
    Fit 4: weight is 0.111, at (   0.00,  -15.00) arcsec
    Fit 5: weight is 0.028, at (  15.00,   15.00) arcsec
    Fit 6: weight is 0.028, at ( -15.00,   15.00) arcsec
    Fit 7: weight is 0.028, at ( -15.00,  -15.00) arcsec
    Fit 8: weight is 0.028, at (  15.00,  -15.00) arcsec
[00;00mThere are 1 evaluation directions[00;00m at sampling 1/128 m.
    Evl 0: weight is 1.000, at (   0.00,    0.00) arcsec
[00;00mSimulation[00;00m start at step 0, end at step 1600, with time step 1/1500s, [00;00mclose loop[00;00m.
After setup_parms:	120.5 MiB.
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
CUDA: minimum memory requirement is 0.4GB
GPU 0 is NVIDIA A100-SXM4-40GB with arch 8.0, 38.9GB free, 39.3GB total device memory.
Using GPU 0
Use 1 GPUs for WFS Tomo Fit Evl

*** Preparation started at 2025/02/17 15:21:38 in nid001972. ***

Using OpenMP version 201511 with 128 threads
Reading aperture amplitude map from KECK.fits
[00;00m[0;36mWarning(accphi.c:477): 108396 points not covered by input screen
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
 ->maos.c:447->setup.c:148->aper.c:74->utils.c:478->accphi.c:478
iwvl 0: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 1: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 2: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 3: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 4: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 5: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 6: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 7: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 8: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
After setup_aper:	349.7 MiB.

[00;00mSetting up powfs 0 geom[00;00m

There are 20 points in each subaperture of 0.15m.
There are 3300 valid subaperture.

[00;00mSetting up powfs 1 geom[00;00m

There are 88 points in each subaperture of 5.5m.
There are 4 valid subaperture.

[00;00mSetting up powfs 2 geom[00;00m

There are 18 points in each subaperture of 0.563m.
There are 236 valid subaperture.
After setup_powfs_init:	451.9 MiB.

[00;00mSetting up reconstructor geometry.[00;00m

PLOC is 151x151, with sampling of 0.07m (square)
    DM 0: grid is 77 x 77
    DM 1: grid is 75 x 75
    DM 2: grid is 80 x 79
FLOC is 151x151, with sampling of 0.07m (not square)
Tomography grid is square:
    layer 0: xloc grid is 280 x 280, sampling is 0.075 m, 78400 points
    layer 1: xloc grid is 280 x 280, sampling is 0.075 m, 78400 points
    layer 2: xloc grid is 280 x 280, sampling is 0.075 m, 78400 points
    layer 3: xloc grid is 280 x 280, sampling is 0.075 m, 78400 points
    layer 4: xloc grid is 280 x 280, sampling is 0.075 m, 78400 points
    layer 5: xloc grid is 280 x 280, sampling is 0.075 m, 78400 points
    layer 6: xloc grid is 280 x 280, sampling is 0.075 m, 78400 points
    layer 7: xloc grid is 280 x 280, sampling is 0.075 m, 78400 points
    layer 8: xloc grid is 280 x 280, sampling is 0.075 m, 78400 points
    layer 9: xloc grid is 280 x 280, sampling is 0.074 m, 78400 points
    layer 10: xloc grid is 280 x 280, sampling is 0.071 m, 78400 points
    layer 11: xloc grid is 280 x 280, sampling is 0.068 m, 78400 points
    layer 12: xloc grid is 280 x 280, sampling is 0.065 m, 78400 points
    layer 13: xloc grid is 280 x 280, sampling is 0.058 m, 78400 points

[00;00mSetting up powfs 0 PO WFS[00;00m

OTF dimension is 40x40 (calculated)
Uplink FWHM (illt 0, iwvl 0) is 0.576822"
Downlink FWHM (illt 0, iwvl 0) is 0"
Generating matched filter for powfs 0
sa index   location       noise equivalent angle
    1648: (  4.8,  -0.1) m, (5000.00, 5000.00) mas
    1641: (  3.8,  -0.1) m, (5000.00, 5000.00) mas
    1634: (  2.7,  -0.1) m, (5000.00, 5000.00) mas
    1626: (  1.5,  -0.1) m, (5000.00, 5000.00) mas
    1625: (  1.3,  -0.1) m, (5000.00, 5000.00) mas
    1171: ( -0.6,  -1.3) m, (5000.00, 5000.00) mas
    1620: ( -1.8,  -0.1) m, (5000.00, 5000.00) mas
    1613: ( -2.9,  -0.1) m, (5000.00, 5000.00) mas
    1606: ( -3.9,  -0.1) m, (5000.00, 5000.00) mas
    1598: ( -5.1,  -0.1) m, (5000.00, 5000.00) mas
    1596: ( -5.4,  -0.1) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    2832: (  3.8,   3.0) m, (5000.00, 5000.00) mas
    2778: (  3.4,   2.9) m, (5000.00, 5000.00) mas
    2511: (  2.5,   2.1) m, (5000.00, 5000.00) mas
    2203: (  1.6,   1.3) m, (5000.00, 5000.00) mas
    2019: (  1.1,   0.9) m, (5000.00, 5000.00) mas
    1177: (  0.3,  -1.3) m, (5000.00, 5000.00) mas
    1285: ( -1.2,  -1.1) m, (5000.00, 5000.00) mas
    1101: ( -1.8,  -1.5) m, (5000.00, 5000.00) mas
     793: ( -2.7,  -2.2) m, (5000.00, 5000.00) mas
     526: ( -3.6,  -3.0) m, (5000.00, 5000.00) mas
     119: ( -3.0,  -4.3) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    3280: (  0.8,   4.6) m, (5000.00, 5000.00) mas
    2810: (  0.4,   3.0) m, (5000.00, 5000.00) mas
    2496: (  0.3,   2.1) m, (5000.00, 5000.00) mas
    2131: (  0.1,   1.2) m, (5000.00, 5000.00) mas
    1564: ( -1.5,  -0.3) m, (5000.00, 5000.00) mas
    1111: ( -0.3,  -1.5) m, (5000.00, 5000.00) mas
     808: ( -0.4,  -2.2) m, (5000.00, 5000.00) mas
     494: ( -0.6,  -3.1) m, (5000.00, 5000.00) mas
      20: ( -0.9,  -4.8) m, (5000.00, 5000.00) mas
      16: ( -2.2,  -4.8) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    3230: ( -2.7,   4.5) m, (5000.00, 5000.00) mas
    2940: ( -2.1,   3.4) m, (5000.00, 5000.00) mas
    2589: ( -1.5,   2.4) m, (5000.00, 5000.00) mas
    2186: ( -0.9,   1.3) m, (5000.00, 5000.00) mas
    2069: ( -0.8,   1.1) m, (5000.00, 5000.00) mas
    1740: (  1.2,   0.1) m, (5000.00, 5000.00) mas
    1118: (  0.8,  -1.5) m, (5000.00, 5000.00) mas
     995: (  0.9,  -1.8) m, (5000.00, 5000.00) mas
     715: (  1.3,  -2.5) m, (5000.00, 5000.00) mas
     363: (  1.9,  -3.6) m, (5000.00, 5000.00) mas
      73: (  2.5,  -4.6) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    2285: ( -4.6,   1.6) m, (5000.00, 5000.00) mas
    2106: ( -3.6,   1.2) m, (5000.00, 5000.00) mas
    2053: ( -3.1,   1.1) m, (5000.00, 5000.00) mas
    1906: ( -1.9,   0.6) m, (5000.00, 5000.00) mas
    1853: ( -1.5,   0.4) m, (5000.00, 5000.00) mas
    2072: (  0.6,   1.1) m, (5000.00, 5000.00) mas
    1452: (  1.3,  -0.6) m, (5000.00, 5000.00) mas
    1399: (  1.8,  -0.8) m, (5000.00, 5000.00) mas
    1198: (  3.4,  -1.3) m, (5000.00, 5000.00) mas
    1139: (  3.9,  -1.5) m, (5000.00, 5000.00) mas
    1477: (  5.1,  -0.6) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
     958: ( -4.6,  -1.8) m, (5000.00, 5000.00) mas
    1151: ( -3.6,  -1.3) m, (5000.00, 5000.00) mas
    1216: ( -3.1,  -1.2) m, (5000.00, 5000.00) mas
    1388: ( -1.9,  -0.8) m, (5000.00, 5000.00) mas
    1447: ( -1.5,  -0.6) m, (5000.00, 5000.00) mas
    1235: (  0.6,  -1.2) m, (5000.00, 5000.00) mas
    1858: (  1.3,   0.4) m, (5000.00, 5000.00) mas
    1917: (  1.8,   0.6) m, (5000.00, 5000.00) mas
    2153: (  3.4,   1.2) m, (5000.00, 5000.00) mas
    2218: (  3.9,   1.3) m, (5000.00, 5000.00) mas
    1883: (  5.1,   0.4) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
      40: ( -2.7,  -4.6) m, (5000.00, 5000.00) mas
     336: ( -2.1,  -3.6) m, (5000.00, 5000.00) mas
     696: ( -1.5,  -2.5) m, (5000.00, 5000.00) mas
    1107: ( -0.9,  -1.5) m, (5000.00, 5000.00) mas
    1232: ( -0.8,  -1.2) m, (5000.00, 5000.00) mas
    1508: (  1.2,  -0.4) m, (5000.00, 5000.00) mas
    2197: (  0.8,   1.3) m, (5000.00, 5000.00) mas
    2322: (  0.9,   1.6) m, (5000.00, 5000.00) mas
    2608: (  1.3,   2.4) m, (5000.00, 5000.00) mas
    2967: (  1.9,   3.4) m, (5000.00, 5000.00) mas
    3262: (  2.5,   4.5) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
      27: (  0.8,  -4.8) m, (5000.00, 5000.00) mas
     501: (  0.4,  -3.1) m, (5000.00, 5000.00) mas
     813: (  0.3,  -2.2) m, (5000.00, 5000.00) mas
    1114: (  0.1,  -1.5) m, (5000.00, 5000.00) mas
    1738: ( -1.5,   0.1) m, (5000.00, 5000.00) mas
    2190: ( -0.3,   1.3) m, (5000.00, 5000.00) mas
    2491: ( -0.4,   2.1) m, (5000.00, 5000.00) mas
    2803: ( -0.6,   3.0) m, (5000.00, 5000.00) mas
    3273: ( -0.9,   4.6) m, (5000.00, 5000.00) mas
    3269: ( -2.2,   4.6) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
     523: (  3.8,  -3.1) m, (5000.00, 5000.00) mas
     573: (  3.4,  -3.0) m, (5000.00, 5000.00) mas
     828: (  2.5,  -2.2) m, (5000.00, 5000.00) mas
    1124: (  1.6,  -1.5) m, (5000.00, 5000.00) mas
    1290: (  1.1,  -1.1) m, (5000.00, 5000.00) mas
    2132: (  0.3,   1.2) m, (5000.00, 5000.00) mas
    2014: ( -1.2,   0.9) m, (5000.00, 5000.00) mas
    2180: ( -1.8,   1.3) m, (5000.00, 5000.00) mas
    2476: ( -2.7,   2.1) m, (5000.00, 5000.00) mas
    2731: ( -3.6,   2.9) m, (5000.00, 5000.00) mas
    3145: ( -3.0,   4.2) m, (5000.00, 5000.00) mas

[00;00mSetting up powfs 2 PO WFS[00;00m

OTF dimension is 48x48 (calculated)
Generating matched filter for powfs 2
Use sanea to derive neasim
Use sanea to derive neasim

[00;00mSetting up reconstructor[00;00m

Recon NEA: cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) geom(0.31) geom(0.31) geom(0.31) mf(0.14)  mas
Setup or update control matrix parameters.
RRtwfs svd threshold is 1e-10
Replacing HA by HA*fit->actextrap
Adding piston cr to fit matrix
Adding TT cr on upper DMs to fit matrix.
Before assembling fit matrix:	5459.0 MiB.
Building fit->FR
Building fit->FL
Adding tikhonov constraint of 1.0e-07 to FLM
The maximum eigen value is estimated to be around 2.7e-04
DM Fit number of Low rank terms: 16 in LHS
After assemble fit matrix:	7370.5 MiB.
After setup_recon:	7370.5 MiB.
GPU 0: mem used 1650 MB (wfs init)
GPU 0: mem used 2818 MB (recon init)
GPU 0: mem used 2848 MB (perf init)

*** Simulation started at 2025/02/17 15:23:18 in nid001972. ***

Running seed 1
GPU 0: mem used 2850 MB (wfs seeding)
Wind dir: 267.3 261.7 167.0 130.5 300.7  32.3 119.8 139.0 150.8 277.7 203.0 133.1  45.9 265.1 deg
Using /global/homes/b/bpeck/.aos/cache/atm/vonkarman_14_8192x8192_0.0078125_1115374592d.bin
After genatm:	7255.2 MiB.
Step     #  Open Loop  PR TT  On axis  PR TT  Field RMS PR TT     Timing 
Step     0: OL  884.6  248.3  OA  884.6 248.3 CL  884.6 248.3 nm  0.125 s
Step    14: OL  906.0  253.8  OA  753.3 236.4 CL  753.3 236.4 nm  0.074 s
Step    27: OL  926.0  258.0  OA  750.5 239.8 CL  750.5 239.8 nm  0.091 s
Step    39: OL  944.3  260.5  OA  744.3 238.4 CL  744.3 238.4 nm  0.081 s
Step    51: OL  962.2  261.3  OA  735.7 236.4 CL  735.7 236.4 nm  0.081 s
Step    63: OL  980.3  260.7  OA  728.2 233.3 CL  728.2 233.3 nm  0.096 s
Step    75: OL  998.9  259.5  OA  719.1 230.2 CL  719.1 230.2 nm  0.084 s
Step    87: OL 1018.0  258.5  OA  711.9 228.0 CL  711.9 228.0 nm  0.082 s
Step    99: OL 1037.4  257.8  OA  706.5 227.1 CL  706.5 227.1 nm  0.096 s
Step   111: OL 1056.8  258.1  OA  703.4 223.6 CL  703.4 223.6 nm  0.081 s
Step   123: OL 1075.8  259.3  OA  702.4 220.3 CL  702.4 220.3 nm  0.094 s
Step   135: OL 1093.6  262.2  OA  703.4 216.3 CL  703.4 216.3 nm  0.081 s
Step   147: OL 1110.6  266.6  OA  701.4 210.9 CL  701.4 210.9 nm  0.086 s
Step   159: OL 1125.7  272.2  OA  700.6 207.3 CL  700.6 207.3 nm  0.081 s
Step   171: OL 1139.2  279.0  OA  699.6 205.4 CL  699.6 205.4 nm  0.091 s
Step   183: OL 1150.7  286.6  OA  700.7 204.1 CL  700.7 204.1 nm  0.085 s
Step   195: OL 1159.9  294.4  OA  701.4 203.6 CL  701.4 203.6 nm  0.081 s
Step   207: OL 1167.5  302.0  OA  702.4 205.2 CL  702.4 205.2 nm  0.082 s
Step   219: OL 1173.6  309.7  OA  704.8 206.3 CL  704.8 206.3 nm  0.091 s
Step   231: OL 1177.7  317.6  OA  709.2 209.4 CL  709.2 209.4 nm  0.081 s
Step   243: OL 1180.0  325.7  OA  711.7 214.0 CL  711.7 214.0 nm  0.081 s
Step   255: OL 1179.3  334.3  OA  715.0 219.4 CL  715.0 219.4 nm  0.086 s
Step   255 updated high order loop gain: 0.424
Step   267: OL 1175.3  342.9  OA  715.6 226.3 CL  715.6 226.3 nm  0.082 s
Step   279: OL 1168.2  351.6  OA  714.9 234.0 CL  714.9 234.0 nm  0.086 s
Step   291: OL 1159.0  361.1  OA  713.9 242.6 CL  713.9 242.6 nm  0.137 s
Step   303: OL 1148.5  371.6  OA  713.6 251.6 CL  713.6 251.6 nm  0.084 s
Step   315: OL 1136.1  382.7  OA  713.7 261.4 CL  713.7 261.4 nm  0.081 s
Step   327: OL 1122.0  394.6  OA  710.9 272.0 CL  710.9 272.0 nm  0.096 s
Step   340: OL 1106.1  409.3  OA  712.6 285.7 CL  712.6 285.7 nm  0.081 s
Step   352: OL 1091.0  424.3  OA  711.2 298.4 CL  711.2 298.4 nm  0.080 s
Step   364: OL 1076.1  440.7  OA  713.6 312.6 CL  713.6 312.6 nm  0.082 s
Step   376: OL 1061.7  457.8  OA  717.6 327.6 CL  717.6 327.6 nm  0.080 s
Step   388: OL 1047.7  475.2  OA  719.7 342.1 CL  719.7 342.1 nm  0.092 s
Step   399: OL 1034.7  491.0  OA  721.2 356.8 CL  721.2 356.8 nm  0.086 s
Step   411: OL 1020.2  508.0  OA  726.5 371.5 CL  726.5 371.5 nm  0.080 s
Step   423: OL 1005.1  524.1  OA  729.0 386.9 CL  729.0 386.9 nm  0.090 s
Step   435: OL  990.3  540.1  OA  731.0 401.7 CL  731.0 401.7 nm  0.080 s
Step   447: OL  976.0  555.6  OA  730.4 416.1 CL  730.4 416.1 nm  0.083 s
Step   459: OL  963.7  571.3  OA  732.0 430.0 CL  732.0 430.0 nm  0.096 s
Step   471: OL  954.1  586.9  OA  736.2 444.6 CL  736.2 444.6 nm  0.084 s
Step   482: OL  948.4  600.9  OA  741.5 457.1 CL  741.5 457.1 nm  0.081 s
Step   494: OL  945.5  615.5  OA  751.0 470.8 CL  751.0 470.8 nm  0.093 s
Step   506: OL  944.8  629.2  OA  761.8 484.3 CL  761.8 484.3 nm  0.083 s
Step   511 updated high order loop gain: 0.426
Step   518: OL  945.8  641.5  OA  772.6 495.4 CL  772.6 495.4 nm  0.081 s
Step   530: OL  948.5  651.7  OA  782.5 504.4 CL  782.5 504.4 nm  0.092 s
Step   542: OL  953.1  659.5  OA  790.8 509.4 CL  790.8 509.4 nm  0.082 s
Step   554: OL  959.7  665.1  OA  800.1 514.1 CL  800.1 514.1 nm  0.082 s
Step   566: OL  968.2  668.7  OA  808.1 515.6 CL  808.1 515.6 nm  0.094 s
Step   578: OL  978.1  670.6  OA  813.2 514.2 CL  813.2 514.2 nm  0.085 s
Step   590: OL  989.6  670.8  OA  818.0 512.4 CL  818.0 512.4 nm  0.081 s
Step   602: OL 1002.2  668.7  OA  822.9 509.1 CL  822.9 509.1 nm  0.093 s
Step   614: OL 1015.4  664.2  OA  824.6 502.0 CL  824.6 502.0 nm  0.083 s
Step   626: OL 1028.7  657.7  OA  823.1 493.2 CL  823.1 493.2 nm  0.083 s
Step   638: OL 1041.5  649.0  OA  818.9 483.3 CL  818.9 483.3 nm  0.085 s
Step   650: OL 1053.3  638.9  OA  810.9 471.0 CL  810.9 471.0 nm  0.085 s
Step   662: OL 1063.9  627.5  OA  801.5 459.2 CL  801.5 459.2 nm  0.083 s
Step   674: OL 1073.6  615.1  OA  790.6 445.3 CL  790.6 445.3 nm  0.082 s
Step   686: OL 1082.9  602.6  OA  780.0 430.0 CL  780.0 430.0 nm  0.081 s
Step   698: OL 1090.9  589.5  OA  769.4 413.9 CL  769.4 413.9 nm  0.081 s
Step   710: OL 1097.0  575.4  OA  759.7 398.4 CL  759.7 398.4 nm  0.081 s
Step   722: OL 1100.7  560.6  OA  747.7 379.0 CL  747.7 379.0 nm  0.079 s
Step   734: OL 1101.8  545.8  OA  736.6 361.8 CL  736.6 361.8 nm  0.092 s
Step   746: OL 1100.3  531.0  OA  724.7 342.8 CL  724.7 342.8 nm  0.082 s
Step   758: OL 1096.5  516.7  OA  712.4 326.2 CL  712.4 326.2 nm  0.081 s
Step   767 updated high order loop gain: 0.427
Step   770: OL 1090.3  502.8  OA  699.8 311.0 CL  699.8 311.0 nm  0.091 s
Step   782: OL 1081.6  489.3  OA  686.7 296.1 CL  686.7 296.1 nm  0.086 s
Step   794: OL 1070.1  475.9  OA  672.6 280.6 CL  672.6 280.6 nm  0.082 s
Step   806: OL 1056.7  462.5  OA  661.7 266.1 CL  661.7 266.1 nm  0.099 s
Step   818: OL 1041.4  449.1  OA  650.3 251.2 CL  650.3 251.2 nm  0.082 s
Step   829: OL 1025.6  437.0  OA  640.4 237.6 CL  640.4 237.6 nm  0.083 s
Step   841: OL 1007.1  424.3  OA  630.9 221.6 CL  630.9 221.6 nm  0.084 s
Step   853: OL  988.2  412.3  OA  623.6 206.3 CL  623.6 206.3 nm  0.083 s
Step   865: OL  969.7  401.3  OA  619.0 193.7 CL  619.0 193.7 nm  0.081 s
Step   877: OL  952.3  391.4  OA  615.0 182.2 CL  615.0 182.2 nm  0.084 s
Step   889: OL  936.0  382.8  OA  613.5 172.8 CL  613.5 172.8 nm  0.079 s
Step   901: OL  919.2  375.0  OA  611.6 165.2 CL  611.6 165.2 nm  0.081 s
Step   913: OL  902.0  368.5  OA  606.8 160.7 CL  606.8 160.7 nm  0.083 s
Step   925: OL  884.9  362.7  OA  600.8 156.7 CL  600.8 156.7 nm  0.086 s
Step   937: OL  868.4  356.9  OA  595.1 154.9 CL  595.1 154.9 nm  0.082 s
Step   948: OL  853.8  351.7  OA  588.5 152.7 CL  588.5 152.7 nm  0.089 s
Step   960: OL  838.9  345.5  OA  583.6 151.8 CL  583.6 151.8 nm  0.081 s
Step   973: OL  825.1  338.1  OA  578.7 149.4 CL  578.7 149.4 nm  0.080 s
Step   985: OL  814.0  330.6  OA  576.5 148.1 CL  576.5 148.1 nm  0.096 s
Step   997: OL  803.8  322.3  OA  575.3 145.3 CL  575.3 145.3 nm  0.083 s
Step  1009: OL  794.2  313.3  OA  574.2 142.0 CL  574.2 142.0 nm  0.082 s
Step  1021: OL  785.6  304.1  OA  570.6 138.2 CL  570.6 138.2 nm  0.094 s
Step  1023 updated high order loop gain: 0.427
Step  1033: OL  777.8  294.5  OA  567.2 134.9 CL  567.2 134.9 nm  0.082 s
Step  1045: OL  770.7  284.3  OA  565.7 130.6 CL  565.7 130.6 nm  0.081 s
Step  1057: OL  763.2  273.3  OA  561.5 125.7 CL  561.5 125.7 nm  0.082 s
Step  1067: OL  757.1  263.1  OA  558.9 121.1 CL  558.9 121.1 nm  0.086 s
Step  1079: OL  751.2  249.7  OA  556.9 112.7 CL  556.9 112.7 nm  0.094 s
Step  1091: OL  746.9  235.6  OA  555.8 102.9 CL  555.8 102.9 nm  0.082 s
Step  1103: OL  743.9  222.4  OA  555.4  92.7 CL  555.4  92.7 nm  0.086 s
Step  1115: OL  741.9  210.2  OA  557.4  83.5 CL  557.4  83.5 nm  0.096 s
Step  1127: OL  740.6  199.5  OA  557.7  76.0 CL  557.7  76.0 nm  0.080 s
Step  1139: OL  739.7  190.4  OA  561.5  71.0 CL  561.5  71.0 nm  0.081 s
Step  1151: OL  739.1  182.8  OA  563.0  66.1 CL  563.0  66.1 nm  0.089 s
Step  1163: OL  738.4  176.9  OA  566.8  64.6 CL  566.8  64.6 nm  0.081 s
Step  1175: OL  738.0  172.7  OA  570.7  63.7 CL  570.7  63.7 nm  0.082 s
Step  1187: OL  739.0  169.8  OA  575.7  63.6 CL  575.7  63.6 nm  0.083 s
Step  1199: OL  740.9  167.2  OA  584.1  62.8 CL  584.1  62.8 nm  0.091 s
Step  1211: OL  743.1  165.1  OA  592.9  63.5 CL  592.9  63.5 nm  0.081 s
Step  1223: OL  745.7  163.7  OA  600.5  64.4 CL  600.5  64.4 nm  0.079 s
Step  1235: OL  747.9  163.7  OA  608.7  65.6 CL  608.7  65.6 nm  0.091 s
Step  1248: OL  750.0  165.6  OA  615.7  71.0 CL  615.7  71.0 nm  0.080 s
Step  1260: OL  752.7  169.3  OA  621.2  75.1 CL  621.2  75.1 nm  0.082 s
Step  1272: OL  755.9  174.7  OA  627.6  80.1 CL  627.6  80.1 nm  0.086 s
Step  1279 updated high order loop gain: 0.428
Step  1284: OL  760.1  181.4  OA  632.4  86.3 CL  632.4  86.3 nm  0.088 s
Step  1296: OL  765.0  188.9  OA  636.1  90.0 CL  636.1  90.0 nm  0.092 s
Step  1308: OL  769.5  197.4  OA  638.0  94.1 CL  638.0  94.1 nm  0.086 s
Step  1320: OL  773.5  206.8  OA  636.7  98.4 CL  636.7  98.4 nm  0.082 s
Step  1332: OL  777.6  217.0  OA  636.7 102.1 CL  636.7 102.1 nm  0.092 s
Step  1344: OL  782.7  227.9  OA  633.4 106.2 CL  633.4 106.2 nm  0.082 s
Step  1356: OL  789.0  238.8  OA  633.4 107.9 CL  633.4 107.9 nm  0.081 s
Step  1368: OL  796.2  248.4  OA  635.8 108.7 CL  635.8 108.7 nm  0.086 s
Step  1380: OL  803.7  256.4  OA  637.2 108.1 CL  637.2 108.1 nm  0.082 s
Step  1393: OL  812.7  263.4  OA  642.7 106.2 CL  642.7 106.2 nm  0.081 s
Step  1405: OL  822.0  268.3  OA  648.0 103.4 CL  648.0 103.4 nm  0.094 s
Step  1417: OL  831.9  271.9  OA  656.1 101.8 CL  656.1 101.8 nm  0.082 s
Step  1429: OL  842.0  274.8  OA  661.9  99.1 CL  661.9  99.1 nm  0.087 s
Step  1441: OL  851.5  277.3  OA  666.1  95.7 CL  666.1  95.7 nm  0.082 s
Step  1453: OL  860.5  279.1  OA  669.9  93.2 CL  669.9  93.2 nm  0.082 s
Step  1465: OL  868.3  279.7  OA  669.9  90.4 CL  669.9  90.4 nm  0.080 s
Step  1477: OL  873.7  279.0  OA  670.6  88.6 CL  670.6  88.6 nm  0.082 s
Step  1489: OL  876.2  276.7  OA  668.7  88.5 CL  668.7  88.5 nm  0.083 s
Step  1501: OL  876.1  272.9  OA  664.2  88.5 CL  664.2  88.5 nm  0.084 s
Step  1513: OL  873.9  267.8  OA  655.4  90.1 CL  655.4  90.1 nm  0.085 s
Step  1524: OL  870.7  262.5  OA  651.3  91.4 CL  651.3  91.4 nm  0.085 s
Step  1535 updated high order loop gain: 0.428
Step  1536: OL  865.6  255.5  OA  644.5  91.8 CL  644.5  91.8 nm  0.116 s
Step  1548: OL  859.9  247.8  OA  640.4  91.0 CL  640.4  91.0 nm  0.083 s
Step  1560: OL  854.3  239.9  OA  638.0  89.5 CL  638.0  89.5 nm  0.081 s
Step  1572: OL  848.8  232.6  OA  635.1  90.3 CL  635.1  90.3 nm  0.086 s
Step  1584: OL  843.0  226.3  OA  632.8  92.9 CL  632.8  92.9 nm  0.083 s
Step  1596: OL  837.0  221.2  OA  632.2  95.9 CL  632.2  95.9 nm  0.082 s
Step 1599: Output PSF
Step  1599: OL  835.4  219.9  OA  632.4  97.9 CL  632.4  97.9 nm  1.437 s
Mean: 671.37 275.61 612.19  nm.

*** Simulation Finished at 2025/02/17 15:25:42 in nid001972. ***

[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
/global/cfs/cdirs/ulens/vismcao/maos -o studies/reduced_ngs/9_lgs/8mag_lgs/4500count -c master_files/reduced_ngs/9_lgs/8mag_lgs/kola_4500act.conf -O 
Output folder is 'studies/reduced_ngs/9_lgs/8mag_lgs/4500count'.
SRC: /global/homes/b/bpeck/code/maos v2.9 4c88b7c2 2024-11-13 16:45:33 -0800
BUILT: /global/homes/b/bpeck/code/maos/optim by GCC (v12) on 2024/11/18 09:40:03 CPU(F64,+O3) with CUDA(v122,F32)
Launched at 2025/02/17 15:25:43 in nid001972 with PID 1698730.
The web based job monitor can be accessed at http://localhost:10300
Main config file is /global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_4500act.conf
[00;00m[0;36mWarning(path.c:48): Path not found: path=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; abspath=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; Ignored.
[00;00m[0;36mWarning(path.c:48): Path not found: path=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; abspath=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; Ignored.
[00;00m[0;36mWarning(readcfg.c:399): sim.apfsm has been renamed to powfs.apfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.epfsm has been renamed to powfs.epfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.alfsm has been renamed to powfs.alfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.commonfsm has been renamed to powfs.commonfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.idealfsm has been renamed to powfs.idealfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.zetafsm has been renamed to powfs.zetafsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.f0fsm has been renamed to powfs.f0fsm.
[00;00m[0;36mWarning(readcfg.c:399): tsurf has been renamed to ncpa.tsurf.
loaded 132 (132 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_sim.conf'
loaded  19 ( 19 new) records from '/global/cfs/cdirs/ulens/vismcao/./dm_none.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_ASM.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_DM2.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_DM3.conf'
loaded   0 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_dm_multiple.conf'
loaded   7 (  5 new) records from '/global/cfs/cdirs/ulens/vismcao/./atm_mk13n50p_ground_detail.conf'
loaded  76 ( 69 new) records from '/global/homes/b/bpeck/code/maos/config/maos/powfs_common.conf'
loaded  44 ( 38 new) records from '/global/cfs/cdirs/ulens/vismcao/./powfs_none.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_lgs.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_ttf_strap.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_twfs_lbwfs.conf'
loaded   0 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_wfs_lgs_strap_lbwfs.conf'
loaded  71 ( 71 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_recon.conf'
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_smooth has been renamed to powfs0_llt.na_smooth.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_interp has been renamed to powfs0_llt.na_interp.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_thres has been renamed to powfs0_llt.na_thres.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_maxit has been renamed to powfs0_llt.na_fit_maxit.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_svdthres has been renamed to powfs0_llt.na_fit_svdthres.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_dh has been renamed to powfs0_llt.na_fit_dh.
[00;00m[0;36mWarning(readcfg.c:399): dbg.ncpa_preload has been renamed to ncpa.preload.
[00;00m[0;36mWarning(readcfg.c:399): dbg.ncpa_rmsci has been renamed to ncpa.rmsci.
[00;00m[0;36mWarning(readcfg.c:399): dbg.draw_opdmax has been renamed to plot.opdmax.
[00;00m[0;36mWarning(readcfg.c:399): dbg.draw_gmax has been renamed to plot.gmax.
loaded  95 ( 93 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_dbg.conf'
loaded   4 (  4 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_fit_mcao.conf'
[00;00m[0;36mWarning(readcfg.c:399): surf has been renamed to ncpa.surf.
loaded  39 (  7 new) records from '/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_4500act.conf'
loaded   0 (  0 new) records from 'command line'
loaded  24 ( 18 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_llt_CL.conf'
Adjust LGS range by telescope altitude 4145m.
Zenith angle is 30 degree.
    Scaling turbulence height and LGS hs by sec(za).
    Scaling r0 by cos(za)^(3/5).
    Scaling wind speed and LGS signal level by cos(za).
powfs0: Adjusting dx from 0.0078125 to 0.00805556. 
powfs0.llt.fsm: f0=0 Hz, LPF ep=0
powfs0.epfsm is set to 0.517618 (auto)
powfs2: Adjusting dx from 0.03125 to 0.0312778. 
powfs2 is TWFS for powfs0
sim.ephi is set to 0.427717 (auto)
sim.eplo is set to 0.427717 (auto)
[00;00m[0;36mWarning(parms.c:2296): Layer 1 at 17.3205m is very close to layer 0 at 0m (OK).
[00;00m[0;36mWarning(parms.c:2296): Layer 2 at 34.641m is very close to layer 1 at 17.3205m (OK).
[00;00m[0;36mWarning(parms.c:2296): Layer 3 at 51.9615m is very close to layer 2 at 34.641m (OK).
dm 0: stroke=30 um is provided in micron.
dm 0: assume ia stroke=2 um is provided in micron.
dm 1: stroke=7 um is provided in micron.
dm 1: assume ia stroke=2 um is provided in micron.
dm 2: stroke=7 um is provided in micron.
dm 2: assume ia stroke=2 um is provided in micron.
Focus blending is not implemented yet for integrated tomography
parms->sim.mffocus is reset to 0
There are 1 valid simulation seeds:  1
Output PSF for 1 directions
Used 449 of 456 supplied keys
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_flate" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_flatv" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_psx" is not recognized, value is [0 0 0 0]
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_psy" is not recognized, value is [0 0 0 0]
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_pupelong" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_raw" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_side" is not recognized, value is 4
[00;00mAperture[00;00m is 11 m with sampling 1/128 m
[00;00mTurbulence at 30 degree zenith angle:[00;00m r0=0.128424m, L0=30m, 14 layers.
    Greenwood freq is 25.1Hz, anisoplanatic angle is 1.58 as
    Sampled 8192x8192 at 1/128m. wind dir is randomized.
    layer 0: ht=      0 m, wt= 0.302, ws=  4.8 m/s
    layer 1: ht=     17 m, wt= 0.154, ws=  5.0 m/s
    layer 2: ht=     35 m, wt= 0.041, ws=  5.4 m/s
    layer 3: ht=     52 m, wt= 0.002, ws=  6.6 m/s
    layer 4: ht=    139 m, wt= 0.021, ws=  6.1 m/s
    layer 5: ht=    231 m, wt= 0.010, ws=  6.1 m/s
    layer 6: ht=    323 m, wt= 0.008, ws=  6.1 m/s
    layer 7: ht=    416 m, wt= 0.005, ws=  6.1 m/s
    layer 8: ht=    508 m, wt= 0.001, ws=  6.1 m/s
    layer 9: ht=    932 m, wt= 0.107, ws=  5.6 m/s
    layer 10: ht=   5022 m, wt= 0.144, ws= 11.1 m/s
    layer 11: ht=   9238 m, wt= 0.093, ws= 19.1 m/s
    layer 12: ht=  13856 m, wt= 0.075, ws=  8.2 m/s
    layer 13: ht=  22518 m, wt= 0.036, ws=  4.8 m/s
[00;00mReconstruction[00;00m: r0=0.128424m L0=30m. 14 layers. use cone coordinate.
    layer 0: ht=      0 m, wt= 0.302
    layer 1: ht=     17 m, wt= 0.154
    layer 2: ht=     35 m, wt= 0.041
    layer 3: ht=     52 m, wt= 0.002
    layer 4: ht=    139 m, wt= 0.021
    layer 5: ht=    231 m, wt= 0.010
    layer 6: ht=    323 m, wt= 0.008
    layer 7: ht=    416 m, wt= 0.005
    layer 8: ht=    508 m, wt= 0.001
    layer 9: ht=    932 m, wt= 0.107
    layer 10: ht=   5022 m, wt= 0.144
    layer 11: ht=   9238 m, wt= 0.093
    layer 12: ht=  13856 m, wt= 0.075
    layer 13: ht=  22518 m, wt= 0.036
[00;00mThere are 3 powfs[00;00m
  powfs0: Order 76, LGS at 99.1 km. Sampling 1/124.138 m. Thres 30%. [00;00mT/T is removed in right hand side in tomography.[00;00m
    CCD image is 25x25 @ 500x500 mas, blur 27% (sigma), 1500Hz, wvl: [ 5.89e-07]
    Gtilt in reconstruction. Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
  powfs1: Order  2, NGS at inf km. Sampling 1/16 m. Thres 30%. 
    Ztilt in reconstruction. Geomtric optics start at 2 with ztilt [00;00m(noisy)[00;00m
  powfs2: Order 20, NGS at inf km. Sampling 1/31.9716 m. Thres 50%. 
    CCD image is 4x4 @ 1500x1500 mas, blur 0% (sigma), 0.015Hz, wvl: [ 7.2e-07]
    Gtilt in reconstruction. Geomtric optics start at 50 with gtilt Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
[00;00mThere are 13 wfs[00;00m
    wfs 0: type 0, at (  30.00,    0.00) arcsec,  99 km, siglev is 25.21 bkgrnd is 0.1
    wfs 1: type 0, at (  22.98,   19.28) arcsec,  99 km, siglev is 25.21 bkgrnd is 0.1
    wfs 2: type 0, at (   5.21,   29.54) arcsec,  99 km, siglev is 25.21 bkgrnd is 0.1
    wfs 3: type 0, at ( -15.00,   25.98) arcsec,  99 km, siglev is 25.21 bkgrnd is 0.1
    wfs 4: type 0, at ( -28.19,   10.26) arcsec,  99 km, siglev is 25.21 bkgrnd is 0.1
    wfs 5: type 0, at ( -28.19,  -10.26) arcsec,  99 km, siglev is 25.21 bkgrnd is 0.1
    wfs 6: type 0, at ( -15.00,  -25.98) arcsec,  99 km, siglev is 25.21 bkgrnd is 0.1
    wfs 7: type 0, at (   5.21,  -29.54) arcsec,  99 km, siglev is 25.21 bkgrnd is 0.1
    wfs 8: type 0, at (  22.98,  -19.28) arcsec,  99 km, siglev is 25.21 bkgrnd is 0.1
    wfs 9: type 1, at (   5.00,    8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 10: type 1, at ( -10.00,    0.00) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 11: type 1, at (   5.00,   -8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 12: type 2, at (   0.00,    0.00) arcsec, inf km, siglev is 4.1558e+06 bkgrnd is 0.001
[00;00mThere are 3 DMs[00;00m
  DM 0 at -0.1km, actuator pitch 0.145m, offset   0, with 30.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 1 at    6km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 2 at   10km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
[00;00mTomography[00;00m is using CG, with [00;00mFourer Domain[00;00m preconditioner, [00;00m12[00;00m iterations, integrated tomo.
[00;00mDM Fitting [00;00mis using CG, with [00;00mNo[00;00m preconditioner, [00;00m10[00;00m iterations
[00;00mThere are 9 fit directions[00;00m
    Fit 0: weight is 0.444, at (   0.00,    0.00) arcsec
    Fit 1: weight is 0.111, at (  15.00,    0.00) arcsec
    Fit 2: weight is 0.111, at (   0.00,   15.00) arcsec
    Fit 3: weight is 0.111, at ( -15.00,    0.00) arcsec
    Fit 4: weight is 0.111, at (   0.00,  -15.00) arcsec
    Fit 5: weight is 0.028, at (  15.00,   15.00) arcsec
    Fit 6: weight is 0.028, at ( -15.00,   15.00) arcsec
    Fit 7: weight is 0.028, at ( -15.00,  -15.00) arcsec
    Fit 8: weight is 0.028, at (  15.00,  -15.00) arcsec
[00;00mThere are 1 evaluation directions[00;00m at sampling 1/128 m.
    Evl 0: weight is 1.000, at (   0.00,    0.00) arcsec
[00;00mSimulation[00;00m start at step 0, end at step 1600, with time step 1/1500s, [00;00mclose loop[00;00m.
After setup_parms:	120.5 MiB.
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
CUDA: minimum memory requirement is 0.3GB
GPU 0 is NVIDIA A100-SXM4-40GB with arch 8.0, 38.9GB free, 39.3GB total device memory.
Using GPU 0
Use 1 GPUs for WFS Tomo Fit Evl

*** Preparation started at 2025/02/17 15:25:44 in nid001972. ***

Using OpenMP version 201511 with 128 threads
Reading aperture amplitude map from KECK.fits
[00;00m[0;36mWarning(accphi.c:477): 108139 points not covered by input screen
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
 ->maos.c:447->setup.c:148->aper.c:74->utils.c:478->accphi.c:478
iwvl 0: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 1: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 2: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 3: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 4: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 5: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 6: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 7: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 8: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
After setup_aper:	344.7 MiB.

[00;00mSetting up powfs 0 geom[00;00m

There are 18 points in each subaperture of 0.145m.
There are 3550 valid subaperture.

[00;00mSetting up powfs 1 geom[00;00m

There are 88 points in each subaperture of 5.5m.
There are 4 valid subaperture.

[00;00mSetting up powfs 2 geom[00;00m

There are 18 points in each subaperture of 0.563m.
There are 236 valid subaperture.
After setup_powfs_init:	420.4 MiB.

[00;00mSetting up reconstructor geometry.[00;00m

PLOC is 155x155, with sampling of 0.07m (square)
    DM 0: grid is 81 x 81
    DM 1: grid is 75 x 75
    DM 2: grid is 80 x 79
FLOC is 155x155, with sampling of 0.07m (not square)
Tomography grid is square:
    layer 0: xloc grid is 280 x 280, sampling is 0.072 m, 78400 points
    layer 1: xloc grid is 280 x 280, sampling is 0.072 m, 78400 points
    layer 2: xloc grid is 280 x 280, sampling is 0.072 m, 78400 points
    layer 3: xloc grid is 280 x 280, sampling is 0.072 m, 78400 points
    layer 4: xloc grid is 280 x 280, sampling is 0.072 m, 78400 points
    layer 5: xloc grid is 280 x 280, sampling is 0.072 m, 78400 points
    layer 6: xloc grid is 280 x 280, sampling is 0.072 m, 78400 points
    layer 7: xloc grid is 280 x 280, sampling is 0.072 m, 78400 points
    layer 8: xloc grid is 280 x 280, sampling is 0.072 m, 78400 points
    layer 9: xloc grid is 280 x 280, sampling is 0.072 m, 78400 points
    layer 10: xloc grid is 280 x 280, sampling is 0.069 m, 78400 points
    layer 11: xloc grid is 280 x 280, sampling is 0.066 m, 78400 points
    layer 12: xloc grid is 280 x 280, sampling is 0.062 m, 78400 points
    layer 13: xloc grid is 280 x 280, sampling is 0.056 m, 78400 points

[00;00mSetting up powfs 0 PO WFS[00;00m

OTF dimension is 36x36 (calculated)
There is no bias
Uplink FWHM (illt 0, iwvl 0) is 0.578619"
Downlink FWHM (illt 0, iwvl 0) is 1.36259"
Generating matched filter for powfs 0
sa index   location       noise equivalent angle
    1772: (  4.8,  -0.1) m, (163.81, 156.98) mas
    1765: (  3.8,  -0.1) m, (174.57, 158.80) mas
    1757: (  2.6,  -0.1) m, (189.91, 161.43) mas
    1750: (  1.6,  -0.1) m, (204.17, 163.91) mas
    1748: (  1.3,  -0.1) m, (208.37, 164.65) mas
    1277: ( -0.6,  -1.3) m, (237.66, 173.39) mas
    1743: ( -1.7,  -0.1) m, (254.66, 172.33) mas
    1735: ( -2.9,  -0.1) m, (274.69, 175.11) mas
    1728: ( -3.9,  -0.1) m, (293.99, 177.49) mas
    1720: ( -5.1,  -0.1) m, (318.58, 180.11) mas
    1718: ( -5.4,  -0.1) m, (324.67, 180.71) mas
sa index   location       noise equivalent angle
    2951: (  3.3,   2.8) m, (162.86, 161.22) mas
    2673: (  2.5,   2.0) m, (184.64, 181.92) mas
    2350: (  1.6,   1.3) m, (183.50, 177.57) mas
    2159: (  1.0,   0.9) m, (192.52, 184.25) mas
    1284: (  0.4,  -1.3) m, (203.60, 216.10) mas
    1395: ( -1.2,  -1.0) m, (227.78, 213.06) mas
    1204: ( -1.7,  -1.4) m, (237.50, 220.04) mas
     880: ( -2.6,  -2.2) m, (267.31, 245.53) mas
     602: ( -3.5,  -2.9) m, (269.96, 245.65) mas
     126: ( -3.0,  -4.3) m, (264.12, 272.24) mas
sa index   location       noise equivalent angle
    3545: (  0.7,   4.8) m, (160.57, 166.66) mas
    3497: (  0.7,   4.5) m, (157.41, 164.92) mas
    2985: (  0.4,   2.9) m, (161.23, 183.67) mas
    2658: (  0.3,   2.0) m, (165.94, 197.02) mas
    2340: (  0.1,   1.3) m, (166.21, 206.66) mas
    1685: ( -1.4,  -0.3) m, (181.09, 232.60) mas
    1214: ( -0.3,  -1.4) m, (174.94, 249.11) mas
     895: ( -0.4,  -2.2) m, (181.17, 264.79) mas
     568: ( -0.6,  -3.0) m, (180.08, 277.40) mas
      55: ( -0.9,  -4.6) m, (185.10, 309.84) mas
      16: ( -2.3,  -4.8) m, (197.44, 318.15) mas
sa index   location       noise equivalent angle
    3432: ( -2.6,   4.3) m, (157.99, 160.64) mas
    3125: ( -2.0,   3.3) m, (174.92, 185.21) mas
    2756: ( -1.4,   2.3) m, (168.89, 182.82) mas
    2333: ( -0.9,   1.3) m, (176.24, 196.98) mas
    2269: ( -0.7,   1.2) m, (177.98, 199.11) mas
    1868: (  1.3,   0.1) m, (205.15, 216.53) mas
    1221: (  0.7,  -1.4) m, (199.37, 242.49) mas
     797: (  1.3,  -2.5) m, (208.55, 261.26) mas
     690: (  1.4,  -2.8) m, (210.80, 266.45) mas
     428: (  1.9,  -3.5) m, (236.73, 309.03) mas
     120: (  2.5,  -4.5) m, (228.18, 302.26) mas
sa index   location       noise equivalent angle
    2437: ( -4.6,   1.6) m, (163.02, 157.71) mas
    2312: ( -3.9,   1.3) m, (169.68, 159.80) mas
    2250: ( -3.5,   1.2) m, (174.89, 161.33) mas
    2038: ( -1.9,   0.6) m, (196.89, 168.79) mas
    1984: ( -1.4,   0.4) m, (203.17, 170.47) mas
    1216: (  0.0,  -1.4) m, (233.71, 197.46) mas
    1569: (  1.3,  -0.6) m, (247.85, 185.03) mas
    1515: (  1.7,  -0.7) m, (256.01, 187.73) mas
    1304: (  3.3,  -1.3) m, (286.28, 195.93) mas
    1242: (  3.8,  -1.4) m, (294.77, 198.10) mas
    1595: (  5.1,  -0.6) m, (320.00, 191.75) mas
sa index   location       noise equivalent angle
    1054: ( -4.6,  -1.7) m, (163.02, 157.71) mas
    1189: ( -3.9,  -1.4) m, (169.68, 159.80) mas
    1257: ( -3.5,  -1.3) m, (174.89, 161.33) mas
    1504: ( -1.9,  -0.7) m, (196.44, 168.35) mas
    1566: ( -1.4,  -0.6) m, (203.17, 170.47) mas
    2339: (  0.0,   1.3) m, (233.71, 197.46) mas
    1987: (  1.3,   0.4) m, (247.85, 185.03) mas
    2049: (  1.7,   0.6) m, (256.80, 188.31) mas
    2297: (  3.3,   1.2) m, (286.28, 195.93) mas
    2365: (  3.8,   1.3) m, (294.77, 198.10) mas
    2013: (  5.1,   0.4) m, (320.00, 191.75) mas
sa index   location       noise equivalent angle
      85: ( -2.6,  -4.5) m, (157.99, 160.64) mas
     401: ( -2.0,  -3.5) m, (175.17, 187.15) mas
     778: ( -1.4,  -2.5) m, (168.89, 182.82) mas
    1210: ( -0.9,  -1.4) m, (176.24, 196.98) mas
    1276: ( -0.7,  -1.3) m, (177.98, 199.11) mas
    1688: (  1.3,  -0.3) m, (205.15, 216.53) mas
    2344: (  0.7,   1.3) m, (199.37, 242.49) mas
    2775: (  1.3,   2.3) m, (208.55, 261.26) mas
    2884: (  1.4,   2.6) m, (210.80, 266.45) mas
    3152: (  1.9,   3.3) m, (236.02, 306.17) mas
    3467: (  2.5,   4.3) m, (228.18, 302.26) mas
sa index   location       noise equivalent angle
       7: (  0.7,  -4.9) m, (158.23, 164.11) mas
      66: (  0.7,  -4.6) m, (157.41, 164.92) mas
     575: (  0.4,  -3.0) m, (161.23, 183.67) mas
     900: (  0.3,  -2.2) m, (168.17, 198.63) mas
    1217: (  0.1,  -1.4) m, (166.21, 206.66) mas
    1865: ( -1.4,   0.1) m, (181.09, 232.60) mas
    2337: ( -0.3,   1.3) m, (174.94, 249.11) mas
    2653: ( -0.4,   2.0) m, (179.00, 262.74) mas
    2978: ( -0.6,   2.9) m, (180.08, 277.40) mas
    3486: ( -0.9,   4.5) m, (185.10, 309.84) mas
    3515: ( -2.3,   4.6) m, (197.44, 318.15) mas
sa index   location       noise equivalent angle
     649: (  3.3,  -2.9) m, (162.86, 161.22) mas
     915: (  2.5,  -2.2) m, (183.10, 179.17) mas
    1227: (  1.6,  -1.4) m, (183.50, 177.57) mas
    1400: (  1.0,  -1.0) m, (192.52, 184.25) mas
    2277: (  0.4,   1.2) m, (203.31, 215.80) mas
    2154: ( -1.2,   0.9) m, (227.78, 213.06) mas
    2327: ( -1.7,   1.3) m, (237.50, 220.04) mas
    2638: ( -2.6,   2.0) m, (270.41, 249.42) mas
    2904: ( -3.5,   2.8) m, (269.96, 245.65) mas
    3385: ( -3.0,   4.2) m, (264.12, 272.24) mas

[00;00mSetting up powfs 2 PO WFS[00;00m

OTF dimension is 48x48 (calculated)
Generating matched filter for powfs 2
Use sanea to derive neasim
Use sanea to derive neasim

[00;00mSetting up reconstructor[00;00m

Recon NEA: cmf(212.83) cmf(214.31) cmf(212.59) cmf(213.90) cmf(213.04) cmf(213.02) cmf(213.83) cmf(212.52) cmf(214.26) geom(0.31) geom(0.31) geom(0.31) mf(0.14)  mas
Setup or update control matrix parameters.
RRtwfs svd threshold is 1e-10
Replacing HA by HA*fit->actextrap
Adding piston cr to fit matrix
Adding TT cr on upper DMs to fit matrix.
Before assembling fit matrix:	5356.1 MiB.
Building fit->FR
Building fit->FL
Adding tikhonov constraint of 1.0e-07 to FLM
The maximum eigen value is estimated to be around 2.7e-04
DM Fit number of Low rank terms: 16 in LHS
After assemble fit matrix:	7309.2 MiB.
After setup_recon:	7309.2 MiB.
GPU 0: mem used 1722 MB (wfs init)
GPU 0: mem used 2934 MB (recon init)
GPU 0: mem used 2964 MB (perf init)

*** Simulation started at 2025/02/17 15:27:55 in nid001972. ***

Running seed 1
GPU 0: mem used 2966 MB (wfs seeding)
Wind dir: 267.3 261.7 167.0 130.5 300.7  32.3 119.8 139.0 150.8 277.7 203.0 133.1  45.9 265.1 deg
Using /global/homes/b/bpeck/.aos/cache/atm/vonkarman_14_8192x8192_0.0078125_1115374592d.bin
After genatm:	7193.0 MiB.
Step     #  Open Loop  PR TT  On axis  PR TT  Field RMS PR TT     Timing 
Step     0: OL  884.6  248.3  OA  884.6 248.3 CL  884.6 248.3 nm  0.115 s
Step    13: OL  904.8  253.4  OA  149.2  84.7 CL  149.2  84.7 nm  0.075 s
Step    26: OL  925.3  257.6  OA  113.1  11.1 CL  113.1  11.1 nm  0.082 s
Step    38: OL  943.9  260.2  OA  114.2  18.5 CL  114.2  18.5 nm  0.087 s
Step    50: OL  961.6  261.2  OA  109.9  17.7 CL  109.9  17.7 nm  0.084 s
Step    62: OL  979.4  260.6  OA  107.3   3.6 CL  107.3   3.6 nm  0.093 s
Step    74: OL  997.4  259.3  OA  111.3  15.0 CL  111.3  15.0 nm  0.083 s
Step    86: OL 1015.8  258.2  OA  111.9  33.2 CL  111.9  33.2 nm  0.086 s
Step    98: OL 1034.2  257.5  OA  111.6   7.1 CL  111.6   7.1 nm  0.084 s
Step   110: OL 1052.6  257.6  OA  107.9  19.0 CL  107.9  19.0 nm  0.092 s
Step   122: OL 1070.6  258.8  OA  104.9  10.2 CL  104.9  10.2 nm  0.083 s
Step   134: OL 1087.6  261.4  OA  109.2  17.9 CL  109.2  17.9 nm  0.083 s
Step   146: OL 1103.6  265.7  OA  107.4  24.1 CL  107.4  24.1 nm  0.084 s
Step   158: OL 1117.8  271.1  OA  109.9  24.5 CL  109.9  24.5 nm  0.086 s
Step   170: OL 1130.3  277.8  OA  108.3  25.2 CL  108.3  25.2 nm  0.084 s
Step   182: OL 1140.7  285.3  OA  110.2   8.7 CL  110.2   8.7 nm  0.084 s
Step   194: OL 1148.7  293.1  OA  108.2  28.5 CL  108.2  28.5 nm  0.139 s
Step   206: OL 1154.9  300.7  OA  105.9  19.6 CL  105.9  19.6 nm  0.083 s
Step   218: OL 1159.3  308.4  OA  107.8  20.4 CL  107.8  20.4 nm  0.084 s
Step   230: OL 1161.5  316.2  OA  108.1  10.1 CL  108.1  10.1 nm  0.085 s
Step   242: OL 1161.7  324.2  OA  109.0  16.1 CL  109.0  16.1 nm  0.084 s
Step   254: OL 1159.0  332.8  OA  109.2  22.8 CL  109.2  22.8 nm  0.091 s
Step   255 updated high order loop gain: 0.348
Step   266: OL 1152.7  341.4  OA  110.0  26.7 CL  110.0  26.7 nm  0.084 s
Step   278: OL 1143.4  350.1  OA  103.2  10.4 CL  103.2  10.4 nm  0.085 s
Step   290: OL 1132.0  359.5  OA  104.7  26.9 CL  104.7  26.9 nm  0.086 s
Step   302: OL 1119.3  369.9  OA  106.8  18.3 CL  106.8  18.3 nm  0.083 s
Step   314: OL 1105.2  380.9  OA  113.0  40.1 CL  113.0  40.1 nm  0.083 s
Step   326: OL 1089.7  392.8  OA  110.8  29.7 CL  110.8  29.7 nm  0.091 s
Step   338: OL 1073.8  406.1  OA  107.8  10.6 CL  107.8  10.6 nm  0.083 s
Step   350: OL 1057.9  420.9  OA  105.6  24.5 CL  105.6  24.5 nm  0.084 s
Step   362: OL 1042.6  437.2  OA  116.0  32.0 CL  116.0  32.0 nm  0.083 s
Step   374: OL 1028.1  454.2  OA  109.5  16.7 CL  109.5  16.7 nm  0.087 s
Step   386: OL 1014.4  471.6  OA  117.1  36.7 CL  117.1  36.7 nm  0.088 s
Step   398: OL 1001.1  488.9  OA  110.2  19.6 CL  110.2  19.6 nm  0.083 s
Step   410: OL  987.7  505.9  OA  112.1  30.6 CL  112.1  30.6 nm  0.093 s
Step   422: OL  974.0  522.2  OA  110.8  20.6 CL  110.8  20.6 nm  0.084 s
Step   434: OL  960.3  538.1  OA  108.6  26.5 CL  108.6  26.5 nm  0.084 s
Step   446: OL  947.5  553.7  OA  113.7  27.4 CL  113.7  27.4 nm  0.086 s
Step   458: OL  936.7  569.4  OA  110.7  18.6 CL  110.7  18.6 nm  0.095 s
Step   470: OL  928.8  585.1  OA  112.8  36.8 CL  112.8  36.8 nm  0.084 s
Step   482: OL  924.5  600.3  OA  110.3  26.4 CL  110.3  26.4 nm  0.084 s
Step   494: OL  923.8  615.0  OA  111.6  20.8 CL  111.6  20.8 nm  0.085 s
Step   506: OL  925.1  628.7  OA  110.8  21.2 CL  110.8  21.2 nm  0.086 s
Step   511 updated high order loop gain: 0.306
Step   518: OL  928.3  641.0  OA  113.8  31.0 CL  113.8  31.0 nm  0.087 s
Step   530: OL  933.0  651.3  OA  110.6  26.7 CL  110.6  26.7 nm  0.086 s
Step   542: OL  939.5  659.1  OA  111.1  21.9 CL  111.1  21.9 nm  0.085 s
Step 546, DM 2: 1 actuators over ia limit. trials=2: success.
Step 547, DM 2: 1 actuators over ia limit. trials=2: success.
Step 548, DM 2: 1 actuators over ia limit. trials=2: success.
Step 549, DM 2: 1 actuators over ia limit. trials=2: success.
Step 550, DM 2: 1 actuators over ia limit. trials=2: success.
Step 551, DM 2: 1 actuators over ia limit. trials=2: success.
Step 552, DM 2: 1 actuators over ia limit. trials=2: success.
Step   553: OL  947.1  664.3  OA  112.4  12.5 CL  112.4  12.5 nm  0.086 s
Step 553, DM 2: 1 actuators over ia limit. trials=2: success.
Step 554, DM 2: 1 actuators over ia limit. trials=2: success.
Step 555, DM 2: 1 actuators over ia limit. trials=2: success.
Step 556, DM 2: 1 actuators over ia limit. trials=2: success.
Step 557, DM 2: 1 actuators over ia limit. trials=2: success.
Step 558, DM 2: 1 actuators over ia limit. trials=2: success.
Step 559, DM 2: 1 actuators over ia limit. trials=2: success.
Step 560, DM 2: 1 actuators over ia limit. trials=2: success.
Step 561, DM 2: 1 actuators over ia limit. trials=2: success.
Step 562, DM 2: 1 actuators over ia limit. trials=2: success.
Step 563, DM 2: 1 actuators over ia limit. trials=2: success.
Step 564, DM 2: 1 actuators over ia limit. trials=2: success.
Step   565: OL  957.2  668.0  OA  108.8  11.0 CL  108.8  11.0 nm  0.085 s
Step 565, DM 2: 1 actuators over ia limit. trials=2: success.
Step 566, DM 2: 1 actuators over ia limit. trials=2: success.
Step 567, DM 2: 1 actuators over ia limit. trials=2: success.
Step 568, DM 2: 1 actuators over ia limit. trials=2: success.
Step 569, DM 2: 1 actuators over ia limit. trials=2: success.
Step 570, DM 2: 1 actuators over ia limit. trials=2: success.
Step 571, DM 2: 1 actuators over ia limit. trials=2: success.
Step 572, DM 2: 1 actuators over ia limit. trials=2: success.
Step 573, DM 2: 1 actuators over ia limit. trials=2: success.
Step 574, DM 2: 1 actuators over ia limit. trials=2: success.
Step 575, DM 2: 1 actuators over ia limit. trials=2: success.
Step 576, DM 2: 1 actuators over ia limit. trials=2: success.
Step   577: OL  968.5  670.1  OA  110.5   8.4 CL  110.5   8.4 nm  0.086 s
Step 577, DM 2: 1 actuators over ia limit. trials=2: success.
Step 578, DM 2: 1 actuators over ia limit. trials=2: success.
Step 579, DM 2: 1 actuators over ia limit. trials=2: success.
Step 580, DM 2: 1 actuators over ia limit. trials=2: success.
Step 581, DM 2: 1 actuators over ia limit. trials=2: success.
Step   589: OL  981.3  670.5  OA  109.2  16.2 CL  109.2  16.2 nm  0.092 s
Step 598, DM 1: 1 actuators over ia limit. trials=2: success.
Step 599, DM 1: 1 actuators over ia limit. trials=2: success.
Step 600, DM 1: 1 actuators over ia limit. trials=2: success.
Step   601: OL  995.1  668.6  OA  110.8  17.2 CL  110.8  17.2 nm  0.087 s
Step 601, DM 1: 1 actuators over ia limit. trials=2: success.
Step 602, DM 1: 1 actuators over ia limit. trials=2: success.
Step 603, DM 1: 1 actuators over ia limit. trials=2: success.
Step 609, DM 1: 1 actuators over ia limit. trials=2: success.
Step 610, DM 1: 1 actuators over ia limit. trials=2: success.
Step 611, DM 1: 1 actuators over ia limit. trials=2: success.
Step   613: OL 1009.3  664.3  OA  110.3  24.4 CL  110.3  24.4 nm  0.087 s
Step 619, DM 1: 1 actuators over ia limit. trials=2: success.
Step 620, DM 1: 1 actuators over ia limit. trials=2: success.
Step 621, DM 1: 1 actuators over ia limit. trials=2: success.
Step 622, DM 1: 1 actuators over ia limit. trials=2: success.
Step   625: OL 1023.6  657.9  OA  105.5   9.3 CL  105.5   9.3 nm  0.084 s
Step   637: OL 1037.4  649.4  OA  104.7  17.1 CL  104.7  17.1 nm  0.089 s
Step   649: OL 1050.2  639.4  OA  103.7   5.7 CL  103.7   5.7 nm  0.086 s
Step   661: OL 1061.9  628.1  OA  104.5   9.7 CL  104.5   9.7 nm  0.090 s
Step   673: OL 1072.7  615.7  OA  108.0   8.4 CL  108.0   8.4 nm  0.084 s
Step   685: OL 1083.1  603.2  OA  107.3  19.5 CL  107.3  19.5 nm  0.084 s
Step   697: OL 1092.3  590.2  OA  105.7  11.9 CL  105.7  11.9 nm  0.082 s
Step   709: OL 1099.7  576.1  OA  108.1   7.0 CL  108.1   7.0 nm  0.085 s
Step   721: OL 1104.7  561.3  OA  107.2  13.8 CL  107.2  13.8 nm  0.143 s
Step   733: OL 1107.1  546.5  OA  105.8  10.6 CL  105.8  10.6 nm  0.083 s
Step   745: OL 1106.8  531.7  OA  105.6   6.2 CL  105.6   6.2 nm  0.086 s
Step   757: OL 1104.1  517.3  OA  101.1   5.7 CL  101.1   5.7 nm  0.086 s
Step   767 updated high order loop gain: 0.286
Step   769: OL 1098.8  503.4  OA  102.4   2.9 CL  102.4   2.9 nm  0.084 s
Step   781: OL 1091.1  489.8  OA  103.4   4.5 CL  103.4   4.5 nm  0.092 s
Step   793: OL 1080.5  476.4  OA  107.7  13.5 CL  107.7  13.5 nm  0.083 s
Step   805: OL 1067.7  463.0  OA  109.7  21.8 CL  109.7  21.8 nm  0.085 s
Step   817: OL 1052.9  449.6  OA  107.9  20.7 CL  107.9  20.7 nm  0.086 s
Step   829: OL 1036.0  436.4  OA  108.9  18.5 CL  108.9  18.5 nm  0.084 s
Step   841: OL 1017.7  423.7  OA  108.8  14.0 CL  108.8  14.0 nm  0.082 s
Step   853: OL  998.8  411.7  OA  106.4   8.3 CL  106.4   8.3 nm  0.084 s
Step   865: OL  979.8  400.6  OA  107.8  15.4 CL  107.8  15.4 nm  0.083 s
Step   877: OL  961.4  390.8  OA  109.3  10.5 CL  109.3  10.5 nm  0.093 s
Step   888: OL  945.2  382.8  OA  108.0   8.9 CL  108.0   8.9 nm  0.085 s
Step   900: OL  926.8  375.0  OA  105.2  10.5 CL  105.2  10.5 nm  0.085 s
Step   912: OL  907.6  368.3  OA  110.2  12.4 CL  110.2  12.4 nm  0.094 s
Step   924: OL  888.2  362.5  OA  108.9   3.2 CL  108.9   3.2 nm  0.087 s
Step   936: OL  869.2  356.8  OA  105.4   9.8 CL  105.4   9.8 nm  0.085 s
Step   948: OL  850.9  351.1  OA  108.6   6.9 CL  108.6   6.9 nm  0.085 s
Step   960: OL  833.7  345.0  OA  106.2  10.4 CL  106.2  10.4 nm  0.083 s
Step   972: OL  818.6  338.2  OA  105.9  14.4 CL  105.9  14.4 nm  0.089 s
Step   984: OL  805.3  330.8  OA  105.5  11.9 CL  105.5  11.9 nm  0.084 s
Step   996: OL  793.3  322.5  OA  109.3   3.9 CL  109.3   3.9 nm  0.085 s
Step  1008: OL  782.1  313.6  OA  112.0   2.8 CL  112.0   2.8 nm  0.090 s
Step  1020: OL  772.3  304.4  OA  110.5  17.8 CL  110.5  17.8 nm  0.082 s
Step  1023 updated high order loop gain: 0.275
Step  1032: OL  763.7  295.0  OA  114.9  31.5 CL  114.9  31.5 nm  0.084 s
Step  1044: OL  756.4  284.8  OA  109.5  22.0 CL  109.5  22.0 nm  0.083 s
Step  1056: OL  749.0  273.9  OA  110.9  30.3 CL  110.9  30.3 nm  0.081 s
Step  1068: OL  742.2  261.7  OA  106.8  17.6 CL  106.8  17.6 nm  0.104 s
Step  1080: OL  737.2  248.2  OA  111.6  26.4 CL  111.6  26.4 nm  0.085 s
Step  1092: OL  734.1  234.2  OA  113.4  19.6 CL  113.4  19.6 nm  0.101 s
Step  1104: OL  732.3  221.1  OA  106.3  19.6 CL  106.3  19.6 nm  0.084 s
Step  1116: OL  731.6  209.0  OA  110.7  31.7 CL  110.7  31.7 nm  0.084 s
Step  1128: OL  731.6  198.4  OA  103.8  20.3 CL  103.8  20.3 nm  0.091 s
Step  1140: OL  732.0  189.5  OA  102.8  19.2 CL  102.8  19.2 nm  0.085 s
Step  1152: OL  732.6  182.0  OA  106.3  20.4 CL  106.3  20.4 nm  0.084 s
Step  1164: OL  732.9  176.3  OA  106.9  25.7 CL  106.9  25.7 nm  0.085 s
Step  1176: OL  733.6  172.3  OA  101.6  18.4 CL  101.6  18.4 nm  0.088 s
Step  1184: OL  734.9  170.3  OA  103.2  22.1 CL  103.2  22.1 nm  0.424 s
Step  1189: OL  735.9  169.2  OA  103.1  14.3 CL  103.1  14.3 nm  0.084 s
Step  1201: OL  738.8  166.7  OA  101.7  21.5 CL  101.7  21.5 nm  0.084 s
Step  1213: OL  741.8  164.6  OA  104.8  20.2 CL  104.8  20.2 nm  0.084 s
Step  1225: OL  745.1  163.5  OA  106.6  12.2 CL  106.6  12.2 nm  0.092 s
Step  1237: OL  747.7  163.8  OA  105.2  16.7 CL  105.2  16.7 nm  0.084 s
Step  1249: OL  750.0  165.8  OA  102.1  16.8 CL  102.1  16.8 nm  0.084 s
Step  1261: OL  753.0  169.7  OA  103.2   3.4 CL  103.2   3.4 nm  0.093 s
Step  1273: OL  756.5  175.2  OA  100.8  14.0 CL  100.8  14.0 nm  0.086 s
Step  1279 updated high order loop gain: 0.265
Step  1285: OL  761.0  181.9  OA  105.2  15.8 CL  105.2  15.8 nm  0.085 s
Step  1297: OL  766.2  189.6  OA  102.9   9.3 CL  102.9   9.3 nm  0.085 s
Step  1309: OL  771.3  198.1  OA  107.4  19.1 CL  107.4  19.1 nm  0.083 s
Step  1321: OL  776.0  207.5  OA  103.6  15.0 CL  103.6  15.0 nm  0.094 s
Step  1333: OL  781.3  217.8  OA  103.5  15.1 CL  103.5  15.1 nm  0.084 s
Step  1345: OL  787.6  228.7  OA  101.4  16.3 CL  101.4  16.3 nm  0.085 s
Step  1357: OL  795.3  239.5  OA  100.0  10.9 CL  100.0  10.9 nm  0.082 s
Step  1369: OL  803.9  249.0  OA  104.4  18.0 CL  104.4  18.0 nm  0.085 s
Step  1381: OL  813.0  256.8  OA  100.1  12.2 CL  100.1  12.2 nm  0.093 s
Step  1393: OL  823.2  263.2  OA  100.7   6.0 CL  100.7   6.0 nm  0.088 s
Step  1405: OL  834.3  268.1  OA  102.4  10.6 CL  102.4  10.6 nm  0.085 s
Step  1417: OL  846.0  271.7  OA  100.2  13.2 CL  100.2  13.2 nm  0.085 s
Step  1429: OL  857.9  274.6  OA  100.3  13.1 CL  100.3  13.1 nm  0.087 s
Step  1441: OL  869.2  277.0  OA   98.3   4.3 CL   98.3   4.3 nm  0.084 s
Step  1453: OL  879.7  278.8  OA  101.4  12.8 CL  101.4  12.8 nm  0.086 s
Step  1465: OL  889.0  279.4  OA  104.9  12.6 CL  104.9  12.6 nm  0.087 s
Step  1477: OL  895.8  278.6  OA  101.1   3.9 CL  101.1   3.9 nm  0.092 s
Step  1489: OL  899.7  276.3  OA   97.1   3.4 CL   97.1   3.4 nm  0.084 s
Step  1497: OL  900.6  273.9  OA  101.3   6.1 CL  101.3   6.1 nm  0.085 s
Step  1509: OL  900.0  269.1  OA  104.5  15.6 CL  104.5  15.6 nm  0.093 s
Step  1521: OL  897.4  263.5  OA  101.6   2.2 CL  101.6   2.2 nm  0.085 s
Step  1533: OL  892.8  256.8  OA  100.3  16.8 CL  100.3  16.8 nm  0.086 s
Step  1535 updated high order loop gain: 0.267
Step  1545: OL  886.6  249.2  OA  102.2   8.4 CL  102.2   8.4 nm  0.085 s
Step  1557: OL  879.7  241.2  OA  103.4  11.9 CL  103.4  11.9 nm  0.084 s
Step  1569: OL  873.0  233.7  OA  104.1  10.8 CL  104.1  10.8 nm  0.093 s
Step  1581: OL  865.5  227.1  OA  104.2  25.1 CL  104.2  25.1 nm  0.084 s
Step  1593: OL  857.5  221.8  OA  106.6  18.7 CL  106.6  18.7 nm  0.085 s
Step 1599: Output PSF
Step  1599: OL  853.3  219.3  OA  105.0  10.4 CL  105.0  10.4 nm  2.594 s
Mean: 106.64 17.91 105.12  nm.

*** Simulation Finished at 2025/02/17 15:30:25 in nid001972. ***

[00;00m>>>>>>>>>>>>>>>>[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
/global/cfs/cdirs/ulens/vismcao/maos -o studies/reduced_ngs/9_lgs/8mag_lgs/4750count -c master_files/reduced_ngs/9_lgs/8mag_lgs/kola_4750act.conf -O 
Output folder is 'studies/reduced_ngs/9_lgs/8mag_lgs/4750count'.
SRC: /global/homes/b/bpeck/code/maos v2.9 4c88b7c2 2024-11-13 16:45:33 -0800
BUILT: /global/homes/b/bpeck/code/maos/optim by GCC (v12) on 2024/11/18 09:40:03 CPU(F64,+O3) with CUDA(v122,F32)
Launched at 2025/02/17 15:30:26 in nid001972 with PID 1700244.
The web based job monitor can be accessed at http://localhost:10300
Main config file is /global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_4750act.conf
[00;00m[0;36mWarning(path.c:48): Path not found: path=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; abspath=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; Ignored.
[00;00m[0;36mWarning(path.c:48): Path not found: path=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; abspath=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; Ignored.
[00;00m[0;36mWarning(readcfg.c:399): sim.apfsm has been renamed to powfs.apfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.epfsm has been renamed to powfs.epfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.alfsm has been renamed to powfs.alfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.commonfsm has been renamed to powfs.commonfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.idealfsm has been renamed to powfs.idealfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.zetafsm has been renamed to powfs.zetafsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.f0fsm has been renamed to powfs.f0fsm.
[00;00m[0;36mWarning(readcfg.c:399): tsurf has been renamed to ncpa.tsurf.
loaded 132 (132 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_sim.conf'
loaded  19 ( 19 new) records from '/global/cfs/cdirs/ulens/vismcao/./dm_none.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_ASM.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_DM2.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_DM3.conf'
loaded   0 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_dm_multiple.conf'
loaded   7 (  5 new) records from '/global/cfs/cdirs/ulens/vismcao/./atm_mk13n50p_ground_detail.conf'
loaded  76 ( 69 new) records from '/global/homes/b/bpeck/code/maos/config/maos/powfs_common.conf'
loaded  44 ( 38 new) records from '/global/cfs/cdirs/ulens/vismcao/./powfs_none.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_lgs.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_ttf_strap.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_twfs_lbwfs.conf'
loaded   0 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_wfs_lgs_strap_lbwfs.conf'
loaded  71 ( 71 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_recon.conf'
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_smooth has been renamed to powfs0_llt.na_smooth.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_interp has been renamed to powfs0_llt.na_interp.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_thres has been renamed to powfs0_llt.na_thres.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_maxit has been renamed to powfs0_llt.na_fit_maxit.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_svdthres has been renamed to powfs0_llt.na_fit_svdthres.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_dh has been renamed to powfs0_llt.na_fit_dh.
[00;00m[0;36mWarning(readcfg.c:399): dbg.ncpa_preload has been renamed to ncpa.preload.
[00;00m[0;36mWarning(readcfg.c:399): dbg.ncpa_rmsci has been renamed to ncpa.rmsci.
[00;00m[0;36mWarning(readcfg.c:399): dbg.draw_opdmax has been renamed to plot.opdmax.
[00;00m[0;36mWarning(readcfg.c:399): dbg.draw_gmax has been renamed to plot.gmax.
loaded  95 ( 93 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_dbg.conf'
loaded   4 (  4 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_fit_mcao.conf'
[00;00m[0;36mWarning(readcfg.c:399): surf has been renamed to ncpa.surf.
loaded  39 (  7 new) records from '/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_4750act.conf'
loaded   0 (  0 new) records from 'command line'
loaded  24 ( 18 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_llt_CL.conf'
Adjust LGS range by telescope altitude 4145m.
Zenith angle is 30 degree.
    Scaling turbulence height and LGS hs by sec(za).
    Scaling r0 by cos(za)^(3/5).
    Scaling wind speed and LGS signal level by cos(za).
powfs0: Adjusting dx from 0.0078125 to 0.00783333. 
powfs0.llt.fsm: f0=0 Hz, LPF ep=0
powfs0.epfsm is set to 0.517618 (auto)
powfs2: Adjusting dx from 0.03125 to 0.0312778. 
powfs2 is TWFS for powfs0
sim.ephi is set to 0.427717 (auto)
sim.eplo is set to 0.427717 (auto)
[00;00m[0;36mWarning(parms.c:2296): Layer 1 at 17.3205m is very close to layer 0 at 0m (OK).
[00;00m[0;36mWarning(parms.c:2296): Layer 2 at 34.641m is very close to layer 1 at 17.3205m (OK).
[00;00m[0;36mWarning(parms.c:2296): Layer 3 at 51.9615m is very close to layer 2 at 34.641m (OK).
dm 0: stroke=30 um is provided in micron.
dm 0: assume ia stroke=2 um is provided in micron.
dm 1: stroke=7 um is provided in micron.
dm 1: assume ia stroke=2 um is provided in micron.
dm 2: stroke=7 um is provided in micron.
dm 2: assume ia stroke=2 um is provided in micron.
Focus blending is not implemented yet for integrated tomography
parms->sim.mffocus is reset to 0
There are 1 valid simulation seeds:  1
Output PSF for 1 directions
Used 449 of 456 supplied keys
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_flate" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_flatv" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_psx" is not recognized, value is [0 0 0 0]
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_psy" is not recognized, value is [0 0 0 0]
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_pupelong" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_raw" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_side" is not recognized, value is 4
[00;00mAperture[00;00m is 11 m with sampling 1/128 m
[00;00mTurbulence at 30 degree zenith angle:[00;00m r0=0.128424m, L0=30m, 14 layers.
    Greenwood freq is 25.1Hz, anisoplanatic angle is 1.58 as
    Sampled 8192x8192 at 1/128m. wind dir is randomized.
    layer 0: ht=      0 m, wt= 0.302, ws=  4.8 m/s
    layer 1: ht=     17 m, wt= 0.154, ws=  5.0 m/s
    layer 2: ht=     35 m, wt= 0.041, ws=  5.4 m/s
    layer 3: ht=     52 m, wt= 0.002, ws=  6.6 m/s
    layer 4: ht=    139 m, wt= 0.021, ws=  6.1 m/s
    layer 5: ht=    231 m, wt= 0.010, ws=  6.1 m/s
    layer 6: ht=    323 m, wt= 0.008, ws=  6.1 m/s
    layer 7: ht=    416 m, wt= 0.005, ws=  6.1 m/s
    layer 8: ht=    508 m, wt= 0.001, ws=  6.1 m/s
    layer 9: ht=    932 m, wt= 0.107, ws=  5.6 m/s
    layer 10: ht=   5022 m, wt= 0.144, ws= 11.1 m/s
    layer 11: ht=   9238 m, wt= 0.093, ws= 19.1 m/s
    layer 12: ht=  13856 m, wt= 0.075, ws=  8.2 m/s
    layer 13: ht=  22518 m, wt= 0.036, ws=  4.8 m/s
[00;00mReconstruction[00;00m: r0=0.128424m L0=30m. 14 layers. use cone coordinate.
    layer 0: ht=      0 m, wt= 0.302
    layer 1: ht=     17 m, wt= 0.154
    layer 2: ht=     35 m, wt= 0.041
    layer 3: ht=     52 m, wt= 0.002
    layer 4: ht=    139 m, wt= 0.021
    layer 5: ht=    231 m, wt= 0.010
    layer 6: ht=    323 m, wt= 0.008
    layer 7: ht=    416 m, wt= 0.005
    layer 8: ht=    508 m, wt= 0.001
    layer 9: ht=    932 m, wt= 0.107
    layer 10: ht=   5022 m, wt= 0.144
    layer 11: ht=   9238 m, wt= 0.093
    layer 12: ht=  13856 m, wt= 0.075
    layer 13: ht=  22518 m, wt= 0.036
[00;00mThere are 3 powfs[00;00m
  powfs0: Order 79, LGS at 99.1 km. Sampling 1/127.66 m. Thres 30%. [00;00mT/T is removed in right hand side in tomography.[00;00m
    CCD image is 25x25 @ 500x500 mas, blur 27% (sigma), 1500Hz, wvl: [ 5.89e-07]
    Gtilt in reconstruction. Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
  powfs1: Order  2, NGS at inf km. Sampling 1/16 m. Thres 30%. 
    Ztilt in reconstruction. Geomtric optics start at 2 with ztilt [00;00m(noisy)[00;00m
  powfs2: Order 20, NGS at inf km. Sampling 1/31.9716 m. Thres 50%. 
    CCD image is 4x4 @ 1500x1500 mas, blur 0% (sigma), 0.015Hz, wvl: [ 7.2e-07]
    Gtilt in reconstruction. Geomtric optics start at 50 with gtilt Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
[00;00mThere are 13 wfs[00;00m
    wfs 0: type 0, at (  30.00,    0.00) arcsec,  99 km, siglev is 23.8382 bkgrnd is 0.1
    wfs 1: type 0, at (  22.98,   19.28) arcsec,  99 km, siglev is 23.8382 bkgrnd is 0.1
    wfs 2: type 0, at (   5.21,   29.54) arcsec,  99 km, siglev is 23.8382 bkgrnd is 0.1
    wfs 3: type 0, at ( -15.00,   25.98) arcsec,  99 km, siglev is 23.8382 bkgrnd is 0.1
    wfs 4: type 0, at ( -28.19,   10.26) arcsec,  99 km, siglev is 23.8382 bkgrnd is 0.1
    wfs 5: type 0, at ( -28.19,  -10.26) arcsec,  99 km, siglev is 23.8382 bkgrnd is 0.1
    wfs 6: type 0, at ( -15.00,  -25.98) arcsec,  99 km, siglev is 23.8382 bkgrnd is 0.1
    wfs 7: type 0, at (   5.21,  -29.54) arcsec,  99 km, siglev is 23.8382 bkgrnd is 0.1
    wfs 8: type 0, at (  22.98,  -19.28) arcsec,  99 km, siglev is 23.8382 bkgrnd is 0.1
    wfs 9: type 1, at (   5.00,    8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 10: type 1, at ( -10.00,    0.00) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 11: type 1, at (   5.00,   -8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 12: type 2, at (   0.00,    0.00) arcsec, inf km, siglev is 4.1558e+06 bkgrnd is 0.001
[00;00mThere are 3 DMs[00;00m
  DM 0 at -0.1km, actuator pitch 0.141m, offset   0, with 30.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 1 at    6km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 2 at   10km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
[00;00mTomography[00;00m is using CG, with [00;00mFourer Domain[00;00m preconditioner, [00;00m12[00;00m iterations, integrated tomo.
[00;00mDM Fitting [00;00mis using CG, with [00;00mNo[00;00m preconditioner, [00;00m10[00;00m iterations
[00;00mThere are 9 fit directions[00;00m
    Fit 0: weight is 0.444, at (   0.00,    0.00) arcsec
    Fit 1: weight is 0.111, at (  15.00,    0.00) arcsec
    Fit 2: weight is 0.111, at (   0.00,   15.00) arcsec
    Fit 3: weight is 0.111, at ( -15.00,    0.00) arcsec
    Fit 4: weight is 0.111, at (   0.00,  -15.00) arcsec
    Fit 5: weight is 0.028, at (  15.00,   15.00) arcsec
    Fit 6: weight is 0.028, at ( -15.00,   15.00) arcsec
    Fit 7: weight is 0.028, at ( -15.00,  -15.00) arcsec
    Fit 8: weight is 0.028, at (  15.00,  -15.00) arcsec
[00;00mThere are 1 evaluation directions[00;00m at sampling 1/128 m.
    Evl 0: weight is 1.000, at (   0.00,    0.00) arcsec
[00;00mSimulation[00;00m start at step 0, end at step 1600, with time step 1/1500s, [00;00mclose loop[00;00m.
After setup_parms:	120.5 MiB.
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
CUDA: minimum memory requirement is 0.3GB
GPU 0 is NVIDIA A100-SXM4-40GB with arch 8.0, 38.9GB free, 39.3GB total device memory.
Using GPU 0
Use 1 GPUs for WFS Tomo Fit Evl

*** Preparation started at 2025/02/17 15:30:26 in nid001972. ***

Using OpenMP version 201511 with 128 threads
Reading aperture amplitude map from KECK.fits
[00;00m[0;36mWarning(accphi.c:477): 108691 points not covered by input screen
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
 ->maos.c:447->setup.c:148->aper.c:74->utils.c:478->accphi.c:478
iwvl 0: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 1: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 2: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 3: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 4: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 5: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 6: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 7: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 8: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
After setup_aper:	343.0 MiB.

[00;00mSetting up powfs 0 geom[00;00m

There are 18 points in each subaperture of 0.141m.
There are 3737 valid subaperture.

[00;00mSetting up powfs 1 geom[00;00m

There are 88 points in each subaperture of 5.5m.
There are 4 valid subaperture.

[00;00mSetting up powfs 2 geom[00;00m

There are 18 points in each subaperture of 0.563m.
There are 236 valid subaperture.
After setup_powfs_init:	439.8 MiB.

[00;00mSetting up reconstructor geometry.[00;00m

PLOC is 161x161, with sampling of 0.07m (square)
    DM 0: grid is 82 x 82
    DM 1: grid is 75 x 75
    DM 2: grid is 80 x 79
FLOC is 161x161, with sampling of 0.07m (not square)
Tomography grid is square:
    layer 0: xloc grid is 280 x 280, sampling is 0.070 m, 78400 points
    layer 1: xloc grid is 280 x 280, sampling is 0.070 m, 78400 points
    layer 2: xloc grid is 280 x 280, sampling is 0.070 m, 78400 points
    layer 3: xloc grid is 280 x 280, sampling is 0.070 m, 78400 points
    layer 4: xloc grid is 280 x 280, sampling is 0.070 m, 78400 points
    layer 5: xloc grid is 280 x 280, sampling is 0.070 m, 78400 points
    layer 6: xloc grid is 280 x 280, sampling is 0.070 m, 78400 points
    layer 7: xloc grid is 280 x 280, sampling is 0.070 m, 78400 points
    layer 8: xloc grid is 280 x 280, sampling is 0.070 m, 78400 points
    layer 9: xloc grid is 280 x 280, sampling is 0.070 m, 78400 points
    layer 10: xloc grid is 280 x 280, sampling is 0.067 m, 78400 points
    layer 11: xloc grid is 280 x 280, sampling is 0.064 m, 78400 points
    layer 12: xloc grid is 280 x 280, sampling is 0.061 m, 78400 points
[00;00m[0;36mWarning(map.c:195): ninx=280 is too small. need 281
[00;00m[0;36mWarning(map.c:200): niny=280 is too small. need 281
    layer 13: xloc grid is 280 x 280, sampling is 0.054 m, 78400 points

[00;00mSetting up powfs 0 PO WFS[00;00m

OTF dimension is 36x36 (calculated)
Uplink FWHM (illt 0, iwvl 0) is 0.580741"
Downlink FWHM (illt 0, iwvl 0) is 0"
Generating matched filter for powfs 0
sa index   location       noise equivalent angle
    1838: (  4.9,  -0.2) m, (5000.00, 5000.00) mas
    1830: (  3.7,  -0.2) m, (5000.00, 5000.00) mas
    1822: (  2.6,  -0.2) m, (5000.00, 5000.00) mas
    1815: (  1.6,  -0.2) m, (5000.00, 5000.00) mas
    1813: (  1.3,  -0.2) m, (5000.00, 5000.00) mas
    1334: ( -0.5,  -1.3) m, (5000.00, 5000.00) mas
    1808: ( -1.8,  -0.2) m, (5000.00, 5000.00) mas
    1800: ( -2.9,  -0.2) m, (5000.00, 5000.00) mas
    1792: ( -4.0,  -0.2) m, (5000.00, 5000.00) mas
    1785: ( -5.0,  -0.2) m, (5000.00, 5000.00) mas
    1782: ( -5.4,  -0.2) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    3217: (  3.7,   3.0) m, (5000.00, 5000.00) mas
    3104: (  3.3,   2.7) m, (5000.00, 5000.00) mas
    2820: (  2.5,   2.0) m, (5000.00, 5000.00) mas
    2487: (  1.6,   1.3) m, (5000.00, 5000.00) mas
    2230: (  0.9,   0.8) m, (5000.00, 5000.00) mas
    1340: (  0.4,  -1.3) m, (5000.00, 5000.00) mas
    1456: ( -1.2,  -1.1) m, (5000.00, 5000.00) mas
    1258: ( -1.8,  -1.5) m, (5000.00, 5000.00) mas
     925: ( -2.6,  -2.2) m, (5000.00, 5000.00) mas
     640: ( -3.5,  -2.9) m, (5000.00, 5000.00) mas
     150: ( -3.0,  -4.3) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    3726: (  0.8,   4.7) m, (5000.00, 5000.00) mas
    3531: (  0.6,   4.0) m, (5000.00, 5000.00) mas
    3248: (  0.5,   3.2) m, (5000.00, 5000.00) mas
    2918: (  0.4,   2.3) m, (5000.00, 5000.00) mas
    2477: (  0.2,   1.3) m, (5000.00, 5000.00) mas
    1749: ( -1.5,  -0.4) m, (5000.00, 5000.00) mas
    1134: ( -0.4,  -1.8) m, (5000.00, 5000.00) mas
     826: ( -0.5,  -2.5) m, (5000.00, 5000.00) mas
     495: ( -0.6,  -3.3) m, (5000.00, 5000.00) mas
     211: ( -0.8,  -4.2) m, (5000.00, 5000.00) mas
      11: ( -2.3,  -4.9) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    3685: ( -2.7,   4.6) m, (5000.00, 5000.00) mas
    3376: ( -2.2,   3.6) m, (5000.00, 5000.00) mas
    3123: ( -1.8,   2.9) m, (5000.00, 5000.00) mas
    2733: ( -1.2,   1.9) m, (5000.00, 5000.00) mas
    2403: ( -0.8,   1.2) m, (5000.00, 5000.00) mas
    1995: (  1.2,   0.2) m, (5000.00, 5000.00) mas
    1342: (  0.6,  -1.3) m, (5000.00, 5000.00) mas
    1012: (  1.1,  -2.0) m, (5000.00, 5000.00) mas
     621: (  1.6,  -3.0) m, (5000.00, 5000.00) mas
     366: (  2.0,  -3.7) m, (5000.00, 5000.00) mas
      57: (  2.6,  -4.7) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    2644: ( -4.6,   1.8) m, (5000.00, 5000.00) mas
    2447: ( -4.0,   1.3) m, (5000.00, 5000.00) mas
    2326: ( -3.2,   1.1) m, (5000.00, 5000.00) mas
    2111: ( -1.6,   0.5) m, (5000.00, 5000.00) mas
    2054: ( -1.3,   0.4) m, (5000.00, 5000.00) mas
    2287: (  0.8,   0.9) m, (5000.00, 5000.00) mas
    1633: (  1.5,  -0.6) m, (5000.00, 5000.00) mas
    1578: (  1.9,  -0.8) m, (5000.00, 5000.00) mas
    1362: (  3.5,  -1.3) m, (5000.00, 5000.00) mas
    1298: (  3.9,  -1.5) m, (5000.00, 5000.00) mas
    1718: (  5.1,  -0.5) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    1037: ( -4.6,  -1.9) m, (5000.00, 5000.00) mas
    1242: ( -4.0,  -1.5) m, (5000.00, 5000.00) mas
    1382: ( -3.2,  -1.2) m, (5000.00, 5000.00) mas
    1626: ( -1.6,  -0.6) m, (5000.00, 5000.00) mas
    1689: ( -1.3,  -0.5) m, (5000.00, 5000.00) mas
    1459: (  0.8,  -1.1) m, (5000.00, 5000.00) mas
    2118: (  1.5,   0.5) m, (5000.00, 5000.00) mas
    2180: (  1.9,   0.6) m, (5000.00, 5000.00) mas
    2433: (  3.5,   1.2) m, (5000.00, 5000.00) mas
    2503: (  3.9,   1.3) m, (5000.00, 5000.00) mas
    2083: (  5.1,   0.4) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
      28: ( -2.7,  -4.7) m, (5000.00, 5000.00) mas
     336: ( -2.2,  -3.7) m, (5000.00, 5000.00) mas
     597: ( -1.8,  -3.0) m, (5000.00, 5000.00) mas
     996: ( -1.2,  -2.0) m, (5000.00, 5000.00) mas
    1332: ( -0.8,  -1.3) m, (5000.00, 5000.00) mas
    2285: ( -0.9,   0.9) m, (5000.00, 5000.00) mas
    2413: (  0.6,   1.2) m, (5000.00, 5000.00) mas
    2749: (  1.1,   1.9) m, (5000.00, 5000.00) mas
    3147: (  1.6,   2.9) m, (5000.00, 5000.00) mas
    3406: (  2.0,   3.6) m, (5000.00, 5000.00) mas
    3714: (  2.6,   4.6) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
      20: (  0.8,  -4.9) m, (5000.00, 5000.00) mas
     221: (  0.6,  -4.2) m, (5000.00, 5000.00) mas
     503: (  0.5,  -3.3) m, (5000.00, 5000.00) mas
     832: (  0.4,  -2.5) m, (5000.00, 5000.00) mas
    1272: (  0.2,  -1.5) m, (5000.00, 5000.00) mas
    1993: ( -1.5,   0.2) m, (5000.00, 5000.00) mas
    2607: ( -0.4,   1.6) m, (5000.00, 5000.00) mas
    2912: ( -0.5,   2.3) m, (5000.00, 5000.00) mas
    3240: ( -0.6,   3.2) m, (5000.00, 5000.00) mas
    3521: ( -0.8,   4.0) m, (5000.00, 5000.00) mas
    3718: ( -2.3,   4.7) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
     581: (  3.7,  -3.2) m, (5000.00, 5000.00) mas
     688: (  3.3,  -2.9) m, (5000.00, 5000.00) mas
     961: (  2.5,  -2.2) m, (5000.00, 5000.00) mas
    1282: (  1.6,  -1.5) m, (5000.00, 5000.00) mas
    1515: (  0.9,  -0.9) m, (5000.00, 5000.00) mas
    2411: (  0.4,   1.2) m, (5000.00, 5000.00) mas
    2229: ( -1.1,   0.8) m, (5000.00, 5000.00) mas
    2463: ( -1.8,   1.3) m, (5000.00, 5000.00) mas
    2784: ( -2.6,   2.0) m, (5000.00, 5000.00) mas
    3056: ( -3.5,   2.7) m, (5000.00, 5000.00) mas
    3550: ( -3.0,   4.2) m, (5000.00, 5000.00) mas

[00;00mSetting up powfs 2 PO WFS[00;00m

OTF dimension is 48x48 (calculated)
Generating matched filter for powfs 2
Use sanea to derive neasim
Use sanea to derive neasim

[00;00mSetting up reconstructor[00;00m

Recon NEA: cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) geom(0.31) geom(0.31) geom(0.31) mf(0.14)  mas
Setup or update control matrix parameters.
RRtwfs svd threshold is 1e-10
Replacing HA by HA*fit->actextrap
Adding piston cr to fit matrix
Adding TT cr on upper DMs to fit matrix.
Before assembling fit matrix:	5566.0 MiB.
Building fit->FR
Building fit->FL
Adding tikhonov constraint of 1.0e-07 to FLM
The maximum eigen value is estimated to be around 2.6e-04
DM Fit number of Low rank terms: 16 in LHS
After assemble fit matrix:	7634.5 MiB.
After setup_recon:	7634.5 MiB.
GPU 0: mem used 1596 MB (wfs init)
GPU 0: mem used 2856 MB (recon init)
GPU 0: mem used 2886 MB (perf init)

*** Simulation started at 2025/02/17 15:32:09 in nid001972. ***

Running seed 1
GPU 0: mem used 2888 MB (wfs seeding)
Wind dir: 267.3 261.7 167.0 130.5 300.7  32.3 119.8 139.0 150.8 277.7 203.0 133.1  45.9 265.1 deg
Using /global/homes/b/bpeck/.aos/cache/atm/vonkarman_14_8192x8192_0.0078125_1115374592d.bin
After genatm:	7416.7 MiB.
Step     #  Open Loop  PR TT  On axis  PR TT  Field RMS PR TT     Timing 
Step     0: OL  884.6  248.3  OA  884.6 248.3 CL  884.6 248.3 nm  0.106 s
Step    10: OL  899.9  252.3  OA  756.9 231.3 CL  756.9 231.3 nm  0.079 s
Step    23: OL  919.9  256.8  OA  749.3 227.6 CL  749.3 227.6 nm  0.087 s
Step    34: OL  936.8  259.7  OA  746.7 225.1 CL  746.7 225.1 nm  0.120 s
Step    46: OL  954.8  261.2  OA  742.7 221.9 CL  742.7 221.9 nm  0.094 s
Step    58: OL  972.7  261.1  OA  735.4 217.6 CL  735.4 217.6 nm  0.088 s
Step    70: OL  991.1  260.0  OA  728.2 211.9 CL  728.2 211.9 nm  0.087 s
Step    82: OL 1009.9  258.8  OA  723.0 206.3 CL  723.0 206.3 nm  0.090 s
Step    94: OL 1029.2  258.0  OA  721.3 203.4 CL  721.3 203.4 nm  0.089 s
Step   106: OL 1048.5  257.8  OA  721.0 199.0 CL  721.0 199.0 nm  0.087 s
Step   118: OL 1067.7  258.7  OA  723.9 194.5 CL  723.9 194.5 nm  0.089 s
Step   130: OL 1086.0  260.7  OA  725.9 189.0 CL  725.9 189.0 nm  0.091 s
Step   142: OL 1103.4  264.6  OA  731.5 185.0 CL  731.5 185.0 nm  0.085 s
Step   154: OL 1119.2  269.7  OA  736.8 181.5 CL  736.8 181.5 nm  0.088 s
Step   166: OL 1133.4  276.1  OA  740.1 178.8 CL  740.1 178.8 nm  0.096 s
Step   178: OL 1145.7  283.3  OA  743.1 177.7 CL  743.1 177.7 nm  0.089 s
Step   189: OL 1155.1  290.4  OA  743.6 178.6 CL  743.6 178.6 nm  0.090 s
Step   201: OL 1163.4  298.2  OA  744.8 180.2 CL  744.8 180.2 nm  0.088 s
Step   212: OL 1169.7  305.2  OA  747.3 183.1 CL  747.3 183.1 nm  0.089 s
Step   224: OL 1174.9  313.0  OA  750.5 188.2 CL  750.5 188.2 nm  0.088 s
Step   236: OL 1178.2  320.9  OA  754.7 193.9 CL  754.7 193.9 nm  0.091 s
Step   248: OL 1179.4  329.2  OA  754.6 199.9 CL  754.6 199.9 nm  0.087 s
Step   255 updated high order loop gain: 0.425
Step   260: OL 1177.3  337.8  OA  757.0 209.2 CL  757.0 209.2 nm  0.088 s
Step   272: OL 1171.9  346.5  OA  755.5 218.5 CL  755.5 218.5 nm  0.088 s
Step   284: OL 1163.7  355.4  OA  753.7 228.1 CL  753.7 228.1 nm  0.095 s
Step   296: OL 1153.9  365.4  OA  750.7 240.4 CL  750.7 240.4 nm  0.089 s
Step   308: OL 1142.8  376.1  OA  748.0 252.2 CL  748.0 252.2 nm  0.089 s
Step   320: OL 1129.6  387.5  OA  744.1 263.9 CL  744.1 263.9 nm  0.085 s
Step   332: OL 1115.2  400.0  OA  741.2 277.4 CL  741.2 277.4 nm  0.098 s
Step   343: OL 1101.7  412.9  OA  738.8 290.1 CL  738.8 290.1 nm  0.088 s
Step   355: OL 1086.7  428.3  OA  738.3 306.3 CL  738.3 306.3 nm  0.091 s
Step   367: OL 1072.0  445.0  OA  740.9 323.7 CL  740.9 323.7 nm  0.126 s
Step   379: OL 1057.8  462.2  OA  743.0 339.9 CL  743.0 339.9 nm  0.087 s
Step   391: OL 1043.9  479.6  OA  745.6 356.9 CL  745.6 356.9 nm  0.092 s
Step   403: OL 1029.8  496.7  OA  749.1 373.1 CL  749.1 373.1 nm  0.088 s
Step   415: OL 1015.2  513.5  OA  751.4 389.6 CL  751.4 389.6 nm  0.096 s
Step   427: OL 1000.2  529.4  OA  753.8 405.2 CL  753.8 405.2 nm  0.088 s
Step   439: OL  985.6  545.3  OA  753.2 420.5 CL  753.2 420.5 nm  0.089 s
Step   450: OL  973.0  559.5  OA  752.4 433.5 CL  752.4 433.5 nm  0.089 s
Step   462: OL  961.5  575.3  OA  752.1 447.6 CL  752.1 447.6 nm  0.089 s
Step   474: OL  952.8  590.7  OA  755.8 462.2 CL  755.8 462.2 nm  0.100 s
Step   486: OL  947.7  605.8  OA  762.6 476.5 CL  762.6 476.5 nm  0.088 s
Step   497: OL  945.9  619.0  OA  770.7 488.5 CL  770.7 488.5 nm  0.093 s
Step   509: OL  945.5  632.4  OA  780.3 500.8 CL  780.3 500.8 nm  0.092 s
Step   511 updated high order loop gain: 0.426
Step   521: OL  947.0  644.3  OA  790.3 512.1 CL  790.3 512.1 nm  0.088 s
Step   533: OL  950.1  653.9  OA  799.8 520.1 CL  799.8 520.1 nm  0.089 s
Step   544: OL  954.7  660.6  OA  807.3 524.6 CL  807.3 524.6 nm  0.087 s
Step   556: OL  961.7  665.8  OA  815.8 527.6 CL  815.8 527.6 nm  0.096 s
Step   568: OL  970.4  669.1  OA  823.4 529.2 CL  823.4 529.2 nm  0.087 s
Step   580: OL  980.5  670.8  OA  827.4 528.3 CL  827.4 528.3 nm  0.095 s
Step   592: OL  992.2  670.7  OA  832.1 526.3 CL  832.1 526.3 nm  0.088 s
Step   604: OL 1004.8  668.1  OA  835.8 521.5 CL  835.8 521.5 nm  0.088 s
Step   616: OL 1018.0  663.3  OA  837.0 514.3 CL  837.0 514.3 nm  0.093 s
Step   628: OL 1031.2  656.4  OA  834.7 506.6 CL  834.7 506.6 nm  0.090 s
Step   640: OL 1043.9  647.5  OA  830.2 496.2 CL  830.2 496.2 nm  0.088 s
Step   651: OL 1054.5  638.0  OA  822.0 484.8 CL  822.0 484.8 nm  0.090 s
Step   663: OL 1065.0  626.5  OA  813.5 473.6 CL  813.5 473.6 nm  0.097 s
Step   674: OL 1073.8  615.1  OA  803.3 461.1 CL  803.3 461.1 nm  0.087 s
Step   686: OL 1083.0  602.6  OA  792.3 446.0 CL  792.3 446.0 nm  0.088 s
Step   698: OL 1091.0  589.5  OA  781.8 430.1 CL  781.8 430.1 nm  0.087 s
Step   709: OL 1096.6  576.6  OA  773.5 416.3 CL  773.5 416.3 nm  0.087 s
Step   721: OL 1100.5  561.8  OA  761.7 398.0 CL  761.7 398.0 nm  0.089 s
Step   733: OL 1101.8  547.0  OA  751.5 380.4 CL  751.5 380.4 nm  0.093 s
Step   745: OL 1100.5  532.2  OA  740.4 362.8 CL  740.4 362.8 nm  0.087 s
Step   757: OL 1096.8  517.8  OA  728.9 346.9 CL  728.9 346.9 nm  0.092 s
Step   767 updated high order loop gain: 0.427
Step   769: OL 1090.8  503.9  OA  718.2 333.1 CL  718.2 333.1 nm  0.087 s
Step   780: OL 1083.2  491.5  OA  707.6 320.4 CL  707.6 320.4 nm  0.087 s
Step   791: OL 1073.2  479.2  OA  697.5 307.9 CL  697.5 307.9 nm  0.096 s
Step   803: OL 1060.1  465.8  OA  685.4 294.1 CL  685.4 294.1 nm  0.087 s
Step   815: OL 1045.4  452.5  OA  676.4 280.0 CL  676.4 280.0 nm  0.087 s
Step   826: OL 1030.0  440.3  OA  668.0 266.3 CL  668.0 266.3 nm  0.089 s
Step   838: OL 1011.8  427.4  OA  659.1 252.7 CL  659.1 252.7 nm  0.087 s
Step   850: OL  992.9  415.2  OA  652.2 238.8 CL  652.2 238.8 nm  0.089 s
Step   862: OL  974.2  403.9  OA  646.7 226.9 CL  646.7 226.9 nm  0.090 s
Step   874: OL  956.5  393.8  OA  642.4 216.6 CL  642.4 216.6 nm  0.087 s
Step   885: OL  941.4  385.6  OA  639.9 208.8 CL  639.9 208.8 nm  0.087 s
Step   896: OL  926.2  378.2  OA  637.1 202.1 CL  637.1 202.1 nm  0.093 s
Step   908: OL  909.1  371.1  OA  631.8 196.5 CL  631.8 196.5 nm  0.086 s
Step   920: OL  891.9  365.1  OA  624.6 192.4 CL  624.6 192.4 nm  0.096 s
Step   932: OL  875.1  359.3  OA  616.4 188.8 CL  616.4 188.8 nm  0.089 s
Step   944: OL  858.9  353.6  OA  608.2 186.3 CL  608.2 186.3 nm  0.088 s
Step   956: OL  843.5  347.6  OA  600.8 183.1 CL  600.8 183.1 nm  0.086 s
Step   968: OL  830.0  341.1  OA  595.3 181.0 CL  595.3 181.0 nm  0.090 s
Step   980: OL  818.3  333.8  OA  590.6 177.4 CL  590.6 177.4 nm  0.088 s
Step   992: OL  807.9  325.8  OA  588.7 174.4 CL  588.7 174.4 nm  0.089 s
Step  1003: OL  798.7  317.8  OA  585.7 170.2 CL  585.7 170.2 nm  0.087 s
Step  1015: OL  789.6  308.7  OA  581.9 165.2 CL  581.9 165.2 nm  0.088 s
Step  1023 updated high order loop gain: 0.427
Step  1026: OL  782.2  300.2  OA  577.8 161.9 CL  577.8 161.9 nm  0.095 s
Step  1037: OL  775.4  291.2  OA  574.9 157.7 CL  574.9 157.7 nm  0.088 s
Step  1049: OL  768.3  280.7  OA  570.8 152.1 CL  570.8 152.1 nm  0.088 s
Step  1061: OL  760.8  269.4  OA  567.6 145.6 CL  567.6 145.6 nm  0.086 s
Step  1073: OL  754.1  256.6  OA  563.1 138.2 CL  563.1 138.2 nm  0.095 s
Step  1085: OL  749.0  242.6  OA  562.3 128.1 CL  562.3 128.1 nm  0.088 s
Step  1097: OL  745.5  228.9  OA  560.0 118.4 CL  560.0 118.4 nm  0.096 s
Step  1109: OL  743.2  216.2  OA  560.3 108.5 CL  560.3 108.5 nm  0.087 s
Step  1121: OL  741.6  204.6  OA  562.4 100.0 CL  562.4 100.0 nm  0.097 s
Step  1133: OL  740.6  194.8  OA  565.2  93.7 CL  565.2  93.7 nm  0.090 s
Step  1145: OL  739.9  186.4  OA  567.7  88.6 CL  567.7  88.6 nm  0.087 s
Step  1157: OL  739.3  179.6  OA  571.7  85.9 CL  571.7  85.9 nm  0.087 s
Step  1169: OL  738.6  174.7  OA  574.7  84.3 CL  574.7  84.3 nm  0.087 s
Step  1181: OL  738.9  171.2  OA  578.5  83.6 CL  578.5  83.6 nm  0.089 s
Step  1193: OL  740.4  168.5  OA  585.6  83.0 CL  585.6  83.0 nm  0.087 s
Step  1205: OL  742.4  166.1  OA  594.1  82.2 CL  594.1  82.2 nm  0.092 s
Step  1216: OL  744.5  164.4  OA  600.4  82.0 CL  600.4  82.0 nm  0.087 s
Step  1227: OL  746.8  163.5  OA  607.5  81.9 CL  607.5  81.9 nm  0.088 s
Step  1239: OL  748.8  164.1  OA  612.1  83.1 CL  612.1  83.1 nm  0.088 s
Step  1251: OL  750.7  166.4  OA  619.1  86.6 CL  619.1  86.6 nm  0.088 s
Step  1263: OL  753.5  170.6  OA  624.2  90.9 CL  624.2  90.9 nm  0.097 s
Step  1275: OL  756.7  176.3  OA  628.9  95.4 CL  628.9  95.4 nm  0.093 s
Step  1279 updated high order loop gain: 0.428
Step  1287: OL  761.1  183.2  OA  633.2 100.6 CL  633.2 100.6 nm  0.094 s
Step  1299: OL  765.9  191.0  OA  636.7 105.5 CL  636.7 105.5 nm  0.089 s
Step  1311: OL  770.2  199.7  OA  638.3 111.0 CL  638.3 111.0 nm  0.092 s
Step  1322: OL  773.8  208.4  OA  634.3 115.8 CL  634.3 115.8 nm  0.087 s
Step  1334: OL  778.1  218.8  OA  635.0 121.9 CL  635.0 121.9 nm  0.087 s
Step  1341: OL  781.1  225.2  OA  632.4 124.4 CL  632.4 124.4 nm  0.088 s
Step  1353: OL  787.0  236.1  OA  629.8 129.1 CL  629.8 129.1 nm  0.086 s
Step  1364: OL  793.6  245.4  OA  633.0 132.7 CL  633.0 132.7 nm  0.087 s
Step  1376: OL  801.1  253.9  OA  633.0 133.6 CL  633.0 133.6 nm  0.090 s
Step  1388: OL  809.1  260.9  OA  636.5 135.3 CL  636.5 135.3 nm  0.087 s
Step  1400: OL  818.2  266.4  OA  644.1 134.8 CL  644.1 134.8 nm  0.086 s
Step  1412: OL  827.9  270.5  OA  649.9 134.7 CL  649.9 134.7 nm  0.087 s
Step  1424: OL  838.2  273.7  OA  656.0 133.4 CL  656.0 133.4 nm  0.088 s
Step  1436: OL  848.1  276.3  OA  661.0 132.4 CL  661.0 132.4 nm  0.088 s
Step  1447: OL  856.7  278.3  OA  664.9 131.4 CL  664.9 131.4 nm  0.096 s
Step  1459: OL  865.3  279.6  OA  664.9 129.1 CL  664.9 129.1 nm  0.086 s
Step  1471: OL  872.2  279.5  OA  668.2 128.4 CL  668.2 128.4 nm  0.091 s
Step  1482: OL  876.0  278.2  OA  669.4 127.5 CL  669.4 127.5 nm  0.087 s
Step  1494: OL  877.4  275.3  OA  667.3 126.7 CL  667.3 126.7 nm  0.096 s
Step  1506: OL  876.4  270.9  OA  662.5 126.2 CL  662.5 126.2 nm  0.087 s
Step  1518: OL  873.6  265.5  OA  658.0 125.5 CL  658.0 125.5 nm  0.086 s
Step  1530: OL  869.3  259.1  OA  651.7 124.7 CL  651.7 124.7 nm  0.088 s
Step  1535 updated high order loop gain: 0.428
Step  1539: OL  865.2  253.6  OA  647.2 124.7 CL  647.2 124.7 nm  0.086 s
Step  1551: OL  859.4  245.8  OA  646.2 121.7 CL  646.2 121.7 nm  0.090 s
Step  1563: OL  853.7  237.9  OA  644.7 119.8 CL  644.7 119.8 nm  0.089 s
Step  1575: OL  848.0  230.8  OA  643.8 119.4 CL  643.8 119.4 nm  0.087 s
Step  1587: OL  842.1  224.9  OA  642.1 120.4 CL  642.1 120.4 nm  0.089 s
Step 1599: Output PSF
Step  1599: OL  835.8  219.9  OA  642.8 123.6 CL  642.8 123.6 nm  1.280 s
Mean: 683.06 291.16 617.90  nm.

*** Simulation Finished at 2025/02/17 15:34:42 in nid001972. ***

[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
/global/cfs/cdirs/ulens/vismcao/maos -o studies/reduced_ngs/9_lgs/8mag_lgs/5000count -c master_files/reduced_ngs/9_lgs/8mag_lgs/kola_5000act.conf -O 
Output folder is 'studies/reduced_ngs/9_lgs/8mag_lgs/5000count'.
SRC: /global/homes/b/bpeck/code/maos v2.9 4c88b7c2 2024-11-13 16:45:33 -0800
BUILT: /global/homes/b/bpeck/code/maos/optim by GCC (v12) on 2024/11/18 09:40:03 CPU(F64,+O3) with CUDA(v122,F32)
Launched at 2025/02/17 15:34:42 in nid001972 with PID 1700720.
The web based job monitor can be accessed at http://localhost:10300
Main config file is /global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_5000act.conf
[00;00m[0;36mWarning(path.c:48): Path not found: path=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; abspath=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; Ignored.
[00;00m[0;36mWarning(path.c:48): Path not found: path=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; abspath=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; Ignored.
[00;00m[0;36mWarning(readcfg.c:399): sim.apfsm has been renamed to powfs.apfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.epfsm has been renamed to powfs.epfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.alfsm has been renamed to powfs.alfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.commonfsm has been renamed to powfs.commonfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.idealfsm has been renamed to powfs.idealfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.zetafsm has been renamed to powfs.zetafsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.f0fsm has been renamed to powfs.f0fsm.
[00;00m[0;36mWarning(readcfg.c:399): tsurf has been renamed to ncpa.tsurf.
loaded 132 (132 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_sim.conf'
loaded  19 ( 19 new) records from '/global/cfs/cdirs/ulens/vismcao/./dm_none.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_ASM.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_DM2.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_DM3.conf'
loaded   0 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_dm_multiple.conf'
loaded   7 (  5 new) records from '/global/cfs/cdirs/ulens/vismcao/./atm_mk13n50p_ground_detail.conf'
loaded  76 ( 69 new) records from '/global/homes/b/bpeck/code/maos/config/maos/powfs_common.conf'
loaded  44 ( 38 new) records from '/global/cfs/cdirs/ulens/vismcao/./powfs_none.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_lgs.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_ttf_strap.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_twfs_lbwfs.conf'
loaded   0 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_wfs_lgs_strap_lbwfs.conf'
loaded  71 ( 71 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_recon.conf'
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_smooth has been renamed to powfs0_llt.na_smooth.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_interp has been renamed to powfs0_llt.na_interp.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_thres has been renamed to powfs0_llt.na_thres.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_maxit has been renamed to powfs0_llt.na_fit_maxit.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_svdthres has been renamed to powfs0_llt.na_fit_svdthres.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_dh has been renamed to powfs0_llt.na_fit_dh.
[00;00m[0;36mWarning(readcfg.c:399): dbg.ncpa_preload has been renamed to ncpa.preload.
[00;00m[0;36mWarning(readcfg.c:399): dbg.ncpa_rmsci has been renamed to ncpa.rmsci.
[00;00m[0;36mWarning(readcfg.c:399): dbg.draw_opdmax has been renamed to plot.opdmax.
[00;00m[0;36mWarning(readcfg.c:399): dbg.draw_gmax has been renamed to plot.gmax.
loaded  95 ( 93 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_dbg.conf'
loaded   4 (  4 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_fit_mcao.conf'
[00;00m[0;36mWarning(readcfg.c:399): surf has been renamed to ncpa.surf.
loaded  39 (  7 new) records from '/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_5000act.conf'
loaded   0 (  0 new) records from 'command line'
loaded  24 ( 18 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_llt_CL.conf'
Adjust LGS range by telescope altitude 4145m.
Zenith angle is 30 degree.
    Scaling turbulence height and LGS hs by sec(za).
    Scaling r0 by cos(za)^(3/5).
    Scaling wind speed and LGS signal level by cos(za).
powfs0: Adjusting dx from 0.0078125 to 0.00766667. 
powfs0.llt.fsm: f0=0 Hz, LPF ep=0
powfs0.epfsm is set to 0.517618 (auto)
powfs2: Adjusting dx from 0.03125 to 0.0312778. 
powfs2 is TWFS for powfs0
sim.ephi is set to 0.427717 (auto)
sim.eplo is set to 0.427717 (auto)
[00;00m[0;36mWarning(parms.c:2296): Layer 1 at 17.3205m is very close to layer 0 at 0m (OK).
[00;00m[0;36mWarning(parms.c:2296): Layer 2 at 34.641m is very close to layer 1 at 17.3205m (OK).
[00;00m[0;36mWarning(parms.c:2296): Layer 3 at 51.9615m is very close to layer 2 at 34.641m (OK).
dm 0: stroke=30 um is provided in micron.
dm 0: assume ia stroke=2 um is provided in micron.
dm 1: stroke=7 um is provided in micron.
dm 1: assume ia stroke=2 um is provided in micron.
dm 2: stroke=7 um is provided in micron.
dm 2: assume ia stroke=2 um is provided in micron.
Focus blending is not implemented yet for integrated tomography
parms->sim.mffocus is reset to 0
There are 1 valid simulation seeds:  1
Output PSF for 1 directions
Used 449 of 456 supplied keys
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_flate" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_flatv" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_psx" is not recognized, value is [0 0 0 0]
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_psy" is not recognized, value is [0 0 0 0]
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_pupelong" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_raw" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_side" is not recognized, value is 4
[00;00mAperture[00;00m is 11 m with sampling 1/128 m
[00;00mTurbulence at 30 degree zenith angle:[00;00m r0=0.128424m, L0=30m, 14 layers.
    Greenwood freq is 25.1Hz, anisoplanatic angle is 1.58 as
    Sampled 8192x8192 at 1/128m. wind dir is randomized.
    layer 0: ht=      0 m, wt= 0.302, ws=  4.8 m/s
    layer 1: ht=     17 m, wt= 0.154, ws=  5.0 m/s
    layer 2: ht=     35 m, wt= 0.041, ws=  5.4 m/s
    layer 3: ht=     52 m, wt= 0.002, ws=  6.6 m/s
    layer 4: ht=    139 m, wt= 0.021, ws=  6.1 m/s
    layer 5: ht=    231 m, wt= 0.010, ws=  6.1 m/s
    layer 6: ht=    323 m, wt= 0.008, ws=  6.1 m/s
    layer 7: ht=    416 m, wt= 0.005, ws=  6.1 m/s
    layer 8: ht=    508 m, wt= 0.001, ws=  6.1 m/s
    layer 9: ht=    932 m, wt= 0.107, ws=  5.6 m/s
    layer 10: ht=   5022 m, wt= 0.144, ws= 11.1 m/s
    layer 11: ht=   9238 m, wt= 0.093, ws= 19.1 m/s
    layer 12: ht=  13856 m, wt= 0.075, ws=  8.2 m/s
    layer 13: ht=  22518 m, wt= 0.036, ws=  4.8 m/s
[00;00mReconstruction[00;00m: r0=0.128424m L0=30m. 14 layers. use cone coordinate.
    layer 0: ht=      0 m, wt= 0.302
    layer 1: ht=     17 m, wt= 0.154
    layer 2: ht=     35 m, wt= 0.041
    layer 3: ht=     52 m, wt= 0.002
    layer 4: ht=    139 m, wt= 0.021
    layer 5: ht=    231 m, wt= 0.010
    layer 6: ht=    323 m, wt= 0.008
    layer 7: ht=    416 m, wt= 0.005
    layer 8: ht=    508 m, wt= 0.001
    layer 9: ht=    932 m, wt= 0.107
    layer 10: ht=   5022 m, wt= 0.144
    layer 11: ht=   9238 m, wt= 0.093
    layer 12: ht=  13856 m, wt= 0.075
    layer 13: ht=  22518 m, wt= 0.036
[00;00mThere are 3 powfs[00;00m
  powfs0: Order 80, LGS at 99.1 km. Sampling 1/130.435 m. Thres 30%. [00;00mT/T is removed in right hand side in tomography.[00;00m
    CCD image is 25x25 @ 500x500 mas, blur 27% (sigma), 1500Hz, wvl: [ 5.89e-07]
    Gtilt in reconstruction. Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
  powfs1: Order  2, NGS at inf km. Sampling 1/16 m. Thres 30%. 
    Ztilt in reconstruction. Geomtric optics start at 2 with ztilt [00;00m(noisy)[00;00m
  powfs2: Order 20, NGS at inf km. Sampling 1/31.9716 m. Thres 50%. 
    CCD image is 4x4 @ 1500x1500 mas, blur 0% (sigma), 0.015Hz, wvl: [ 7.2e-07]
    Gtilt in reconstruction. Geomtric optics start at 50 with gtilt Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
[00;00mThere are 13 wfs[00;00m
    wfs 0: type 0, at (  30.00,    0.00) arcsec,  99 km, siglev is 22.8345 bkgrnd is 0.1
    wfs 1: type 0, at (  22.98,   19.28) arcsec,  99 km, siglev is 22.8345 bkgrnd is 0.1
    wfs 2: type 0, at (   5.21,   29.54) arcsec,  99 km, siglev is 22.8345 bkgrnd is 0.1
    wfs 3: type 0, at ( -15.00,   25.98) arcsec,  99 km, siglev is 22.8345 bkgrnd is 0.1
    wfs 4: type 0, at ( -28.19,   10.26) arcsec,  99 km, siglev is 22.8345 bkgrnd is 0.1
    wfs 5: type 0, at ( -28.19,  -10.26) arcsec,  99 km, siglev is 22.8345 bkgrnd is 0.1
    wfs 6: type 0, at ( -15.00,  -25.98) arcsec,  99 km, siglev is 22.8345 bkgrnd is 0.1
    wfs 7: type 0, at (   5.21,  -29.54) arcsec,  99 km, siglev is 22.8345 bkgrnd is 0.1
    wfs 8: type 0, at (  22.98,  -19.28) arcsec,  99 km, siglev is 22.8345 bkgrnd is 0.1
    wfs 9: type 1, at (   5.00,    8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 10: type 1, at ( -10.00,    0.00) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 11: type 1, at (   5.00,   -8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 12: type 2, at (   0.00,    0.00) arcsec, inf km, siglev is 4.1558e+06 bkgrnd is 0.001
[00;00mThere are 3 DMs[00;00m
  DM 0 at -0.1km, actuator pitch 0.138m, offset   0, with 30.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 1 at    6km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 2 at   10km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
[00;00mTomography[00;00m is using CG, with [00;00mFourer Domain[00;00m preconditioner, [00;00m12[00;00m iterations, integrated tomo.
[00;00mDM Fitting [00;00mis using CG, with [00;00mNo[00;00m preconditioner, [00;00m10[00;00m iterations
[00;00mThere are 9 fit directions[00;00m
    Fit 0: weight is 0.444, at (   0.00,    0.00) arcsec
    Fit 1: weight is 0.111, at (  15.00,    0.00) arcsec
    Fit 2: weight is 0.111, at (   0.00,   15.00) arcsec
    Fit 3: weight is 0.111, at ( -15.00,    0.00) arcsec
    Fit 4: weight is 0.111, at (   0.00,  -15.00) arcsec
    Fit 5: weight is 0.028, at (  15.00,   15.00) arcsec
    Fit 6: weight is 0.028, at ( -15.00,   15.00) arcsec
    Fit 7: weight is 0.028, at ( -15.00,  -15.00) arcsec
    Fit 8: weight is 0.028, at (  15.00,  -15.00) arcsec
[00;00mThere are 1 evaluation directions[00;00m at sampling 1/128 m.
    Evl 0: weight is 1.000, at (   0.00,    0.00) arcsec
[00;00mSimulation[00;00m start at step 0, end at step 1600, with time step 1/1500s, [00;00mclose loop[00;00m.
After setup_parms:	120.5 MiB.
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
CUDA: minimum memory requirement is 0.4GB
GPU 0 is NVIDIA A100-SXM4-40GB with arch 8.0, 38.9GB free, 39.3GB total device memory.
Using GPU 0
Use 1 GPUs for WFS Tomo Fit Evl

*** Preparation started at 2025/02/17 15:34:43 in nid001972. ***

Using OpenMP version 201511 with 128 threads
Reading aperture amplitude map from KECK.fits
[00;00m[0;36mWarning(accphi.c:477): 108520 points not covered by input screen
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
 ->maos.c:447->setup.c:148->aper.c:74->utils.c:478->accphi.c:478
iwvl 0: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 1: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 2: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 3: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 4: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 5: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 6: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 7: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 8: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
After setup_aper:	344.8 MiB.

[00;00mSetting up powfs 0 geom[00;00m

There are 18 points in each subaperture of 0.138m.
There are 3911 valid subaperture.

[00;00mSetting up powfs 1 geom[00;00m

There are 88 points in each subaperture of 5.5m.
There are 4 valid subaperture.

[00;00mSetting up powfs 2 geom[00;00m

There are 18 points in each subaperture of 0.563m.
There are 236 valid subaperture.
After setup_powfs_init:	445.0 MiB.

[00;00mSetting up reconstructor geometry.[00;00m

PLOC is 163x163, with sampling of 0.07m (square)
    DM 0: grid is 84 x 83
    DM 1: grid is 75 x 75
    DM 2: grid is 80 x 79
FLOC is 163x163, with sampling of 0.07m (not square)
Tomography grid is square:
    layer 0: xloc grid is 288 x 288, sampling is 0.069 m, 82944 points
    layer 1: xloc grid is 288 x 288, sampling is 0.069 m, 82944 points
    layer 2: xloc grid is 288 x 288, sampling is 0.069 m, 82944 points
    layer 3: xloc grid is 288 x 288, sampling is 0.069 m, 82944 points
    layer 4: xloc grid is 288 x 288, sampling is 0.069 m, 82944 points
    layer 5: xloc grid is 288 x 288, sampling is 0.069 m, 82944 points
    layer 6: xloc grid is 288 x 288, sampling is 0.069 m, 82944 points
    layer 7: xloc grid is 288 x 288, sampling is 0.069 m, 82944 points
    layer 8: xloc grid is 288 x 288, sampling is 0.069 m, 82944 points
    layer 9: xloc grid is 288 x 288, sampling is 0.068 m, 82944 points
    layer 10: xloc grid is 288 x 288, sampling is 0.066 m, 82944 points
    layer 11: xloc grid is 288 x 288, sampling is 0.063 m, 82944 points
    layer 12: xloc grid is 288 x 288, sampling is 0.059 m, 82944 points
    layer 13: xloc grid is 288 x 288, sampling is 0.053 m, 82944 points

[00;00mSetting up powfs 0 PO WFS[00;00m

OTF dimension is 36x36 (calculated)
There is no bias
Uplink FWHM (illt 0, iwvl 0) is 0.581315"
Downlink FWHM (illt 0, iwvl 0) is 1.4091"
Generating matched filter for powfs 0
sa index   location       noise equivalent angle
    1955: (  4.8,  -0.1) m, (178.16, 170.08) mas
    1947: (  3.7,  -0.1) m, (191.70, 172.09) mas
    1939: (  2.6,  -0.1) m, (209.51, 174.70) mas
    1931: (  1.5,  -0.1) m, (230.10, 177.67) mas
    1929: (  1.2,  -0.1) m, (235.48, 178.43) mas
    1375: ( -0.6,  -1.4) m, (268.94, 187.62) mas
    1925: ( -1.8,  -0.1) m, (292.53, 186.78) mas
    1917: ( -2.9,  -0.1) m, (312.94, 189.77) mas
    1909: ( -4.0,  -0.1) m, (332.26, 192.54) mas
    1901: ( -5.1,  -0.1) m, (353.75, 195.40) mas
    1899: ( -5.4,  -0.1) m, (361.19, 196.29) mas
sa index   location       noise equivalent angle
    3367: (  3.7,   3.0) m, (174.74, 173.65) mas
    3192: (  3.2,   2.6) m, (178.23, 175.98) mas
    2894: (  2.3,   1.9) m, (189.41, 184.61) mas
    2620: (  1.7,   1.4) m, (200.42, 192.95) mas
    2357: (  1.0,   0.8) m, (212.19, 201.83) mas
    1382: (  0.4,  -1.4) m, (222.01, 238.07) mas
    1561: ( -1.1,  -1.0) m, (248.83, 231.41) mas
    1298: ( -1.8,  -1.5) m, (262.48, 241.81) mas
    1023: ( -2.5,  -2.1) m, (276.51, 252.55) mas
     725: ( -3.3,  -2.8) m, (293.80, 266.33) mas
     164: ( -3.0,  -4.3) m, (287.43, 295.31) mas
sa index   location       noise equivalent angle
    3894: (  0.7,   4.7) m, (170.50, 178.22) mas
    3781: (  0.7,   4.3) m, (170.90, 181.43) mas
    3229: (  0.4,   2.8) m, (175.03, 204.23) mas
    2879: (  0.3,   1.9) m, (196.13, 247.16) mas
    2541: (  0.1,   1.2) m, (180.30, 232.79) mas
    1802: ( -1.4,  -0.4) m, (196.15, 263.21) mas
    1377: ( -0.3,  -1.4) m, (189.50, 282.51) mas
    1038: ( -0.4,  -2.1) m, (213.32, 333.05) mas
     412: ( -0.7,  -3.6) m, (197.77, 324.94) mas
     134: ( -0.8,  -4.4) m, (200.89, 342.41) mas
      13: ( -2.2,  -4.8) m, (219.22, 357.61) mas
sa index   location       noise equivalent angle
    3803: ( -2.6,   4.4) m, (170.91, 173.39) mas
    3712: ( -2.5,   4.1) m, (172.32, 176.64) mas
    3382: ( -1.9,   3.2) m, (177.41, 187.68) mas
    2988: ( -1.4,   2.2) m, (184.31, 202.20) mas
    2534: ( -0.8,   1.2) m, (192.30, 218.61) mas
    2053: (  1.2,   0.1) m, (222.63, 237.65) mas
    1384: (  0.7,  -1.4) m, (215.78, 266.72) mas
     929: (  1.2,  -2.3) m, (225.41, 286.32) mas
     534: (  1.8,  -3.3) m, (235.48, 306.54) mas
     203: (  2.3,  -4.3) m, (246.03, 327.39) mas
     112: (  2.5,  -4.6) m, (249.07, 334.04) mas
sa index   location       noise equivalent angle
    2710: ( -4.7,   1.7) m, (181.01, 173.91) mas
    2513: ( -3.7,   1.2) m, (188.12, 174.08) mas
    2452: ( -3.3,   1.1) m, (193.84, 175.63) mas
    2235: ( -1.8,   0.6) m, (218.63, 182.91) mas
    2177: ( -1.4,   0.4) m, (227.31, 185.37) mas
    1379: (  0.0,  -1.4) m, (259.93, 214.28) mas
    1742: (  1.2,  -0.6) m, (276.85, 200.53) mas
    1683: (  1.7,  -0.7) m, (285.73, 203.07) mas
    1466: (  3.2,  -1.2) m, (316.38, 212.31) mas
    1274: (  4.3,  -1.7) m, (339.91, 219.55) mas
    1770: (  5.1,  -0.6) m, (353.44, 208.71) mas
sa index   location       noise equivalent angle
    1141: ( -4.7,  -1.8) m, (181.01, 173.91) mas
    1352: ( -3.7,  -1.4) m, (188.12, 174.08) mas
    1423: ( -3.3,  -1.2) m, (193.84, 175.63) mas
    1674: ( -1.8,  -0.7) m, (218.63, 182.91) mas
    1739: ( -1.4,  -0.6) m, (227.31, 185.37) mas
    2540: (  0.0,   1.2) m, (259.61, 214.03) mas
    2180: (  1.2,   0.4) m, (276.85, 200.53) mas
    2244: (  1.7,   0.6) m, (285.73, 203.07) mas
    2495: (  3.2,   1.1) m, (316.38, 212.31) mas
    2707: (  4.3,   1.5) m, (339.91, 219.55) mas
    2208: (  5.1,   0.4) m, (353.44, 208.71) mas
sa index   location       noise equivalent angle
      75: ( -2.6,  -4.6) m, (170.91, 173.39) mas
     168: ( -2.5,  -4.3) m, (172.32, 176.64) mas
     507: ( -1.9,  -3.3) m, (177.41, 187.68) mas
     910: ( -1.4,  -2.3) m, (184.31, 202.20) mas
    1373: ( -0.8,  -1.4) m, (192.30, 218.61) mas
    1867: (  1.2,  -0.3) m, (222.63, 237.65) mas
    2545: (  0.7,   1.2) m, (215.78, 266.72) mas
    3007: (  1.2,   2.2) m, (225.41, 286.32) mas
    3409: (  1.8,   3.2) m, (235.48, 306.54) mas
    3747: (  2.3,   4.1) m, (246.03, 327.39) mas
    3840: (  2.5,   4.4) m, (249.07, 334.04) mas
sa index   location       noise equivalent angle
      23: (  0.7,  -4.8) m, (170.50, 178.22) mas
     145: (  0.7,  -4.4) m, (170.90, 181.43) mas
     695: (  0.4,  -2.9) m, (175.03, 204.23) mas
    1043: (  0.3,  -2.1) m, (195.66, 245.23) mas
    1380: (  0.1,  -1.4) m, (180.31, 232.82) mas
    2114: ( -1.4,   0.3) m, (196.15, 263.21) mas
    2538: ( -0.3,   1.2) m, (189.48, 282.46) mas
    2874: ( -0.4,   1.9) m, (213.30, 333.30) mas
    3494: ( -0.7,   3.5) m, (197.77, 324.94) mas
    3770: ( -0.8,   4.3) m, (200.89, 342.41) mas
    3885: ( -2.2,   4.7) m, (226.57, 366.85) mas
sa index   location       noise equivalent angle
     605: (  3.7,  -3.2) m, (174.70, 173.59) mas
     772: (  3.2,  -2.8) m, (178.23, 175.98) mas
    1058: (  2.3,  -2.1) m, (189.41, 184.61) mas
    1323: (  1.7,  -1.5) m, (200.42, 192.95) mas
    1564: (  1.0,  -1.0) m, (212.19, 201.83) mas
    2543: (  0.4,   1.2) m, (222.01, 238.07) mas
    2354: ( -1.1,   0.8) m, (248.83, 231.41) mas
    2595: ( -1.8,   1.4) m, (262.48, 241.81) mas
    2859: ( -2.5,   1.9) m, (276.51, 252.55) mas
    3145: ( -3.3,   2.6) m, (293.80, 266.33) mas
    3708: ( -3.0,   4.1) m, (287.43, 295.31) mas

[00;00mSetting up powfs 2 PO WFS[00;00m

OTF dimension is 48x48 (calculated)
Generating matched filter for powfs 2
Use sanea to derive neasim
Use sanea to derive neasim

[00;00mSetting up reconstructor[00;00m

Recon NEA: cmf(235.57) cmf(236.18) cmf(235.21) cmf(236.02) cmf(235.42) cmf(235.38) cmf(235.92) cmf(235.10) cmf(236.11) geom(0.31) geom(0.31) geom(0.31) mf(0.14)  mas
Setup or update control matrix parameters.
RRtwfs svd threshold is 1e-10
Replacing HA by HA*fit->actextrap
Adding piston cr to fit matrix
Adding TT cr on upper DMs to fit matrix.
Before assembling fit matrix:	5788.9 MiB.
Building fit->FR
Building fit->FL
Adding tikhonov constraint of 1.0e-07 to FLM
The maximum eigen value is estimated to be around 2.6e-04
DM Fit number of Low rank terms: 16 in LHS
After assemble fit matrix:	7924.5 MiB.
After setup_recon:	7924.5 MiB.
GPU 0: mem used 1776 MB (wfs init)
GPU 0: mem used 3086 MB (recon init)
GPU 0: mem used 3116 MB (perf init)

*** Simulation started at 2025/02/17 15:37:00 in nid001972. ***

Running seed 1
GPU 0: mem used 3116 MB (wfs seeding)
Wind dir: 267.3 261.7 167.0 130.5 300.7  32.3 119.8 139.0 150.8 277.7 203.0 133.1  45.9 265.1 deg
Using /global/homes/b/bpeck/.aos/cache/atm/vonkarman_14_8192x8192_0.0078125_1115374592d.bin
After genatm:	7714.4 MiB.
Step     #  Open Loop  PR TT  On axis  PR TT  Field RMS PR TT     Timing 
Step     0: OL  884.6  248.3  OA  884.6 248.3 CL  884.6 248.3 nm  0.110 s
Step    12: OL  903.2  253.0  OA  132.7  17.9 CL  132.7  17.9 nm  0.082 s
Step    24: OL  922.1  257.1  OA  120.5  37.7 CL  120.5  37.7 nm  0.098 s
Step    35: OL  939.2  259.7  OA  115.8  15.4 CL  115.8  15.4 nm  0.089 s
Step    46: OL  955.7  261.0  OA  113.9  25.7 CL  113.9  25.7 nm  0.091 s
Step    57: OL  971.9  261.0  OA  118.2  12.1 CL  118.2  12.1 nm  0.099 s
Step    68: OL  988.3  260.0  OA  109.2  28.7 CL  109.2  28.7 nm  0.090 s
Step    79: OL 1005.0  258.8  OA  122.2  39.5 CL  122.2  39.5 nm  0.092 s
Step    90: OL 1021.9  258.0  OA  115.6  15.7 CL  115.6  15.7 nm  0.093 s
Step   101: OL 1038.8  257.4  OA  125.7  11.0 CL  125.7  11.0 nm  0.090 s
Step   112: OL 1055.6  257.8  OA  110.9  15.3 CL  110.9  15.3 nm  0.089 s
Step   123: OL 1072.1  258.9  OA  118.0  19.2 CL  118.0  19.2 nm  0.102 s
Step   134: OL 1087.6  261.4  OA  115.7  31.2 CL  115.7  31.2 nm  0.090 s
Step   145: OL 1102.4  265.3  OA  110.9  19.3 CL  110.9  19.3 nm  0.089 s
Step   156: OL 1115.6  270.1  OA  109.4   9.2 CL  109.4   9.2 nm  0.091 s
Step   167: OL 1127.4  276.1  OA  105.0   9.6 CL  105.0   9.6 nm  0.092 s
Step   178: OL 1137.6  282.7  OA  110.3  19.3 CL  110.3  19.3 nm  0.092 s
Step   189: OL 1145.8  289.8  OA  104.8  11.7 CL  104.8  11.7 nm  0.092 s
Step   200: OL 1152.1  296.9  OA  115.1  36.1 CL  115.1  36.1 nm  0.097 s
Step   211: OL 1157.2  303.9  OA  107.0   8.8 CL  107.0   8.8 nm  0.094 s
Step   222: OL 1160.6  311.0  OA  109.5   9.9 CL  109.5   9.9 nm  0.091 s
Step   233: OL 1162.2  318.2  OA  110.0   7.0 CL  110.0   7.0 nm  0.090 s
Step   244: OL 1162.0  325.7  OA  107.2  12.5 CL  107.2  12.5 nm  0.092 s
Step   255: OL 1159.2  333.5  OA  109.0  13.6 CL  109.0  13.6 nm  0.093 s
Step   255 updated high order loop gain: 0.341
Step   266: OL 1153.4  341.4  OA  114.9  31.1 CL  114.9  31.1 nm  0.093 s
Step   277: OL 1145.1  349.4  OA  102.5  20.2 CL  102.5  20.2 nm  0.098 s
Step   288: OL 1135.0  357.9  OA  107.3  30.5 CL  107.3  30.5 nm  0.090 s
Step   299: OL 1123.7  367.2  OA  116.5  37.2 CL  116.5  37.2 nm  0.092 s
Step   310: OL 1111.4  377.2  OA  109.0  24.8 CL  109.0  24.8 nm  0.097 s
Step   321: OL 1097.6  387.7  OA  113.6  32.9 CL  113.6  32.9 nm  0.090 s
Step   332: OL 1083.2  399.3  OA  108.8  21.4 CL  108.8  21.4 nm  0.090 s
Step   343: OL 1068.6  412.1  OA  107.7  27.6 CL  107.7  27.6 nm  0.100 s
Step   354: OL 1054.0  426.2  OA  106.3  21.7 CL  106.3  21.7 nm  0.090 s
Step   365: OL 1040.1  441.4  OA  112.6  28.6 CL  112.6  28.6 nm  0.091 s
Step   376: OL 1026.9  457.1  OA  114.9  23.1 CL  114.9  23.1 nm  0.096 s
Step   387: OL 1014.2  473.1  OA  122.4  42.6 CL  122.4  42.6 nm  0.091 s
Step   398: OL 1001.8  488.9  OA  116.6  36.6 CL  116.6  36.6 nm  0.090 s
Step   409: OL  989.3  504.5  OA  110.1  25.2 CL  110.1  25.2 nm  0.092 s
Step   420: OL  976.5  519.5  OA  114.7  29.3 CL  114.7  29.3 nm  0.090 s
Step   431: OL  963.8  534.1  OA  110.1  30.7 CL  110.1  30.7 nm  0.089 s
Step   442: OL  951.7  548.6  OA  112.1  23.4 CL  112.1  23.4 nm  0.092 s
Step   453: OL  940.8  562.8  OA  113.2  29.2 CL  113.2  29.2 nm  0.091 s
Step   464: OL  932.2  577.3  OA  111.1  19.5 CL  111.1  19.5 nm  0.092 s
Step   475: OL  926.3  591.5  OA  108.4  21.6 CL  108.4  21.6 nm  0.091 s
Step   486: OL  923.6  605.3  OA  120.2  43.8 CL  120.2  43.8 nm  0.091 s
Step 491, DM 2: 1 actuators over ia limit. trials=2: success.
Step 492, DM 2: 1 actuators over ia limit. trials=2: success.
Step 493, DM 2: 1 actuators over ia limit. trials=2: success.
Step 494, DM 2: 1 actuators over ia limit. trials=2: success.
Step 495, DM 2: 1 actuators over ia limit. trials=2: success.
Step 496, DM 2: 1 actuators over ia limit. trials=2: success.
Step   497: OL  923.5  618.5  OA  114.6  36.6 CL  114.6  36.6 nm  0.092 s
Step 497, DM 2: 1 actuators over ia limit. trials=2: success.
Step 499, DM 2: 1 actuators over ia limit. trials=2: success.
Step 500, DM 2: 1 actuators over ia limit. trials=2: success.
Step 501, DM 2: 1 actuators over ia limit. trials=2: success.
Step 502, DM 2: 1 actuators over ia limit. trials=2: success.
Step 503, DM 2: 1 actuators over ia limit. trials=2: success.
Step 504, DM 2: 1 actuators over ia limit. trials=2: success.
Step 505, DM 2: 1 actuators over ia limit. trials=2: success.
Step 506, DM 2: 1 actuators over ia limit. trials=2: success.
Step 507, DM 2: 1 actuators over ia limit. trials=2: success.
Step   508: OL  924.9  630.8  OA  116.4  27.5 CL  116.4  27.5 nm  0.090 s
Step 508, DM 2: 1 actuators over ia limit. trials=2: success.
Step 509, DM 2: 1 actuators over ia limit. trials=2: success.
Step 510, DM 2: 1 actuators over ia limit. trials=2: success.
Step   511 updated high order loop gain: 0.294
Step 511, DM 2: 1 actuators over ia limit. trials=2: success.
Step 512, DM 2: 1 actuators over ia limit. trials=2: success.
Step 513, DM 2: 1 actuators over ia limit. trials=2: success.
Step 514, DM 2: 1 actuators over ia limit. trials=2: success.
Step 515, DM 2: 1 actuators over ia limit. trials=2: success.
Step 516, DM 2: 1 actuators over ia limit. trials=2: success.
Step 517, DM 2: 1 actuators over ia limit. trials=2: success.
Step 518, DM 2: 1 actuators over ia limit. trials=2: success.
Step   519: OL  928.2  641.9  OA  124.5  38.8 CL  124.5  38.8 nm  0.092 s
Step 519, DM 2: 1 actuators over ia limit. trials=2: success.
Step 520, DM 2: 1 actuators over ia limit. trials=2: success.
Step 521, DM 2: 1 actuators over ia limit. trials=2: success.
Step 522, DM 2: 1 actuators over ia limit. trials=2: success.
Step 523, DM 2: 1 actuators over ia limit. trials=2: success.
Step 524, DM 2: 1 actuators over ia limit. trials=2: success.
Step 525, DM 2: 1 actuators over ia limit. trials=2: success.
Step 526, DM 2: 1 actuators over ia limit. trials=2: success.
Step 527, DM 2: 1 actuators over ia limit. trials=2: success.
Step 528, DM 2: 1 actuators over ia limit. trials=2: success.
Step 529, DM 2: 1 actuators over ia limit. trials=2: success.
Step   530: OL  932.5  651.2  OA  112.9  18.2 CL  112.9  18.2 nm  0.103 s
Step 530, DM 2: 1 actuators over ia limit. trials=2: success.
Step 531, DM 2: 1 actuators over ia limit. trials=2: success.
Step 532, DM 2: 1 actuators over ia limit. trials=2: success.
Step 533, DM 2: 1 actuators over ia limit. trials=2: success.
Step 534, DM 2: 1 actuators over ia limit. trials=2: success.
Step 535, DM 2: 1 actuators over ia limit. trials=2: success.
Step 536, DM 2: 1 actuators over ia limit. trials=2: success.
Step 537, DM 2: 1 actuators over ia limit. trials=2: success.
Step 538, DM 2: 1 actuators over ia limit. trials=2: success.
Step 539, DM 2: 1 actuators over ia limit. trials=2: success.
Step 540, DM 2: 1 actuators over ia limit. trials=2: success.
Step   541: OL  938.4  658.5  OA  117.5  32.9 CL  117.5  32.9 nm  0.091 s
Step 541, DM 2: 1 actuators over ia limit. trials=2: success.
Step 542, DM 2: 1 actuators over ia limit. trials=2: success.
Step 543, DM 2: 1 actuators over ia limit. trials=2: success.
Step 544, DM 2: 1 actuators over ia limit. trials=2: success.
Step 545, DM 2: 1 actuators over ia limit. trials=2: success.
Step 546, DM 2: 1 actuators over ia limit. trials=2: success.
Step 547, DM 2: 1 actuators over ia limit. trials=2: success.
Step 548, DM 2: 1 actuators over ia limit. trials=2: success.
Step 549, DM 2: 1 actuators over ia limit. trials=2: success.
Step 550, DM 2: 1 actuators over ia limit. trials=2: success.
Step 551, DM 2: 1 actuators over ia limit. trials=2: success.
Step   552: OL  946.0  663.9  OA  114.8  15.3 CL  114.8  15.3 nm  0.090 s
Step 552, DM 2: 1 actuators over ia limit. trials=2: success.
Step 553, DM 2: 1 actuators over ia limit. trials=2: success.
Step 554, DM 2: 1 actuators over ia limit. trials=2: success.
Step 555, DM 2: 1 actuators over ia limit. trials=2: success.
Step 556, DM 2: 1 actuators over ia limit. trials=2: success.
Step 557, DM 2: 1 actuators over ia limit. trials=2: success.
Step 558, DM 2: 1 actuators over ia limit. trials=2: success.
Step 559, DM 2: 1 actuators over ia limit. trials=2: success.
Step 560, DM 2: 1 actuators over ia limit. trials=2: success.
Step 561, DM 2: 1 actuators over ia limit. trials=2: success.
Step 562, DM 2: 1 actuators over ia limit. trials=2: success.
Step   563: OL  955.2  667.5  OA  111.5  25.2 CL  111.5  25.2 nm  0.112 s
Step 563, DM 2: 1 actuators over ia limit. trials=2: success.
Step 564, DM 2: 1 actuators over ia limit. trials=2: success.
Step 565, DM 2: 1 actuators over ia limit. trials=2: success.
Step 566, DM 2: 1 actuators over ia limit. trials=2: success.
Step 567, DM 2: 1 actuators over ia limit. trials=2: success.
Step 568, DM 2: 1 actuators over ia limit. trials=2: success.
Step 569, DM 2: 1 actuators over ia limit. trials=2: success.
Step 570, DM 2: 1 actuators over ia limit. trials=2: success.
Step 571, DM 2: 1 actuators over ia limit. trials=2: success.
Step 572, DM 2: 1 actuators over ia limit. trials=2: success.
Step 573, DM 2: 1 actuators over ia limit. trials=2: success.
Step   574: OL  965.4  669.7  OA  109.6  23.0 CL  109.6  23.0 nm  0.092 s
Step 574, DM 2: 1 actuators over ia limit. trials=2: success.
Step 575, DM 2: 1 actuators over ia limit. trials=2: success.
Step 576, DM 2: 1 actuators over ia limit. trials=2: success.
Step 577, DM 2: 1 actuators over ia limit. trials=2: success.
Step 578, DM 2: 1 actuators over ia limit. trials=2: success.
Step 579, DM 2: 1 actuators over ia limit. trials=2: success.
Step 580, DM 2: 1 actuators over ia limit. trials=2: success.
Step 581, DM 2: 1 actuators over ia limit. trials=2: success.
Step 582, DM 2: 1 actuators over ia limit. trials=2: success.
Step 583, DM 2: 1 actuators over ia limit. trials=2: success.
Step 584, DM 2: 1 actuators over ia limit. trials=2: success.
Step   585: OL  976.7  670.6  OA  111.4  17.5 CL  111.4  17.5 nm  0.091 s
Step 585, DM 2: 1 actuators over ia limit. trials=2: success.
Step 586, DM 2: 1 actuators over ia limit. trials=2: success.
Step 587, DM 2: 1 actuators over ia limit. trials=2: success.
Step 588, DM 2: 1 actuators over ia limit. trials=2: success.
Step 589, DM 2: 1 actuators over ia limit. trials=2: success.
Step 590, DM 2: 1 actuators over ia limit. trials=2: success.
Step 591, DM 2: 1 actuators over ia limit. trials=2: success.
Step 592, DM 2: 1 actuators over ia limit. trials=2: success.
Step 593, DM 2: 1 actuators over ia limit. trials=2: success.
Step 594, DM 2: 1 actuators over ia limit. trials=2: success.
Step 595, DM 2: 1 actuators over ia limit. trials=2: success.
Step   596: OL  989.2  669.7  OA  117.8  19.9 CL  117.8  19.9 nm  0.098 s
Step 596, DM 2: 1 actuators over ia limit. trials=2: success.
Step 597, DM 2: 1 actuators over ia limit. trials=2: success.
Step 598, DM 2: 1 actuators over ia limit. trials=2: success.
Step 599, DM 2: 1 actuators over ia limit. trials=2: success.
Step 600, DM 2: 1 actuators over ia limit. trials=2: success.
Step 601, DM 2: 1 actuators over ia limit. trials=2: success.
Step 602, DM 2: 1 actuators over ia limit. trials=2: success.
Step 603, DM 2: 1 actuators over ia limit. trials=2: success.
Step 604, DM 2: 1 actuators over ia limit. trials=2: success.
Step 605, DM 2: 1 actuators over ia limit. trials=2: success.
Step 606, DM 2: 1 actuators over ia limit. trials=2: success.
Step   607: OL 1002.1  666.7  OA  112.0  11.7 CL  112.0  11.7 nm  0.093 s
Step 607, DM 2: 1 actuators over ia limit. trials=2: success.
Step 608, DM 2: 1 actuators over ia limit. trials=2: success.
Step 609, DM 2: 1 actuators over ia limit. trials=2: success.
Step 610, DM 2: 1 actuators over ia limit. trials=2: success.
Step 611, DM 2: 1 actuators over ia limit. trials=2: success.
Step 612, DM 2: 1 actuators over ia limit. trials=2: success.
Step 613, DM 2: 1 actuators over ia limit. trials=2: success.
Step 614, DM 2: 1 actuators over ia limit. trials=2: success.
Step 615, DM 2: 1 actuators over ia limit. trials=2: success.
Step   618: OL 1015.3  661.8  OA  111.3  23.4 CL  111.3  23.4 nm  0.092 s
Step   629: OL 1028.3  655.3  OA  111.3  18.9 CL  111.3  18.9 nm  0.089 s
Step   640: OL 1040.8  647.0  OA  108.7  14.7 CL  108.7  14.7 nm  0.092 s
Step   651: OL 1052.3  637.6  OA  109.1   6.8 CL  109.1   6.8 nm  0.093 s
Step   662: OL 1062.9  627.1  OA  108.4  12.6 CL  108.4  12.6 nm  0.099 s
Step   667: OL 1067.5  622.0  OA  108.5  16.5 CL  108.5  16.5 nm  0.091 s
Step   678: OL 1077.2  610.5  OA  105.5   4.2 CL  105.5   4.2 nm  0.094 s
Step   689: OL 1086.5  599.0  OA  109.2  19.0 CL  109.2  19.0 nm  0.090 s
Step   700: OL 1094.5  586.8  OA  113.5   4.2 CL  113.5   4.2 nm  0.090 s
Step   711: OL 1100.9  573.7  OA  114.4   5.2 CL  114.4   5.2 nm  0.096 s
Step   722: OL 1105.0  560.1  OA  108.4  11.3 CL  108.4  11.3 nm  0.099 s
Step   733: OL 1107.1  546.5  OA  109.9  19.1 CL  109.9  19.1 nm  0.093 s
Step   744: OL 1106.9  532.9  OA  110.1  15.8 CL  110.1  15.8 nm  0.090 s
Step   755: OL 1104.7  519.7  OA  109.4   4.1 CL  109.4   4.1 nm  0.090 s
Step   766: OL 1100.4  506.8  OA  104.6  10.6 CL  104.6  10.6 nm  0.092 s
Step   767 updated high order loop gain: 0.275
Step   775: OL 1095.3  496.6  OA  108.9  19.4 CL  108.9  19.4 nm  0.098 s
Step   786: OL 1086.8  484.2  OA  106.4  16.9 CL  106.4  16.9 nm  0.089 s
Step   797: OL 1076.2  472.0  OA  105.4   8.2 CL  105.4   8.2 nm  0.090 s
Step   808: OL 1064.1  459.7  OA  109.1  13.3 CL  109.1  13.3 nm  0.097 s
Step   819: OL 1050.1  447.4  OA  108.9  15.0 CL  108.9  15.0 nm  0.090 s
Step   830: OL 1034.6  435.3  OA  105.4   6.8 CL  105.4   6.8 nm  0.092 s
Step   841: OL 1017.7  423.7  OA  106.6   3.5 CL  106.6   3.5 nm  0.094 s
Step   852: OL 1000.3  412.6  OA  110.1  18.4 CL  110.1  18.4 nm  0.093 s
Step   863: OL  982.8  402.4  OA  109.6  21.2 CL  109.6  21.2 nm  0.092 s
Step   874: OL  965.7  393.1  OA  103.7   6.0 CL  103.7   6.0 nm  0.094 s
Step   885: OL  949.5  384.9  OA  106.3   2.8 CL  106.3   2.8 nm  0.090 s
Step   896: OL  932.8  377.5  OA  105.7  11.0 CL  105.7  11.0 nm  0.096 s
Step   907: OL  915.5  370.9  OA  109.8  13.7 CL  109.8  13.7 nm  0.092 s
Step   918: OL  897.8  365.4  OA  104.7   9.0 CL  104.7   9.0 nm  0.090 s
Step   929: OL  880.2  360.1  OA  106.0   9.4 CL  106.0   9.4 nm  0.099 s
Step   940: OL  863.0  354.9  OA  108.8   9.9 CL  108.8   9.9 nm  0.090 s
Step   951: OL  846.5  349.6  OA  109.9   6.8 CL  109.9   6.8 nm  0.091 s
Step   961: OL  832.4  344.4  OA  105.6   7.4 CL  105.6   7.4 nm  0.091 s
Step   972: OL  818.7  338.2  OA  107.9   9.3 CL  107.9   9.3 nm  0.097 s
Step   983: OL  806.4  331.4  OA  109.8  33.0 CL  109.8  33.0 nm  0.089 s
Step   994: OL  795.3  323.9  OA  104.1  10.9 CL  104.1  10.9 nm  0.099 s
Step  1005: OL  784.8  315.9  OA  107.9  12.9 CL  107.9  12.9 nm  0.090 s
Step  1016: OL  775.4  307.5  OA  107.8  15.7 CL  107.8  15.7 nm  0.098 s
Step  1023 updated high order loop gain: 0.265
Step  1027: OL  767.2  299.0  OA  111.8  24.9 CL  111.8  24.9 nm  0.091 s
Step  1038: OL  760.0  290.0  OA  116.3  20.7 CL  116.3  20.7 nm  0.094 s
Step  1049: OL  753.4  280.4  OA  110.6  26.9 CL  110.6  26.9 nm  0.090 s
Step  1060: OL  746.7  270.0  OA  107.1  17.7 CL  107.1  17.7 nm  0.090 s
Step  1071: OL  740.9  258.5  OA  112.7  39.3 CL  112.7  39.3 nm  0.094 s
Step  1082: OL  736.6  245.8  OA  107.8  20.2 CL  107.8  20.2 nm  0.090 s
Step  1093: OL  733.9  233.1  OA  112.8  31.8 CL  112.8  31.8 nm  0.093 s
Step  1104: OL  732.3  221.1  OA  116.2  38.0 CL  116.2  38.0 nm  0.097 s
Step  1115: OL  731.7  210.0  OA  109.8  33.6 CL  109.8  33.6 nm  0.090 s
Step  1126: OL  731.6  200.0  OA  108.1  25.5 CL  108.1  25.5 nm  0.093 s
Step  1137: OL  731.8  191.6  OA  102.1  18.5 CL  102.1  18.5 nm  0.099 s
Step  1148: OL  732.3  184.4  OA  107.1  24.3 CL  107.1  24.3 nm  0.090 s
Step  1159: OL  732.7  178.5  OA  107.1  32.1 CL  107.1  32.1 nm  0.091 s
Step  1170: OL  733.1  174.1  OA  106.3  19.3 CL  106.3  19.3 nm  0.098 s
Step  1181: OL  734.3  171.0  OA  104.3  19.5 CL  104.3  19.5 nm  0.091 s
Step  1192: OL  736.5  168.5  OA  100.9  13.9 CL  100.9  13.9 nm  0.089 s
Step  1203: OL  739.2  166.3  OA  104.8  14.9 CL  104.8  14.9 nm  0.097 s
Step  1214: OL  742.0  164.5  OA  107.4   5.2 CL  107.4   5.2 nm  0.092 s
Step  1225: OL  744.9  163.5  OA  105.4   7.5 CL  105.4   7.5 nm  0.090 s
Step  1236: OL  747.4  163.6  OA  106.0  10.4 CL  106.0  10.4 nm  0.092 s
Step  1247: OL  749.5  165.3  OA  103.6  19.5 CL  103.6  19.5 nm  0.092 s
Step  1258: OL  752.2  168.5  OA  106.1  22.3 CL  106.1  22.3 nm  0.091 s
Step  1269: OL  755.3  173.2  OA  103.8  13.6 CL  103.8  13.6 nm  0.098 s
Step  1279 updated high order loop gain: 0.254
Step  1280: OL  759.1  179.0  OA  103.7  13.2 CL  103.7  13.2 nm  0.096 s
Step  1291: OL  763.8  185.6  OA  106.0   9.1 CL  106.0   9.1 nm  0.091 s
Step  1302: OL  768.5  193.0  OA  106.7  15.3 CL  106.7  15.3 nm  0.100 s
Step  1313: OL  773.0  201.1  OA  106.4  10.2 CL  106.4  10.2 nm  0.089 s
Step  1324: OL  777.3  210.0  OA  103.8  20.4 CL  103.8  20.4 nm  0.091 s
Step  1335: OL  782.2  219.6  OA  109.9  27.5 CL  109.9  27.5 nm  0.091 s
Step  1346: OL  788.1  229.6  OA   99.9  10.9 CL   99.9  10.9 nm  0.092 s
Step  1357: OL  795.2  239.5  OA  102.9  16.9 CL  102.9  16.9 nm  0.099 s
Step  1368: OL  803.0  248.3  OA  105.4  29.6 CL  105.4  29.6 nm  0.091 s
Step  1379: OL  811.3  255.6  OA  103.4  31.7 CL  103.4  31.7 nm  0.090 s
Step  1390: OL  820.2  261.7  OA  107.0  14.3 CL  107.0  14.3 nm  0.099 s
Step  1401: OL  830.0  266.6  OA  106.7  20.8 CL  106.7  20.8 nm  0.090 s
Step  1412: OL  840.5  270.3  OA  102.8  13.9 CL  102.8  13.9 nm  0.090 s
Step  1423: OL  851.4  273.2  OA  108.0  35.6 CL  108.0  35.6 nm  0.097 s
Step  1434: OL  862.1  275.6  OA  100.5  16.7 CL  100.5  16.7 nm  0.091 s
Step  1445: OL  872.1  277.7  OA  105.7  24.5 CL  105.7  24.5 nm  0.088 s
Step  1456: OL  881.6  279.0  OA  100.1  17.4 CL  100.1  17.4 nm  0.097 s
Step  1467: OL  889.8  279.4  OA  107.2  21.9 CL  107.2  21.9 nm  0.091 s
Step  1478: OL  895.7  278.5  OA  104.8  15.1 CL  104.8  15.1 nm  0.092 s
Step  1489: OL  898.9  276.3  OA  102.4  10.8 CL  102.4  10.8 nm  0.090 s
Step  1500: OL  899.6  272.8  OA  102.1   7.5 CL  102.1   7.5 nm  0.091 s
Step  1511: OL  898.4  268.3  OA  101.5   3.1 CL  101.5   3.1 nm  0.094 s
Step  1522: OL  895.8  263.0  OA  102.8   5.1 CL  102.8   5.1 nm  0.089 s
Step  1533: OL  891.3  256.9  OA  103.5   9.9 CL  103.5   9.9 nm  0.090 s
Step  1535 updated high order loop gain: 0.253
Step  1544: OL  885.5  249.9  OA  104.6  15.3 CL  104.6  15.3 nm  0.098 s
Step  1555: OL  879.4  242.6  OA  103.7  13.3 CL  103.7  13.3 nm  0.088 s
Step  1566: OL  873.3  235.5  OA  104.7  11.6 CL  104.7  11.6 nm  0.118 s
Step  1577: OL  866.8  229.2  OA  106.5   7.1 CL  106.5   7.1 nm  0.096 s
Step  1588: OL  859.5  223.9  OA  111.7  19.8 CL  111.7  19.8 nm  0.090 s
Step 1599: Output PSF
Step  1599: OL  852.1  219.3  OA  110.7  22.3 CL  110.7  22.3 nm  1.329 s
Mean: 108.61 21.32 106.50  nm.

*** Simulation Finished at 2025/02/17 15:39:38 in nid001972. ***

[00;00m>>>>>>>>>>>>>>>>[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
/global/cfs/cdirs/ulens/vismcao/maos -o studies/reduced_ngs/9_lgs/8mag_lgs/5250count -c master_files/reduced_ngs/9_lgs/8mag_lgs/kola_5250act.conf -O 
Output folder is 'studies/reduced_ngs/9_lgs/8mag_lgs/5250count'.
SRC: /global/homes/b/bpeck/code/maos v2.9 4c88b7c2 2024-11-13 16:45:33 -0800
BUILT: /global/homes/b/bpeck/code/maos/optim by GCC (v12) on 2024/11/18 09:40:03 CPU(F64,+O3) with CUDA(v122,F32)
Launched at 2025/02/17 15:39:39 in nid001972 with PID 1701247.
The web based job monitor can be accessed at http://localhost:10300
Main config file is /global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_5250act.conf
[00;00m[0;36mWarning(path.c:48): Path not found: path=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; abspath=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; Ignored.
[00;00m[0;36mWarning(path.c:48): Path not found: path=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; abspath=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; Ignored.
[00;00m[0;36mWarning(readcfg.c:399): sim.apfsm has been renamed to powfs.apfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.epfsm has been renamed to powfs.epfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.alfsm has been renamed to powfs.alfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.commonfsm has been renamed to powfs.commonfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.idealfsm has been renamed to powfs.idealfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.zetafsm has been renamed to powfs.zetafsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.f0fsm has been renamed to powfs.f0fsm.
[00;00m[0;36mWarning(readcfg.c:399): tsurf has been renamed to ncpa.tsurf.
loaded 132 (132 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_sim.conf'
loaded  19 ( 19 new) records from '/global/cfs/cdirs/ulens/vismcao/./dm_none.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_ASM.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_DM2.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_DM3.conf'
loaded   0 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_dm_multiple.conf'
loaded   7 (  5 new) records from '/global/cfs/cdirs/ulens/vismcao/./atm_mk13n50p_ground_detail.conf'
loaded  76 ( 69 new) records from '/global/homes/b/bpeck/code/maos/config/maos/powfs_common.conf'
loaded  44 ( 38 new) records from '/global/cfs/cdirs/ulens/vismcao/./powfs_none.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_lgs.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_ttf_strap.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_twfs_lbwfs.conf'
loaded   0 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_wfs_lgs_strap_lbwfs.conf'
loaded  71 ( 71 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_recon.conf'
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_smooth has been renamed to powfs0_llt.na_smooth.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_interp has been renamed to powfs0_llt.na_interp.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_thres has been renamed to powfs0_llt.na_thres.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_maxit has been renamed to powfs0_llt.na_fit_maxit.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_svdthres has been renamed to powfs0_llt.na_fit_svdthres.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_dh has been renamed to powfs0_llt.na_fit_dh.
[00;00m[0;36mWarning(readcfg.c:399): dbg.ncpa_preload has been renamed to ncpa.preload.
[00;00m[0;36mWarning(readcfg.c:399): dbg.ncpa_rmsci has been renamed to ncpa.rmsci.
[00;00m[0;36mWarning(readcfg.c:399): dbg.draw_opdmax has been renamed to plot.opdmax.
[00;00m[0;36mWarning(readcfg.c:399): dbg.draw_gmax has been renamed to plot.gmax.
loaded  95 ( 93 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_dbg.conf'
loaded   4 (  4 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_fit_mcao.conf'
[00;00m[0;36mWarning(readcfg.c:399): surf has been renamed to ncpa.surf.
loaded  39 (  7 new) records from '/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_5250act.conf'
loaded   0 (  0 new) records from 'command line'
loaded  24 ( 18 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_llt_CL.conf'
Adjust LGS range by telescope altitude 4145m.
Zenith angle is 30 degree.
    Scaling turbulence height and LGS hs by sec(za).
    Scaling r0 by cos(za)^(3/5).
    Scaling wind speed and LGS signal level by cos(za).
powfs0: Adjusting dx from 0.0078125 to 0.0075. 
powfs0.llt.fsm: f0=0 Hz, LPF ep=0
powfs0.epfsm is set to 0.517618 (auto)
powfs2: Adjusting dx from 0.03125 to 0.0312778. 
powfs2 is TWFS for powfs0
sim.ephi is set to 0.427717 (auto)
sim.eplo is set to 0.427717 (auto)
[00;00m[0;36mWarning(parms.c:2296): Layer 1 at 17.3205m is very close to layer 0 at 0m (OK).
[00;00m[0;36mWarning(parms.c:2296): Layer 2 at 34.641m is very close to layer 1 at 17.3205m (OK).
[00;00m[0;36mWarning(parms.c:2296): Layer 3 at 51.9615m is very close to layer 2 at 34.641m (OK).
dm 0: stroke=30 um is provided in micron.
dm 0: assume ia stroke=2 um is provided in micron.
dm 1: stroke=7 um is provided in micron.
dm 1: assume ia stroke=2 um is provided in micron.
dm 2: stroke=7 um is provided in micron.
dm 2: assume ia stroke=2 um is provided in micron.
Focus blending is not implemented yet for integrated tomography
parms->sim.mffocus is reset to 0
There are 1 valid simulation seeds:  1
Output PSF for 1 directions
Used 449 of 456 supplied keys
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_flate" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_flatv" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_psx" is not recognized, value is [0 0 0 0]
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_psy" is not recognized, value is [0 0 0 0]
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_pupelong" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_raw" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_side" is not recognized, value is 4
[00;00mAperture[00;00m is 11 m with sampling 1/128 m
[00;00mTurbulence at 30 degree zenith angle:[00;00m r0=0.128424m, L0=30m, 14 layers.
    Greenwood freq is 25.1Hz, anisoplanatic angle is 1.58 as
    Sampled 8192x8192 at 1/128m. wind dir is randomized.
    layer 0: ht=      0 m, wt= 0.302, ws=  4.8 m/s
    layer 1: ht=     17 m, wt= 0.154, ws=  5.0 m/s
    layer 2: ht=     35 m, wt= 0.041, ws=  5.4 m/s
    layer 3: ht=     52 m, wt= 0.002, ws=  6.6 m/s
    layer 4: ht=    139 m, wt= 0.021, ws=  6.1 m/s
    layer 5: ht=    231 m, wt= 0.010, ws=  6.1 m/s
    layer 6: ht=    323 m, wt= 0.008, ws=  6.1 m/s
    layer 7: ht=    416 m, wt= 0.005, ws=  6.1 m/s
    layer 8: ht=    508 m, wt= 0.001, ws=  6.1 m/s
    layer 9: ht=    932 m, wt= 0.107, ws=  5.6 m/s
    layer 10: ht=   5022 m, wt= 0.144, ws= 11.1 m/s
    layer 11: ht=   9238 m, wt= 0.093, ws= 19.1 m/s
    layer 12: ht=  13856 m, wt= 0.075, ws=  8.2 m/s
    layer 13: ht=  22518 m, wt= 0.036, ws=  4.8 m/s
[00;00mReconstruction[00;00m: r0=0.128424m L0=30m. 14 layers. use cone coordinate.
    layer 0: ht=      0 m, wt= 0.302
    layer 1: ht=     17 m, wt= 0.154
    layer 2: ht=     35 m, wt= 0.041
    layer 3: ht=     52 m, wt= 0.002
    layer 4: ht=    139 m, wt= 0.021
    layer 5: ht=    231 m, wt= 0.010
    layer 6: ht=    323 m, wt= 0.008
    layer 7: ht=    416 m, wt= 0.005
    layer 8: ht=    508 m, wt= 0.001
    layer 9: ht=    932 m, wt= 0.107
    layer 10: ht=   5022 m, wt= 0.144
    layer 11: ht=   9238 m, wt= 0.093
    layer 12: ht=  13856 m, wt= 0.075
    layer 13: ht=  22518 m, wt= 0.036
[00;00mThere are 3 powfs[00;00m
  powfs0: Order 82, LGS at 99.1 km. Sampling 1/133.333 m. Thres 30%. [00;00mT/T is removed in right hand side in tomography.[00;00m
    CCD image is 25x25 @ 500x500 mas, blur 27% (sigma), 1500Hz, wvl: [ 5.89e-07]
    Gtilt in reconstruction. Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
  powfs1: Order  2, NGS at inf km. Sampling 1/16 m. Thres 30%. 
    Ztilt in reconstruction. Geomtric optics start at 2 with ztilt [00;00m(noisy)[00;00m
  powfs2: Order 20, NGS at inf km. Sampling 1/31.9716 m. Thres 50%. 
    CCD image is 4x4 @ 1500x1500 mas, blur 0% (sigma), 0.015Hz, wvl: [ 7.2e-07]
    Gtilt in reconstruction. Geomtric optics start at 50 with gtilt Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
[00;00mThere are 13 wfs[00;00m
    wfs 0: type 0, at (  30.00,    0.00) arcsec,  99 km, siglev is 21.8524 bkgrnd is 0.1
    wfs 1: type 0, at (  22.98,   19.28) arcsec,  99 km, siglev is 21.8524 bkgrnd is 0.1
    wfs 2: type 0, at (   5.21,   29.54) arcsec,  99 km, siglev is 21.8524 bkgrnd is 0.1
    wfs 3: type 0, at ( -15.00,   25.98) arcsec,  99 km, siglev is 21.8524 bkgrnd is 0.1
    wfs 4: type 0, at ( -28.19,   10.26) arcsec,  99 km, siglev is 21.8524 bkgrnd is 0.1
    wfs 5: type 0, at ( -28.19,  -10.26) arcsec,  99 km, siglev is 21.8524 bkgrnd is 0.1
    wfs 6: type 0, at ( -15.00,  -25.98) arcsec,  99 km, siglev is 21.8524 bkgrnd is 0.1
    wfs 7: type 0, at (   5.21,  -29.54) arcsec,  99 km, siglev is 21.8524 bkgrnd is 0.1
    wfs 8: type 0, at (  22.98,  -19.28) arcsec,  99 km, siglev is 21.8524 bkgrnd is 0.1
    wfs 9: type 1, at (   5.00,    8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 10: type 1, at ( -10.00,    0.00) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 11: type 1, at (   5.00,   -8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 12: type 2, at (   0.00,    0.00) arcsec, inf km, siglev is 4.1558e+06 bkgrnd is 0.001
[00;00mThere are 3 DMs[00;00m
  DM 0 at -0.1km, actuator pitch 0.135m, offset   0, with 30.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 1 at    6km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 2 at   10km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
[00;00mTomography[00;00m is using CG, with [00;00mFourer Domain[00;00m preconditioner, [00;00m12[00;00m iterations, integrated tomo.
[00;00mDM Fitting [00;00mis using CG, with [00;00mNo[00;00m preconditioner, [00;00m10[00;00m iterations
[00;00mThere are 9 fit directions[00;00m
    Fit 0: weight is 0.444, at (   0.00,    0.00) arcsec
    Fit 1: weight is 0.111, at (  15.00,    0.00) arcsec
    Fit 2: weight is 0.111, at (   0.00,   15.00) arcsec
    Fit 3: weight is 0.111, at ( -15.00,    0.00) arcsec
    Fit 4: weight is 0.111, at (   0.00,  -15.00) arcsec
    Fit 5: weight is 0.028, at (  15.00,   15.00) arcsec
    Fit 6: weight is 0.028, at ( -15.00,   15.00) arcsec
    Fit 7: weight is 0.028, at ( -15.00,  -15.00) arcsec
    Fit 8: weight is 0.028, at (  15.00,  -15.00) arcsec
[00;00mThere are 1 evaluation directions[00;00m at sampling 1/128 m.
    Evl 0: weight is 1.000, at (   0.00,    0.00) arcsec
[00;00mSimulation[00;00m start at step 0, end at step 1600, with time step 1/1500s, [00;00mclose loop[00;00m.
After setup_parms:	120.5 MiB.
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
CUDA: minimum memory requirement is 0.4GB
GPU 0 is NVIDIA A100-SXM4-40GB with arch 8.0, 38.9GB free, 39.3GB total device memory.
Using GPU 0
Use 1 GPUs for WFS Tomo Fit Evl

*** Preparation started at 2025/02/17 15:39:40 in nid001972. ***

Using OpenMP version 201511 with 128 threads
Reading aperture amplitude map from KECK.fits
[00;00m[0;36mWarning(accphi.c:477): 108139 points not covered by input screen
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
 ->start.S:122->maos.c:456->maos.c:447->setup.c:148->aper.c:74->utils.c:478->accphi.c:478
iwvl 0: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 1: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 2: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 3: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 4: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 5: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 6: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 7: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 8: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
After setup_aper:	341.1 MiB.

[00;00mSetting up powfs 0 geom[00;00m

There are 18 points in each subaperture of 0.135m.
There are 4078 valid subaperture.

[00;00mSetting up powfs 1 geom[00;00m

There are 88 points in each subaperture of 5.5m.
There are 4 valid subaperture.

[00;00mSetting up powfs 2 geom[00;00m

There are 18 points in each subaperture of 0.563m.
There are 236 valid subaperture.
After setup_powfs_init:	432.9 MiB.

[00;00mSetting up reconstructor geometry.[00;00m

PLOC is 167x167, with sampling of 0.07m (square)
    DM 0: grid is 85 x 85
    DM 1: grid is 75 x 75
    DM 2: grid is 80 x 79
FLOC is 167x167, with sampling of 0.07m (not square)
Tomography grid is square:
    layer 0: xloc grid is 300 x 300, sampling is 0.068 m, 90000 points
    layer 1: xloc grid is 300 x 300, sampling is 0.067 m, 90000 points
    layer 2: xloc grid is 300 x 300, sampling is 0.067 m, 90000 points
    layer 3: xloc grid is 300 x 300, sampling is 0.067 m, 90000 points
    layer 4: xloc grid is 300 x 300, sampling is 0.067 m, 90000 points
    layer 5: xloc grid is 300 x 300, sampling is 0.067 m, 90000 points
    layer 6: xloc grid is 300 x 300, sampling is 0.067 m, 90000 points
    layer 7: xloc grid is 300 x 300, sampling is 0.067 m, 90000 points
    layer 8: xloc grid is 300 x 300, sampling is 0.067 m, 90000 points
    layer 9: xloc grid is 300 x 300, sampling is 0.067 m, 90000 points
    layer 10: xloc grid is 300 x 300, sampling is 0.064 m, 90000 points
    layer 11: xloc grid is 300 x 300, sampling is 0.061 m, 90000 points
    layer 12: xloc grid is 300 x 300, sampling is 0.058 m, 90000 points
    layer 13: xloc grid is 300 x 300, sampling is 0.052 m, 90000 points

[00;00mSetting up powfs 0 PO WFS[00;00m

OTF dimension is 36x36 (calculated)
Uplink FWHM (illt 0, iwvl 0) is 0.576822"
Downlink FWHM (illt 0, iwvl 0) is 0"
Generating matched filter for powfs 0
sa index   location       noise equivalent angle
    2036: (  4.9,  -0.1) m, (5000.00, 5000.00) mas
    2028: (  3.8,  -0.1) m, (5000.00, 5000.00) mas
    2020: (  2.7,  -0.1) m, (5000.00, 5000.00) mas
    2011: (  1.5,  -0.1) m, (5000.00, 5000.00) mas
    2010: (  1.4,  -0.1) m, (5000.00, 5000.00) mas
    1442: ( -0.5,  -1.4) m, (5000.00, 5000.00) mas
    2005: ( -1.8,  -0.1) m, (5000.00, 5000.00) mas
    1997: ( -2.8,  -0.1) m, (5000.00, 5000.00) mas
    1989: ( -3.9,  -0.1) m, (5000.00, 5000.00) mas
    1981: ( -5.0,  -0.1) m, (5000.00, 5000.00) mas
    1978: ( -5.4,  -0.1) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    3543: (  3.6,   3.1) m, (5000.00, 5000.00) mas
    3307: (  3.1,   2.6) m, (5000.00, 5000.00) mas
    3001: (  2.3,   1.9) m, (5000.00, 5000.00) mas
    2718: (  1.6,   1.4) m, (5000.00, 5000.00) mas
    2449: (  0.9,   0.8) m, (5000.00, 5000.00) mas
    1449: (  0.4,  -1.4) m, (5000.00, 5000.00) mas
    1632: ( -1.1,  -0.9) m, (5000.00, 5000.00) mas
    1363: ( -1.8,  -1.5) m, (5000.00, 5000.00) mas
    1080: ( -2.4,  -2.0) m, (5000.00, 5000.00) mas
     774: ( -3.2,  -2.7) m, (5000.00, 5000.00) mas
     153: ( -3.1,  -4.3) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    4066: (  0.8,   4.7) m, (5000.00, 5000.00) mas
    3910: (  0.7,   4.2) m, (5000.00, 5000.00) mas
    3345: (  0.4,   2.7) m, (5000.00, 5000.00) mas
    2986: (  0.3,   1.9) m, (5000.00, 5000.00) mas
    2637: (  0.1,   1.2) m, (5000.00, 5000.00) mas
    1880: ( -1.4,  -0.4) m, (5000.00, 5000.00) mas
    1233: ( -0.4,  -1.8) m, (5000.00, 5000.00) mas
    1095: ( -0.4,  -2.0) m, (5000.00, 5000.00) mas
     452: ( -0.7,  -3.5) m, (5000.00, 5000.00) mas
     170: ( -0.8,  -4.3) m, (5000.00, 5000.00) mas
       9: ( -2.3,  -4.9) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    3932: ( -2.6,   4.3) m, (5000.00, 5000.00) mas
    3841: ( -2.4,   4.1) m, (5000.00, 5000.00) mas
    3502: ( -1.9,   3.1) m, (5000.00, 5000.00) mas
    3099: ( -1.4,   2.2) m, (5000.00, 5000.00) mas
    2630: ( -0.8,   1.2) m, (5000.00, 5000.00) mas
    2137: (  1.2,   0.1) m, (5000.00, 5000.00) mas
    1451: (  0.7,  -1.4) m, (5000.00, 5000.00) mas
     982: (  1.2,  -2.3) m, (5000.00, 5000.00) mas
     579: (  1.8,  -3.2) m, (5000.00, 5000.00) mas
     239: (  2.3,  -4.2) m, (5000.00, 5000.00) mas
     148: (  2.4,  -4.5) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    2882: ( -4.6,   1.8) m, (5000.00, 5000.00) mas
    2609: ( -3.6,   1.2) m, (5000.00, 5000.00) mas
    2548: ( -3.2,   1.1) m, (5000.00, 5000.00) mas
    2323: ( -1.8,   0.5) m, (5000.00, 5000.00) mas
    2263: ( -1.4,   0.4) m, (5000.00, 5000.00) mas
    2508: (  0.8,   0.9) m, (5000.00, 5000.00) mas
    1818: (  1.2,  -0.5) m, (5000.00, 5000.00) mas
    1758: (  1.6,  -0.7) m, (5000.00, 5000.00) mas
    1533: (  3.1,  -1.2) m, (5000.00, 5000.00) mas
    1337: (  4.2,  -1.6) m, (5000.00, 5000.00) mas
    1847: (  5.1,  -0.5) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    1132: ( -4.6,  -1.9) m, (5000.00, 5000.00) mas
    1419: ( -3.6,  -1.4) m, (5000.00, 5000.00) mas
    1492: ( -3.2,  -1.2) m, (5000.00, 5000.00) mas
    1749: ( -1.8,  -0.7) m, (5000.00, 5000.00) mas
    1815: ( -1.4,  -0.5) m, (5000.00, 5000.00) mas
    1576: (  0.8,  -1.1) m, (5000.00, 5000.00) mas
    2266: (  1.2,   0.4) m, (5000.00, 5000.00) mas
    2332: (  1.6,   0.5) m, (5000.00, 5000.00) mas
    2589: (  3.1,   1.1) m, (5000.00, 5000.00) mas
    2807: (  4.2,   1.5) m, (5000.00, 5000.00) mas
    2295: (  5.1,   0.4) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
     111: ( -2.6,  -4.5) m, (5000.00, 5000.00) mas
     204: ( -2.4,  -4.2) m, (5000.00, 5000.00) mas
     552: ( -1.9,  -3.2) m, (5000.00, 5000.00) mas
     963: ( -1.4,  -2.3) m, (5000.00, 5000.00) mas
    1440: ( -0.8,  -1.4) m, (5000.00, 5000.00) mas
    1945: (  1.2,  -0.3) m, (5000.00, 5000.00) mas
    2641: (  0.7,   1.2) m, (5000.00, 5000.00) mas
    3118: (  1.2,   2.2) m, (5000.00, 5000.00) mas
    3529: (  1.8,   3.1) m, (5000.00, 5000.00) mas
    3876: (  2.3,   4.1) m, (5000.00, 5000.00) mas
    3969: (  2.4,   4.3) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
      19: (  0.8,  -4.9) m, (5000.00, 5000.00) mas
     181: (  0.7,  -4.3) m, (5000.00, 5000.00) mas
     743: (  0.4,  -2.8) m, (5000.00, 5000.00) mas
    1100: (  0.3,  -2.0) m, (5000.00, 5000.00) mas
    1377: (  0.1,  -1.5) m, (5000.00, 5000.00) mas
    2200: ( -1.4,   0.3) m, (5000.00, 5000.00) mas
    2634: ( -0.3,   1.2) m, (5000.00, 5000.00) mas
    2981: ( -0.4,   1.9) m, (5000.00, 5000.00) mas
    3620: ( -0.7,   3.4) m, (5000.00, 5000.00) mas
    3899: ( -0.8,   4.2) m, (5000.00, 5000.00) mas
    4056: ( -2.3,   4.7) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
     593: (  3.6,  -3.2) m, (5000.00, 5000.00) mas
     821: (  3.1,  -2.7) m, (5000.00, 5000.00) mas
    1115: (  2.3,  -2.0) m, (5000.00, 5000.00) mas
    1388: (  1.6,  -1.5) m, (5000.00, 5000.00) mas
    1635: (  0.9,  -0.9) m, (5000.00, 5000.00) mas
    2639: (  0.4,   1.2) m, (5000.00, 5000.00) mas
    2446: ( -1.1,   0.8) m, (5000.00, 5000.00) mas
    2693: ( -1.8,   1.4) m, (5000.00, 5000.00) mas
    2966: ( -2.4,   1.9) m, (5000.00, 5000.00) mas
    3260: ( -3.2,   2.6) m, (5000.00, 5000.00) mas
    3882: ( -3.1,   4.2) m, (5000.00, 5000.00) mas

[00;00mSetting up powfs 2 PO WFS[00;00m

OTF dimension is 48x48 (calculated)
Generating matched filter for powfs 2
Use sanea to derive neasim
Use sanea to derive neasim

[00;00mSetting up reconstructor[00;00m

Recon NEA: cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) geom(0.31) geom(0.31) geom(0.31) mf(0.14)  mas
Setup or update control matrix parameters.
RRtwfs svd threshold is 1e-10
Replacing HA by HA*fit->actextrap
Adding piston cr to fit matrix
Adding TT cr on upper DMs to fit matrix.
Before assembling fit matrix:	6103.1 MiB.
Building fit->FR
Building fit->FL
Adding tikhonov constraint of 1.0e-07 to FLM
The maximum eigen value is estimated to be around 2.6e-04
DM Fit number of Low rank terms: 16 in LHS
After assemble fit matrix:	8320.6 MiB.
After setup_recon:	8320.6 MiB.
GPU 0: mem used 1636 MB (wfs init)
GPU 0: mem used 3012 MB (recon init)
GPU 0: mem used 3042 MB (perf init)

*** Simulation started at 2025/02/17 15:41:29 in nid001972. ***

Running seed 1
GPU 0: mem used 3042 MB (wfs seeding)
Wind dir: 267.3 261.7 167.0 130.5 300.7  32.3 119.8 139.0 150.8 277.7 203.0 133.1  45.9 265.1 deg
Using /global/homes/b/bpeck/.aos/cache/atm/vonkarman_14_8192x8192_0.0078125_1115374592d.bin
After genatm:	7981.9 MiB.
Step     #  Open Loop  PR TT  On axis  PR TT  Field RMS PR TT     Timing 
Step     0: OL  884.6  248.3  OA  884.6 248.3 CL  884.6 248.3 nm  0.161 s
Step    12: OL  903.0  253.0  OA  788.6 248.3 CL  788.6 248.3 nm  0.085 s
Step    24: OL  921.6  257.1  OA  796.1 246.7 CL  796.1 246.7 nm  0.102 s
Step    35: OL  938.5  259.8  OA  796.5 244.0 CL  796.5 244.0 nm  0.094 s
Step    46: OL  954.9  261.2  OA  795.6 239.7 CL  795.6 239.7 nm  0.103 s
Step    57: OL  971.2  261.1  OA  790.8 234.7 CL  790.8 234.7 nm  0.095 s
Step    68: OL  987.9  260.2  OA  787.0 228.4 CL  787.0 228.4 nm  0.105 s
Step    79: OL 1004.9  259.0  OA  784.2 222.9 CL  784.2 222.9 nm  0.095 s
Step    90: OL 1022.5  258.2  OA  783.3 217.0 CL  783.3 217.0 nm  0.102 s
Step   101: OL 1040.0  257.7  OA  783.1 212.7 CL  783.1 212.7 nm  0.095 s
Step   112: OL 1057.7  258.1  OA  786.6 207.9 CL  786.6 207.9 nm  0.102 s
Step   123: OL 1075.0  259.3  OA  790.9 203.8 CL  790.9 203.8 nm  0.094 s
Step   134: OL 1091.4  261.8  OA  796.8 200.4 CL  796.8 200.4 nm  0.094 s
Step   145: OL 1107.1  265.7  OA  802.4 198.9 CL  802.4 198.9 nm  0.100 s
Step   156: OL 1121.3  270.6  OA  807.0 198.3 CL  807.0 198.3 nm  0.096 s
Step   167: OL 1134.2  276.6  OA  811.0 199.0 CL  811.0 199.0 nm  0.100 s
Step   178: OL 1145.6  283.3  OA  815.0 200.8 CL  815.0 200.8 nm  0.093 s
Step   189: OL 1155.1  290.4  OA  816.4 204.7 CL  816.4 204.7 nm  0.103 s
Step   200: OL 1163.0  297.6  OA  818.4 209.2 CL  818.4 209.2 nm  0.096 s
Step   211: OL 1169.8  304.6  OA  821.8 214.3 CL  821.8 214.3 nm  0.101 s
Step   222: OL 1175.1  311.7  OA  824.6 219.7 CL  824.6 219.7 nm  0.094 s
Step   233: OL 1179.0  318.9  OA  830.0 225.6 CL  830.0 225.6 nm  0.095 s
Step   244: OL 1181.3  326.4  OA  832.2 233.4 CL  832.2 233.4 nm  0.094 s
Step   255: OL 1181.2  334.3  OA  836.5 241.5 CL  836.5 241.5 nm  0.094 s
Step   255 updated high order loop gain: 0.425
Step   266: OL 1178.4  342.3  OA  838.0 250.3 CL  838.0 250.3 nm  0.095 s
Step   277: OL 1173.1  350.2  OA  839.0 260.1 CL  839.0 260.1 nm  0.098 s
Step   288: OL 1166.0  358.7  OA  840.0 270.7 CL  840.0 270.7 nm  0.095 s
Step   299: OL 1157.9  368.1  OA  838.8 281.2 CL  838.8 281.2 nm  0.094 s
Step   310: OL 1148.7  378.1  OA  839.6 293.5 CL  839.6 293.5 nm  0.095 s
Step   320: OL 1138.9  387.6  OA  839.7 304.8 CL  839.7 304.8 nm  0.102 s
Step   331: OL 1127.2  399.1  OA  839.8 318.3 CL  839.8 318.3 nm  0.094 s
Step   342: OL 1115.4  411.9  OA  839.9 332.6 CL  839.9 332.6 nm  0.096 s
Step   353: OL 1103.3  425.9  OA  840.6 348.7 CL  840.6 348.7 nm  0.097 s
Step   364: OL 1091.5  441.0  OA  844.3 365.3 CL  844.3 365.3 nm  0.094 s
Step   375: OL 1080.0  456.7  OA  848.8 382.6 CL  848.8 382.6 nm  0.098 s
Step   386: OL 1068.8  472.6  OA  851.9 400.1 CL  851.9 400.1 nm  0.095 s
Step   397: OL 1057.6  488.5  OA  855.4 417.3 CL  855.4 417.3 nm  0.098 s
Step   408: OL 1046.0  504.1  OA  859.1 433.8 CL  859.1 433.8 nm  0.097 s
Step   419: OL 1033.7  519.2  OA  861.5 450.5 CL  861.5 450.5 nm  0.093 s
Step   430: OL 1021.3  533.8  OA  862.7 466.6 CL  862.7 466.6 nm  0.107 s
Step   441: OL 1009.2  548.3  OA  863.1 482.1 CL  863.1 482.1 nm  0.095 s
Step   452: OL  997.8  562.5  OA  862.6 497.2 CL  862.6 497.2 nm  0.100 s
Step   463: OL  988.2  577.0  OA  863.2 512.4 CL  863.2 512.4 nm  0.095 s
Step   474: OL  980.8  591.2  OA  865.6 526.7 CL  865.6 526.7 nm  0.100 s
Step   485: OL  976.2  605.0  OA  871.9 541.9 CL  871.9 541.9 nm  0.095 s
Step   496: OL  974.0  618.3  OA  880.2 555.9 CL  880.2 555.9 nm  0.096 s
Step   507: OL  973.1  630.7  OA  889.4 569.1 CL  889.4 569.1 nm  0.095 s
Step   511 updated high order loop gain: 0.426
Step   518: OL  973.5  642.0  OA  898.0 579.9 CL  898.0 579.9 nm  0.094 s
Step   529: OL  975.1  651.4  OA  906.1 588.7 CL  906.1 588.7 nm  0.108 s
Step   540: OL  978.1  658.9  OA  912.9 594.8 CL  912.9 594.8 nm  0.095 s
Step   551: OL  982.7  664.4  OA  921.2 598.8 CL  921.2 598.8 nm  0.102 s
Step   562: OL  988.7  668.2  OA  927.5 601.6 CL  927.5 601.6 nm  0.096 s
Step   573: OL  996.0  670.5  OA  932.7 601.9 CL  932.7 601.9 nm  0.097 s
Step   584: OL 1004.5  671.5  OA  937.0 600.6 CL  937.0 600.6 nm  0.091 s
Step   595: OL 1014.4  670.8  OA  941.2 597.1 CL  941.2 597.1 nm  0.111 s
Step   606: OL 1024.8  668.0  OA  945.4 592.1 CL  945.4 592.1 nm  0.101 s
Step   617: OL 1035.7  663.2  OA  946.1 583.8 CL  946.1 583.8 nm  0.096 s
Step   628: OL 1046.7  656.9  OA  944.8 575.2 CL  944.8 575.2 nm  0.095 s
Step   639: OL 1057.2  648.8  OA  942.4 564.3 CL  942.4 564.3 nm  0.094 s
Step   650: OL 1066.7  639.4  OA  937.3 551.6 CL  937.3 551.6 nm  0.102 s
Step   661: OL 1075.1  629.0  OA  930.9 538.5 CL  930.9 538.5 nm  0.094 s
Step   672: OL 1082.8  617.7  OA  923.0 523.8 CL  923.0 523.8 nm  0.095 s
Step   683: OL 1090.0  606.3  OA  915.2 507.5 CL  915.2 507.5 nm  0.095 s
Step   694: OL 1096.4  594.5  OA  907.3 489.8 CL  907.3 489.8 nm  0.095 s
Step   705: OL 1101.3  581.9  OA  899.3 470.9 CL  899.3 470.9 nm  0.094 s
Step   716: OL 1104.5  568.5  OA  891.2 449.4 CL  891.2 449.4 nm  0.095 s
Step   727: OL 1105.6  554.9  OA  881.8 428.0 CL  881.8 428.0 nm  0.100 s
Step   738: OL 1104.7  541.4  OA  873.7 407.8 CL  873.7 407.8 nm  0.094 s
Step   748: OL 1102.1  529.0  OA  865.6 389.3 CL  865.6 389.3 nm  0.094 s
Step   759: OL 1097.6  516.0  OA  856.0 369.5 CL  856.0 369.5 nm  0.100 s
Step   767 updated high order loop gain: 0.427
Step   770: OL 1091.3  503.3  OA  845.7 351.7 CL  845.7 351.7 nm  0.093 s
Step   781: OL 1083.0  490.9  OA  835.3 334.4 CL  835.3 334.4 nm  0.104 s
Step   792: OL 1072.5  478.6  OA  824.4 317.9 CL  824.4 317.9 nm  0.093 s
Step   802: OL 1061.5  467.4  OA  814.0 303.9 CL  814.0 303.9 nm  0.096 s
Step   813: OL 1048.1  455.2  OA  803.5 289.4 CL  803.5 289.4 nm  0.093 s
Step   824: OL 1033.0  443.0  OA  793.0 275.1 CL  793.0 275.1 nm  0.095 s
Step   835: OL 1016.6  431.0  OA  782.4 262.7 CL  782.4 262.7 nm  0.093 s
Step   846: OL  999.6  419.7  OA  772.0 251.4 CL  772.0 251.4 nm  0.093 s
Step   857: OL  982.7  408.9  OA  762.4 242.8 CL  762.4 242.8 nm  0.100 s
Step   868: OL  966.5  399.1  OA  755.0 236.1 CL  755.0 236.1 nm  0.097 s
Step   879: OL  951.6  390.3  OA  747.5 232.9 CL  747.5 232.9 nm  0.101 s
Step   890: OL  937.4  382.5  OA  741.6 231.6 CL  741.6 231.6 nm  0.094 s
Step   901: OL  923.0  375.4  OA  734.3 231.4 CL  734.3 231.4 nm  0.098 s
Step   912: OL  908.2  369.3  OA  725.6 234.2 CL  725.6 234.2 nm  0.093 s
Step   923: OL  893.6  364.0  OA  716.2 236.7 CL  716.2 236.7 nm  0.093 s
Step   934: OL  879.5  358.7  OA  705.8 239.9 CL  705.8 239.9 nm  0.095 s
Step   945: OL  865.9  353.4  OA  695.2 242.7 CL  695.2 242.7 nm  0.096 s
Step   956: OL  853.1  347.9  OA  686.4 244.6 CL  686.4 244.6 nm  0.102 s
Step   967: OL  842.0  342.0  OA  679.1 247.5 CL  679.1 247.5 nm  0.093 s
Step   978: OL  832.5  335.4  OA  672.7 248.2 CL  672.7 248.2 nm  0.104 s
Step   989: OL  824.2  328.2  OA  668.4 247.7 CL  668.4 247.7 nm  0.095 s
Step  1000: OL  816.5  320.4  OA  665.2 245.8 CL  665.2 245.8 nm  0.093 s
Step  1011: OL  809.3  312.0  OA  660.0 243.0 CL  660.0 243.0 nm  0.096 s
Step  1022: OL  803.0  303.6  OA  654.4 239.5 CL  654.4 239.5 nm  0.095 s
Step  1023 updated high order loop gain: 0.427
Step  1033: OL  797.4  294.8  OA  649.4 235.6 CL  649.4 235.6 nm  0.094 s
Step  1043: OL  792.7  286.4  OA  646.1 230.4 CL  646.1 230.4 nm  0.093 s
Step  1054: OL  787.1  276.5  OA  639.2 223.9 CL  639.2 223.9 nm  0.099 s
Step  1065: OL  781.4  265.6  OA  632.9 216.0 CL  632.9 216.0 nm  0.094 s
Step  1076: OL  776.6  253.5  OA  627.0 205.6 CL  627.0 205.6 nm  0.093 s
Step  1087: OL  772.9  240.7  OA  621.7 193.7 CL  621.7 193.7 nm  0.095 s
Step  1098: OL  770.3  228.1  OA  616.3 182.0 CL  616.3 182.0 nm  0.095 s
Step  1109: OL  768.4  216.6  OA  612.3 170.1 CL  612.3 170.1 nm  0.098 s
Step  1120: OL  767.2  205.9  OA  610.8 159.4 CL  610.8 159.4 nm  0.094 s
Step  1131: OL  766.2  196.7  OA  611.1 150.4 CL  611.1 150.4 nm  0.100 s
Step  1142: OL  765.2  188.9  OA  609.8 142.1 CL  609.8 142.1 nm  0.095 s
Step  1153: OL  764.3  182.2  OA  611.6 135.9 CL  611.6 135.9 nm  0.100 s
Step  1164: OL  763.0  177.0  OA  613.1 131.7 CL  613.1 131.7 nm  0.095 s
Step  1175: OL  761.9  173.3  OA  616.3 128.7 CL  616.3 128.7 nm  0.093 s
Step  1186: OL  761.6  170.6  OA  619.9 126.2 CL  619.9 126.2 nm  0.092 s
Step  1197: OL  761.8  168.2  OA  625.3 124.1 CL  625.3 124.1 nm  0.094 s
Step  1208: OL  761.8  166.2  OA  631.1 122.1 CL  631.1 122.1 nm  0.101 s
Step  1218: OL  762.0  164.7  OA  635.0 121.1 CL  635.0 121.1 nm  0.093 s
Step  1229: OL  762.1  164.1  OA  640.1 120.8 CL  640.1 120.8 nm  0.095 s
Step  1240: OL  761.4  164.8  OA  641.5 122.3 CL  641.5 122.3 nm  0.100 s
Step  1251: OL  760.7  166.9  OA  645.0 124.6 CL  645.0 124.6 nm  0.095 s
Step  1262: OL  760.7  170.7  OA  646.9 128.8 CL  646.9 128.8 nm  0.098 s
Step  1273: OL  761.0  175.8  OA  648.8 133.2 CL  648.8 133.2 nm  0.094 s
Step  1279 updated high order loop gain: 0.428
Step  1284: OL  762.1  181.9  OA  649.5 138.5 CL  649.5 138.5 nm  0.093 s
Step  1295: OL  764.1  188.8  OA  650.8 142.9 CL  650.8 142.9 nm  0.095 s
Step  1306: OL  766.0  196.4  OA  648.6 147.8 CL  648.6 147.8 nm  0.093 s
Step  1317: OL  767.7  204.8  OA  646.6 152.9 CL  646.6 152.9 nm  0.099 s
Step  1328: OL  769.8  213.9  OA  643.5 157.4 CL  643.5 157.4 nm  0.095 s
Step  1339: OL  773.0  223.7  OA  639.0 163.7 CL  639.0 163.7 nm  0.102 s
Step  1350: OL  777.4  233.7  OA  636.3 168.6 CL  636.3 168.6 nm  0.095 s
Step  1361: OL  783.2  243.3  OA  635.7 172.4 CL  635.7 172.4 nm  0.103 s
Step  1372: OL  789.7  251.5  OA  634.8 175.3 CL  634.8 175.3 nm  0.095 s
Step  1383: OL  796.9  258.4  OA  635.6 176.9 CL  635.6 176.9 nm  0.094 s
Step  1394: OL  805.0  264.1  OA  638.5 177.8 CL  638.5 177.8 nm  0.095 s
Step  1405: OL  814.1  268.5  OA  640.8 177.2 CL  640.8 177.2 nm  0.095 s
Step  1416: OL  824.1  271.8  OA  644.8 176.7 CL  644.8 176.7 nm  0.100 s
Step  1427: OL  834.4  274.5  OA  647.7 176.6 CL  647.7 176.6 nm  0.093 s
Step  1438: OL  844.4  276.8  OA  649.7 175.5 CL  649.7 175.5 nm  0.101 s
Step  1449: OL  854.1  278.6  OA  651.4 175.5 CL  651.4 175.5 nm  0.095 s
Step  1459: OL  862.3  279.6  OA  649.4 174.6 CL  649.4 174.6 nm  0.096 s
Step  1470: OL  870.0  279.6  OA  649.1 175.1 CL  649.1 175.1 nm  0.095 s
Step  1481: OL  875.3  278.3  OA  649.0 174.8 CL  649.0 174.8 nm  0.096 s
Step  1492: OL  878.3  275.8  OA  645.3 175.3 CL  645.3 175.3 nm  0.102 s
Step  1503: OL  879.0  272.0  OA  641.2 174.5 CL  641.2 174.5 nm  0.094 s
Step  1514: OL  877.9  267.3  OA  633.3 174.2 CL  633.3 174.2 nm  0.102 s
Step  1525: OL  875.5  261.8  OA  629.1 174.1 CL  629.1 174.1 nm  0.096 s
Step  1535 updated high order loop gain: 0.428
Step  1536: OL  871.5  255.4  OA  623.7 173.0 CL  623.7 173.0 nm  0.120 s
Step  1547: OL  866.8  248.3  OA  620.5 171.9 CL  620.5 171.9 nm  0.093 s
Step  1558: OL  861.8  240.9  OA  619.8 170.3 CL  619.8 170.3 nm  0.092 s
Step  1569: OL  856.8  234.1  OA  618.7 170.2 CL  618.7 170.2 nm  0.094 s
Step  1580: OL  851.3  228.0  OA  618.3 171.5 CL  618.3 171.5 nm  0.095 s
Step  1591: OL  845.4  223.0  OA  620.8 173.6 CL  620.8 173.6 nm  0.104 s
Step 1599: Output PSF
Step  1599: OL  840.9  219.7  OA  622.1 175.8 CL  622.1 175.8 nm  1.628 s
Mean: 753.97 337.06 674.43  nm.

*** Simulation Finished at 2025/02/17 15:44:13 in nid001972. ***

[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
/global/cfs/cdirs/ulens/vismcao/maos -o studies/reduced_ngs/9_lgs/8mag_lgs/5500count -c master_files/reduced_ngs/9_lgs/8mag_lgs/kola_5500act.conf -O 
Output folder is 'studies/reduced_ngs/9_lgs/8mag_lgs/5500count'.
SRC: /global/homes/b/bpeck/code/maos v2.9 4c88b7c2 2024-11-13 16:45:33 -0800
BUILT: /global/homes/b/bpeck/code/maos/optim by GCC (v12) on 2024/11/18 09:40:03 CPU(F64,+O3) with CUDA(v122,F32)
Launched at 2025/02/17 15:44:14 in nid001972 with PID 1701784.
The web based job monitor can be accessed at http://localhost:10300
Main config file is /global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_5500act.conf
[00;00m[0;36mWarning(path.c:48): Path not found: path=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; abspath=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; Ignored.
[00;00m[0;36mWarning(path.c:48): Path not found: path=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; abspath=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; Ignored.
[00;00m[0;36mWarning(readcfg.c:399): sim.apfsm has been renamed to powfs.apfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.epfsm has been renamed to powfs.epfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.alfsm has been renamed to powfs.alfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.commonfsm has been renamed to powfs.commonfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.idealfsm has been renamed to powfs.idealfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.zetafsm has been renamed to powfs.zetafsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.f0fsm has been renamed to powfs.f0fsm.
[00;00m[0;36mWarning(readcfg.c:399): tsurf has been renamed to ncpa.tsurf.
loaded 132 (132 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_sim.conf'
loaded  19 ( 19 new) records from '/global/cfs/cdirs/ulens/vismcao/./dm_none.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_ASM.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_DM2.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_DM3.conf'
loaded   0 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_dm_multiple.conf'
loaded   7 (  5 new) records from '/global/cfs/cdirs/ulens/vismcao/./atm_mk13n50p_ground_detail.conf'
loaded  76 ( 69 new) records from '/global/homes/b/bpeck/code/maos/config/maos/powfs_common.conf'
loaded  44 ( 38 new) records from '/global/cfs/cdirs/ulens/vismcao/./powfs_none.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_lgs.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_ttf_strap.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_twfs_lbwfs.conf'
loaded   0 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_wfs_lgs_strap_lbwfs.conf'
loaded  71 ( 71 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_recon.conf'
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_smooth has been renamed to powfs0_llt.na_smooth.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_interp has been renamed to powfs0_llt.na_interp.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_thres has been renamed to powfs0_llt.na_thres.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_maxit has been renamed to powfs0_llt.na_fit_maxit.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_svdthres has been renamed to powfs0_llt.na_fit_svdthres.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_dh has been renamed to powfs0_llt.na_fit_dh.
[00;00m[0;36mWarning(readcfg.c:399): dbg.ncpa_preload has been renamed to ncpa.preload.
[00;00m[0;36mWarning(readcfg.c:399): dbg.ncpa_rmsci has been renamed to ncpa.rmsci.
[00;00m[0;36mWarning(readcfg.c:399): dbg.draw_opdmax has been renamed to plot.opdmax.
[00;00m[0;36mWarning(readcfg.c:399): dbg.draw_gmax has been renamed to plot.gmax.
loaded  95 ( 93 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_dbg.conf'
loaded   4 (  4 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_fit_mcao.conf'
[00;00m[0;36mWarning(readcfg.c:399): surf has been renamed to ncpa.surf.
loaded  39 (  7 new) records from '/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_5500act.conf'
loaded   0 (  0 new) records from 'command line'
loaded  24 ( 18 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_llt_CL.conf'
Adjust LGS range by telescope altitude 4145m.
Zenith angle is 30 degree.
    Scaling turbulence height and LGS hs by sec(za).
    Scaling r0 by cos(za)^(3/5).
    Scaling wind speed and LGS signal level by cos(za).
powfs0: Adjusting dx from 0.0078125 to 0.0081875. 
powfs0.llt.fsm: f0=0 Hz, LPF ep=0
powfs0.epfsm is set to 0.517618 (auto)
powfs2: Adjusting dx from 0.03125 to 0.0312778. 
powfs2 is TWFS for powfs0
sim.ephi is set to 0.427717 (auto)
sim.eplo is set to 0.427717 (auto)
[00;00m[0;36mWarning(parms.c:2296): Layer 1 at 17.3205m is very close to layer 0 at 0m (OK).
[00;00m[0;36mWarning(parms.c:2296): Layer 2 at 34.641m is very close to layer 1 at 17.3205m (OK).
[00;00m[0;36mWarning(parms.c:2296): Layer 3 at 51.9615m is very close to layer 2 at 34.641m (OK).
dm 0: stroke=30 um is provided in micron.
dm 0: assume ia stroke=2 um is provided in micron.
dm 1: stroke=7 um is provided in micron.
dm 1: assume ia stroke=2 um is provided in micron.
dm 2: stroke=7 um is provided in micron.
dm 2: assume ia stroke=2 um is provided in micron.
Focus blending is not implemented yet for integrated tomography
parms->sim.mffocus is reset to 0
There are 1 valid simulation seeds:  1
Output PSF for 1 directions
Used 449 of 456 supplied keys
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_flate" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_flatv" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_psx" is not recognized, value is [0 0 0 0]
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_psy" is not recognized, value is [0 0 0 0]
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_pupelong" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_raw" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_side" is not recognized, value is 4
[00;00mAperture[00;00m is 11 m with sampling 1/128 m
[00;00mTurbulence at 30 degree zenith angle:[00;00m r0=0.128424m, L0=30m, 14 layers.
    Greenwood freq is 25.1Hz, anisoplanatic angle is 1.58 as
    Sampled 8192x8192 at 1/128m. wind dir is randomized.
    layer 0: ht=      0 m, wt= 0.302, ws=  4.8 m/s
    layer 1: ht=     17 m, wt= 0.154, ws=  5.0 m/s
    layer 2: ht=     35 m, wt= 0.041, ws=  5.4 m/s
    layer 3: ht=     52 m, wt= 0.002, ws=  6.6 m/s
    layer 4: ht=    139 m, wt= 0.021, ws=  6.1 m/s
    layer 5: ht=    231 m, wt= 0.010, ws=  6.1 m/s
    layer 6: ht=    323 m, wt= 0.008, ws=  6.1 m/s
    layer 7: ht=    416 m, wt= 0.005, ws=  6.1 m/s
    layer 8: ht=    508 m, wt= 0.001, ws=  6.1 m/s
    layer 9: ht=    932 m, wt= 0.107, ws=  5.6 m/s
    layer 10: ht=   5022 m, wt= 0.144, ws= 11.1 m/s
    layer 11: ht=   9238 m, wt= 0.093, ws= 19.1 m/s
    layer 12: ht=  13856 m, wt= 0.075, ws=  8.2 m/s
    layer 13: ht=  22518 m, wt= 0.036, ws=  4.8 m/s
[00;00mReconstruction[00;00m: r0=0.128424m L0=30m. 14 layers. use cone coordinate.
    layer 0: ht=      0 m, wt= 0.302
    layer 1: ht=     17 m, wt= 0.154
    layer 2: ht=     35 m, wt= 0.041
    layer 3: ht=     52 m, wt= 0.002
    layer 4: ht=    139 m, wt= 0.021
    layer 5: ht=    231 m, wt= 0.010
    layer 6: ht=    323 m, wt= 0.008
    layer 7: ht=    416 m, wt= 0.005
    layer 8: ht=    508 m, wt= 0.001
    layer 9: ht=    932 m, wt= 0.107
    layer 10: ht=   5022 m, wt= 0.144
    layer 11: ht=   9238 m, wt= 0.093
    layer 12: ht=  13856 m, wt= 0.075
    layer 13: ht=  22518 m, wt= 0.036
[00;00mThere are 3 powfs[00;00m
  powfs0: Order 84, LGS at 99.1 km. Sampling 1/122.137 m. Thres 30%. [00;00mT/T is removed in right hand side in tomography.[00;00m
    CCD image is 25x25 @ 500x500 mas, blur 27% (sigma), 1500Hz, wvl: [ 5.89e-07]
    Gtilt in reconstruction. Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
  powfs1: Order  2, NGS at inf km. Sampling 1/16 m. Thres 30%. 
    Ztilt in reconstruction. Geomtric optics start at 2 with ztilt [00;00m(noisy)[00;00m
  powfs2: Order 20, NGS at inf km. Sampling 1/31.9716 m. Thres 50%. 
    CCD image is 4x4 @ 1500x1500 mas, blur 0% (sigma), 0.015Hz, wvl: [ 7.2e-07]
    Gtilt in reconstruction. Geomtric optics start at 50 with gtilt Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
[00;00mThere are 13 wfs[00;00m
    wfs 0: type 0, at (  30.00,    0.00) arcsec,  99 km, siglev is 20.5768 bkgrnd is 0.1
    wfs 1: type 0, at (  22.98,   19.28) arcsec,  99 km, siglev is 20.5768 bkgrnd is 0.1
    wfs 2: type 0, at (   5.21,   29.54) arcsec,  99 km, siglev is 20.5768 bkgrnd is 0.1
    wfs 3: type 0, at ( -15.00,   25.98) arcsec,  99 km, siglev is 20.5768 bkgrnd is 0.1
    wfs 4: type 0, at ( -28.19,   10.26) arcsec,  99 km, siglev is 20.5768 bkgrnd is 0.1
    wfs 5: type 0, at ( -28.19,  -10.26) arcsec,  99 km, siglev is 20.5768 bkgrnd is 0.1
    wfs 6: type 0, at ( -15.00,  -25.98) arcsec,  99 km, siglev is 20.5768 bkgrnd is 0.1
    wfs 7: type 0, at (   5.21,  -29.54) arcsec,  99 km, siglev is 20.5768 bkgrnd is 0.1
    wfs 8: type 0, at (  22.98,  -19.28) arcsec,  99 km, siglev is 20.5768 bkgrnd is 0.1
    wfs 9: type 1, at (   5.00,    8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 10: type 1, at ( -10.00,    0.00) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 11: type 1, at (   5.00,   -8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 12: type 2, at (   0.00,    0.00) arcsec, inf km, siglev is 4.1558e+06 bkgrnd is 0.001
[00;00mThere are 3 DMs[00;00m
  DM 0 at -0.1km, actuator pitch 0.131m, offset   0, with 30.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 1 at    6km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 2 at   10km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
[00;00mTomography[00;00m is using CG, with [00;00mFourer Domain[00;00m preconditioner, [00;00m12[00;00m iterations, integrated tomo.
[00;00mDM Fitting [00;00mis using CG, with [00;00mNo[00;00m preconditioner, [00;00m10[00;00m iterations
[00;00mThere are 9 fit directions[00;00m
    Fit 0: weight is 0.444, at (   0.00,    0.00) arcsec
    Fit 1: weight is 0.111, at (  15.00,    0.00) arcsec
    Fit 2: weight is 0.111, at (   0.00,   15.00) arcsec
    Fit 3: weight is 0.111, at ( -15.00,    0.00) arcsec
    Fit 4: weight is 0.111, at (   0.00,  -15.00) arcsec
    Fit 5: weight is 0.028, at (  15.00,   15.00) arcsec
    Fit 6: weight is 0.028, at ( -15.00,   15.00) arcsec
    Fit 7: weight is 0.028, at ( -15.00,  -15.00) arcsec
    Fit 8: weight is 0.028, at (  15.00,  -15.00) arcsec
[00;00mThere are 1 evaluation directions[00;00m at sampling 1/128 m.
    Evl 0: weight is 1.000, at (   0.00,    0.00) arcsec
[00;00mSimulation[00;00m start at step 0, end at step 1600, with time step 1/1500s, [00;00mclose loop[00;00m.
After setup_parms:	120.5 MiB.
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
CUDA: minimum memory requirement is 0.3GB
GPU 0 is NVIDIA A100-SXM4-40GB with arch 8.0, 38.9GB free, 39.3GB total device memory.
Using GPU 0
Use 1 GPUs for WFS Tomo Fit Evl

*** Preparation started at 2025/02/17 15:44:15 in nid001972. ***

Using OpenMP version 201511 with 128 threads
Reading aperture amplitude map from KECK.fits
[00;00m[0;36mWarning(accphi.c:477): 108831 points not covered by input screen
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
 ->maos.c:447->setup.c:148->aper.c:74->utils.c:478->accphi.c:478
iwvl 0: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 1: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 2: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 3: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 4: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 5: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 6: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 7: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 8: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
After setup_aper:	344.7 MiB.

[00;00mSetting up powfs 0 geom[00;00m

There are 16 points in each subaperture of 0.131m.
There are 4336 valid subaperture.

[00;00mSetting up powfs 1 geom[00;00m

There are 88 points in each subaperture of 5.5m.
There are 4 valid subaperture.

[00;00mSetting up powfs 2 geom[00;00m

There are 18 points in each subaperture of 0.563m.
There are 236 valid subaperture.
After setup_powfs_init:	418.2 MiB.

[00;00mSetting up reconstructor geometry.[00;00m

PLOC is 171x171, with sampling of 0.07m (square)
    DM 0: grid is 89 x 89
    DM 1: grid is 75 x 75
    DM 2: grid is 80 x 79
FLOC is 171x171, with sampling of 0.07m (not square)
Tomography grid is square:
    layer 0: xloc grid is 300 x 300, sampling is 0.066 m, 90000 points
    layer 1: xloc grid is 300 x 300, sampling is 0.065 m, 90000 points
    layer 2: xloc grid is 300 x 300, sampling is 0.065 m, 90000 points
    layer 3: xloc grid is 300 x 300, sampling is 0.065 m, 90000 points
    layer 4: xloc grid is 300 x 300, sampling is 0.065 m, 90000 points
    layer 5: xloc grid is 300 x 300, sampling is 0.065 m, 90000 points
    layer 6: xloc grid is 300 x 300, sampling is 0.065 m, 90000 points
    layer 7: xloc grid is 300 x 300, sampling is 0.065 m, 90000 points
    layer 8: xloc grid is 300 x 300, sampling is 0.065 m, 90000 points
    layer 9: xloc grid is 300 x 300, sampling is 0.065 m, 90000 points
    layer 10: xloc grid is 300 x 300, sampling is 0.062 m, 90000 points
    layer 11: xloc grid is 300 x 300, sampling is 0.059 m, 90000 points
    layer 12: xloc grid is 300 x 300, sampling is 0.056 m, 90000 points
[00;00m[0;36mWarning(map.c:195): ninx=300 is too small. need 301
[00;00m[0;36mWarning(map.c:200): niny=300 is too small. need 301
    layer 13: xloc grid is 300 x 300, sampling is 0.051 m, 90000 points

[00;00mSetting up powfs 0 PO WFS[00;00m

OTF dimension is 32x32 (calculated)
There is no bias
Uplink FWHM (illt 0, iwvl 0) is 0.579608"
Downlink FWHM (illt 0, iwvl 0) is 1.47508"
Generating matched filter for powfs 0
sa index   location       noise equivalent angle
    2166: (  4.8,  -0.1) m, (192.12, 183.27) mas
    2158: (  3.8,  -0.1) m, (205.68, 185.11) mas
    2149: (  2.6,  -0.1) m, (227.08, 187.98) mas
    2141: (  1.6,  -0.1) m, (247.79, 190.67) mas
    2139: (  1.3,  -0.1) m, (256.17, 191.70) mas
    1557: ( -0.5,  -1.3) m, (298.96, 201.88) mas
    2134: ( -1.7,  -0.1) m, (329.02, 200.59) mas
    2125: ( -2.9,  -0.1) m, (358.16, 204.09) mas
    2117: ( -3.9,  -0.1) m, (384.06, 207.20) mas
    2108: ( -5.1,  -0.1) m, (413.42, 210.62) mas
    2106: ( -5.4,  -0.1) m, (418.98, 211.32) mas
sa index   location       noise equivalent angle
    3476: (  3.0,   2.5) m, (195.46, 192.19) mas
    3157: (  2.2,   1.8) m, (206.39, 200.57) mas
    2865: (  1.6,   1.3) m, (218.91, 209.94) mas
    2590: (  0.9,   0.8) m, (235.09, 222.89) mas
    1564: (  0.4,  -1.3) m, (240.53, 257.28) mas
    1687: ( -1.3,  -1.0) m, (276.08, 252.87) mas
    1549: ( -1.6,  -1.3) m, (300.97, 273.26) mas
    1184: ( -2.4,  -2.0) m, (298.90, 271.62) mas
     865: ( -3.1,  -2.6) m, (317.60, 286.34) mas
     165: ( -3.0,  -4.3) m, (314.90, 325.83) mas
sa index   location       noise equivalent angle
    4320: (  0.8,   4.7) m, (183.51, 192.18) mas
    4110: (  0.7,   4.1) m, (184.53, 198.17) mas
    3516: (  0.4,   2.6) m, (188.88, 224.00) mas
    3142: (  0.3,   1.8) m, (192.97, 241.95) mas
    2854: (  0.1,   1.3) m, (193.82, 252.78) mas
    2004: ( -1.4,  -0.4) m, (211.81, 289.40) mas
    1342: ( -0.4,  -1.7) m, (205.71, 324.97) mas
    1199: ( -0.4,  -2.0) m, (207.30, 331.59) mas
     527: ( -0.7,  -3.4) m, (222.06, 382.34) mas
     230: ( -0.8,  -4.2) m, (215.63, 386.26) mas
      12: ( -2.2,  -4.8) m, (242.02, 417.07) mas
sa index   location       noise equivalent angle
    4274: ( -2.8,   4.6) m, (182.17, 182.64) mas
    4039: ( -2.4,   3.9) m, (186.67, 192.60) mas
    3679: ( -1.8,   3.0) m, (192.56, 205.65) mas
    3262: ( -1.3,   2.1) m, (199.68, 221.06) mas
    2775: ( -0.8,   1.2) m, (207.90, 238.62) mas
    2336: (  1.2,   0.3) m, (262.10, 278.29) mas
    1566: (  0.7,  -1.3) m, (233.06, 292.98) mas
    1079: (  1.2,  -2.2) m, (242.97, 314.18) mas
     662: (  1.7,  -3.1) m, (253.68, 336.63) mas
     301: (  2.2,  -4.1) m, (264.52, 358.85) mas
      66: (  2.6,  -4.7) m, (272.97, 375.07) mas
sa index   location       noise equivalent angle
    2962: ( -4.6,   1.6) m, (192.22, 184.55) mas
    2693: ( -3.1,   1.0) m, (212.61, 190.00) mas
    2462: ( -1.7,   0.5) m, (239.23, 197.36) mas
    2401: ( -1.3,   0.4) m, (249.01, 199.94) mas
    2651: (  0.8,   0.9) m, (304.91, 207.14) mas
    1879: (  1.6,  -0.7) m, (315.30, 218.24) mas
    1819: (  2.0,  -0.8) m, (328.74, 223.09) mas
    1648: (  3.0,  -1.2) m, (349.46, 227.74) mas
    1379: (  4.5,  -1.7) m, (388.50, 238.63) mas
    1970: (  5.1,  -0.5) m, (407.55, 225.84) mas
sa index   location       noise equivalent angle
    1310: ( -4.6,  -1.7) m, (192.22, 184.55) mas
    1609: ( -3.1,  -1.2) m, (212.61, 190.00) mas
    1870: ( -1.7,  -0.7) m, (239.23, 197.36) mas
    1939: ( -1.3,  -0.5) m, (249.59, 200.46) mas
    1691: (  0.8,  -1.0) m, (313.21, 214.53) mas
    2471: (  1.6,   0.5) m, (315.30, 218.24) mas
    2537: (  2.0,   0.7) m, (326.95, 221.87) mas
    2732: (  3.0,   1.0) m, (349.46, 227.74) mas
    3031: (  4.5,   1.6) m, (388.50, 238.63) mas
    2432: (  5.1,   0.4) m, (407.55, 225.84) mas
sa index   location       noise equivalent angle
      33: ( -2.8,  -4.7) m, (182.17, 182.64) mas
     266: ( -2.4,  -4.1) m, (186.67, 192.60) mas
     635: ( -1.8,  -3.1) m, (192.56, 205.65) mas
    1060: ( -1.3,  -2.2) m, (199.68, 221.06) mas
    1555: ( -0.8,  -1.3) m, (207.90, 238.62) mas
    2649: ( -0.9,   0.9) m, (222.88, 301.79) mas
    2786: (  0.7,   1.2) m, (233.06, 292.98) mas
    3281: (  1.2,   2.1) m, (242.97, 314.18) mas
    3706: (  1.7,   3.0) m, (253.68, 336.63) mas
    4074: (  2.2,   3.9) m, (264.52, 358.85) mas
    4303: (  2.6,   4.6) m, (272.97, 375.07) mas
sa index   location       noise equivalent angle
      23: (  0.8,  -4.8) m, (183.51, 192.18) mas
     241: (  0.7,  -4.2) m, (184.53, 198.17) mas
     832: (  0.4,  -2.8) m, (188.88, 224.00) mas
    1204: (  0.3,  -2.0) m, (191.97, 241.05) mas
    1490: (  0.1,  -1.4) m, (193.82, 252.78) mas
    2530: (  1.0,   0.7) m, (211.26, 319.99) mas
    2994: ( -0.4,   1.6) m, (205.71, 324.97) mas
    3137: ( -0.4,   1.8) m, (209.38, 333.89) mas
    3804: ( -0.7,   3.3) m, (217.76, 375.90) mas
    4099: ( -0.8,   4.1) m, (215.63, 386.26) mas
    4309: ( -2.2,   4.7) m, (252.29, 431.58) mas
sa index   location       noise equivalent angle
     912: (  3.0,  -2.6) m, (195.46, 192.19) mas
    1219: (  2.2,  -2.0) m, (206.39, 200.57) mas
    1501: (  1.6,  -1.4) m, (218.91, 209.94) mas
    1751: (  0.9,  -0.9) m, (239.32, 227.11) mas
    2783: (  0.3,   1.2) m, (264.30, 280.11) mas
    2589: ( -1.0,   0.8) m, (282.50, 260.91) mas
    2769: ( -1.6,   1.2) m, (300.97, 273.26) mas
    3122: ( -2.4,   1.8) m, (298.90, 271.62) mas
    3429: ( -3.1,   2.5) m, (317.60, 286.34) mas
    4130: ( -3.0,   4.2) m, (314.90, 325.83) mas

[00;00mSetting up powfs 2 PO WFS[00;00m

OTF dimension is 48x48 (calculated)
Generating matched filter for powfs 2
Use sanea to derive neasim
Use sanea to derive neasim

[00;00mSetting up reconstructor[00;00m

Recon NEA: cmf(259.87) cmf(258.31) cmf(259.04) cmf(258.50) cmf(258.47) cmf(258.41) cmf(258.32) cmf(258.82) cmf(258.16) geom(0.31) geom(0.31) geom(0.31) mf(0.14)  mas
Setup or update control matrix parameters.
RRtwfs svd threshold is 1e-10
Replacing HA by HA*fit->actextrap
Adding piston cr to fit matrix
Adding TT cr on upper DMs to fit matrix.
Before assembling fit matrix:	6007.7 MiB.
Building fit->FR
Building fit->FL
Adding tikhonov constraint of 1.0e-07 to FLM
The maximum eigen value is estimated to be around 2.5e-04
DM Fit number of Low rank terms: 16 in LHS
After assemble fit matrix:	8338.8 MiB.
After setup_recon:	8338.8 MiB.
GPU 0: mem used 1724 MB (wfs init)
GPU 0: mem used 3150 MB (recon init)
GPU 0: mem used 3180 MB (perf init)

*** Simulation started at 2025/02/17 15:46:30 in nid001972. ***

Running seed 1
GPU 0: mem used 3180 MB (wfs seeding)
Wind dir: 267.3 261.7 167.0 130.5 300.7  32.3 119.8 139.0 150.8 277.7 203.0 133.1  45.9 265.1 deg
Using /global/homes/b/bpeck/.aos/cache/atm/vonkarman_14_8192x8192_0.0078125_1115374592d.bin
After genatm:	8159.0 MiB.
Step     #  Open Loop  PR TT  On axis  PR TT  Field RMS PR TT     Timing 
Step     0: OL  884.6  248.3  OA  884.6 248.3 CL  884.6 248.3 nm  0.185 s
Step     9: OL  898.4  251.9  OA  289.6 211.9 CL  289.6 211.9 nm  0.090 s
Step    20: OL  915.8  255.8  OA  118.4  13.7 CL  118.4  13.7 nm  0.102 s
Step    30: OL  931.5  258.7  OA  121.1  22.3 CL  121.1  22.3 nm  0.098 s
Step    41: OL  948.2  260.6  OA  122.0  12.6 CL  122.0  12.6 nm  0.105 s
Step    51: OL  963.0  261.2  OA  122.5  36.8 CL  122.5  36.8 nm  0.097 s
Step    61: OL  977.7  260.7  OA  120.4   9.0 CL  120.4   9.0 nm  0.098 s
Step    70: OL  991.3  259.8  OA  118.4   7.5 CL  118.4   7.5 nm  0.730 s
Step    76: OL 1000.3  259.1  OA  125.3  40.8 CL  125.3  40.8 nm  0.098 s
Step    86: OL 1015.7  258.2  OA  116.9  28.5 CL  116.9  28.5 nm  0.107 s
Step    96: OL 1031.1  257.6  OA  119.6  31.3 CL  119.6  31.3 nm  0.096 s
Step   106: OL 1046.4  257.5  OA  118.1  27.1 CL  118.1  27.1 nm  0.097 s
Step   116: OL 1061.8  258.1  OA  117.4  26.2 CL  117.4  26.2 nm  0.100 s
Step   126: OL 1076.5  259.4  OA  116.1  18.4 CL  116.1  18.4 nm  0.106 s
Step   137: OL 1091.8  262.4  OA  116.6  21.3 CL  116.6  21.3 nm  0.100 s
Step   147: OL 1105.0  266.1  OA  118.9  37.0 CL  118.9  37.0 nm  0.105 s
Step   157: OL 1116.9  270.6  OA  118.3  32.7 CL  118.3  32.7 nm  0.099 s
Step   168: OL 1128.5  276.7  OA  114.9  14.4 CL  114.9  14.4 nm  0.108 s
Step   179: OL 1138.5  283.4  OA  116.4  11.6 CL  116.4  11.6 nm  0.097 s
Step   189: OL 1145.8  289.8  OA  117.6  33.6 CL  117.6  33.6 nm  0.095 s
Step   200: OL 1152.1  296.9  OA  115.6  25.2 CL  115.6  25.2 nm  0.107 s
Step   210: OL 1156.7  303.3  OA  120.6  23.5 CL  120.6  23.5 nm  0.100 s
Step   221: OL 1160.2  310.3  OA  107.6  12.6 CL  107.6  12.6 nm  0.098 s
Step   231: OL 1161.9  316.8  OA  114.3  19.3 CL  114.3  19.3 nm  0.099 s
Step   242: OL 1162.0  324.3  OA  119.3  39.2 CL  119.3  39.2 nm  0.097 s
Step   253: OL 1159.7  332.1  OA  115.8  33.9 CL  115.8  33.9 nm  0.097 s
Step   255 updated high order loop gain: 0.337
Step   263: OL 1155.1  339.3  OA  111.4  31.8 CL  111.4  31.8 nm  0.098 s
Step   273: OL 1148.2  346.5  OA  106.1  21.2 CL  106.1  21.2 nm  0.096 s
Step   283: OL 1139.5  353.9  OA  113.7  30.1 CL  113.7  30.1 nm  0.111 s
Step   293: OL 1129.7  362.0  OA  106.7  27.6 CL  106.7  27.6 nm  0.098 s
Step   303: OL 1119.2  370.8  OA  114.1  38.0 CL  114.1  38.0 nm  0.100 s
Step   313: OL 1107.4  380.0  OA  115.4  31.3 CL  115.4  31.3 nm  0.106 s
Step   323: OL 1094.8  389.7  OA  112.6  20.8 CL  112.6  20.8 nm  0.098 s
Step   333: OL 1081.6  400.4  OA  114.7  41.3 CL  114.7  41.3 nm  0.099 s
Step   343: OL 1068.3  412.1  OA  119.1  34.2 CL  119.1  34.2 nm  0.110 s
Step   353: OL 1055.0  424.9  OA  116.6  35.3 CL  116.6  35.3 nm  0.101 s
Step   363: OL 1042.2  438.6  OA  116.8  41.4 CL  116.8  41.4 nm  0.099 s
Step   373: OL 1030.0  452.8  OA  115.0  27.7 CL  115.0  27.7 nm  0.100 s
Step   383: OL 1018.3  467.2  OA  120.0  26.9 CL  120.0  26.9 nm  0.102 s
Step   393: OL 1007.0  481.7  OA  122.7  45.9 CL  122.7  45.9 nm  0.100 s
Step   403: OL  995.8  496.1  OA  115.2  28.1 CL  115.2  28.1 nm  0.113 s
Step   414: OL  983.3  511.4  OA  109.3  13.7 CL  109.3  13.7 nm  0.095 s
Step   425: OL  970.5  526.1  OA  118.5  40.7 CL  118.5  40.7 nm  0.102 s
Step   436: OL  957.9  540.7  OA  111.1  25.1 CL  111.1  25.1 nm  0.100 s
Step   446: OL  947.1  553.7  OA  111.2  18.5 CL  111.2  18.5 nm  0.098 s
Step   456: OL  937.7  566.8  OA  119.8  38.7 CL  119.8  38.7 nm  0.107 s
Step   466: OL  930.5  579.9  OA  121.2  48.6 CL  121.2  48.6 nm  0.096 s
Step   476: OL  925.7  592.7  OA  116.8  32.3 CL  116.8  32.3 nm  0.103 s
Step   487: OL  923.4  606.5  OA  108.8   6.4 CL  108.8   6.4 nm  0.104 s
Step   497: OL  923.5  618.5  OA  115.1  15.5 CL  115.1  15.5 nm  0.098 s
Step   508: OL  925.1  630.8  OA  115.8  15.6 CL  115.8  15.6 nm  0.097 s
Step   511 updated high order loop gain: 0.283
Step   518: OL  928.0  641.0  OA  113.5  14.3 CL  113.5  14.3 nm  0.101 s
Step   529: OL  932.3  650.5  OA  116.6  19.9 CL  116.6  19.9 nm  0.098 s
Step   539: OL  937.4  657.3  OA  116.5  18.5 CL  116.5  18.5 nm  0.104 s
Step   549: OL  943.9  662.6  OA  110.8   2.8 CL  110.8   2.8 nm  0.097 s
Step   559: OL  951.8  666.4  OA  115.8  20.3 CL  115.8  20.3 nm  0.117 s
Step   569: OL  960.6  668.8  OA  108.0   4.2 CL  108.0   4.2 nm  0.103 s
Step   579: OL  970.3  670.3  OA  114.6  10.7 CL  114.6  10.7 nm  0.098 s
Step   589: OL  981.1  670.5  OA  109.3   8.8 CL  109.3   8.8 nm  0.096 s
Step   600: OL  993.8  668.8  OA  109.4  17.7 CL  109.4  17.7 nm  0.100 s
Step   610: OL 1005.7  665.5  OA  111.2   6.8 CL  111.2   6.8 nm  0.106 s
Step   620: OL 1017.7  660.7  OA  109.6  16.2 CL  109.6  16.2 nm  0.100 s
Step   631: OL 1030.6  653.9  OA  105.9   9.3 CL  105.9   9.3 nm  0.101 s
Step   642: OL 1043.0  645.4  OA  109.3  13.6 CL  109.3  13.6 nm  0.100 s
Step   653: OL 1054.4  635.7  OA  105.0  12.3 CL  105.0  12.3 nm  0.105 s
Step   663: OL 1064.0  626.0  OA  105.8  18.9 CL  105.8  18.9 nm  0.097 s
Step   673: OL 1073.0  615.7  OA  113.6  12.5 CL  113.6  12.5 nm  0.102 s
Step   684: OL 1082.5  604.3  OA  110.3   5.0 CL  110.3   5.0 nm  0.107 s
Step   694: OL 1090.4  593.5  OA  111.4   8.6 CL  111.4   8.6 nm  0.095 s
Step   704: OL 1097.2  582.1  OA  110.8  14.5 CL  110.8  14.5 nm  0.098 s
Step   714: OL 1102.4  570.0  OA  111.1   8.7 CL  111.1   8.7 nm  0.105 s
Step   724: OL 1105.8  557.6  OA  116.5  27.1 CL  116.5  27.1 nm  0.098 s
Step   734: OL 1107.5  545.3  OA  109.2  28.4 CL  109.2  28.4 nm  0.100 s
Step   745: OL 1107.1  531.7  OA  106.4   1.6 CL  106.4   1.6 nm  0.101 s
Step   756: OL 1104.7  518.5  OA  106.2   1.5 CL  106.2   1.5 nm  0.098 s
Step   766: OL 1100.6  506.8  OA  108.3  17.8 CL  108.3  17.8 nm  0.095 s
Step   767 updated high order loop gain: 0.260
Step   776: OL 1094.8  495.5  OA  109.7  19.5 CL  109.7  19.5 nm  0.099 s
Step   786: OL 1087.0  484.2  OA  111.6  14.0 CL  111.6  14.0 nm  0.098 s
Step   796: OL 1077.3  473.1  OA  107.9  15.6 CL  107.9  15.6 nm  0.097 s
Step   806: OL 1066.3  461.9  OA  112.3  10.3 CL  112.3  10.3 nm  0.104 s
Step   816: OL 1054.0  450.7  OA  112.9  20.9 CL  112.9  20.9 nm  0.102 s
Step   827: OL 1038.8  438.6  OA  105.2  10.8 CL  105.2  10.8 nm  0.101 s
Step   837: OL 1023.7  427.8  OA  104.7   0.4 CL  104.7   0.4 nm  0.101 s
Step   847: OL 1008.0  417.6  OA  107.8  11.2 CL  107.8  11.2 nm  0.098 s
Step   857: OL  992.1  407.8  OA  106.2  13.1 CL  106.2  13.1 nm  0.121 s
Step   867: OL  976.3  398.9  OA  108.4   6.2 CL  108.4   6.2 nm  0.102 s
Step   878: OL  959.7  390.0  OA  110.9   3.2 CL  110.9   3.2 nm  0.097 s
Step   888: OL  944.9  382.8  OA  112.1   7.6 CL  112.1   7.6 nm  0.105 s
Step   898: OL  929.7  376.2  OA  113.3   4.6 CL  113.3   4.6 nm  0.100 s
Step   908: OL  913.9  370.4  OA  111.3  12.3 CL  111.3  12.3 nm  0.099 s
Step   918: OL  897.8  365.4  OA  112.2  16.3 CL  112.2  16.3 nm  0.104 s
Step   929: OL  880.3  360.1  OA  112.6  15.1 CL  112.6  15.1 nm  0.096 s
Step   940: OL  863.1  354.9  OA  114.0   8.1 CL  114.0   8.1 nm  0.106 s
Step   950: OL  848.0  350.1  OA  111.7  13.6 CL  111.7  13.6 nm  0.097 s
Step   960: OL  833.7  345.0  OA  112.3  10.9 CL  112.3  10.9 nm  0.098 s
Step   970: OL  821.0  339.4  OA  109.5   5.9 CL  109.5   5.9 nm  0.097 s
Step   980: OL  809.6  333.3  OA  117.4  32.5 CL  117.4  32.5 nm  0.103 s
Step   990: OL  799.2  326.7  OA  113.9  27.8 CL  113.9  27.8 nm  0.098 s
Step  1000: OL  789.4  319.6  OA  118.4  30.1 CL  118.4  30.1 nm  0.097 s
Step  1010: OL  780.2  312.0  OA  111.1  14.0 CL  111.1  14.0 nm  0.102 s
Step  1020: OL  772.0  304.4  OA  111.8  11.8 CL  111.8  11.8 nm  0.099 s
Step  1023 updated high order loop gain: 0.246
Step  1030: OL  764.8  296.6  OA  115.5  23.2 CL  115.5  23.2 nm  0.097 s
Step  1041: OL  757.9  287.4  OA  116.3  32.2 CL  116.3  32.2 nm  0.099 s
Step  1052: OL  751.3  277.6  OA  114.7  21.3 CL  114.7  21.3 nm  0.095 s
Step  1062: OL  745.3  268.0  OA  110.1   7.6 CL  110.1   7.6 nm  0.107 s
Step  1072: OL  740.1  257.4  OA  115.2  24.8 CL  115.2  24.8 nm  0.098 s
Step  1083: OL  736.0  244.7  OA  107.0  18.0 CL  107.0  18.0 nm  0.102 s
Step  1093: OL  733.6  233.1  OA  112.9  36.5 CL  112.9  36.5 nm  0.097 s
Step  1104: OL  732.0  221.1  OA  113.6  25.8 CL  113.6  25.8 nm  0.103 s
Step  1115: OL  731.2  210.0  OA  109.8  19.0 CL  109.8  19.0 nm  0.097 s
Step  1126: OL  731.1  200.0  OA  109.6  24.7 CL  109.6  24.7 nm  0.104 s
Step  1137: OL  731.4  191.6  OA  106.3  15.9 CL  106.3  15.9 nm  0.099 s
Step  1147: OL  731.8  184.9  OA  110.5  27.7 CL  110.5  27.7 nm  0.102 s
Step  1157: OL  732.2  179.4  OA  101.2   9.8 CL  101.2   9.8 nm  0.098 s
Step  1168: OL  732.5  174.8  OA  103.4  12.5 CL  103.4  12.5 nm  0.106 s
Step  1178: OL  733.4  171.7  OA  105.5  23.2 CL  105.5  23.2 nm  0.097 s
Step  1188: OL  735.3  169.4  OA  103.2  14.5 CL  103.2  14.5 nm  0.102 s
Step  1198: OL  737.7  167.3  OA  108.6  27.1 CL  108.6  27.1 nm  0.099 s
Step  1208: OL  740.3  165.4  OA  104.0  22.4 CL  104.0  22.4 nm  0.101 s
Step  1218: OL  742.9  164.0  OA  107.4   6.9 CL  107.4   6.9 nm  0.104 s
Step  1228: OL  745.6  163.4  OA  103.7  20.3 CL  103.7  20.3 nm  0.099 s
Step  1238: OL  747.8  163.8  OA  102.0  11.1 CL  102.0  11.1 nm  0.101 s
Step  1248: OL  749.7  165.5  OA  103.5  16.8 CL  103.5  16.8 nm  0.099 s
Step  1258: OL  752.3  168.5  OA  102.6  11.9 CL  102.6  11.9 nm  0.097 s
Step  1268: OL  755.2  172.7  OA  104.1  13.3 CL  104.1  13.3 nm  0.099 s
Step  1278: OL  758.5  177.8  OA  103.2  17.6 CL  103.2  17.6 nm  0.103 s
Step  1279 updated high order loop gain: 0.240
Step  1288: OL  762.8  183.7  OA  106.3   3.7 CL  106.3   3.7 nm  0.098 s
Step  1298: OL  767.3  190.2  OA  108.1  22.3 CL  108.1  22.3 nm  0.099 s
Step  1308: OL  771.6  197.4  OA  106.1   7.0 CL  106.1   7.0 nm  0.106 s
Step  1319: OL  776.1  205.8  OA  110.3   8.5 CL  110.3   8.5 nm  0.098 s
Step  1329: OL  780.2  214.3  OA  108.6  17.5 CL  108.6  17.5 nm  0.104 s
Step  1340: OL  785.6  224.1  OA  104.3  17.4 CL  104.3  17.4 nm  0.101 s
Step  1350: OL  791.3  233.3  OA  105.8  12.1 CL  105.8  12.1 nm  0.102 s
Step  1360: OL  798.1  242.0  OA  102.3  17.9 CL  102.3  17.9 nm  0.106 s
Step  1371: OL  806.2  250.4  OA  104.6  10.7 CL  104.6  10.7 nm  0.108 s
Step  1381: OL  813.9  256.8  OA  101.9   7.2 CL  101.9   7.2 nm  0.098 s
Step  1391: OL  822.2  262.2  OA  107.1  19.6 CL  107.1  19.6 nm  0.101 s
Step  1402: OL  831.9  267.0  OA  105.8  13.2 CL  105.8  13.2 nm  0.098 s
Step  1412: OL  841.4  270.3  OA  109.4  17.8 CL  109.4  17.8 nm  0.101 s
Step  1423: OL  852.4  273.2  OA  106.2  26.8 CL  106.2  26.8 nm  0.100 s
Step  1434: OL  863.0  275.6  OA  106.9  19.9 CL  106.9  19.9 nm  0.106 s
Step  1445: OL  873.2  277.6  OA  105.3  22.3 CL  105.3  22.3 nm  0.098 s
Step  1455: OL  882.1  278.9  OA  108.9   5.1 CL  108.9   5.1 nm  0.096 s
Step  1466: OL  890.6  279.4  OA  102.1   6.3 CL  102.1   6.3 nm  0.109 s
Step  1476: OL  896.4  278.7  OA  101.7   5.0 CL  101.7   5.0 nm  0.097 s
Step  1486: OL  900.0  276.9  OA  101.1   5.0 CL  101.1   5.0 nm  0.106 s
Step  1497: OL  901.4  273.9  OA  101.0   7.9 CL  101.0   7.9 nm  0.099 s
Step  1507: OL  900.8  270.0  OA  104.9   6.3 CL  104.9   6.3 nm  0.099 s
Step  1517: OL  899.0  265.5  OA  101.1  20.0 CL  101.1  20.0 nm  0.108 s
Step  1527: OL  895.9  260.3  OA  104.0  14.9 CL  104.0  14.9 nm  0.098 s
Step  1535 updated high order loop gain: 0.238
Step  1537: OL  891.2  254.4  OA  103.5   9.0 CL  103.5   9.0 nm  0.097 s
Step  1547: OL  885.9  247.9  OA  104.4   8.8 CL  104.4   8.8 nm  0.112 s
Step  1557: OL  880.3  241.2  OA  105.5  13.5 CL  105.5  13.5 nm  0.099 s
Step  1567: OL  874.5  234.9  OA  106.2   2.9 CL  106.2   2.9 nm  0.102 s
Step  1578: OL  867.6  228.6  OA  108.4  12.8 CL  108.4  12.8 nm  0.099 s
Step  1588: OL  860.8  223.9  OA  111.3  12.3 CL  111.3  12.3 nm  0.101 s
Step  1598: OL  853.8  219.7  OA  108.1  25.1 CL  108.1  25.1 nm  0.098 s
Step 1599: Output PSF
Step  1599: OL  853.1  219.3  OA  109.6  31.9 CL  109.6  31.9 nm  1.544 s
Mean: 109.96 19.71 108.18  nm.

*** Simulation Finished at 2025/02/17 15:49:21 in nid001972. ***

[00;00m>>>>>>>>>>>>>>>>[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
/global/cfs/cdirs/ulens/vismcao/maos -o studies/reduced_ngs/9_lgs/8mag_lgs/5750count -c master_files/reduced_ngs/9_lgs/8mag_lgs/kola_5750act.conf -O 
Output folder is 'studies/reduced_ngs/9_lgs/8mag_lgs/5750count'.
SRC: /global/homes/b/bpeck/code/maos v2.9 4c88b7c2 2024-11-13 16:45:33 -0800
BUILT: /global/homes/b/bpeck/code/maos/optim by GCC (v12) on 2024/11/18 09:40:03 CPU(F64,+O3) with CUDA(v122,F32)
Launched at 2025/02/17 15:49:22 in nid001972 with PID 1703278.
The web based job monitor can be accessed at http://localhost:10300
Main config file is /global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_5750act.conf
[00;00m[0;36mWarning(path.c:48): Path not found: path=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; abspath=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; Ignored.
[00;00m[0;36mWarning(path.c:48): Path not found: path=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; abspath=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; Ignored.
[00;00m[0;36mWarning(readcfg.c:399): sim.apfsm has been renamed to powfs.apfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.epfsm has been renamed to powfs.epfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.alfsm has been renamed to powfs.alfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.commonfsm has been renamed to powfs.commonfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.idealfsm has been renamed to powfs.idealfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.zetafsm has been renamed to powfs.zetafsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.f0fsm has been renamed to powfs.f0fsm.
[00;00m[0;36mWarning(readcfg.c:399): tsurf has been renamed to ncpa.tsurf.
loaded 132 (132 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_sim.conf'
loaded  19 ( 19 new) records from '/global/cfs/cdirs/ulens/vismcao/./dm_none.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_ASM.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_DM2.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_DM3.conf'
loaded   0 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_dm_multiple.conf'
loaded   7 (  5 new) records from '/global/cfs/cdirs/ulens/vismcao/./atm_mk13n50p_ground_detail.conf'
loaded  76 ( 69 new) records from '/global/homes/b/bpeck/code/maos/config/maos/powfs_common.conf'
loaded  44 ( 38 new) records from '/global/cfs/cdirs/ulens/vismcao/./powfs_none.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_lgs.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_ttf_strap.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_twfs_lbwfs.conf'
loaded   0 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_wfs_lgs_strap_lbwfs.conf'
loaded  71 ( 71 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_recon.conf'
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_smooth has been renamed to powfs0_llt.na_smooth.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_interp has been renamed to powfs0_llt.na_interp.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_thres has been renamed to powfs0_llt.na_thres.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_maxit has been renamed to powfs0_llt.na_fit_maxit.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_svdthres has been renamed to powfs0_llt.na_fit_svdthres.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_dh has been renamed to powfs0_llt.na_fit_dh.
[00;00m[0;36mWarning(readcfg.c:399): dbg.ncpa_preload has been renamed to ncpa.preload.
[00;00m[0;36mWarning(readcfg.c:399): dbg.ncpa_rmsci has been renamed to ncpa.rmsci.
[00;00m[0;36mWarning(readcfg.c:399): dbg.draw_opdmax has been renamed to plot.opdmax.
[00;00m[0;36mWarning(readcfg.c:399): dbg.draw_gmax has been renamed to plot.gmax.
loaded  95 ( 93 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_dbg.conf'
loaded   4 (  4 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_fit_mcao.conf'
[00;00m[0;36mWarning(readcfg.c:399): surf has been renamed to ncpa.surf.
loaded  39 (  7 new) records from '/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_5750act.conf'
loaded   0 (  0 new) records from 'command line'
loaded  24 ( 18 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_llt_CL.conf'
Adjust LGS range by telescope altitude 4145m.
Zenith angle is 30 degree.
    Scaling turbulence height and LGS hs by sec(za).
    Scaling r0 by cos(za)^(3/5).
    Scaling wind speed and LGS signal level by cos(za).
powfs0: Adjusting dx from 0.0078125 to 0.0080625. 
powfs0.llt.fsm: f0=0 Hz, LPF ep=0
powfs0.epfsm is set to 0.517618 (auto)
powfs2: Adjusting dx from 0.03125 to 0.0312778. 
powfs2 is TWFS for powfs0
sim.ephi is set to 0.427717 (auto)
sim.eplo is set to 0.427717 (auto)
[00;00m[0;36mWarning(parms.c:2296): Layer 1 at 17.3205m is very close to layer 0 at 0m (OK).
[00;00m[0;36mWarning(parms.c:2296): Layer 2 at 34.641m is very close to layer 1 at 17.3205m (OK).
[00;00m[0;36mWarning(parms.c:2296): Layer 3 at 51.9615m is very close to layer 2 at 34.641m (OK).
dm 0: stroke=30 um is provided in micron.
dm 0: assume ia stroke=2 um is provided in micron.
dm 1: stroke=7 um is provided in micron.
dm 1: assume ia stroke=2 um is provided in micron.
dm 2: stroke=7 um is provided in micron.
dm 2: assume ia stroke=2 um is provided in micron.
Focus blending is not implemented yet for integrated tomography
parms->sim.mffocus is reset to 0
There are 1 valid simulation seeds:  1
Output PSF for 1 directions
Used 449 of 456 supplied keys
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_flate" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_flatv" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_psx" is not recognized, value is [0 0 0 0]
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_psy" is not recognized, value is [0 0 0 0]
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_pupelong" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_raw" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_side" is not recognized, value is 4
[00;00mAperture[00;00m is 11 m with sampling 1/128 m
[00;00mTurbulence at 30 degree zenith angle:[00;00m r0=0.128424m, L0=30m, 14 layers.
    Greenwood freq is 25.1Hz, anisoplanatic angle is 1.58 as
    Sampled 8192x8192 at 1/128m. wind dir is randomized.
    layer 0: ht=      0 m, wt= 0.302, ws=  4.8 m/s
    layer 1: ht=     17 m, wt= 0.154, ws=  5.0 m/s
    layer 2: ht=     35 m, wt= 0.041, ws=  5.4 m/s
    layer 3: ht=     52 m, wt= 0.002, ws=  6.6 m/s
    layer 4: ht=    139 m, wt= 0.021, ws=  6.1 m/s
    layer 5: ht=    231 m, wt= 0.010, ws=  6.1 m/s
    layer 6: ht=    323 m, wt= 0.008, ws=  6.1 m/s
    layer 7: ht=    416 m, wt= 0.005, ws=  6.1 m/s
    layer 8: ht=    508 m, wt= 0.001, ws=  6.1 m/s
    layer 9: ht=    932 m, wt= 0.107, ws=  5.6 m/s
    layer 10: ht=   5022 m, wt= 0.144, ws= 11.1 m/s
    layer 11: ht=   9238 m, wt= 0.093, ws= 19.1 m/s
    layer 12: ht=  13856 m, wt= 0.075, ws=  8.2 m/s
    layer 13: ht=  22518 m, wt= 0.036, ws=  4.8 m/s
[00;00mReconstruction[00;00m: r0=0.128424m L0=30m. 14 layers. use cone coordinate.
    layer 0: ht=      0 m, wt= 0.302
    layer 1: ht=     17 m, wt= 0.154
    layer 2: ht=     35 m, wt= 0.041
    layer 3: ht=     52 m, wt= 0.002
    layer 4: ht=    139 m, wt= 0.021
    layer 5: ht=    231 m, wt= 0.010
    layer 6: ht=    323 m, wt= 0.008
    layer 7: ht=    416 m, wt= 0.005
    layer 8: ht=    508 m, wt= 0.001
    layer 9: ht=    932 m, wt= 0.107
    layer 10: ht=   5022 m, wt= 0.144
    layer 11: ht=   9238 m, wt= 0.093
    layer 12: ht=  13856 m, wt= 0.075
    layer 13: ht=  22518 m, wt= 0.036
[00;00mThere are 3 powfs[00;00m
  powfs0: Order 86, LGS at 99.1 km. Sampling 1/124.031 m. Thres 30%. [00;00mT/T is removed in right hand side in tomography.[00;00m
    CCD image is 25x25 @ 500x500 mas, blur 27% (sigma), 1500Hz, wvl: [ 5.89e-07]
    Gtilt in reconstruction. Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
  powfs1: Order  2, NGS at inf km. Sampling 1/16 m. Thres 30%. 
    Ztilt in reconstruction. Geomtric optics start at 2 with ztilt [00;00m(noisy)[00;00m
  powfs2: Order 20, NGS at inf km. Sampling 1/31.9716 m. Thres 50%. 
    CCD image is 4x4 @ 1500x1500 mas, blur 0% (sigma), 0.015Hz, wvl: [ 7.2e-07]
    Gtilt in reconstruction. Geomtric optics start at 50 with gtilt Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
[00;00mThere are 13 wfs[00;00m
    wfs 0: type 0, at (  30.00,    0.00) arcsec,  99 km, siglev is 19.9532 bkgrnd is 0.1
    wfs 1: type 0, at (  22.98,   19.28) arcsec,  99 km, siglev is 19.9532 bkgrnd is 0.1
    wfs 2: type 0, at (   5.21,   29.54) arcsec,  99 km, siglev is 19.9532 bkgrnd is 0.1
    wfs 3: type 0, at ( -15.00,   25.98) arcsec,  99 km, siglev is 19.9532 bkgrnd is 0.1
    wfs 4: type 0, at ( -28.19,   10.26) arcsec,  99 km, siglev is 19.9532 bkgrnd is 0.1
    wfs 5: type 0, at ( -28.19,  -10.26) arcsec,  99 km, siglev is 19.9532 bkgrnd is 0.1
    wfs 6: type 0, at ( -15.00,  -25.98) arcsec,  99 km, siglev is 19.9532 bkgrnd is 0.1
    wfs 7: type 0, at (   5.21,  -29.54) arcsec,  99 km, siglev is 19.9532 bkgrnd is 0.1
    wfs 8: type 0, at (  22.98,  -19.28) arcsec,  99 km, siglev is 19.9532 bkgrnd is 0.1
    wfs 9: type 1, at (   5.00,    8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 10: type 1, at ( -10.00,    0.00) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 11: type 1, at (   5.00,   -8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 12: type 2, at (   0.00,    0.00) arcsec, inf km, siglev is 4.1558e+06 bkgrnd is 0.001
[00;00mThere are 3 DMs[00;00m
  DM 0 at -0.1km, actuator pitch 0.129m, offset   0, with 30.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 1 at    6km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 2 at   10km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
[00;00mTomography[00;00m is using CG, with [00;00mFourer Domain[00;00m preconditioner, [00;00m12[00;00m iterations, integrated tomo.
[00;00mDM Fitting [00;00mis using CG, with [00;00mNo[00;00m preconditioner, [00;00m10[00;00m iterations
[00;00mThere are 9 fit directions[00;00m
    Fit 0: weight is 0.444, at (   0.00,    0.00) arcsec
    Fit 1: weight is 0.111, at (  15.00,    0.00) arcsec
    Fit 2: weight is 0.111, at (   0.00,   15.00) arcsec
    Fit 3: weight is 0.111, at ( -15.00,    0.00) arcsec
    Fit 4: weight is 0.111, at (   0.00,  -15.00) arcsec
    Fit 5: weight is 0.028, at (  15.00,   15.00) arcsec
    Fit 6: weight is 0.028, at ( -15.00,   15.00) arcsec
    Fit 7: weight is 0.028, at ( -15.00,  -15.00) arcsec
    Fit 8: weight is 0.028, at (  15.00,  -15.00) arcsec
[00;00mThere are 1 evaluation directions[00;00m at sampling 1/128 m.
    Evl 0: weight is 1.000, at (   0.00,    0.00) arcsec
[00;00mSimulation[00;00m start at step 0, end at step 1600, with time step 1/1500s, [00;00mclose loop[00;00m.
After setup_parms:	120.4 MiB.
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
CUDA: minimum memory requirement is 0.3GB
GPU 0 is NVIDIA A100-SXM4-40GB with arch 8.0, 38.9GB free, 39.3GB total device memory.
Using GPU 0
Use 1 GPUs for WFS Tomo Fit Evl

*** Preparation started at 2025/02/17 15:49:22 in nid001972. ***

Using OpenMP version 201511 with 128 threads
Reading aperture amplitude map from KECK.fits
[00;00m[0;36mWarning(accphi.c:477): 108268 points not covered by input screen
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
 ->maos.c:447->setup.c:148->aper.c:74->utils.c:478->accphi.c:478
iwvl 0: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 1: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 2: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 3: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 4: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 5: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 6: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 7: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 8: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
After setup_aper:	340.9 MiB.

[00;00mSetting up powfs 0 geom[00;00m

There are 16 points in each subaperture of 0.129m.
There are 4460 valid subaperture.

[00;00mSetting up powfs 1 geom[00;00m

There are 88 points in each subaperture of 5.5m.
There are 4 valid subaperture.

[00;00mSetting up powfs 2 geom[00;00m

There are 18 points in each subaperture of 0.563m.
There are 236 valid subaperture.
After setup_powfs_init:	415.1 MiB.

[00;00mSetting up reconstructor geometry.[00;00m

PLOC is 175x175, with sampling of 0.06m (square)
    DM 0: grid is 89 x 89
    DM 1: grid is 75 x 75
    DM 2: grid is 80 x 79
FLOC is 175x175, with sampling of 0.06m (not square)
Tomography grid is square:
    layer 0: xloc grid is 320 x 320, sampling is 0.065 m, 102400 points
    layer 1: xloc grid is 320 x 320, sampling is 0.064 m, 102400 points
    layer 2: xloc grid is 320 x 320, sampling is 0.064 m, 102400 points
    layer 3: xloc grid is 320 x 320, sampling is 0.064 m, 102400 points
    layer 4: xloc grid is 320 x 320, sampling is 0.064 m, 102400 points
    layer 5: xloc grid is 320 x 320, sampling is 0.064 m, 102400 points
    layer 6: xloc grid is 320 x 320, sampling is 0.064 m, 102400 points
    layer 7: xloc grid is 320 x 320, sampling is 0.064 m, 102400 points
    layer 8: xloc grid is 320 x 320, sampling is 0.064 m, 102400 points
    layer 9: xloc grid is 320 x 320, sampling is 0.064 m, 102400 points
    layer 10: xloc grid is 320 x 320, sampling is 0.061 m, 102400 points
    layer 11: xloc grid is 320 x 320, sampling is 0.058 m, 102400 points
    layer 12: xloc grid is 320 x 320, sampling is 0.055 m, 102400 points
    layer 13: xloc grid is 320 x 320, sampling is 0.050 m, 102400 points

[00;00mSetting up powfs 0 PO WFS[00;00m

OTF dimension is 32x32 (calculated)
Uplink FWHM (illt 0, iwvl 0) is 0.578379"
Downlink FWHM (illt 0, iwvl 0) is 0"
Generating matched filter for powfs 0
sa index   location       noise equivalent angle
    2228: (  4.9,  -0.1) m, (5000.00, 5000.00) mas
    2219: (  3.7,  -0.1) m, (5000.00, 5000.00) mas
    2211: (  2.7,  -0.1) m, (5000.00, 5000.00) mas
    2202: (  1.5,  -0.1) m, (5000.00, 5000.00) mas
    2200: (  1.3,  -0.1) m, (5000.00, 5000.00) mas
    1607: ( -0.5,  -1.3) m, (5000.00, 5000.00) mas
    2194: ( -1.8,  -0.1) m, (5000.00, 5000.00) mas
    2186: ( -2.8,  -0.1) m, (5000.00, 5000.00) mas
    2177: ( -4.0,  -0.1) m, (5000.00, 5000.00) mas
    2169: ( -5.0,  -0.1) m, (5000.00, 5000.00) mas
    2166: ( -5.4,  -0.1) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    3813: (  3.7,   3.0) m, (5000.00, 5000.00) mas
    3563: (  3.0,   2.5) m, (5000.00, 5000.00) mas
    3235: (  2.2,   1.8) m, (5000.00, 5000.00) mas
    2865: (  1.4,   1.2) m, (5000.00, 5000.00) mas
    2724: (  1.0,   0.9) m, (5000.00, 5000.00) mas
    1614: (  0.4,  -1.3) m, (5000.00, 5000.00) mas
    1739: ( -1.3,  -1.0) m, (5000.00, 5000.00) mas
    1599: ( -1.5,  -1.3) m, (5000.00, 5000.00) mas
     901: ( -3.1,  -2.6) m, (5000.00, 5000.00) mas
     590: ( -3.9,  -3.2) m, (5000.00, 5000.00) mas
     188: ( -3.1,  -4.3) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    4454: (  0.8,   4.8) m, (5000.00, 5000.00) mas
    4209: (  0.6,   4.0) m, (5000.00, 5000.00) mas
    3604: (  0.4,   2.6) m, (5000.00, 5000.00) mas
    3220: (  0.3,   1.8) m, (5000.00, 5000.00) mas
    2928: (  0.1,   1.3) m, (5000.00, 5000.00) mas
    2061: ( -1.4,  -0.4) m, (5000.00, 5000.00) mas
    1316: ( -0.4,  -1.8) m, (5000.00, 5000.00) mas
    1243: ( -0.4,  -1.9) m, (5000.00, 5000.00) mas
     556: ( -0.6,  -3.4) m, (5000.00, 5000.00) mas
       5: ( -0.9,  -4.9) m, (5000.00, 5000.00) mas
       2: ( -2.3,  -4.9) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    4375: ( -2.7,   4.5) m, (5000.00, 5000.00) mas
    4138: ( -2.3,   3.9) m, (5000.00, 5000.00) mas
    3770: ( -1.8,   3.0) m, (5000.00, 5000.00) mas
    3344: ( -1.3,   2.1) m, (5000.00, 5000.00) mas
    2848: ( -0.8,   1.2) m, (5000.00, 5000.00) mas
    2336: (  1.3,   0.1) m, (5000.00, 5000.00) mas
    1616: (  0.6,  -1.3) m, (5000.00, 5000.00) mas
    1119: (  1.2,  -2.2) m, (5000.00, 5000.00) mas
     694: (  1.7,  -3.1) m, (5000.00, 5000.00) mas
     325: (  2.2,  -4.0) m, (5000.00, 5000.00) mas
      88: (  2.6,  -4.6) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    3037: ( -4.6,   1.5) m, (5000.00, 5000.00) mas
    3038: ( -4.5,   1.5) m, (5000.00, 5000.00) mas
    2765: ( -3.1,   1.0) m, (5000.00, 5000.00) mas
    2531: ( -1.7,   0.5) m, (5000.00, 5000.00) mas
    2469: ( -1.3,   0.4) m, (5000.00, 5000.00) mas
    1538: (  0.0,  -1.4) m, (5000.00, 5000.00) mas
    1934: (  1.5,  -0.6) m, (5000.00, 5000.00) mas
    1757: (  2.6,  -1.0) m, (5000.00, 5000.00) mas
    1699: (  3.0,  -1.2) m, (5000.00, 5000.00) mas
    1426: (  4.4,  -1.7) m, (5000.00, 5000.00) mas
    2027: (  5.2,  -0.5) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
    1356: ( -4.6,  -1.7) m, (5000.00, 5000.00) mas
    1357: ( -4.5,  -1.7) m, (5000.00, 5000.00) mas
    1660: ( -3.1,  -1.2) m, (5000.00, 5000.00) mas
    1925: ( -1.7,  -0.6) m, (5000.00, 5000.00) mas
    1995: ( -1.3,  -0.5) m, (5000.00, 5000.00) mas
    2927: (  0.0,   1.3) m, (5000.00, 5000.00) mas
    2540: (  1.5,   0.5) m, (5000.00, 5000.00) mas
    2736: (  2.6,   0.9) m, (5000.00, 5000.00) mas
    2804: (  3.0,   1.0) m, (5000.00, 5000.00) mas
    3107: (  4.4,   1.5) m, (5000.00, 5000.00) mas
    2501: (  5.2,   0.4) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
      51: ( -2.7,  -4.6) m, (5000.00, 5000.00) mas
     290: ( -2.3,  -4.0) m, (5000.00, 5000.00) mas
     667: ( -1.8,  -3.1) m, (5000.00, 5000.00) mas
    1100: ( -1.3,  -2.2) m, (5000.00, 5000.00) mas
    1605: ( -0.8,  -1.3) m, (5000.00, 5000.00) mas
    2132: (  1.3,  -0.3) m, (5000.00, 5000.00) mas
    2859: (  0.6,   1.2) m, (5000.00, 5000.00) mas
    3363: (  1.2,   2.1) m, (5000.00, 5000.00) mas
    3797: (  1.7,   3.0) m, (5000.00, 5000.00) mas
    4173: (  2.2,   3.9) m, (5000.00, 5000.00) mas
    4410: (  2.6,   4.5) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
      10: (  0.8,  -4.9) m, (5000.00, 5000.00) mas
     265: (  0.6,  -4.1) m, (5000.00, 5000.00) mas
     867: (  0.4,  -2.7) m, (5000.00, 5000.00) mas
    1248: (  0.3,  -1.9) m, (5000.00, 5000.00) mas
    1539: (  0.1,  -1.4) m, (5000.00, 5000.00) mas
    2401: ( -1.4,   0.3) m, (5000.00, 5000.00) mas
    3143: ( -0.4,   1.7) m, (5000.00, 5000.00) mas
    3215: ( -0.4,   1.8) m, (5000.00, 5000.00) mas
    3898: ( -0.6,   3.2) m, (5000.00, 5000.00) mas
    4449: ( -0.9,   4.8) m, (5000.00, 5000.00) mas
    4446: ( -2.3,   4.8) m, (5000.00, 5000.00) mas
sa index   location       noise equivalent angle
     710: (  3.7,  -3.1) m, (5000.00, 5000.00) mas
     948: (  3.0,  -2.6) m, (5000.00, 5000.00) mas
    1263: (  2.2,  -1.9) m, (5000.00, 5000.00) mas
    1622: (  1.4,  -1.3) m, (5000.00, 5000.00) mas
    1745: (  1.0,  -1.0) m, (5000.00, 5000.00) mas
    2857: (  0.4,   1.2) m, (5000.00, 5000.00) mas
    2718: ( -1.3,   0.9) m, (5000.00, 5000.00) mas
    2842: ( -1.5,   1.2) m, (5000.00, 5000.00) mas
    3516: ( -3.1,   2.5) m, (5000.00, 5000.00) mas
    3576: ( -3.2,   2.6) m, (5000.00, 5000.00) mas
    4228: ( -3.1,   4.1) m, (5000.00, 5000.00) mas

[00;00mSetting up powfs 2 PO WFS[00;00m

OTF dimension is 48x48 (calculated)
Generating matched filter for powfs 2
Use sanea to derive neasim
Use sanea to derive neasim

[00;00mSetting up reconstructor[00;00m

Recon NEA: cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) cmf(5000.00) geom(0.31) geom(0.31) geom(0.31) mf(0.14)  mas
Setup or update control matrix parameters.
RRtwfs svd threshold is 1e-10
Replacing HA by HA*fit->actextrap
Adding piston cr to fit matrix
Adding TT cr on upper DMs to fit matrix.
Before assembling fit matrix:	6326.9 MiB.
Building fit->FR
Building fit->FL
Adding tikhonov constraint of 1.0e-07 to FLM
The maximum eigen value is estimated to be around 2.5e-04
DM Fit number of Low rank terms: 16 in LHS
After assemble fit matrix:	8716.5 MiB.
After setup_recon:	8716.5 MiB.
GPU 0: mem used 1564 MB (wfs init)
GPU 0: mem used 3068 MB (recon init)
GPU 0: mem used 3098 MB (perf init)

*** Simulation started at 2025/02/17 15:51:27 in nid001972. ***

Running seed 1
GPU 0: mem used 3098 MB (wfs seeding)
Wind dir: 267.3 261.7 167.0 130.5 300.7  32.3 119.8 139.0 150.8 277.7 203.0 133.1  45.9 265.1 deg
Using /global/homes/b/bpeck/.aos/cache/atm/vonkarman_14_8192x8192_0.0078125_1115374592d.bin
After genatm:	8553.3 MiB.
Step     #  Open Loop  PR TT  On axis  PR TT  Field RMS PR TT     Timing 
Step     0: OL  884.6  248.3  OA  884.6 248.3 CL  884.6 248.3 nm  0.122 s
Step    11: OL  901.5  252.7  OA  795.0 244.3 CL  795.0 244.3 nm  0.095 s
Step    22: OL  918.5  256.5  OA  800.1 243.3 CL  800.1 243.3 nm  0.106 s
Step    32: OL  933.9  259.2  OA  803.4 240.8 CL  803.4 240.8 nm  0.110 s
Step    42: OL  949.0  260.8  OA  805.2 237.8 CL  805.2 237.8 nm  0.100 s
Step    52: OL  963.7  261.3  OA  805.3 234.0 CL  805.3 234.0 nm  0.101 s
Step    62: OL  978.7  260.8  OA  805.8 229.2 CL  805.8 229.2 nm  0.099 s
Step    72: OL  994.0  259.8  OA  804.3 224.3 CL  804.3 224.3 nm  0.102 s
Step    82: OL 1009.7  258.8  OA  803.7 218.6 CL  803.7 218.6 nm  0.100 s
Step    92: OL 1025.6  258.1  OA  806.3 214.5 CL  806.3 214.5 nm  0.103 s
Step   102: OL 1041.6  257.7  OA  809.1 210.4 CL  809.1 210.4 nm  0.109 s
Step   112: OL 1057.6  258.1  OA  815.9 206.8 CL  815.9 206.8 nm  0.101 s
Step   122: OL 1073.3  259.1  OA  821.9 203.2 CL  821.9 203.2 nm  0.099 s
Step   132: OL 1088.3  261.2  OA  828.5 200.2 CL  828.5 200.2 nm  0.100 s
Step   142: OL 1102.7  264.6  OA  836.8 198.7 CL  836.8 198.7 nm  0.115 s
Step   152: OL 1116.1  268.7  OA  843.2 198.5 CL  843.2 198.5 nm  0.098 s
Step   162: OL 1128.2  273.8  OA  850.0 198.9 CL  850.0 198.9 nm  0.102 s
Step   172: OL 1139.2  279.6  OA  853.2 201.7 CL  853.2 201.7 nm  0.100 s
Step   182: OL 1148.8  285.9  OA  856.7 204.5 CL  856.7 204.5 nm  0.099 s
Step   192: OL 1156.9  292.4  OA  859.4 208.5 CL  859.4 208.5 nm  0.107 s
Step   202: OL 1163.7  298.8  OA  860.8 212.5 CL  860.8 212.5 nm  0.103 s
Step   212: OL 1169.6  305.2  OA  863.2 217.8 CL  863.2 217.8 nm  0.100 s
Step   222: OL 1174.3  311.7  OA  866.3 223.4 CL  866.3 223.4 nm  0.109 s
Step   232: OL 1177.7  318.2  OA  870.0 229.0 CL  870.0 229.0 nm  0.101 s
Step   242: OL 1179.8  325.0  OA  873.2 236.5 CL  873.2 236.5 nm  0.114 s
Step   252: OL 1180.1  332.1  OA  874.5 243.9 CL  874.5 243.9 nm  0.102 s
Step   255 updated high order loop gain: 0.424
Step   262: OL 1178.2  339.3  OA  876.7 252.3 CL  876.7 252.3 nm  0.098 s
Step   272: OL 1174.0  346.6  OA  876.5 261.0 CL  876.5 261.0 nm  0.104 s
Step   282: OL 1168.0  353.9  OA  874.4 269.5 CL  874.4 269.5 nm  0.107 s
Step   292: OL 1160.9  362.0  OA  872.7 280.1 CL  872.7 280.1 nm  0.104 s
Step   302: OL 1153.0  370.8  OA  870.7 290.1 CL  870.7 290.1 nm  0.099 s
Step   312: OL 1144.0  379.9  OA  867.9 301.2 CL  867.9 301.2 nm  0.103 s
Step   322: OL 1133.7  389.6  OA  864.3 312.5 CL  864.3 312.5 nm  0.102 s
Step   332: OL 1122.8  400.2  OA  861.2 324.7 CL  861.2 324.7 nm  0.103 s
Step   342: OL 1111.7  411.8  OA  858.4 337.7 CL  858.4 337.7 nm  0.100 s
Step   352: OL 1100.4  424.5  OA  857.0 352.4 CL  857.0 352.4 nm  0.102 s
Step   362: OL 1089.3  438.1  OA  858.2 367.4 CL  858.2 367.4 nm  0.099 s
Step   372: OL 1078.6  452.3  OA  859.4 382.7 CL  859.4 382.7 nm  0.100 s
Step   382: OL 1068.0  466.7  OA  859.8 398.1 CL  859.8 398.1 nm  0.107 s
Step   392: OL 1057.7  481.2  OA  860.4 413.2 CL  860.4 413.2 nm  0.101 s
Step   402: OL 1047.1  495.6  OA  862.0 428.3 CL  862.0 428.3 nm  0.106 s
Step   412: OL 1036.1  509.6  OA  862.7 443.1 CL  862.7 443.1 nm  0.100 s
Step   422: OL 1024.7  523.1  OA  864.0 458.0 CL  864.0 458.0 nm  0.101 s
Step   432: OL 1013.2  536.4  OA  863.0 472.0 CL  863.0 472.0 nm  0.100 s
Step   442: OL 1002.0  549.5  OA  862.3 485.3 CL  862.3 485.3 nm  0.104 s
Step   452: OL  991.6  562.4  OA  860.0 498.3 CL  860.0 498.3 nm  0.103 s
Step   462: OL  982.7  575.6  OA  858.6 511.4 CL  858.6 511.4 nm  0.104 s
Step   472: OL  975.6  588.5  OA  861.2 524.1 CL  861.2 524.1 nm  0.099 s
Step   482: OL  970.8  601.2  OA  864.7 536.9 CL  864.7 536.9 nm  0.104 s
Step   492: OL  968.2  613.5  OA  869.3 549.2 CL  869.3 549.2 nm  0.106 s
Step   502: OL  967.1  625.1  OA  876.7 561.4 CL  876.7 561.4 nm  0.100 s
Step   511 updated high order loop gain: 0.426
Step   512: OL  966.9  635.9  OA  882.4 570.8 CL  882.4 570.8 nm  0.112 s
Step   522: OL  967.9  645.5  OA  890.4 580.5 CL  890.4 580.5 nm  0.101 s
Step   532: OL  969.8  653.6  OA  896.9 587.6 CL  896.9 587.6 nm  0.098 s
Step   542: OL  973.1  659.9  OA  903.3 591.9 CL  903.3 591.9 nm  0.100 s
Step   552: OL  977.6  664.7  OA  910.0 595.9 CL  910.0 595.9 nm  0.109 s
Step   562: OL  983.4  668.1  OA  915.2 598.2 CL  915.2 598.2 nm  0.102 s
Step   572: OL  990.2  670.2  OA  919.5 598.4 CL  919.5 598.4 nm  0.102 s
Step   582: OL  998.0  671.3  OA  923.1 597.4 CL  923.1 597.4 nm  0.101 s
Step   592: OL 1006.9  671.1  OA  926.4 595.0 CL  926.4 595.0 nm  0.102 s
Step   602: OL 1016.5  669.1  OA  929.2 591.1 CL  929.2 591.1 nm  0.108 s
Step   612: OL 1026.5  665.5  OA  930.3 585.4 CL  930.3 585.4 nm  0.100 s
Step   622: OL 1036.7  660.4  OA  931.0 577.8 CL  931.0 577.8 nm  0.100 s
Step   632: OL 1046.7  654.0  OA  929.4 568.8 CL  929.4 568.8 nm  0.110 s
Step   642: OL 1056.3  646.3  OA  926.4 558.7 CL  926.4 558.7 nm  0.099 s
Step   652: OL 1064.8  637.5  OA  920.9 547.4 CL  920.9 547.4 nm  0.099 s
Step   662: OL 1072.7  627.9  OA  915.3 536.4 CL  915.3 536.4 nm  0.103 s
Step   672: OL 1079.9  617.6  OA  908.2 523.5 CL  908.2 523.5 nm  0.101 s
Step   682: OL 1086.7  607.2  OA  901.1 509.4 CL  901.1 509.4 nm  0.107 s
Step   692: OL 1092.9  596.6  OA  893.9 494.8 CL  893.9 494.8 nm  0.101 s
Step   702: OL 1097.9  585.3  OA  887.3 478.9 CL  887.3 478.9 nm  0.104 s
Step   712: OL 1101.6  573.4  OA  879.9 461.2 CL  879.9 461.2 nm  0.103 s
Step   722: OL 1103.6  561.0  OA  872.3 444.0 CL  872.3 444.0 nm  0.097 s
Step   732: OL 1104.0  548.6  OA  866.1 426.2 CL  866.1 426.2 nm  0.101 s
Step   742: OL 1102.5  536.3  OA  858.6 408.8 CL  858.6 408.8 nm  0.101 s
Step   752: OL 1099.5  524.1  OA  850.0 392.5 CL  850.0 392.5 nm  0.099 s
Step   762: OL 1095.0  512.4  OA  842.3 376.4 CL  842.3 376.4 nm  0.108 s
Step   767 updated high order loop gain: 0.427
Step   772: OL 1089.1  500.9  OA  833.9 361.6 CL  833.9 361.6 nm  0.100 s
Step   782: OL 1081.3  489.7  OA  825.3 347.7 CL  825.3 347.7 nm  0.100 s
Step   792: OL 1071.8  478.5  OA  816.4 334.1 CL  816.4 334.1 nm  0.109 s
Step   802: OL 1060.8  467.3  OA  806.8 321.2 CL  806.8 321.2 nm  0.101 s
Step   812: OL 1048.7  456.2  OA  798.5 309.0 CL  798.5 309.0 nm  0.103 s
Step   822: OL 1035.3  445.0  OA  789.5 296.3 CL  789.5 296.3 nm  0.108 s
Step   832: OL 1020.5  434.1  OA  781.0 285.0 CL  781.0 285.0 nm  0.100 s
Step   842: OL 1005.2  423.6  OA  771.5 275.1 CL  771.5 275.1 nm  0.100 s
Step   852: OL  989.7  413.6  OA  763.3 265.4 CL  763.3 265.4 nm  0.100 s
Step   862: OL  974.4  404.2  OA  754.9 257.5 CL  754.9 257.5 nm  0.102 s
Step   872: OL  959.9  395.7  OA  747.5 251.2 CL  747.5 251.2 nm  0.111 s
Step   882: OL  946.5  388.0  OA  740.2 247.3 CL  740.2 247.3 nm  0.101 s
Step   892: OL  933.4  381.1  OA  734.9 244.5 CL  734.9 244.5 nm  0.104 s
Step   902: OL  920.0  374.7  OA  727.5 242.8 CL  727.5 242.8 nm  0.110 s
Step   912: OL  906.2  369.2  OA  718.4 243.3 CL  718.4 243.3 nm  0.101 s
Step   922: OL  892.6  364.3  OA  709.2 243.4 CL  709.2 243.4 nm  0.099 s
Step   932: OL  879.3  359.5  OA  698.6 244.0 CL  698.6 244.0 nm  0.105 s
Step   942: OL  866.5  354.8  OA  689.4 244.7 CL  689.4 244.7 nm  0.104 s
Step   952: OL  854.2  349.9  OA  680.0 245.4 CL  680.0 245.4 nm  0.104 s
Step   962: OL  842.9  344.6  OA  670.8 245.7 CL  670.8 245.7 nm  0.125 s
Step   972: OL  833.2  338.9  OA  664.8 245.2 CL  664.8 245.2 nm  0.098 s
Step   982: OL  824.7  332.8  OA  657.6 244.2 CL  657.6 244.2 nm  0.105 s
Step   992: OL  816.9  326.0  OA  653.7 242.5 CL  653.7 242.5 nm  0.099 s
Step  1002: OL  809.6  318.8  OA  649.2 239.7 CL  649.2 239.7 nm  0.101 s
Step  1012: OL  802.7  311.2  OA  642.5 236.1 CL  642.5 236.1 nm  0.106 s
Step  1022: OL  796.6  303.5  OA  636.6 232.6 CL  636.6 232.6 nm  0.102 s
Step  1023 updated high order loop gain: 0.427
Step  1032: OL  791.1  295.6  OA  630.9 228.5 CL  630.9 228.5 nm  0.109 s
Step  1042: OL  786.0  287.1  OA  626.6 223.4 CL  626.6 223.4 nm  0.098 s
Step  1052: OL  780.7  278.2  OA  619.5 217.7 CL  619.5 217.7 nm  0.100 s
Step  1062: OL  775.2  268.6  OA  614.5 210.6 CL  614.5 210.6 nm  0.107 s
Step  1072: OL  770.2  257.9  OA  607.5 202.4 CL  607.5 202.4 nm  0.104 s
Step  1082: OL  766.2  246.4  OA  603.1 192.8 CL  603.1 192.8 nm  0.103 s
Step  1092: OL  763.3  234.8  OA  598.5 182.2 CL  598.5 182.2 nm  0.102 s
Step  1102: OL  761.1  223.7  OA  595.6 171.8 CL  595.6 171.8 nm  0.101 s
Step  1112: OL  759.5  213.5  OA  593.9 161.9 CL  593.9 161.9 nm  0.104 s
Step  1122: OL  758.3  204.0  OA  594.4 152.9 CL  594.4 152.9 nm  0.099 s
Step  1132: OL  757.5  195.8  OA  595.5 145.1 CL  595.5 145.1 nm  0.100 s
Step  1142: OL  756.6  188.7  OA  596.2 138.2 CL  596.2 138.2 nm  0.103 s
Step  1152: OL  755.8  182.6  OA  598.8 132.6 CL  598.8 132.6 nm  0.098 s
Step  1162: OL  754.8  177.7  OA  601.8 129.2 CL  601.8 129.2 nm  0.101 s
Step  1172: OL  753.8  174.0  OA  604.2 126.3 CL  604.2 126.3 nm  0.105 s
Step  1182: OL  753.5  171.4  OA  608.2 124.0 CL  608.2 124.0 nm  0.099 s
Step  1192: OL  753.9  169.1  OA  614.1 122.0 CL  614.1 122.0 nm  0.097 s
Step  1202: OL  754.4  167.1  OA  619.7 120.8 CL  619.7 120.8 nm  0.111 s
Step  1212: OL  754.9  165.3  OA  624.9 119.1 CL  624.9 119.1 nm  0.101 s
Step  1222: OL  755.6  164.2  OA  629.4 117.9 CL  629.4 117.9 nm  0.100 s
Step  1232: OL  756.0  164.0  OA  634.4 118.1 CL  634.4 118.1 nm  0.105 s
Step  1242: OL  755.9  164.9  OA  636.8 120.2 CL  636.8 120.2 nm  0.100 s
Step  1252: OL  756.0  167.0  OA  640.0 122.3 CL  640.0 122.3 nm  0.123 s
Step  1262: OL  756.8  170.5  OA  642.5 126.0 CL  642.5 126.0 nm  0.101 s
Step  1272: OL  757.8  175.1  OA  645.0 129.9 CL  645.0 129.9 nm  0.100 s
Step  1279 updated high order loop gain: 0.428
Step  1282: OL  759.5  180.6  OA  646.6 135.2 CL  646.6 135.2 nm  0.107 s
Step  1292: OL  762.0  186.7  OA  648.6 138.8 CL  648.6 138.8 nm  0.103 s
Step  1302: OL  764.6  193.4  OA  649.2 143.7 CL  649.2 143.7 nm  0.101 s
Step  1312: OL  767.0  200.7  OA  648.0 148.4 CL  648.0 148.4 nm  0.101 s
Step  1322: OL  769.3  208.7  OA  643.7 153.6 CL  643.7 153.6 nm  0.100 s
Step  1332: OL  772.3  217.2  OA  642.5 158.8 CL  642.5 158.8 nm  0.101 s
Step  1342: OL  776.1  226.3  OA  639.3 164.3 CL  639.3 164.3 nm  0.099 s
Step  1352: OL  780.9  235.4  OA  635.3 169.1 CL  635.3 169.1 nm  0.100 s
Step  1362: OL  786.8  244.0  OA  635.5 173.1 CL  635.5 173.1 nm  0.106 s
Step  1372: OL  793.2  251.4  OA  634.2 175.8 CL  634.2 175.8 nm  0.099 s
Step  1382: OL  800.1  257.7  OA  634.2 178.3 CL  634.2 178.3 nm  0.099 s
Step  1392: OL  807.6  263.0  OA  636.6 179.3 CL  636.6 179.3 nm  0.110 s
Step  1402: OL  816.0  267.3  OA  638.2 179.3 CL  638.2 179.3 nm  0.104 s
Step  1412: OL  825.0  270.6  OA  641.8 179.5 CL  641.8 179.5 nm  0.099 s
Step  1422: OL  834.5  273.2  OA  645.1 179.1 CL  645.1 179.1 nm  0.111 s
Step  1432: OL  843.9  275.5  OA  647.2 178.8 CL  647.2 178.8 nm  0.099 s
Step  1442: OL  852.9  277.4  OA  647.7 178.6 CL  647.7 178.6 nm  0.103 s
Step  1452: OL  861.6  278.9  OA  649.6 178.0 CL  649.6 178.0 nm  0.102 s
Step  1462: OL  869.5  279.6  OA  650.1 176.5 CL  650.1 176.5 nm  0.105 s
Step  1472: OL  876.0  279.4  OA  650.2 176.0 CL  650.2 176.0 nm  0.109 s
Step  1482: OL  880.4  278.1  OA  649.4 175.3 CL  649.4 175.3 nm  0.099 s
Step  1492: OL  882.8  275.7  OA  646.3 174.5 CL  646.3 174.5 nm  0.101 s
Step  1502: OL  883.3  272.3  OA  643.9 172.4 CL  643.9 172.4 nm  0.118 s
Step  1512: OL  882.3  268.1  OA  636.9 171.1 CL  636.9 171.1 nm  0.111 s
Step  1522: OL  880.1  263.3  OA  633.1 170.0 CL  633.1 170.0 nm  0.104 s
Step  1532: OL  876.6  257.8  OA  628.9 167.7 CL  628.9 167.7 nm  0.105 s
Step  1535 updated high order loop gain: 0.428
Step  1542: OL  872.2  251.5  OA  627.0 165.1 CL  627.0 165.1 nm  0.113 s
Step  1552: OL  867.4  244.9  OA  625.1 162.8 CL  625.1 162.8 nm  0.110 s
Step  1562: OL  862.6  238.3  OA  626.5 160.7 CL  626.5 160.7 nm  0.100 s
Step  1572: OL  857.6  232.3  OA  627.0 159.7 CL  627.0 159.7 nm  0.106 s
Step  1582: OL  852.3  226.9  OA  625.2 159.4 CL  625.2 159.4 nm  0.099 s
Step  1592: OL  846.5  222.5  OA  627.8 160.4 CL  627.8 160.4 nm  0.103 s
Step 1599: Output PSF
Step  1599: OL  842.4  219.6  OA  629.0 161.6 CL  629.0 161.6 nm  1.922 s
Mean: 747.98 338.09 667.22  nm.

*** Simulation Finished at 2025/02/17 15:54:22 in nid001972. ***

[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
/global/cfs/cdirs/ulens/vismcao/maos -o studies/reduced_ngs/9_lgs/8mag_lgs/6000count -c master_files/reduced_ngs/9_lgs/8mag_lgs/kola_6000act.conf -O 
Output folder is 'studies/reduced_ngs/9_lgs/8mag_lgs/6000count'.
SRC: /global/homes/b/bpeck/code/maos v2.9 4c88b7c2 2024-11-13 16:45:33 -0800
BUILT: /global/homes/b/bpeck/code/maos/optim by GCC (v12) on 2024/11/18 09:40:03 CPU(F64,+O3) with CUDA(v122,F32)
Launched at 2025/02/17 15:54:22 in nid001972 with PID 1704131.
The web based job monitor can be accessed at http://localhost:10300
Main config file is /global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_6000act.conf
[00;00m[0;36mWarning(path.c:48): Path not found: path=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; abspath=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; Ignored.
[00;00m[0;36mWarning(path.c:48): Path not found: path=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; abspath=/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; Ignored.
[00;00m[0;36mWarning(readcfg.c:399): sim.apfsm has been renamed to powfs.apfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.epfsm has been renamed to powfs.epfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.alfsm has been renamed to powfs.alfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.commonfsm has been renamed to powfs.commonfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.idealfsm has been renamed to powfs.idealfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.zetafsm has been renamed to powfs.zetafsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.f0fsm has been renamed to powfs.f0fsm.
[00;00m[0;36mWarning(readcfg.c:399): tsurf has been renamed to ncpa.tsurf.
loaded 132 (132 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_sim.conf'
loaded  19 ( 19 new) records from '/global/cfs/cdirs/ulens/vismcao/./dm_none.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_ASM.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_DM2.conf'
loaded  19 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_DM3.conf'
loaded   0 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_dm_multiple.conf'
loaded   7 (  5 new) records from '/global/cfs/cdirs/ulens/vismcao/./atm_mk13n50p_ground_detail.conf'
loaded  76 ( 69 new) records from '/global/homes/b/bpeck/code/maos/config/maos/powfs_common.conf'
loaded  44 ( 38 new) records from '/global/cfs/cdirs/ulens/vismcao/./powfs_none.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_lgs.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_ttf_strap.conf'
loaded  44 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_shwfs_twfs_lbwfs.conf'
loaded   0 (  0 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_wfs_lgs_strap_lbwfs.conf'
loaded  71 ( 71 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_recon.conf'
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_smooth has been renamed to powfs0_llt.na_smooth.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_interp has been renamed to powfs0_llt.na_interp.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_thres has been renamed to powfs0_llt.na_thres.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_maxit has been renamed to powfs0_llt.na_fit_maxit.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_svdthres has been renamed to powfs0_llt.na_fit_svdthres.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_dh has been renamed to powfs0_llt.na_fit_dh.
[00;00m[0;36mWarning(readcfg.c:399): dbg.ncpa_preload has been renamed to ncpa.preload.
[00;00m[0;36mWarning(readcfg.c:399): dbg.ncpa_rmsci has been renamed to ncpa.rmsci.
[00;00m[0;36mWarning(readcfg.c:399): dbg.draw_opdmax has been renamed to plot.opdmax.
[00;00m[0;36mWarning(readcfg.c:399): dbg.draw_gmax has been renamed to plot.gmax.
loaded  95 ( 93 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_dbg.conf'
loaded   4 (  4 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_fit_mcao.conf'
[00;00m[0;36mWarning(readcfg.c:399): surf has been renamed to ncpa.surf.
loaded  39 (  7 new) records from '/global/cfs/cdirs/ulens/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_6000act.conf'
loaded   0 (  0 new) records from 'command line'
loaded  24 ( 18 new) records from '/global/cfs/cdirs/ulens/vismcao/./keck_llt_CL.conf'
Adjust LGS range by telescope altitude 4145m.
Zenith angle is 30 degree.
    Scaling turbulence height and LGS hs by sec(za).
    Scaling r0 by cos(za)^(3/5).
    Scaling wind speed and LGS signal level by cos(za).
powfs0: Adjusting dx from 0.0078125 to 0.007875. 
powfs0.llt.fsm: f0=0 Hz, LPF ep=0
powfs0.epfsm is set to 0.517618 (auto)
powfs2: Adjusting dx from 0.03125 to 0.0312778. 
powfs2 is TWFS for powfs0
sim.ephi is set to 0.427717 (auto)
sim.eplo is set to 0.427717 (auto)
[00;00m[0;36mWarning(parms.c:2296): Layer 1 at 17.3205m is very close to layer 0 at 0m (OK).
[00;00m[0;36mWarning(parms.c:2296): Layer 2 at 34.641m is very close to layer 1 at 17.3205m (OK).
[00;00m[0;36mWarning(parms.c:2296): Layer 3 at 51.9615m is very close to layer 2 at 34.641m (OK).
dm 0: stroke=30 um is provided in micron.
dm 0: assume ia stroke=2 um is provided in micron.
dm 1: stroke=7 um is provided in micron.
dm 1: assume ia stroke=2 um is provided in micron.
dm 2: stroke=7 um is provided in micron.
dm 2: assume ia stroke=2 um is provided in micron.
Focus blending is not implemented yet for integrated tomography
parms->sim.mffocus is reset to 0
There are 1 valid simulation seeds:  1
Output PSF for 1 directions
Used 449 of 456 supplied keys
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_flate" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_flatv" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_psx" is not recognized, value is [0 0 0 0]
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_psy" is not recognized, value is [0 0 0 0]
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_pupelong" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_raw" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_side" is not recognized, value is 4
[00;00mAperture[00;00m is 11 m with sampling 1/128 m
[00;00mTurbulence at 30 degree zenith angle:[00;00m r0=0.128424m, L0=30m, 14 layers.
    Greenwood freq is 25.1Hz, anisoplanatic angle is 1.58 as
    Sampled 8192x8192 at 1/128m. wind dir is randomized.
    layer 0: ht=      0 m, wt= 0.302, ws=  4.8 m/s
    layer 1: ht=     17 m, wt= 0.154, ws=  5.0 m/s
    layer 2: ht=     35 m, wt= 0.041, ws=  5.4 m/s
    layer 3: ht=     52 m, wt= 0.002, ws=  6.6 m/s
    layer 4: ht=    139 m, wt= 0.021, ws=  6.1 m/s
    layer 5: ht=    231 m, wt= 0.010, ws=  6.1 m/s
    layer 6: ht=    323 m, wt= 0.008, ws=  6.1 m/s
    layer 7: ht=    416 m, wt= 0.005, ws=  6.1 m/s
    layer 8: ht=    508 m, wt= 0.001, ws=  6.1 m/s
    layer 9: ht=    932 m, wt= 0.107, ws=  5.6 m/s
    layer 10: ht=   5022 m, wt= 0.144, ws= 11.1 m/s
    layer 11: ht=   9238 m, wt= 0.093, ws= 19.1 m/s
    layer 12: ht=  13856 m, wt= 0.075, ws=  8.2 m/s
    layer 13: ht=  22518 m, wt= 0.036, ws=  4.8 m/s
[00;00mReconstruction[00;00m: r0=0.128424m L0=30m. 14 layers. use cone coordinate.
    layer 0: ht=      0 m, wt= 0.302
    layer 1: ht=     17 m, wt= 0.154
    layer 2: ht=     35 m, wt= 0.041
    layer 3: ht=     52 m, wt= 0.002
    layer 4: ht=    139 m, wt= 0.021
    layer 5: ht=    231 m, wt= 0.010
    layer 6: ht=    323 m, wt= 0.008
    layer 7: ht=    416 m, wt= 0.005
    layer 8: ht=    508 m, wt= 0.001
    layer 9: ht=    932 m, wt= 0.107
    layer 10: ht=   5022 m, wt= 0.144
    layer 11: ht=   9238 m, wt= 0.093
    layer 12: ht=  13856 m, wt= 0.075
    layer 13: ht=  22518 m, wt= 0.036
[00;00mThere are 3 powfs[00;00m
  powfs0: Order 88, LGS at 99.1 km. Sampling 1/126.984 m. Thres 30%. [00;00mT/T is removed in right hand side in tomography.[00;00m
    CCD image is 25x25 @ 500x500 mas, blur 27% (sigma), 1500Hz, wvl: [ 5.89e-07]
    Gtilt in reconstruction. Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
  powfs1: Order  2, NGS at inf km. Sampling 1/16 m. Thres 30%. 
    Ztilt in reconstruction. Geomtric optics start at 2 with ztilt [00;00m(noisy)[00;00m
  powfs2: Order 20, NGS at inf km. Sampling 1/31.9716 m. Thres 50%. 
    CCD image is 4x4 @ 1500x1500 mas, blur 0% (sigma), 0.015Hz, wvl: [ 7.2e-07]
    Gtilt in reconstruction. Geomtric optics start at 50 with gtilt Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
[00;00mThere are 13 wfs[00;00m
    wfs 0: type 0, at (  30.00,    0.00) arcsec,  99 km, siglev is 19.0361 bkgrnd is 0.1
    wfs 1: type 0, at (  22.98,   19.28) arcsec,  99 km, siglev is 19.0361 bkgrnd is 0.1
    wfs 2: type 0, at (   5.21,   29.54) arcsec,  99 km, siglev is 19.0361 bkgrnd is 0.1
    wfs 3: type 0, at ( -15.00,   25.98) arcsec,  99 km, siglev is 19.0361 bkgrnd is 0.1
    wfs 4: type 0, at ( -28.19,   10.26) arcsec,  99 km, siglev is 19.0361 bkgrnd is 0.1
    wfs 5: type 0, at ( -28.19,  -10.26) arcsec,  99 km, siglev is 19.0361 bkgrnd is 0.1
    wfs 6: type 0, at ( -15.00,  -25.98) arcsec,  99 km, siglev is 19.0361 bkgrnd is 0.1
    wfs 7: type 0, at (   5.21,  -29.54) arcsec,  99 km, siglev is 19.0361 bkgrnd is 0.1
    wfs 8: type 0, at (  22.98,  -19.28) arcsec,  99 km, siglev is 19.0361 bkgrnd is 0.1
    wfs 9: type 1, at (   5.00,    8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 10: type 1, at ( -10.00,    0.00) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 11: type 1, at (   5.00,   -8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 12: type 2, at (   0.00,    0.00) arcsec, inf km, siglev is 4.1558e+06 bkgrnd is 0.001
[00;00mThere are 3 DMs[00;00m
  DM 0 at -0.1km, actuator pitch 0.126m, offset   0, with 30.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 1 at    6km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 2 at   10km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
[00;00mTomography[00;00m is using CG, with [00;00mFourer Domain[00;00m preconditioner, [00;00m12[00;00m iterations, integrated tomo.
[00;00mDM Fitting [00;00mis using CG, with [00;00mNo[00;00m preconditioner, [00;00m10[00;00m iterations
[00;00mThere are 9 fit directions[00;00m
    Fit 0: weight is 0.444, at (   0.00,    0.00) arcsec
    Fit 1: weight is 0.111, at (  15.00,    0.00) arcsec
    Fit 2: weight is 0.111, at (   0.00,   15.00) arcsec
    Fit 3: weight is 0.111, at ( -15.00,    0.00) arcsec
    Fit 4: weight is 0.111, at (   0.00,  -15.00) arcsec
    Fit 5: weight is 0.028, at (  15.00,   15.00) arcsec
    Fit 6: weight is 0.028, at ( -15.00,   15.00) arcsec
    Fit 7: weight is 0.028, at ( -15.00,  -15.00) arcsec
    Fit 8: weight is 0.028, at (  15.00,  -15.00) arcsec
[00;00mThere are 1 evaluation directions[00;00m at sampling 1/128 m.
    Evl 0: weight is 1.000, at (   0.00,    0.00) arcsec
[00;00mSimulation[00;00m start at step 0, end at step 1600, with time step 1/1500s, [00;00mclose loop[00;00m.
After setup_parms:	120.5 MiB.
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
CUDA: minimum memory requirement is 0.3GB
GPU 0 is NVIDIA A100-SXM4-40GB with arch 8.0, 38.9GB free, 39.3GB total device memory.
Using GPU 0
Use 1 GPUs for WFS Tomo Fit Evl

*** Preparation started at 2025/02/17 15:54:23 in nid001972. ***

Using OpenMP version 201511 with 128 threads
Reading aperture amplitude map from KECK.fits
[00;00m[0;36mWarning(accphi.c:477): 108730 points not covered by input screen
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid001972/scheduler) failed: Invalid argument. 
 ->maos.c:447->setup.c:148->aper.c:74->utils.c:478->accphi.c:478
iwvl 0: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 1: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 2: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 3: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 4: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 5: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 6: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 7: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 8: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
After setup_aper:	343.0 MiB.

[00;00mSetting up powfs 0 geom[00;00m

There are 16 points in each subaperture of 0.126m.
There are 4663 valid subaperture.

[00;00mSetting up powfs 1 geom[00;00m

There are 88 points in each subaperture of 5.5m.
There are 4 valid subaperture.

[00;00mSetting up powfs 2 geom[00;00m

There are 18 points in each subaperture of 0.563m.
There are 236 valid subaperture.
After setup_powfs_init:	421.9 MiB.

[00;00mSetting up reconstructor geometry.[00;00m

PLOC is 179x179, with sampling of 0.06m (square)
    DM 0: grid is 91 x 91
    DM 1: grid is 75 x 75
    DM 2: grid is 80 x 79
FLOC is 179x179, with sampling of 0.06m (not square)
Tomography grid is square:
    layer 0: xloc grid is 320 x 320, sampling is 0.063 m, 102400 points
    layer 1: xloc grid is 320 x 320, sampling is 0.063 m, 102400 points
    layer 2: xloc grid is 320 x 320, sampling is 0.063 m, 102400 points
    layer 3: xloc grid is 320 x 320, sampling is 0.063 m, 102400 points
    layer 4: xloc grid is 320 x 320, sampling is 0.063 m, 102400 points
    layer 5: xloc grid is 320 x 320, sampling is 0.063 m, 102400 points
    layer 6: xloc grid is 320 x 320, sampling is 0.063 m, 102400 points
    layer 7: xloc grid is 320 x 320, sampling is 0.063 m, 102400 points
    layer 8: xloc grid is 320 x 320, sampling is 0.063 m, 102400 points
    layer 9: xloc grid is 320 x 320, sampling is 0.062 m, 102400 points
    layer 10: xloc grid is 320 x 320, sampling is 0.060 m, 102400 points
    layer 11: xloc grid is 320 x 320, sampling is 0.057 m, 102400 points
    layer 12: xloc grid is 320 x 320, sampling is 0.054 m, 102400 points
    layer 13: xloc grid is 320 x 320, sampling is 0.049 m, 102400 points

[00;00mSetting up powfs 0 PO WFS[00;00m

OTF dimension is 32x32 (calculated)
There is no bias
Uplink FWHM (illt 0, iwvl 0) is 0.579373"
Downlink FWHM (illt 0, iwvl 0) is 1.5197"
Generating matched filter for powfs 0
sa index   location       noise equivalent angle
    2329: (  4.9,  -0.1) m, (200.95, 192.96) mas
    2320: (  3.8,  -0.1) m, (216.24, 194.98) mas
    2311: (  2.6,  -0.1) m, (235.86, 197.53) mas
    2302: (  1.5,  -0.1) m, (262.07, 200.87) mas
    2300: (  1.3,  -0.1) m, (269.28, 201.74) mas
    1628: ( -0.5,  -1.4) m, (315.49, 212.40) mas
    2296: ( -1.8,  -0.1) m, (350.56, 211.21) mas
    2287: ( -2.9,  -0.1) m, (382.66, 214.77) mas
    2279: ( -3.9,  -0.1) m, (410.59, 217.89) mas
    2270: ( -5.0,  -0.1) m, (443.22, 221.39) mas
    2267: ( -5.4,  -0.1) m, (453.54, 222.51) mas
sa index   location       noise equivalent angle
    4005: (  3.8,   3.0) m, (201.01, 199.69) mas
    4004: (  3.7,   3.0) m, (199.19, 197.37) mas
    3350: (  2.1,   1.8) m, (219.07, 212.54) mas
    2974: (  1.4,   1.1) m, (233.84, 223.97) mas
    2837: (  1.1,   0.9) m, (237.15, 227.24) mas
    1635: (  0.4,  -1.4) m, (254.53, 273.88) mas
    1765: ( -1.4,  -1.1) m, (293.34, 268.68) mas
    1694: ( -1.5,  -1.3) m, (295.98, 271.19) mas
     978: ( -3.0,  -2.5) m, (333.54, 300.58) mas
     662: ( -3.8,  -3.1) m, (351.93, 315.06) mas
     188: ( -3.0,  -4.3) m, (333.79, 344.28) mas
sa index   location       noise equivalent angle
    4658: (  0.8,   4.8) m, (196.33, 204.75) mas
    4638: (  0.8,   4.7) m, (193.53, 202.94) mas
    3730: (  0.4,   2.5) m, (199.19, 237.63) mas
    3335: (  0.3,   1.8) m, (201.99, 255.05) mas
    3038: (  0.1,   1.3) m, (203.91, 265.51) mas
    2161: ( -1.4,  -0.4) m, (222.65, 306.64) mas
    1407: ( -0.4,  -1.8) m, (216.51, 346.06) mas
    1333: ( -0.4,  -1.9) m, (216.85, 349.20) mas
     625: ( -0.6,  -3.3) m, (225.79, 392.63) mas
      25: ( -0.9,  -4.8) m, (229.55, 429.66) mas
      19: ( -2.3,  -4.8) m, (245.35, 429.87) mas
sa index   location       noise equivalent angle
    4533: ( -2.6,   4.4) m, (193.48, 195.80) mas
    4286: ( -2.3,   3.8) m, (197.45, 204.61) mas
    3899: ( -1.8,   2.9) m, (203.67, 218.44) mas
    3464: ( -1.3,   2.0) m, (217.44, 240.53) mas
    2960: ( -0.8,   1.1) m, (218.82, 251.10) mas
    2437: (  1.3,   0.1) m, (254.70, 273.50) mas
    1707: (  0.6,  -1.3) m, (245.04, 308.14) mas
    1202: (  1.1,  -2.1) m, (266.21, 342.47) mas
     767: (  1.6,  -3.0) m, (265.51, 352.09) mas
     379: (  2.1,  -3.9) m, (277.38, 376.89) mas
     132: (  2.5,  -4.5) m, (286.41, 394.58) mas
sa index   location       noise equivalent angle
    3222: ( -4.7,   1.6) m, (201.27, 194.03) mas
    3150: ( -4.4,   1.5) m, (204.54, 195.01) mas
    2878: ( -3.0,   1.0) m, (225.38, 200.51) mas
    2638: ( -1.6,   0.5) m, (253.23, 208.13) mas
    2573: ( -1.4,   0.4) m, (258.72, 210.00) mas
    1632: (  0.0,  -1.4) m, (302.33, 244.94) mas
    2029: (  1.5,  -0.6) m, (332.66, 229.53) mas
    1848: (  2.5,  -1.0) m, (360.28, 237.11) mas
    1789: (  2.9,  -1.1) m, (370.19, 239.64) mas
    1518: (  4.3,  -1.6) m, (408.33, 250.14) mas
    2057: (  5.0,  -0.6) m, (435.00, 239.33) mas
sa index   location       noise equivalent angle
    1373: ( -4.7,  -1.8) m, (201.27, 194.03) mas
    1449: ( -4.4,  -1.6) m, (204.54, 195.01) mas
    1752: ( -3.0,  -1.1) m, (225.38, 200.51) mas
    2022: ( -1.6,  -0.6) m, (253.23, 208.13) mas
    2092: ( -1.4,  -0.5) m, (258.72, 210.00) mas
    3037: (  0.0,   1.3) m, (302.33, 244.94) mas
    2645: (  1.5,   0.5) m, (332.66, 229.53) mas
    2848: (  2.5,   0.9) m, (360.28, 237.11) mas
    2915: (  2.9,   1.0) m, (370.19, 239.64) mas
    3219: (  4.3,   1.5) m, (408.33, 250.14) mas
    2673: (  5.0,   0.5) m, (437.75, 241.37) mas
sa index   location       noise equivalent angle
      91: ( -2.6,  -4.5) m, (193.48, 195.80) mas
     344: ( -2.3,  -3.9) m, (197.45, 204.61) mas
     740: ( -1.8,  -3.0) m, (203.67, 218.44) mas
    1183: ( -1.3,  -2.1) m, (222.37, 245.47) mas
    1700: ( -0.8,  -1.3) m, (218.82, 251.10) mas
    2232: (  1.3,  -0.3) m, (254.70, 273.50) mas
    2968: (  0.6,   1.1) m, (245.04, 308.14) mas
    3483: (  1.1,   2.0) m, (259.97, 335.51) mas
    3926: (  1.6,   2.9) m, (265.51, 352.09) mas
    4321: (  2.1,   3.8) m, (277.38, 376.89) mas
    4574: (  2.5,   4.4) m, (286.41, 394.58) mas
sa index   location       noise equivalent angle
      10: (  0.8,  -4.9) m, (193.89, 201.69) mas
      32: (  0.8,  -4.8) m, (193.53, 202.94) mas
     943: (  0.4,  -2.6) m, (199.19, 237.63) mas
    1338: (  0.3,  -1.9) m, (201.99, 255.05) mas
    1633: (  0.1,  -1.4) m, (203.91, 265.51) mas
    2504: ( -1.4,   0.3) m, (222.65, 306.64) mas
    3256: ( -0.4,   1.6) m, (216.51, 346.06) mas
    3330: ( -0.4,   1.8) m, (216.85, 349.20) mas
    4032: ( -0.6,   3.1) m, (229.76, 397.59) mas
    4631: ( -0.9,   4.7) m, (229.55, 429.66) mas
    4625: ( -2.3,   4.7) m, (245.35, 429.87) mas
sa index   location       noise equivalent angle
     722: (  3.8,  -3.1) m, (201.01, 199.69) mas
     721: (  3.7,  -3.1) m, (199.19, 197.37) mas
    1353: (  2.1,  -1.9) m, (219.07, 212.54) mas
    1713: (  1.4,  -1.3) m, (233.84, 223.97) mas
    1837: (  1.1,  -1.0) m, (237.15, 227.24) mas
    3040: (  0.4,   1.3) m, (254.53, 273.88) mas
    2891: ( -1.4,   1.0) m, (293.34, 268.68) mas
    2954: ( -1.5,   1.1) m, (295.98, 271.19) mas
    3641: ( -3.0,   2.4) m, (333.54, 300.58) mas
    3945: ( -3.8,   3.0) m, (351.93, 315.06) mas
    4430: ( -3.0,   4.2) m, (333.79, 344.28) mas

[00;00mSetting up powfs 2 PO WFS[00;00m

OTF dimension is 48x48 (calculated)
Generating matched filter for powfs 2
Use sanea to derive neasim
Use sanea to derive neasim

[00;00mSetting up reconstructor[00;00m

Recon NEA: cmf(274.10) cmf(272.09) cmf(273.42) cmf(272.78) cmf(273.19) cmf(273.14) cmf(272.64) cmf(273.26) cmf(271.99) geom(0.31) geom(0.31) geom(0.31) mf(0.14)  mas
Setup or update control matrix parameters.
RRtwfs svd threshold is 1e-10
Replacing HA by HA*fit->actextrap
Adding piston cr to fit matrix
Adding TT cr on upper DMs to fit matrix.
Before assembling fit matrix:	6560.1 MiB.
Building fit->FR
Building fit->FL
Adding tikhonov constraint of 1.0e-07 to FLM
The maximum eigen value is estimated to be around 2.4e-04
DM Fit number of Low rank terms: 16 in LHS
After assemble fit matrix:	9069.2 MiB.
After setup_recon:	9069.2 MiB.
GPU 0: mem used 1776 MB (wfs init)
GPU 0: mem used 3324 MB (recon init)
GPU 0: mem used 3354 MB (perf init)

*** Simulation started at 2025/02/17 15:56:23 in nid001972. ***

Running seed 1
GPU 0: mem used 3354 MB (wfs seeding)
Wind dir: 267.3 261.7 167.0 130.5 300.7  32.3 119.8 139.0 150.8 277.7 203.0 133.1  45.9 265.1 deg
Using /global/homes/b/bpeck/.aos/cache/atm/vonkarman_14_8192x8192_0.0078125_1115374592d.bin
After genatm:	8740.3 MiB.
Step     #  Open Loop  PR TT  On axis  PR TT  Field RMS PR TT     Timing 
Step     0: OL  884.6  248.3  OA  884.6 248.3 CL  884.6 248.3 nm  0.124 s
Step    10: OL  899.9  252.3  OA  217.2 118.0 CL  217.2 118.0 nm  0.097 s
Step    21: OL  916.9  256.1  OA  126.2  27.4 CL  126.2  27.4 nm  0.104 s
Step    31: OL  932.4  259.0  OA  123.2  11.9 CL  123.2  11.9 nm  0.106 s
Step    41: OL  947.5  260.7  OA  126.0  28.5 CL  126.0  28.5 nm  0.169 s
Step    51: OL  962.3  261.3  OA  123.5  28.5 CL  123.5  28.5 nm  0.114 s
Step    61: OL  977.2  260.9  OA  132.5  46.6 CL  132.5  46.6 nm  0.104 s
Step    71: OL  992.4  259.8  OA  145.2  58.1 CL  145.2  58.1 nm  0.105 s
Step    81: OL 1008.0  258.8  OA  142.5  47.4 CL  142.5  47.4 nm  0.102 s
Step    91: OL 1023.7  258.1  OA  148.3  59.6 CL  148.3  59.6 nm  0.110 s
Step   101: OL 1039.5  257.7  OA  135.3  44.4 CL  135.3  44.4 nm  0.106 s
Step   111: OL 1055.4  258.0  OA  139.4  44.3 CL  139.4  44.3 nm  0.106 s
Step   121: OL 1070.9  258.9  OA  139.2  48.0 CL  139.2  48.0 nm  0.110 s
Step   131: OL 1085.6  260.9  OA  139.7  43.9 CL  139.7  43.9 nm  0.107 s
Step   141: OL 1099.8  264.1  OA  142.1  46.8 CL  142.1  46.8 nm  0.109 s
Step   151: OL 1112.9  268.1  OA  145.6  57.9 CL  145.6  57.9 nm  0.105 s
Step   161: OL 1124.7  273.1  OA  136.7  49.1 CL  136.7  49.1 nm  0.103 s
Step   171: OL 1135.4  278.8  OA  128.5  30.9 CL  128.5  30.9 nm  0.145 s
Step   181: OL 1144.6  285.0  OA  136.1  45.0 CL  136.1  45.0 nm  0.124 s
Step   190: OL 1151.5  290.9  OA  152.1  68.6 CL  152.1  68.6 nm  0.107 s
Step   200: OL 1157.7  297.3  OA  149.2  56.0 CL  149.2  56.0 nm  0.104 s
Step   210: OL 1162.9  303.7  OA  140.1  57.2 CL  140.1  57.2 nm  0.106 s
Step   220: OL 1166.8  310.1  OA  138.6  45.4 CL  138.6  45.4 nm  0.101 s
Step   230: OL 1169.3  316.6  OA  141.5  49.1 CL  141.5  49.1 nm  0.114 s
Step   240: OL 1170.3  323.3  OA  138.3  45.6 CL  138.3  45.6 nm  0.108 s
Step   250: OL 1169.5  330.3  OA  133.0  43.4 CL  133.0  43.4 nm  0.112 s
Step   255 updated high order loop gain: 0.351
Step   260: OL 1166.2  337.5  OA  130.9  38.9 CL  130.9  38.9 nm  0.104 s
Step   270: OL 1160.6  344.7  OA  134.6  34.6 CL  134.6  34.6 nm  0.111 s
Step   280: OL 1153.0  352.0  OA  144.9  51.9 CL  144.9  51.9 nm  0.109 s
Step   289: OL 1144.8  359.1  OA  134.6  30.3 CL  134.6  30.3 nm  0.114 s
Step   299: OL 1134.8  367.6  OA  131.3  42.4 CL  131.3  42.4 nm  0.104 s
Step   309: OL 1123.9  376.6  OA  138.5  53.4 CL  138.5  53.4 nm  0.111 s
Step   318: OL 1112.8  385.1  OA  145.6  50.5 CL  145.6  50.5 nm  0.113 s
Step   328: OL 1099.6  395.2  OA  132.7  34.0 CL  132.7  34.0 nm  0.106 s
Step   338: OL 1086.2  406.4  OA  123.1  29.8 CL  123.1  29.8 nm  0.115 s
Step   348: OL 1072.6  418.7  OA  126.6  31.6 CL  126.6  31.6 nm  0.103 s
Step   358: OL 1059.1  431.9  OA  132.3  34.3 CL  132.3  34.3 nm  0.111 s
Step   368: OL 1046.0  445.9  OA  137.1  40.9 CL  137.1  40.9 nm  0.104 s
Step   376: OL 1035.8  457.4  OA  127.6  30.4 CL  127.6  30.4 nm  0.110 s
Step   386: OL 1023.4  471.8  OA  123.3  21.5 CL  123.3  21.5 nm  0.104 s
Step   396: OL 1011.3  486.2  OA  126.9  28.3 CL  126.9  28.3 nm  0.103 s
Step   406: OL  999.1  500.5  OA  122.3  26.0 CL  122.3  26.0 nm  0.106 s
Step 409, DM 2: 1 actuators over ia limit. trials=2: success.
Step 410, DM 2: 1 actuators over ia limit. trials=2: success.
Step 411, DM 2: 1 actuators over ia limit. trials=2: success.
Step 412, DM 2: 1 actuators over ia limit. trials=2: success.
Step 413, DM 2: 1 actuators over ia limit. trials=2: success.
Step 414, DM 2: 1 actuators over ia limit. trials=2: success.
Step 415, DM 2: 1 actuators over ia limit. trials=2: success.
Step   416: OL  986.5  514.3  OA  119.3  22.9 CL  119.3  22.9 nm  0.111 s
Step 416, DM 2: 1 actuators over ia limit. trials=2: success.
Step 417, DM 2: 1 actuators over ia limit. trials=2: success.
Step 418, DM 2: 1 actuators over ia limit. trials=2: success.
Step 419, DM 2: 1 actuators over ia limit. trials=2: success.
Step 420, DM 2: 1 actuators over ia limit. trials=2: success.
Step 421, DM 2: 1 actuators over ia limit. trials=2: success.
Step 422, DM 2: 1 actuators over ia limit. trials=2: success.
Step 423, DM 2: 1 actuators over ia limit. trials=2: success.
Step 424, DM 2: 1 actuators over ia limit. trials=2: success.
Step 425, DM 2: 1 actuators over ia limit. trials=2: success.
Step   426: OL  973.9  527.6  OA  120.5  22.6 CL  120.5  22.6 nm  0.104 s
Step 426, DM 2: 1 actuators over ia limit. trials=2: success.
Step 427, DM 2: 1 actuators over ia limit. trials=2: success.
Step 428, DM 2: 1 actuators over ia limit. trials=2: success.
Step 429, DM 2: 1 actuators over ia limit. trials=2: success.
Step 430, DM 2: 1 actuators over ia limit. trials=2: success.
Step 431, DM 2: 1 actuators over ia limit. trials=2: success.
Step 432, DM 2: 1 actuators over ia limit. trials=2: success.
Step 433, DM 2: 1 actuators over ia limit. trials=2: success.
Step 434, DM 2: 1 actuators over ia limit. trials=2: success.
Step 435, DM 2: 1 actuators over ia limit. trials=2: success.
Step   436: OL  961.6  540.8  OA  123.1  26.6 CL  123.1  26.6 nm  0.103 s
Step 436, DM 2: 1 actuators over ia limit. trials=2: success.
Step 437, DM 2: 1 actuators over ia limit. trials=2: success.
Step 438, DM 2: 1 actuators over ia limit. trials=2: success.
Step 439, DM 2: 1 actuators over ia limit. trials=2: success.
Step 440, DM 2: 1 actuators over ia limit. trials=2: success.
Step 441, DM 2: 1 actuators over ia limit. trials=2: success.
Step 442, DM 2: 1 actuators over ia limit. trials=2: success.
Step 443, DM 2: 1 actuators over ia limit. trials=2: success.
Step 444, DM 2: 1 actuators over ia limit. trials=2: success.
Step 445, DM 2: 1 actuators over ia limit. trials=2: success.
Step   446: OL  950.0  553.8  OA  120.0  35.8 CL  120.0  35.8 nm  0.144 s
Step 446, DM 2: 1 actuators over ia limit. trials=2: success.
Step 447, DM 2: 1 actuators over ia limit. trials=2: success.
Step 448, DM 2: 1 actuators over ia limit. trials=2: success.
Step 449, DM 2: 1 actuators over ia limit. trials=2: success.
Step 450, DM 2: 1 actuators over ia limit. trials=2: success.
Step 451, DM 2: 1 actuators over ia limit. trials=2: success.
Step 452, DM 2: 1 actuators over ia limit. trials=2: success.
Step 453, DM 2: 1 actuators over ia limit. trials=2: success.
Step 454, DM 2: 1 actuators over ia limit. trials=2: success.
Step   455: OL  940.7  565.5  OA  117.2  26.1 CL  117.2  26.1 nm  0.112 s
Step 455, DM 2: 1 actuators over ia limit. trials=2: success.
Step 456, DM 2: 1 actuators over ia limit. trials=2: success.
Step 457, DM 2: 1 actuators over ia limit. trials=2: success.
Step 458, DM 2: 1 actuators over ia limit. trials=2: success.
Step 459, DM 2: 1 actuators over ia limit. trials=2: success.
Step 460, DM 2: 1 actuators over ia limit. trials=2: success.
Step 461, DM 2: 1 actuators over ia limit. trials=2: success.
Step 462, DM 2: 1 actuators over ia limit. trials=2: success.
Step   463: OL  933.9  576.0  OA  123.4  31.3 CL  123.4  31.3 nm  0.110 s
Step 463, DM 2: 1 actuators over ia limit. trials=2: success.
Step 464, DM 2: 1 actuators over ia limit. trials=2: success.
Step 465, DM 2: 1 actuators over ia limit. trials=2: success.
Step 466, DM 2: 1 actuators over ia limit. trials=2: success.
Step 467, DM 2: 1 actuators over ia limit. trials=2: success.
Step 468, DM 2: 1 actuators over ia limit. trials=2: success.
Step 469, DM 2: 1 actuators over ia limit. trials=2: success.
Step 470, DM 2: 1 actuators over ia limit. trials=2: success.
Step 471, DM 2: 1 actuators over ia limit. trials=2: success.
Step 472, DM 2: 1 actuators over ia limit. trials=2: success.
Step   473: OL  927.5  588.9  OA  122.4  32.4 CL  122.4  32.4 nm  0.106 s
Step 473, DM 2: 1 actuators over ia limit. trials=2: success.
Step 474, DM 2: 1 actuators over ia limit. trials=2: success.
Step 475, DM 2: 1 actuators over ia limit. trials=2: success.
Step 476, DM 2: 1 actuators over ia limit. trials=2: success.
Step 477, DM 2: 1 actuators over ia limit. trials=2: success.
Step 478, DM 2: 1 actuators over ia limit. trials=2: success.
Step 479, DM 2: 1 actuators over ia limit. trials=2: success.
Step 480, DM 2: 1 actuators over ia limit. trials=2: success.
Step 481, DM 2: 1 actuators over ia limit. trials=2: success.
Step 482, DM 2: 1 actuators over ia limit. trials=2: success.
Step   483: OL  923.7  601.5  OA  114.5  19.3 CL  114.5  19.3 nm  0.117 s
Step 483, DM 2: 1 actuators over ia limit. trials=2: success.
Step 484, DM 2: 1 actuators over ia limit. trials=2: success.
Step 485, DM 2: 1 actuators over ia limit. trials=2: success.
Step 486, DM 2: 1 actuators over ia limit. trials=2: success.
Step 487, DM 2: 1 actuators over ia limit. trials=2: success.
Step 488, DM 2: 1 actuators over ia limit. trials=2: success.
Step 489, DM 2: 1 actuators over ia limit. trials=2: success.
Step 490, DM 2: 1 actuators over ia limit. trials=2: success.
Step 491, DM 2: 1 actuators over ia limit. trials=2: success.
Step 492, DM 2: 1 actuators over ia limit. trials=2: success.
Step   493: OL  922.5  613.8  OA  112.2  14.3 CL  112.2  14.3 nm  0.104 s
Step 493, DM 2: 1 actuators over ia limit. trials=2: success.
Step 494, DM 2: 1 actuators over ia limit. trials=2: success.
Step 495, DM 2: 1 actuators over ia limit. trials=2: success.
Step 496, DM 2: 1 actuators over ia limit. trials=2: success.
Step 497, DM 2: 1 actuators over ia limit. trials=2: success.
Step 498, DM 2: 1 actuators over ia limit. trials=2: success.
Step 499, DM 2: 1 actuators over ia limit. trials=2: success.
Step 500, DM 2: 1 actuators over ia limit. trials=2: success.
Step 501, DM 2: 1 actuators over ia limit. trials=2: success.
Step 502, DM 2: 1 actuators over ia limit. trials=2: success.
Step   503: OL  923.1  625.3  OA  120.5  27.1 CL  120.5  27.1 nm  0.113 s
Step 503, DM 2: 1 actuators over ia limit. trials=2: success.
Step 504, DM 2: 1 actuators over ia limit. trials=2: success.
Step 505, DM 2: 1 actuators over ia limit. trials=2: success.
Step 506, DM 2: 1 actuators over ia limit. trials=2: success.
Step 507, DM 2: 1 actuators over ia limit. trials=2: success.
Step 508, DM 2: 1 actuators over ia limit. trials=2: success.
Step 509, DM 2: 1 actuators over ia limit. trials=2: success.
Step 510, DM 2: 1 actuators over ia limit. trials=2: success.
Step   511 updated high order loop gain: 0.307
Step 511, DM 2: 1 actuators over ia limit. trials=2: success.
Step 512, DM 1: 1 actuators over ia limit. trials=2: success.
Step 512, DM 2: 1 actuators over ia limit. trials=2: success.
Step   513: OL  925.0  636.0  OA  120.3  18.4 CL  120.3  18.4 nm  0.109 s
Step 513, DM 1: 1 actuators over ia limit. trials=2: success.
Step 513, DM 2: 1 actuators over ia limit. trials=2: success.
Step 514, DM 1: 1 actuators over ia limit. trials=2: success.
Step 514, DM 2: 1 actuators over ia limit. trials=2: success.
Step 515, DM 1: 1 actuators over ia limit. trials=2: success.
Step 515, DM 2: 1 actuators over ia limit. trials=2: success.
Step 516, DM 1: 1 actuators over ia limit. trials=2: success.
Step 516, DM 2: 1 actuators over ia limit. trials=2: success.
Step 517, DM 1: 1 actuators over ia limit. trials=2: success.
Step 517, DM 2: 1 actuators over ia limit. trials=2: success.
Step 518, DM 1: 1 actuators over ia limit. trials=2: success.
Step 518, DM 2: 1 actuators over ia limit. trials=2: success.
Step 519, DM 1: 1 actuators over ia limit. trials=2: success.
Step 519, DM 2: 1 actuators over ia limit. trials=2: success.
Step 520, DM 1: 1 actuators over ia limit. trials=2: success.
Step 520, DM 2: 1 actuators over ia limit. trials=2: success.
Step 521, DM 1: 1 actuators over ia limit. trials=2: success.
Step 521, DM 2: 1 actuators over ia limit. trials=2: success.
Step 522, DM 1: 1 actuators over ia limit. trials=2: success.
Step 522, DM 2: 1 actuators over ia limit. trials=2: success.
Step   523: OL  928.2  645.5  OA  114.0   8.4 CL  114.0   8.4 nm  0.114 s
Step 523, DM 1: 1 actuators over ia limit. trials=2: success.
Step 523, DM 2: 1 actuators over ia limit. trials=2: success.
Step 524, DM 1: 1 actuators over ia limit. trials=2: success.
Step 524, DM 2: 1 actuators over ia limit. trials=2: success.
Step 525, DM 1: 1 actuators over ia limit. trials=2: success.
Step 525, DM 2: 1 actuators over ia limit. trials=2: success.
Step 526, DM 1: 1 actuators over ia limit. trials=2: success.
Step 526, DM 2: 1 actuators over ia limit. trials=2: success.
Step 527, DM 1: 1 actuators over ia limit. trials=2: success.
Step 527, DM 2: 1 actuators over ia limit. trials=2: success.
Step 528, DM 1: 1 actuators over ia limit. trials=2: success.
Step 528, DM 2: 1 actuators over ia limit. trials=2: success.
Step 529, DM 1: 1 actuators over ia limit. trials=2: success.
Step 529, DM 2: 1 actuators over ia limit. trials=2: success.
Step 530, DM 1: 1 actuators over ia limit. trials=2: success.
Step 530, DM 2: 1 actuators over ia limit. trials=2: success.
Step 531, DM 1: 1 actuators over ia limit. trials=2: success.
Step 531, DM 2: 1 actuators over ia limit. trials=2: success.
Step 532, DM 1: 1 actuators over ia limit. trials=2: success.
Step 532, DM 2: 1 actuators over ia limit. trials=2: success.
Step   533: OL  932.6  653.3  OA  115.9  11.6 CL  115.9  11.6 nm  0.104 s
Step 533, DM 1: 1 actuators over ia limit. trials=2: success.
Step 533, DM 2: 1 actuators over ia limit. trials=2: success.
Step 534, DM 1: 1 actuators over ia limit. trials=2: success.
Step 534, DM 2: 1 actuators over ia limit. trials=2: success.
Step 535, DM 1: 1 actuators over ia limit. trials=2: success.
Step 535, DM 2: 1 actuators over ia limit. trials=2: success.
Step 536, DM 1: 1 actuators over ia limit. trials=2: success.
Step 536, DM 2: 1 actuators over ia limit. trials=2: success.
Step 537, DM 1: 1 actuators over ia limit. trials=2: success.
Step 537, DM 2: 1 actuators over ia limit. trials=2: success.
Step 538, DM 1: 1 actuators over ia limit. trials=2: success.
Step 538, DM 2: 1 actuators over ia limit. trials=2: success.
Step 539, DM 1: 1 actuators over ia limit. trials=2: success.
Step 539, DM 2: 1 actuators over ia limit. trials=2: success.
Step 540, DM 1: 1 actuators over ia limit. trials=2: success.
Step 540, DM 2: 1 actuators over ia limit. trials=2: success.
Step 541, DM 1: 1 actuators over ia limit. trials=2: success.
Step 541, DM 2: 1 actuators over ia limit. trials=2: success.
Step 542, DM 1: 1 actuators over ia limit. trials=2: success.
Step 542, DM 2: 1 actuators over ia limit. trials=2: success.
Step   543: OL  938.3  659.5  OA  123.1  15.4 CL  123.1  15.4 nm  0.112 s
Step 543, DM 1: 1 actuators over ia limit. trials=2: success.
Step 543, DM 2: 1 actuators over ia limit. trials=2: success.
Step 544, DM 1: 1 actuators over ia limit. trials=2: success.
Step 544, DM 2: 1 actuators over ia limit. trials=2: success.
Step 545, DM 1: 1 actuators over ia limit. trials=2: success.
Step 545, DM 2: 1 actuators over ia limit. trials=2: success.
Step 546, DM 1: 1 actuators over ia limit. trials=2: success.
Step 546, DM 2: 1 actuators over ia limit. trials=2: success.
Step 547, DM 1: 1 actuators over ia limit. trials=2: success.
Step 547, DM 2: 1 actuators over ia limit. trials=2: success.
Step 548, DM 1: 1 actuators over ia limit. trials=2: success.
Step 548, DM 2: 1 actuators over ia limit. trials=2: success.
Step 549, DM 1: 1 actuators over ia limit. trials=2: success.
Step 549, DM 2: 1 actuators over ia limit. trials=2: success.
Step 550, DM 1: 1 actuators over ia limit. trials=2: success.
Step 550, DM 2: 1 actuators over ia limit. trials=2: success.
Step 551, DM 1: 1 actuators over ia limit. trials=2: success.
Step 551, DM 2: 1 actuators over ia limit. trials=2: success.
Step 552, DM 1: 1 actuators over ia limit. trials=2: success.
Step 552, DM 2: 1 actuators over ia limit. trials=2: success.
Step   553: OL  945.6  664.1  OA  120.4  20.2 CL  120.4  20.2 nm  0.107 s
Step 553, DM 1: 1 actuators over ia limit. trials=2: success.
Step 553, DM 2: 1 actuators over ia limit. trials=2: success.
Step 554, DM 1: 1 actuators over ia limit. trials=2: success.
Step 554, DM 2: 1 actuators over ia limit. trials=2: success.
Step 555, DM 1: 1 actuators over ia limit. trials=2: success.
Step 555, DM 2: 1 actuators over ia limit. trials=2: success.
Step 556, DM 1: 1 actuators over ia limit. trials=2: success.
Step 556, DM 2: 1 actuators over ia limit. trials=2: success.
Step 557, DM 1: 1 actuators over ia limit. trials=2: success.
Step 557, DM 2: 1 actuators over ia limit. trials=2: success.
Step 558, DM 1: 1 actuators over ia limit. trials=2: success.
Step 558, DM 2: 1 actuators over ia limit. trials=2: success.
Step 559, DM 1: 1 actuators over ia limit. trials=2: success.
Step 559, DM 2: 1 actuators over ia limit. trials=2: success.
Step 560, DM 1: 1 actuators over ia limit. trials=2: success.
Step 560, DM 2: 1 actuators over ia limit. trials=2: success.
Step 561, DM 1: 1 actuators over ia limit. trials=2: success.
Step 561, DM 2: 1 actuators over ia limit. trials=2: success.
Step 562, DM 1: 1 actuators over ia limit. trials=2: success.
Step 562, DM 2: 1 actuators over ia limit. trials=2: success.
Step   563: OL  954.1  667.4  OA  112.5  15.7 CL  112.5  15.7 nm  0.123 s
Step 563, DM 1: 1 actuators over ia limit. trials=2: success.
Step 563, DM 2: 1 actuators over ia limit. trials=2: success.
Step 564, DM 1: 1 actuators over ia limit. trials=2: success.
Step 564, DM 2: 1 actuators over ia limit. trials=2: success.
Step 565, DM 1: 1 actuators over ia limit. trials=2: success.
Step 565, DM 2: 1 actuators over ia limit. trials=2: success.
Step 566, DM 1: 1 actuators over ia limit. trials=2: success.
Step 566, DM 2: 1 actuators over ia limit. trials=2: success.
Step 567, DM 1: 1 actuators over ia limit. trials=2: success.
Step 567, DM 2: 1 actuators over ia limit. trials=2: success.
Step 568, DM 1: 1 actuators over ia limit. trials=2: success.
Step 568, DM 2: 1 actuators over ia limit. trials=2: success.
Step 569, DM 1: 1 actuators over ia limit. trials=2: success.
Step 569, DM 2: 1 actuators over ia limit. trials=2: success.
Step 570, DM 1: 1 actuators over ia limit. trials=2: success.
Step 570, DM 2: 1 actuators over ia limit. trials=2: success.
Step 571, DM 1: 1 actuators over ia limit. trials=2: success.
Step 571, DM 2: 1 actuators over ia limit. trials=2: success.
Step 572, DM 1: 1 actuators over ia limit. trials=2: success.
Step 572, DM 2: 1 actuators over ia limit. trials=2: success.
Step   573: OL  963.6  669.4  OA  115.4  15.0 CL  115.4  15.0 nm  0.105 s
Step 573, DM 1: 1 actuators over ia limit. trials=2: success.
Step 573, DM 2: 1 actuators over ia limit. trials=2: success.
Step 574, DM 1: 1 actuators over ia limit. trials=2: success.
Step 574, DM 2: 1 actuators over ia limit. trials=2: success.
Step 575, DM 1: 1 actuators over ia limit. trials=2: success.
Step 575, DM 2: 1 actuators over ia limit. trials=2: success.
Step 576, DM 1: 1 actuators over ia limit. trials=2: success.
Step 576, DM 2: 1 actuators over ia limit. trials=2: success.
Step 577, DM 1: 1 actuators over ia limit. trials=2: success.
Step 577, DM 2: 1 actuators over ia limit. trials=2: success.
Step 578, DM 1: 1 actuators over ia limit. trials=2: success.
Step 578, DM 2: 1 actuators over ia limit. trials=2: success.
Step 579, DM 1: 1 actuators over ia limit. trials=2: success.
Step 579, DM 2: 1 actuators over ia limit. trials=2: success.
Step 580, DM 1: 1 actuators over ia limit. trials=2: success.
Step 580, DM 2: 1 actuators over ia limit. trials=2: success.
Step 581, DM 1: 1 actuators over ia limit. trials=2: success.
Step 581, DM 2: 1 actuators over ia limit. trials=2: success.
Step 582, DM 1: 1 actuators over ia limit. trials=2: success.
Step 582, DM 2: 1 actuators over ia limit. trials=2: success.
Step   583: OL  974.1  670.4  OA  116.4  10.6 CL  116.4  10.6 nm  0.109 s
Step 583, DM 1: 1 actuators over ia limit. trials=2: success.
Step 583, DM 2: 1 actuators over ia limit. trials=2: success.
Step 584, DM 1: 1 actuators over ia limit. trials=2: success.
Step 584, DM 2: 1 actuators over ia limit. trials=2: success.
Step 585, DM 1: 1 actuators over ia limit. trials=2: success.
Step 585, DM 2: 1 actuators over ia limit. trials=2: success.
Step 586, DM 1: 1 actuators over ia limit. trials=2: success.
Step 586, DM 2: 1 actuators over ia limit. trials=2: success.
Step 587, DM 1: 1 actuators over ia limit. trials=2: success.
Step 587, DM 2: 1 actuators over ia limit. trials=2: success.
Step 588, DM 1: 1 actuators over ia limit. trials=2: success.
Step 588, DM 2: 1 actuators over ia limit. trials=2: success.
Step 589, DM 1: 1 actuators over ia limit. trials=2: success.
Step 589, DM 2: 1 actuators over ia limit. trials=2: success.
Step 590, DM 1: 1 actuators over ia limit. trials=2: success.
Step 590, DM 2: 1 actuators over ia limit. trials=2: success.
Step 591, DM 1: 1 actuators over ia limit. trials=2: success.
Step 591, DM 2: 1 actuators over ia limit. trials=2: success.
Step 592, DM 1: 1 actuators over ia limit. trials=2: success.
Step 592, DM 2: 1 actuators over ia limit. trials=2: success.
Step   593: OL  985.6  670.0  OA  115.9   5.2 CL  115.9   5.2 nm  0.104 s
Step 593, DM 1: 1 actuators over ia limit. trials=2: success.
Step 593, DM 2: 1 actuators over ia limit. trials=2: success.
Step 594, DM 1: 1 actuators over ia limit. trials=2: success.
Step 594, DM 2: 1 actuators over ia limit. trials=2: success.
Step 595, DM 1: 1 actuators over ia limit. trials=2: success.
Step 595, DM 2: 1 actuators over ia limit. trials=2: success.
Step 596, DM 1: 1 actuators over ia limit. trials=2: success.
Step 596, DM 2: 1 actuators over ia limit. trials=2: success.
Step 597, DM 1: 1 actuators over ia limit. trials=2: success.
Step 597, DM 2: 1 actuators over ia limit. trials=2: success.
Step 598, DM 1: 1 actuators over ia limit. trials=2: success.
Step 598, DM 2: 1 actuators over ia limit. trials=2: success.
Step 599, DM 1: 1 actuators over ia limit. trials=2: success.
Step 599, DM 2: 1 actuators over ia limit. trials=2: success.
Step 600, DM 1: 1 actuators over ia limit. trials=2: success.
Step 600, DM 2: 1 actuators over ia limit. trials=2: success.
Step 601, DM 1: 1 actuators over ia limit. trials=2: success.
Step 601, DM 2: 1 actuators over ia limit. trials=2: success.
Step 602, DM 1: 1 actuators over ia limit. trials=2: success.
Step 602, DM 2: 1 actuators over ia limit. trials=2: success.
Step   603: OL  997.5  667.9  OA  115.6  11.1 CL  115.6  11.1 nm  0.113 s
Step 603, DM 1: 1 actuators over ia limit. trials=2: success.
Step 603, DM 2: 1 actuators over ia limit. trials=2: success.
Step 604, DM 1: 1 actuators over ia limit. trials=2: success.
Step 604, DM 2: 1 actuators over ia limit. trials=2: success.
Step 605, DM 1: 1 actuators over ia limit. trials=2: success.
Step 605, DM 2: 1 actuators over ia limit. trials=2: success.
Step 606, DM 1: 1 actuators over ia limit. trials=2: success.
Step 606, DM 2: 1 actuators over ia limit. trials=2: success.
Step 607, DM 1: 1 actuators over ia limit. trials=2: success.
Step 607, DM 2: 1 actuators over ia limit. trials=2: success.
Step 608, DM 1: 1 actuators over ia limit. trials=2: success.
Step 608, DM 2: 1 actuators over ia limit. trials=2: success.
Step 609, DM 1: 1 actuators over ia limit. trials=2: success.
Step 609, DM 2: 1 actuators over ia limit. trials=2: success.
Step 610, DM 1: 1 actuators over ia limit. trials=2: success.
Step 610, DM 2: 1 actuators over ia limit. trials=2: success.
Step 611, DM 1: 1 actuators over ia limit. trials=2: success.
Step 611, DM 2: 1 actuators over ia limit. trials=2: success.
Step 612, DM 1: 1 actuators over ia limit. trials=2: success.
Step 612, DM 2: 1 actuators over ia limit. trials=2: success.
Step   613: OL 1009.7  664.1  OA  116.6   8.2 CL  116.6   8.2 nm  0.105 s
Step 613, DM 1: 1 actuators over ia limit. trials=2: success.
Step 613, DM 2: 1 actuators over ia limit. trials=2: success.
Step 614, DM 1: 1 actuators over ia limit. trials=2: success.
Step 614, DM 2: 1 actuators over ia limit. trials=2: success.
Step 615, DM 1: 1 actuators over ia limit. trials=2: success.
Step 615, DM 2: 1 actuators over ia limit. trials=2: success.
Step 616, DM 1: 1 actuators over ia limit. trials=2: success.
Step 616, DM 2: 1 actuators over ia limit. trials=2: success.
Step 617, DM 1: 1 actuators over ia limit. trials=2: success.
Step 617, DM 2: 1 actuators over ia limit. trials=2: success.
Step 618, DM 1: 1 actuators over ia limit. trials=2: success.
Step 618, DM 2: 1 actuators over ia limit. trials=2: success.
Step 619, DM 1: 1 actuators over ia limit. trials=2: success.
Step 619, DM 2: 1 actuators over ia limit. trials=2: success.
Step 620, DM 1: 1 actuators over ia limit. trials=2: success.
Step 620, DM 2: 1 actuators over ia limit. trials=2: success.
Step 621, DM 1: 1 actuators over ia limit. trials=2: success.
Step 621, DM 2: 1 actuators over ia limit. trials=2: success.
Step 622, DM 1: 1 actuators over ia limit. trials=2: success.
Step 622, DM 2: 1 actuators over ia limit. trials=2: success.
Step   623: OL 1021.9  658.9  OA  121.4  13.7 CL  121.4  13.7 nm  0.110 s
Step 623, DM 1: 1 actuators over ia limit. trials=2: success.
Step 623, DM 2: 1 actuators over ia limit. trials=2: success.
Step 624, DM 1: 1 actuators over ia limit. trials=2: success.
Step 624, DM 2: 1 actuators over ia limit. trials=2: success.
Step 625, DM 1: 1 actuators over ia limit. trials=2: success.
Step 625, DM 2: 1 actuators over ia limit. trials=2: success.
Step 626, DM 1: 1 actuators over ia limit. trials=2: success.
Step 626, DM 2: 1 actuators over ia limit. trials=2: success.
Step 627, DM 1: 1 actuators over ia limit. trials=2: success.
Step 627, DM 2: 1 actuators over ia limit. trials=2: success.
Step 628, DM 1: 1 actuators over ia limit. trials=2: success.
Step 628, DM 2: 1 actuators over ia limit. trials=2: success.
Step 629, DM 1: 1 actuators over ia limit. trials=2: success.
Step 629, DM 2: 1 actuators over ia limit. trials=2: success.
Step 630, DM 1: 1 actuators over ia limit. trials=2: success.
Step 630, DM 2: 1 actuators over ia limit. trials=2: success.
Step 631, DM 1: 1 actuators over ia limit. trials=2: success.
Step 631, DM 2: 1 actuators over ia limit. trials=2: success.
Step 632, DM 1: 1 actuators over ia limit. trials=2: success.
Step 632, DM 2: 1 actuators over ia limit. trials=2: success.
Step   633: OL 1033.8  652.3  OA  115.7  16.1 CL  115.7  16.1 nm  0.105 s
Step 633, DM 1: 1 actuators over ia limit. trials=2: success.
Step 633, DM 2: 1 actuators over ia limit. trials=2: success.
Step 634, DM 1: 1 actuators over ia limit. trials=2: success.
Step 634, DM 2: 1 actuators over ia limit. trials=2: success.
Step 635, DM 1: 1 actuators over ia limit. trials=2: success.
Step 635, DM 2: 1 actuators over ia limit. trials=2: success.
Step 636, DM 1: 1 actuators over ia limit. trials=2: success.
Step 636, DM 2: 1 actuators over ia limit. trials=2: success.
Step 637, DM 1: 1 actuators over ia limit. trials=2: success.
Step 637, DM 2: 1 actuators over ia limit. trials=2: success.
Step 638, DM 1: 1 actuators over ia limit. trials=2: success.
Step 638, DM 2: 1 actuators over ia limit. trials=2: success.
Step 639, DM 1: 1 actuators over ia limit. trials=2: success.
Step 639, DM 2: 1 actuators over ia limit. trials=2: success.
Step 640, DM 1: 1 actuators over ia limit. trials=2: success.
Step 640, DM 2: 1 actuators over ia limit. trials=2: success.
Step 641, DM 1: 1 actuators over ia limit. trials=2: success.
Step 641, DM 2: 1 actuators over ia limit. trials=2: success.
Step 642, DM 1: 1 actuators over ia limit. trials=2: success.
Step 642, DM 2: 1 actuators over ia limit. trials=2: success.
Step   643: OL 1045.1  644.4  OA  117.8  20.1 CL  117.8  20.1 nm  0.109 s
Step 643, DM 1: 1 actuators over ia limit. trials=2: success.
Step 643, DM 2: 1 actuators over ia limit. trials=2: success.
Step 644, DM 1: 1 actuators over ia limit. trials=2: success.
Step 644, DM 2: 1 actuators over ia limit. trials=2: success.
Step 645, DM 1: 1 actuators over ia limit. trials=2: success.
Step 645, DM 2: 1 actuators over ia limit. trials=2: success.
Step 646, DM 1: 1 actuators over ia limit. trials=2: success.
Step 646, DM 2: 1 actuators over ia limit. trials=2: success.
Step 647, DM 1: 1 actuators over ia limit. trials=2: success.
Step 647, DM 2: 1 actuators over ia limit. trials=2: success.
Step 648, DM 1: 1 actuators over ia limit. trials=2: success.
Step 649, DM 1: 1 actuators over ia limit. trials=2: success.
Step 650, DM 1: 1 actuators over ia limit. trials=2: success.
Step 651, DM 1: 1 actuators over ia limit. trials=2: success.
Step 652, DM 1: 1 actuators over ia limit. trials=2: success.
Step   653: OL 1055.5  635.6  OA  114.3  11.9 CL  114.3  11.9 nm  0.105 s
Step 653, DM 1: 1 actuators over ia limit. trials=2: success.
Step 654, DM 1: 1 actuators over ia limit. trials=2: success.
Step 655, DM 1: 1 actuators over ia limit. trials=2: success.
Step 656, DM 1: 1 actuators over ia limit. trials=2: success.
Step 657, DM 1: 1 actuators over ia limit. trials=2: success.
Step 658, DM 1: 1 actuators over ia limit. trials=2: success.
Step 659, DM 1: 1 actuators over ia limit. trials=2: success.
Step 660, DM 1: 1 actuators over ia limit. trials=2: success.
Step 661, DM 1: 1 actuators over ia limit. trials=2: success.
Step 662, DM 1: 1 actuators over ia limit. trials=2: success.
Step   663: OL 1065.3  625.9  OA  118.1  20.6 CL  118.1  20.6 nm  0.108 s
Step 663, DM 1: 1 actuators over ia limit. trials=2: success.
Step 664, DM 1: 1 actuators over ia limit. trials=2: success.
Step 665, DM 1: 1 actuators over ia limit. trials=2: success.
Step 666, DM 1: 1 actuators over ia limit. trials=2: success.
Step 667, DM 1: 1 actuators over ia limit. trials=2: success.
Step 668, DM 1: 1 actuators over ia limit. trials=2: success.
Step 669, DM 1: 1 actuators over ia limit. trials=2: success.
Step 670, DM 1: 1 actuators over ia limit. trials=2: success.
Step 671, DM 1: 1 actuators over ia limit. trials=2: success.
Step 672, DM 1: 1 actuators over ia limit. trials=2: success.
Step   673: OL 1074.3  615.6  OA  116.2  11.8 CL  116.2  11.8 nm  0.104 s
Step 673, DM 1: 1 actuators over ia limit. trials=2: success.
Step 674, DM 1: 1 actuators over ia limit. trials=2: success.
Step 675, DM 1: 1 actuators over ia limit. trials=2: success.
Step 676, DM 1: 1 actuators over ia limit. trials=2: success.
Step 677, DM 1: 1 actuators over ia limit. trials=2: success.
Step 678, DM 1: 1 actuators over ia limit. trials=2: success.
Step 679, DM 1: 1 actuators over ia limit. trials=2: success.
Step 680, DM 1: 1 actuators over ia limit. trials=2: success.
Step 681, DM 1: 1 actuators over ia limit. trials=2: success.
Step 682, DM 1: 1 actuators over ia limit. trials=2: success.
Step   683: OL 1083.0  605.2  OA  122.0  13.5 CL  122.0  13.5 nm  0.106 s
Step 683, DM 1: 1 actuators over ia limit. trials=2: success.
Step 684, DM 1: 1 actuators over ia limit. trials=2: success.
Step 685, DM 1: 1 actuators over ia limit. trials=2: success.
Step 686, DM 1: 1 actuators over ia limit. trials=2: success.
Step 687, DM 1: 1 actuators over ia limit. trials=2: success.
Step 688, DM 1: 1 actuators over ia limit. trials=2: success.
Step 689, DM 1: 1 actuators over ia limit. trials=2: success.
Step 690, DM 1: 1 actuators over ia limit. trials=2: success.
Step 691, DM 1: 1 actuators over ia limit. trials=2: success.
Step 692, DM 1: 1 actuators over ia limit. trials=2: success.
Step   693: OL 1091.1  594.6  OA  122.3  18.0 CL  122.3  18.0 nm  0.105 s
Step 693, DM 1: 1 actuators over ia limit. trials=2: success.
Step 694, DM 1: 1 actuators over ia limit. trials=2: success.
Step 695, DM 1: 1 actuators over ia limit. trials=2: success.
Step 696, DM 1: 1 actuators over ia limit. trials=2: success.
Step 697, DM 1: 1 actuators over ia limit. trials=2: success.
Step 698, DM 1: 1 actuators over ia limit. trials=2: success.
Step 699, DM 1: 1 actuators over ia limit. trials=2: success.
Step 700, DM 1: 1 actuators over ia limit. trials=2: success.
Step 701, DM 1: 1 actuators over ia limit. trials=2: success.
Step 702, DM 1: 1 actuators over ia limit. trials=2: success.
Step   703: OL 1097.9  583.2  OA  122.6   3.8 CL  122.6   3.8 nm  0.107 s
Step 703, DM 1: 1 actuators over ia limit. trials=2: success.
Step 704, DM 1: 1 actuators over ia limit. trials=2: success.
Step 705, DM 1: 1 actuators over ia limit. trials=2: success.
Step 706, DM 1: 1 actuators over ia limit. trials=2: success.
Step 707, DM 1: 1 actuators over ia limit. trials=2: success.
Step 708, DM 1: 1 actuators over ia limit. trials=2: success.
Step 709, DM 1: 1 actuators over ia limit. trials=2: success.
Step 710, DM 1: 1 actuators over ia limit. trials=2: success.
Step 711, DM 1: 1 actuators over ia limit. trials=2: success.
Step 712, DM 1: 1 actuators over ia limit. trials=2: success.
Step   713: OL 1103.1  571.2  OA  124.5  15.2 CL  124.5  15.2 nm  0.113 s
Step 713, DM 1: 1 actuators over ia limit. trials=2: success.
Step 714, DM 1: 1 actuators over ia limit. trials=2: success.
Step 715, DM 1: 1 actuators over ia limit. trials=2: success.
Step 716, DM 1: 1 actuators over ia limit. trials=2: success.
Step 717, DM 1: 1 actuators over ia limit. trials=2: success.
Step 718, DM 1: 1 actuators over ia limit. trials=2: success.
Step 719, DM 1: 1 actuators over ia limit. trials=2: success.
Step 720, DM 1: 1 actuators over ia limit. trials=2: success.
Step 721, DM 1: 1 actuators over ia limit. trials=2: success.
Step   722: OL 1106.3  560.0  OA  123.4   9.9 CL  123.4   9.9 nm  0.105 s
Step 722, DM 1: 1 actuators over ia limit. trials=2: success.
Step 723, DM 1: 1 actuators over ia limit. trials=2: success.
Step 724, DM 1: 1 actuators over ia limit. trials=2: success.
Step 725, DM 1: 1 actuators over ia limit. trials=2: success.
Step 726, DM 1: 1 actuators over ia limit. trials=2: success.
Step 727, DM 1: 1 actuators over ia limit. trials=2: success.
Step 728, DM 1: 1 actuators over ia limit. trials=2: success.
Step 729, DM 1: 1 actuators over ia limit. trials=2: success.
Step 730, DM 1: 1 actuators over ia limit. trials=2: success.
Step 731, DM 1: 1 actuators over ia limit. trials=2: success.
Step   732: OL 1108.0  547.7  OA  122.3  25.0 CL  122.3  25.0 nm  0.106 s
Step 732, DM 1: 1 actuators over ia limit. trials=2: success.
Step 733, DM 1: 1 actuators over ia limit. trials=2: success.
Step 734, DM 1: 1 actuators over ia limit. trials=2: success.
Step   739: OL 1108.1  539.1  OA  119.6  22.9 CL  119.6  22.9 nm  0.130 s
Step 741, DM 1: 1 actuators over ia limit. trials=2: success.
Step 742, DM 1: 1 actuators over ia limit. trials=2: success.
Step 743, DM 1: 1 actuators over ia limit. trials=2: success.
Step 744, DM 1: 1 actuators over ia limit. trials=2: success.
Step 745, DM 1: 1 actuators over ia limit. trials=2: success.
Step 746, DM 1: 1 actuators over ia limit. trials=2: success.
Step 747, DM 1: 1 actuators over ia limit. trials=2: success.
Step 748, DM 1: 1 actuators over ia limit. trials=2: success.
Step   749: OL 1106.6  526.8  OA  121.3  16.8 CL  121.3  16.8 nm  0.110 s
Step 749, DM 1: 1 actuators over ia limit. trials=2: success.
Step 750, DM 1: 1 actuators over ia limit. trials=2: success.
Step 751, DM 1: 1 actuators over ia limit. trials=2: success.
Step 752, DM 1: 1 actuators over ia limit. trials=2: success.
Step 753, DM 1: 1 actuators over ia limit. trials=2: success.
Step   759: OL 1103.4  515.0  OA  122.9  16.0 CL  122.9  16.0 nm  0.112 s
Step   767 updated high order loop gain: 0.287
Step   769: OL 1098.4  503.4  OA  123.7  10.6 CL  123.7  10.6 nm  0.106 s
Step   779: OL 1091.6  492.1  OA  119.3  15.3 CL  119.3  15.3 nm  0.110 s
Step   789: OL 1082.8  480.9  OA  120.7  12.3 CL  120.7  12.3 nm  0.104 s
Step   799: OL 1072.2  469.8  OA  120.6   5.2 CL  120.6   5.2 nm  0.111 s
Step   809: OL 1060.5  458.6  OA  122.8  23.4 CL  122.8  23.4 nm  0.106 s
Step   819: OL 1047.3  447.5  OA  116.0   8.0 CL  116.0   8.0 nm  0.104 s
Step   829: OL 1032.6  436.6  OA  119.9   6.8 CL  119.9   6.8 nm  0.103 s
Step   839: OL 1016.9  425.9  OA  126.2  14.6 CL  126.2  14.6 nm  0.106 s
Step   849: OL 1000.9  415.8  OA  118.1   8.7 CL  118.1   8.7 nm  0.104 s
Step   859: OL  984.7  406.2  OA  124.0  22.5 CL  124.0  22.5 nm  0.105 s
Step   869: OL  968.8  397.4  OA  121.6  13.0 CL  121.6  13.0 nm  0.110 s
Step   879: OL  953.7  389.5  OA  121.8  15.4 CL  121.8  15.4 nm  0.107 s
Step   889: OL  939.1  382.4  OA  125.2  18.3 CL  125.2  18.3 nm  0.113 s
Step   899: OL  924.1  375.8  OA  124.7  19.6 CL  124.7  19.6 nm  0.109 s
Step   909: OL  908.6  370.1  OA  118.1  15.8 CL  118.1  15.8 nm  0.103 s
Step   919: OL  893.1  365.1  OA  122.7  24.9 CL  122.7  24.9 nm  0.103 s
Step   929: OL  877.8  360.4  OA  119.5  23.2 CL  119.5  23.2 nm  0.105 s
Step   939: OL  862.9  355.6  OA  123.6  27.8 CL  123.6  27.8 nm  0.106 s
Step   949: OL  848.5  350.8  OA  118.3  22.1 CL  118.3  22.1 nm  0.103 s
Step   958: OL  836.3  346.2  OA  126.3  28.9 CL  126.3  28.9 nm  0.114 s
Step   968: OL  824.1  340.7  OA  122.7  24.1 CL  122.7  24.1 nm  0.105 s
Step   978: OL  813.1  334.7  OA  120.8  33.6 CL  120.8  33.6 nm  0.110 s
Step   988: OL  803.3  328.3  OA  120.6  28.3 CL  120.6  28.3 nm  0.104 s
Step   998: OL  794.1  321.3  OA  125.3  37.5 CL  125.3  37.5 nm  0.107 s
Step  1008: OL  785.3  313.7  OA  119.0  23.2 CL  119.0  23.2 nm  0.116 s
Step  1018: OL  777.5  306.1  OA  125.6  39.7 CL  125.6  39.7 nm  0.103 s
Step  1023 updated high order loop gain: 0.280
Step  1028: OL  770.5  298.3  OA  124.1  39.1 CL  124.1  39.1 nm  0.107 s
Step  1038: OL  764.2  290.1  OA  126.4  42.0 CL  126.4  42.0 nm  0.107 s
Step  1048: OL  758.3  281.4  OA  132.0  48.7 CL  132.0  48.7 nm  0.112 s
Step  1058: OL  752.0  272.1  OA  125.6  37.8 CL  125.6  37.8 nm  0.108 s
Step  1068: OL  746.2  261.9  OA  136.4  52.4 CL  136.4  52.4 nm  0.107 s
Step  1078: OL  741.5  250.6  OA  128.7  41.6 CL  128.7  41.6 nm  0.111 s
Step  1088: OL  738.0  238.9  OA  129.3  35.4 CL  129.3  35.4 nm  0.111 s
Step  1098: OL  735.7  227.6  OA  127.4  40.5 CL  127.4  40.5 nm  0.108 s
Step  1108: OL  734.2  217.0  OA  123.6  34.4 CL  123.6  34.4 nm  0.104 s
Step  1118: OL  733.3  207.2  OA  121.3  41.3 CL  121.3  41.3 nm  0.108 s
Step  1128: OL  732.9  198.4  OA  118.5  33.0 CL  118.5  33.0 nm  0.105 s
Step  1138: OL  732.7  190.9  OA  122.5  32.6 CL  122.5  32.6 nm  0.101 s
Step  1147: OL  732.8  185.0  OA  117.8  23.7 CL  117.8  23.7 nm  0.104 s
Step  1157: OL  732.9  179.4  OA  121.4  25.5 CL  121.4  25.5 nm  0.112 s
Step  1167: OL  732.9  175.2  OA  117.0   7.0 CL  117.0   7.0 nm  0.106 s
Step  1177: OL  733.4  172.0  OA  121.3  16.2 CL  121.3  16.2 nm  0.111 s
Step  1187: OL  735.0  169.6  OA  120.8  15.6 CL  120.8  15.6 nm  0.111 s
Step  1197: OL  737.2  167.5  OA  118.2  11.4 CL  118.2  11.4 nm  0.109 s
Step  1207: OL  739.7  165.6  OA  122.8  26.1 CL  122.8  26.1 nm  0.105 s
Step  1217: OL  742.3  164.1  OA  127.2  24.6 CL  127.2  24.6 nm  0.116 s
Step  1227: OL  745.1  163.3  OA  121.6  21.0 CL  121.6  21.0 nm  0.102 s
Step  1237: OL  747.4  163.7  OA  117.9  10.6 CL  117.9  10.6 nm  0.112 s
Step  1247: OL  749.5  165.2  OA  120.1  17.9 CL  120.1  17.9 nm  0.104 s
Step  1257: OL  752.1  168.1  OA  123.9   3.5 CL  123.9   3.5 nm  0.114 s
Step  1267: OL  755.1  172.2  OA  126.3  18.2 CL  126.3  18.2 nm  0.104 s
Step  1277: OL  758.5  177.2  OA  123.6  21.5 CL  123.6  21.5 nm  0.107 s
Step  1279 updated high order loop gain: 0.271
Step  1287: OL  762.7  183.1  OA  118.3   8.8 CL  118.3   8.8 nm  0.104 s
Step  1297: OL  767.1  189.5  OA  124.3  14.0 CL  124.3  14.0 nm  0.111 s
Step  1307: OL  771.3  196.6  OA  128.3  17.9 CL  128.3  17.9 nm  0.103 s
Step  1317: OL  775.0  204.2  OA  124.6  22.3 CL  124.6  22.3 nm  0.106 s
Step  1327: OL  778.6  212.5  OA  121.6   8.4 CL  121.6   8.4 nm  0.105 s
Step  1337: OL  782.8  221.4  OA  122.3   5.8 CL  122.3   5.8 nm  0.104 s
Step  1347: OL  787.8  230.6  OA  119.8  17.4 CL  119.8  17.4 nm  0.106 s
Step  1357: OL  793.5  239.5  OA  120.5  31.3 CL  120.5  31.3 nm  0.114 s
Step  1367: OL  799.9  247.6  OA  117.1  23.3 CL  117.1  23.3 nm  0.108 s
Step  1377: OL  806.5  254.4  OA  126.2  38.0 CL  126.2  38.0 nm  0.115 s
Step  1387: OL  813.7  260.2  OA  119.8  28.2 CL  119.8  28.2 nm  0.112 s
Step  1397: OL  821.5  265.1  OA  125.5  40.4 CL  125.5  40.4 nm  0.109 s
Step  1407: OL  829.9  268.8  OA  125.0  28.8 CL  125.0  28.8 nm  0.112 s
Step  1417: OL  838.7  271.8  OA  127.1  45.5 CL  127.1  45.5 nm  0.106 s
Step  1427: OL  847.8  274.2  OA  129.9  44.4 CL  129.9  44.4 nm  0.104 s
Step  1437: OL  856.5  276.4  OA  122.4  25.8 CL  122.4  25.8 nm  0.114 s
Step  1447: OL  864.7  278.1  OA  132.2  51.6 CL  132.2  51.6 nm  0.109 s
Step  1457: OL  872.5  279.3  OA  126.1  41.0 CL  126.1  41.0 nm  0.113 s
Step  1467: OL  879.4  279.5  OA  129.7  37.6 CL  129.7  37.6 nm  0.109 s
Step  1477: OL  884.4  278.8  OA  129.1  35.9 CL  129.1  35.9 nm  0.107 s
Step  1485: OL  887.0  277.4  OA  136.2  48.6 CL  136.2  48.6 nm  0.106 s
Step  1495: OL  888.5  274.7  OA  131.4  42.0 CL  131.4  42.0 nm  0.104 s
Step  1505: OL  888.2  271.0  OA  122.5  26.9 CL  122.5  26.9 nm  0.110 s
Step  1515: OL  886.6  266.6  OA  136.2  55.3 CL  136.2  55.3 nm  0.106 s
Step  1525: OL  883.8  261.7  OA  122.5  31.2 CL  122.5  31.2 nm  0.115 s
Step  1535: OL  879.6  255.8  OA  122.6  38.2 CL  122.6  38.2 nm  0.102 s
Step  1535 updated high order loop gain: 0.265
Step  1545: OL  874.8  249.4  OA  134.4  49.9 CL  134.4  49.9 nm  0.117 s
Step  1554: OL  870.2  243.4  OA  134.4  53.0 CL  134.4  53.0 nm  0.105 s
Step  1564: OL  865.1  237.0  OA  140.9  56.4 CL  140.9  56.4 nm  0.114 s
Step  1572: OL  860.9  232.2  OA  141.9  55.8 CL  141.9  55.8 nm  0.108 s
Step  1582: OL  855.4  226.9  OA  132.0  36.3 CL  132.0  36.3 nm  0.112 s
Step  1592: OL  849.4  222.4  OA  139.7  59.6 CL  139.7  59.6 nm  0.108 s
Step 1599: Output PSF
Step  1599: OL  845.1  219.5  OA  140.3  53.7 CL  140.3  53.7 nm  1.467 s
Mean: 123.35 28.38 120.04  nm.

*** Simulation Finished at 2025/02/17 15:59:26 in nid001972. ***

Beginning actuator count study... 

Found configuration file: master_files/reduced_ngs/9_lgs/8mag_lgs/kola_1000act.conf


Found configuration file: master_files/reduced_ngs/9_lgs/8mag_lgs/kola_1250act.conf


Found configuration file: master_files/reduced_ngs/9_lgs/8mag_lgs/kola_1500act.conf


Found configuration file: master_files/reduced_ngs/9_lgs/8mag_lgs/kola_1750act.conf


Found configuration file: master_files/reduced_ngs/9_lgs/8mag_lgs/kola_2000act.conf


Found configuration file: master_files/reduced_ngs/9_lgs/8mag_lgs/kola_2250act.conf


Found configuration file: master_files/reduced_ngs/9_lgs/8mag_lgs/kola_2500act.conf


Found configuration file: master_files/reduced_ngs/9_lgs/8mag_lgs/kola_2750act.conf


Found configuration file: master_files/reduced_ngs/9_lgs/8mag_lgs/kola_3000act.conf


Found configuration file: master_files/reduced_ngs/9_lgs/8mag_lgs/kola_3250act.conf


Found configuration file: master_files/reduced_ngs/9_lgs/8mag_lgs/kola_3500act.conf


Found configuration file: master_files/reduced_ngs/9_lgs/8mag_lgs/kola_3750act.conf


Found configuration file: master_files/reduced_ngs/9_lgs/8mag_lgs/kola_4000act.conf


Found configuration file: master_files/reduced_ngs/9_lgs/8mag_lgs/kola_4250act.conf


Found configuration file: master_files/reduced_ngs/9_lgs/8mag_lgs/kola_4500act.conf


Found configuration file: master_files/reduced_ngs/9_lgs/8mag_lgs/kola_4750act.conf


Found configuration file: master_files/reduced_ngs/9_lgs/8mag_lgs/kola_5000act.conf


Found configuration file: master_files/reduced_ngs/9_lgs/8mag_lgs/kola_5250act.conf


Found configuration file: master_files/reduced_ngs/9_lgs/8mag_lgs/kola_5500act.conf


Found configuration file: master_files/reduced_ngs/9_lgs/8mag_lgs/kola_5750act.conf


Found configuration file: master_files/reduced_ngs/9_lgs/8mag_lgs/kola_6000act.conf


---------------------------------------
SIM (1000) TIME: 0:2:3.889
SIM (1250) TIME: 0:2:6.485
SIM (1500) TIME: 0:2:8.262
SIM (1750) TIME: 0:2:20.261
SIM (2000) TIME: 0:2:15.828
SIM (2250) TIME: 0:2:27.605
SIM (2500) TIME: 0:2:46.315
SIM (2750) TIME: 0:2:52.858
SIM (3000) TIME: 0:3:17.645
SIM (3250) TIME: 0:3:53.360
SIM (3500) TIME: 0:3:11.771
SIM (3750) TIME: 0:4:0.519
SIM (4000) TIME: 0:4:27.873
SIM (4250) TIME: 0:4:5.320
SIM (4500) TIME: 0:4:42.464
SIM (4750) TIME: 0:4:16.575
SIM (5000) TIME: 0:4:56.871
SIM (5250) TIME: 0:4:35.18
SIM (5500) TIME: 0:5:7.315
SIM (5750) TIME: 0:5:0.820
SIM (6000) TIME: 0:5:4.371
---------------------------------------
Simulation log saved to: studies/reduced_ngs/9_lgs/8mag_lgs/act_count_log_20250217_144345.txt
[00;00m>>>>>>>>>>>>>>>>Mon 17 Feb 2025 03:59:28 PM PST
All done!
