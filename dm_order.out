[00;00m[0;36mWarning(accphi.c:477): 108261 points not covered by input screen
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid008652/scheduler) failed: Invalid argument. 
Step   726: OL 1105.5  555.2  OA  120.3  21.3 CL  120.3  21.3 nm  0.068 s
Step  1151: OL  739.4  182.8  OA   97.0  19.2 CL   97.0  19.2 nm  0.061 s
---------------------------
Job id = 35751110
Proc id = 0
 ->maos.c:447->setup.c:148->aper.c:74->utils.c:478->accphi.c:478
nid003544
Wed 12 Feb 2025 12:35:59 AM PST
iwvl 0: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 1: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
---------------------------
iwvl 2: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 3: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 4: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 5: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 6: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 7: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 8: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
After setup_aper:	343.2 MiB.

[00;00mSetting up powfs 0 geom[00;00m

There are 18 points in each subaperture of 0.145m.
There are 3550 valid subaperture.

[00;00mSetting up powfs 1 geom[00;00m

There are 88 points in each subaperture of 5.5m.
There are 4 valid subaperture.

[00;00mSetting up powfs 2 geom[00;00m

There are 18 points in each subaperture of 0.563m.
There are 236 valid subaperture.
After setup_powfs_init:	418.8 MiB.

[00;00mSetting up reconstructor geometry.[00;00m

PLOC is 155x155, with sampling of 0.07m (square)
    DM 0: grid is 81 x 81
    DM 1: grid is 75 x 75
    DM 2: grid is 81 x 79
FLOC is 155x155, with sampling of 0.07m (not square)
Step   741: OL 1106.7  536.6  OA  120.0  21.4 CL  120.0  21.4 nm  0.064 s
Tomography grid is square:
    layer 0: xloc grid is 280 x 280, sampling is 0.072 m, 78400 points
    layer 1: xloc grid is 280 x 280, sampling is 0.072 m, 78400 points
    layer 2: xloc grid is 280 x 280, sampling is 0.072 m, 78400 points
    layer 3: xloc grid is 280 x 280, sampling is 0.072 m, 78400 points
    layer 4: xloc grid is 280 x 280, sampling is 0.072 m, 78400 points
    layer 5: xloc grid is 280 x 280, sampling is 0.072 m, 78400 points
    layer 6: xloc grid is 280 x 280, sampling is 0.072 m, 78400 points
    layer 7: xloc grid is 280 x 280, sampling is 0.072 m, 78400 points
    layer 8: xloc grid is 280 x 280, sampling is 0.072 m, 78400 points
    layer 9: xloc grid is 280 x 280, sampling is 0.072 m, 78400 points
    layer 10: xloc grid is 280 x 280, sampling is 0.069 m, 78400 points
    layer 11: xloc grid is 280 x 280, sampling is 0.066 m, 78400 points
    layer 12: xloc grid is 280 x 280, sampling is 0.062 m, 78400 points
    layer 13: xloc grid is 280 x 280, sampling is 0.056 m, 78400 points
Step  1168: OL  740.2  175.1  OA   96.3  15.4 CL   96.3  15.4 nm  0.059 s

[00;00mSetting up powfs 0 PO WFS[00;00m

OTF dimension is 36x36 (calculated)
There is no bias
Step   757: OL 1103.6  517.3  OA  119.6  22.3 CL  119.6  22.3 nm  0.062 s
Step  1185: OL  742.1  170.4  OA   97.4  13.0 CL   97.4  13.0 nm  0.058 s
Step   767 updated high order loop gain: 0.292
Step   772: OL 1096.8  500.0  OA  120.0  22.0 CL  120.0  22.0 nm  0.071 s
Step  1202: OL  745.7  166.8  OA   96.3  14.5 CL   96.3  14.5 nm  0.066 s
Step  1219: OL  749.1  164.2  OA   95.1  11.0 CL   95.1  11.0 nm  0.058 s
Step   788: OL 1084.6  482.0  OA  123.3  20.6 CL  123.3  20.6 nm  0.067 s
Step  1236: OL  751.8  164.0  OA   92.6   2.3 CL   92.6   2.3 nm  0.058 s
Step   804: OL 1067.8  464.1  OA  121.4  23.6 CL  121.4  23.6 nm  0.072 s
Step  1253: OL  753.6  167.2  OA   97.9  26.6 CL   97.9  26.6 nm  0.062 s
Step   819: OL 1049.1  447.4  OA  121.6  24.6 CL  121.6  24.6 nm  0.066 s
Step  1270: OL  756.3  174.0  OA   97.6  26.6 CL   97.6  26.6 nm  0.058 s
Step   835: OL 1025.9  430.0  OA  123.2  24.2 CL  123.2  24.2 nm  0.066 s
Step  1279 updated high order loop gain: 0.334
Step  1287: OL  760.3  183.4  OA  100.0  33.9 CL  100.0  33.9 nm  0.059 s
Step   850: OL 1002.2  414.6  OA  120.8  17.9 CL  120.8  17.9 nm  0.066 s
Step  1304: OL  765.3  194.7  OA   96.8  16.2 CL   96.8  16.2 nm  0.058 s
Step   866: OL  976.8  399.8  OA  117.8  14.7 CL  117.8  14.7 nm  0.071 s
Step  1320: OL  769.7  207.0  OA   99.4  16.1 CL   99.4  16.1 nm  0.059 s
Step   882: OL  952.7  387.1  OA  118.7   8.6 CL  118.7   8.6 nm  0.065 s
Step  1337: OL  775.5  221.7  OA  100.8  31.9 CL  100.8  31.9 nm  0.059 s
Step   898: OL  928.6  376.3  OA  113.3  15.8 CL  113.3  15.8 nm  0.062 s
Step  1354: OL  784.0  237.1  OA   95.1  14.7 CL   95.1  14.7 nm  0.060 s
Step   913: OL  904.9  367.9  OA  116.8  24.3 CL  116.8  24.3 nm  0.070 s
Step  1371: OL  795.4  250.6  OA   97.6  20.7 CL   97.6  20.7 nm  0.059 s
Step   928: OL  881.0  360.7  OA  115.8   4.5 CL  115.8   4.5 nm  0.062 s
Step  1388: OL  808.6  260.9  OA  102.5  28.7 CL  102.5  28.7 nm  0.064 s
Step   944: OL  856.4  353.1  OA  120.8  16.4 CL  120.8  16.4 nm  0.063 s
Step  1405: OL  824.0  268.2  OA   97.8  19.5 CL   97.8  19.5 nm  0.059 s
Step   959: OL  834.8  345.5  OA  121.0  11.8 CL  121.0  11.8 nm  0.071 s
Step  1422: OL  841.5  273.1  OA   97.7  11.9 CL   97.7  11.9 nm  0.058 s
Step   975: OL  815.2  336.4  OA  116.0   6.4 CL  116.0   6.4 nm  0.063 s
Step  1439: OL  859.1  276.7  OA  105.8  25.4 CL  105.8  25.4 nm  0.058 s
Step   991: OL  798.6  326.1  OA  123.2  21.0 CL  123.2  21.0 nm  0.074 s
Step  1456: OL  875.2  279.1  OA   94.7   9.5 CL   94.7   9.5 nm  0.064 s
Step  1007: OL  783.6  314.4  OA  120.7  12.4 CL  120.7  12.4 nm  0.064 s
Step  1472: OL  887.9  279.2  OA   94.2   6.8 CL   94.2   6.8 nm  0.058 s
Step  1023: OL  771.0  302.2  OA  122.2   2.8 CL  122.2   2.8 nm  0.065 s
Step  1023 updated high order loop gain: 0.283
Step  1489: OL  896.0  276.3  OA   96.3   6.3 CL   96.3   6.3 nm  0.058 s
Step  1035: OL  763.1  292.5  OA  124.4  14.8 CL  124.4  14.8 nm  0.063 s
Step  1506: OL  898.0  270.4  OA   93.0   2.8 CL   93.0   2.8 nm  0.057 s
Step  1050: OL  754.4  279.5  OA  122.5  14.8 CL  122.5  14.8 nm  0.065 s
Step  1523: OL  895.7  262.5  OA   96.1  12.3 CL   96.1  12.3 nm  0.058 s
Step  1066: OL  745.3  263.9  OA  123.6  13.6 CL  123.6  13.6 nm  0.077 s
Step  1535 updated high order loop gain: 0.334
Step  1539: OL  890.0  253.1  OA   95.3   5.4 CL   95.3   5.4 nm  0.066 s
Step  1081: OL  739.3  247.1  OA  123.1  13.5 CL  123.1  13.5 nm  0.066 s
Step  1556: OL  881.7  241.9  OA   96.1   8.3 CL   96.1   8.3 nm  0.059 s
[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid003544/scheduler) failed: No such file or directory. 
Step  1097: OL  736.1  228.7  OA  123.1   7.7 CL  123.1   7.7 nm  0.062 s
[00;00m[0;36mWarning(daemonize.c:230): Error redirect stdout
Step  1573: OL  872.5  231.3  OA   98.3   9.5 CL   98.3   9.5 nm  0.057 s
Step  1112: OL  735.2  213.0  OA  120.8  29.3 CL  120.8  29.3 nm  0.073 s
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid003544/scheduler) failed: Invalid argument. 
/global/u2/b/bpeck/work/vismcao/maos -o studies/reduced_ngs/9_lgs/8mag_lgs/1000count -c master_files/reduced_ngs/9_lgs/8mag_lgs/kola_1000act.conf -O 
Output folder is 'studies/reduced_ngs/9_lgs/8mag_lgs/1000count'.
SRC: /global/homes/b/bpeck/code/maos v2.9 4c88b7c2 2024-11-13 16:45:33 -0800
BUILT: /global/homes/b/bpeck/code/maos/optim by GCC (v12) on 2024/11/18 09:40:03 CPU(F64,+O3) with CUDA(v122,F32)
Launched at 2025/02/12 00:36:25 in nid003544 with PID 2032900.
The web based job monitor can be accessed at http://localhost:10300
Main config file is /global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_1000act.conf
[00;00m[0;36mWarning(path.c:48): Path not found: path=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; abspath=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; Ignored.
[00;00m[0;36mWarning(path.c:48): Path not found: path=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; abspath=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; Ignored.
[00;00m[0;36mWarning(readcfg.c:399): sim.apfsm has been renamed to powfs.apfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.epfsm has been renamed to powfs.epfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.alfsm has been renamed to powfs.alfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.commonfsm has been renamed to powfs.commonfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.idealfsm has been renamed to powfs.idealfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.zetafsm has been renamed to powfs.zetafsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.f0fsm has been renamed to powfs.f0fsm.
[00;00m[0;36mWarning(readcfg.c:399): tsurf has been renamed to ncpa.tsurf.
loaded 132 (132 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_sim.conf'
loaded  19 ( 19 new) records from '/global/u2/b/bpeck/work/vismcao/./dm_none.conf'
loaded  19 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_ASM.conf'
loaded  19 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_DM2.conf'
loaded  19 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_DM3.conf'
loaded   0 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_dm_multiple.conf'
loaded   7 (  5 new) records from '/global/u2/b/bpeck/work/vismcao/./atm_mk13n50p_ground_detail.conf'
loaded  76 ( 69 new) records from '/global/homes/b/bpeck/code/maos/config/maos/powfs_common.conf'
loaded  44 ( 38 new) records from '/global/u2/b/bpeck/work/vismcao/./powfs_none.conf'
loaded  44 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_shwfs_lgs.conf'
loaded  44 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_shwfs_ttf_strap.conf'
loaded  44 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_shwfs_twfs_lbwfs.conf'
loaded   0 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_wfs_lgs_strap_lbwfs.conf'
loaded  71 ( 71 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_recon.conf'
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_smooth has been renamed to powfs0_llt.na_smooth.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_interp has been renamed to powfs0_llt.na_interp.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_thres has been renamed to powfs0_llt.na_thres.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_maxit has been renamed to powfs0_llt.na_fit_maxit.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_svdthres has been renamed to powfs0_llt.na_fit_svdthres.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_dh has been renamed to powfs0_llt.na_fit_dh.
[00;00m[0;36mWarning(readcfg.c:399): dbg.ncpa_preload has been renamed to ncpa.preload.
[00;00m[0;36mWarning(readcfg.c:399): dbg.ncpa_rmsci has been renamed to ncpa.rmsci.
[00;00m[0;36mWarning(readcfg.c:399): dbg.draw_opdmax has been renamed to plot.opdmax.
[00;00m[0;36mWarning(readcfg.c:399): dbg.draw_gmax has been renamed to plot.gmax.
loaded  95 ( 93 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_dbg.conf'
loaded   4 (  4 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_fit_mcao.conf'
[00;00m[0;36mWarning(readcfg.c:399): surf has been renamed to ncpa.surf.
loaded  39 (  7 new) records from '/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_1000act.conf'
loaded   0 (  0 new) records from 'command line'
loaded  24 ( 18 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_llt_CL.conf'
Adjust LGS range by telescope altitude 4145m.
Zenith angle is 30 degree.
    Scaling turbulence height and LGS hs by sec(za).
    Scaling r0 by cos(za)^(3/5).
    Scaling wind speed and LGS signal level by cos(za).
powfs0: Adjusting dx from 0.0078125 to 0.0077. 
powfs0.llt.fsm: f0=0 Hz, LPF ep=0
powfs0.epfsm is set to 0.517618 (auto)
powfs2: Adjusting dx from 0.03125 to 0.0312778. 
powfs2 is TWFS for powfs0
sim.ephi is set to 0.427717 (auto)
sim.eplo is set to 0.427717 (auto)
[00;00m[0;36mWarning(parms.c:2296): Layer 1 at 17.3205m is very close to layer 0 at 0m (OK).
[00;00m[0;36mWarning(parms.c:2296): Layer 2 at 34.641m is very close to layer 1 at 17.3205m (OK).
[00;00m[0;36mWarning(parms.c:2296): Layer 3 at 51.9615m is very close to layer 2 at 34.641m (OK).
dm 0: stroke=30 um is provided in micron.
dm 0: assume ia stroke=2 um is provided in micron.
dm 1: stroke=7 um is provided in micron.
dm 1: assume ia stroke=2 um is provided in micron.
dm 2: stroke=7 um is provided in micron.
dm 2: assume ia stroke=2 um is provided in micron.
Focus blending is not implemented yet for integrated tomography
parms->sim.mffocus is reset to 0
There are 1 valid simulation seeds:  1
Output PSF for 1 directions
Used 449 of 456 supplied keys
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_flate" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_flatv" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_psx" is not recognized, value is [0 0 0 0]
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_psy" is not recognized, value is [0 0 0 0]
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_pupelong" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_raw" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_side" is not recognized, value is 4
[00;00mAperture[00;00m is 11 m with sampling 1/128 m
[00;00mTurbulence at 30 degree zenith angle:[00;00m r0=0.128424m, L0=30m, 14 layers.
    Greenwood freq is 25.1Hz, anisoplanatic angle is 1.58 as
    Sampled 8192x8192 at 1/128m. wind dir is randomized.
    layer 0: ht=      0 m, wt= 0.302, ws=  4.8 m/s
    layer 1: ht=     17 m, wt= 0.154, ws=  5.0 m/s
    layer 2: ht=     35 m, wt= 0.041, ws=  5.4 m/s
    layer 3: ht=     52 m, wt= 0.002, ws=  6.6 m/s
    layer 4: ht=    139 m, wt= 0.021, ws=  6.1 m/s
    layer 5: ht=    231 m, wt= 0.010, ws=  6.1 m/s
    layer 6: ht=    323 m, wt= 0.008, ws=  6.1 m/s
    layer 7: ht=    416 m, wt= 0.005, ws=  6.1 m/s
    layer 8: ht=    508 m, wt= 0.001, ws=  6.1 m/s
    layer 9: ht=    932 m, wt= 0.107, ws=  5.6 m/s
    layer 10: ht=   5022 m, wt= 0.144, ws= 11.1 m/s
    layer 11: ht=   9238 m, wt= 0.093, ws= 19.1 m/s
    layer 12: ht=  13856 m, wt= 0.075, ws=  8.2 m/s
    layer 13: ht=  22518 m, wt= 0.036, ws=  4.8 m/s
[00;00mReconstruction[00;00m: r0=0.128424m L0=30m. 14 layers. use cone coordinate.
    layer 0: ht=      0 m, wt= 0.302
    layer 1: ht=     17 m, wt= 0.154
    layer 2: ht=     35 m, wt= 0.041
    layer 3: ht=     52 m, wt= 0.002
    layer 4: ht=    139 m, wt= 0.021
    layer 5: ht=    231 m, wt= 0.010
    layer 6: ht=    323 m, wt= 0.008
    layer 7: ht=    416 m, wt= 0.005
    layer 8: ht=    508 m, wt= 0.001
    layer 9: ht=    932 m, wt= 0.107
    layer 10: ht=   5022 m, wt= 0.144
    layer 11: ht=   9238 m, wt= 0.093
    layer 12: ht=  13856 m, wt= 0.075
    layer 13: ht=  22518 m, wt= 0.036
[00;00mThere are 3 powfs[00;00m
  powfs0: Order 36, LGS at 99.1 km. Sampling 1/129.87 m. Thres 30%. [00;00mT/T is removed in right hand side in tomography.[00;00m
    CCD image is 25x25 @ 500x500 mas, blur 27% (sigma), 1500Hz, wvl: [ 5.89e-07]
    Gtilt in reconstruction. Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
  powfs1: Order  2, NGS at inf km. Sampling 1/16 m. Thres 30%. 
    Ztilt in reconstruction. Geomtric optics start at 2 with ztilt [00;00m(noisy)[00;00m
  powfs2: Order 20, NGS at inf km. Sampling 1/31.9716 m. Thres 50%. 
    CCD image is 4x4 @ 1500x1500 mas, blur 0% (sigma), 0.015Hz, wvl: [ 7.2e-07]
    Gtilt in reconstruction. Geomtric optics start at 50 with gtilt Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
[00;00mThere are 13 wfs[00;00m
    wfs 0: type 0, at (  30.00,    0.00) arcsec,  99 km, siglev is 113.746 bkgrnd is 0.1
    wfs 1: type 0, at (  22.98,   19.28) arcsec,  99 km, siglev is 113.746 bkgrnd is 0.1
    wfs 2: type 0, at (   5.21,   29.54) arcsec,  99 km, siglev is 113.746 bkgrnd is 0.1
    wfs 3: type 0, at ( -15.00,   25.98) arcsec,  99 km, siglev is 113.746 bkgrnd is 0.1
    wfs 4: type 0, at ( -28.19,   10.26) arcsec,  99 km, siglev is 113.746 bkgrnd is 0.1
    wfs 5: type 0, at ( -28.19,  -10.26) arcsec,  99 km, siglev is 113.746 bkgrnd is 0.1
    wfs 6: type 0, at ( -15.00,  -25.98) arcsec,  99 km, siglev is 113.746 bkgrnd is 0.1
    wfs 7: type 0, at (   5.21,  -29.54) arcsec,  99 km, siglev is 113.746 bkgrnd is 0.1
    wfs 8: type 0, at (  22.98,  -19.28) arcsec,  99 km, siglev is 113.746 bkgrnd is 0.1
    wfs 9: type 1, at (   5.00,    8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 10: type 1, at ( -10.00,    0.00) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 11: type 1, at (   5.00,   -8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 12: type 2, at (   0.00,    0.00) arcsec, inf km, siglev is 4.1558e+06 bkgrnd is 0.001
[00;00mThere are 3 DMs[00;00m
  DM 0 at -0.1km, actuator pitch 0.308m, offset   0, with 30.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 1 at    6km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 2 at   10km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
[00;00mTomography[00;00m is using CG, with [00;00mFourer Domain[00;00m preconditioner, [00;00m12[00;00m iterations, integrated tomo.
[00;00mDM Fitting [00;00mis using CG, with [00;00mNo[00;00m preconditioner, [00;00m10[00;00m iterations
[00;00mThere are 9 fit directions[00;00m
    Fit 0: weight is 0.444, at (   0.00,    0.00) arcsec
    Fit 1: weight is 0.111, at (  15.00,    0.00) arcsec
    Fit 2: weight is 0.111, at (   0.00,   15.00) arcsec
    Fit 3: weight is 0.111, at ( -15.00,    0.00) arcsec
    Fit 4: weight is 0.111, at (   0.00,  -15.00) arcsec
    Fit 5: weight is 0.028, at (  15.00,   15.00) arcsec
    Fit 6: weight is 0.028, at ( -15.00,   15.00) arcsec
    Fit 7: weight is 0.028, at ( -15.00,  -15.00) arcsec
    Fit 8: weight is 0.028, at (  15.00,  -15.00) arcsec
[00;00mThere are 1 evaluation directions[00;00m at sampling 1/128 m.
    Evl 0: weight is 1.000, at (   0.00,    0.00) arcsec
[00;00mSimulation[00;00m start at step 0, end at step 1600, with time step 1/1500s, [00;00mclose loop[00;00m.
Step  1590: OL  861.7  223.0  OA   97.9  12.5 CL   97.9  12.5 nm  0.058 s
After setup_parms:	120.5 MiB.
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid003544/scheduler) failed: Invalid argument. 
CUDA: minimum memory requirement is 0.4GB
Step  1128: OL  735.4  198.5  OA  115.0  32.1 CL  115.0  32.1 nm  0.065 s
GPU 0 is NVIDIA A100-SXM4-40GB with arch 8.0, 38.9GB free, 39.3GB total device memory.
Using GPU 0
Use 1 GPUs for WFS Tomo Fit Evl

*** Preparation started at 2025/02/12 00:36:26 in nid003544. ***

Using OpenMP version 201511 with 128 threads
Reading aperture amplitude map from KECK.fits
Step 1599: Output PSF
Step  1143: OL  736.0  187.6  OA  115.4  29.2 CL  115.4  29.2 nm  0.073 s
Step  1159: OL  736.9  178.6  OA  112.8  13.3 CL  112.8  13.3 nm  0.063 s
[00;00m[0;36mWarning(accphi.c:477): 108398 points not covered by input screen
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid003544/scheduler) failed: Invalid argument. 
 ->maos.c:447->setup.c:148->aper.c:74->utils.c:478->accphi.c:478
iwvl 0: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 1: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 2: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 3: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 4: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 5: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 6: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 7: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 8: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
After setup_aper:	342.8 MiB.

[00;00mSetting up powfs 0 geom[00;00m

There are 40 points in each subaperture of 0.308m.
There are 787 valid subaperture.

[00;00mSetting up powfs 1 geom[00;00m

There are 88 points in each subaperture of 5.5m.
There are 4 valid subaperture.

[00;00mSetting up powfs 2 geom[00;00m

There are 18 points in each subaperture of 0.563m.
There are 236 valid subaperture.
After setup_powfs_init:	413.3 MiB.

[00;00mSetting up reconstructor geometry.[00;00m

PLOC is 75x75, with sampling of 0.15m (square)
    DM 0: grid is 39 x 39
    DM 1: grid is 75 x 75
    DM 2: grid is 80 x 79
FLOC is 75x75, with sampling of 0.15m (not square)
Step  1599: OL  855.6  219.2  OA   99.9  13.9 CL   99.9  13.9 nm  2.752 s
Step  1175: OL  737.7  172.7  OA  113.6   9.1 CL  113.6   9.1 nm  0.070 s
Mean: 97.09 15.59 95.83  nm.

*** Simulation Finished at 2025/02/12 00:36:29 in nid008213. ***

Tomography grid is square:
    layer 0: xloc grid is 140 x 140, sampling is 0.154 m, 19600 points
    layer 1: xloc grid is 140 x 140, sampling is 0.154 m, 19600 points
    layer 2: xloc grid is 140 x 140, sampling is 0.154 m, 19600 points
    layer 3: xloc grid is 140 x 140, sampling is 0.154 m, 19600 points
    layer 4: xloc grid is 140 x 140, sampling is 0.154 m, 19600 points
    layer 5: xloc grid is 140 x 140, sampling is 0.154 m, 19600 points
    layer 6: xloc grid is 140 x 140, sampling is 0.153 m, 19600 points
    layer 7: xloc grid is 140 x 140, sampling is 0.153 m, 19600 points
    layer 8: xloc grid is 140 x 140, sampling is 0.153 m, 19600 points
    layer 9: xloc grid is 140 x 140, sampling is 0.153 m, 19600 points
    layer 10: xloc grid is 140 x 140, sampling is 0.146 m, 19600 points
    layer 11: xloc grid is 140 x 140, sampling is 0.140 m, 19600 points
    layer 12: xloc grid is 140 x 140, sampling is 0.132 m, 19600 points
    layer 13: xloc grid is 140 x 140, sampling is 0.119 m, 19600 points

[00;00mSetting up powfs 0 PO WFS[00;00m

OTF dimension is 80x80 (calculated)
There is no bias
Step  1191: OL  740.6  168.9  OA  116.2   6.4 CL  116.2   6.4 nm  0.063 s
Step  1206: OL  744.1  166.0  OA  115.7  12.9 CL  115.7  12.9 nm  0.066 s
[00;00m>>>>>>>>>>>>>>>>[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid008213/scheduler) failed: Invalid argument. 
/global/u2/b/bpeck/work/vismcao/maos -o studies/reduced_ngs/10_lgs/8mag_lgs/2750count -c master_files/reduced_ngs/10_lgs/8mag_lgs/kola_2750act.conf -O 
Output folder is 'studies/reduced_ngs/10_lgs/8mag_lgs/2750count'.
SRC: /global/homes/b/bpeck/code/maos v2.9 4c88b7c2 2024-11-13 16:45:33 -0800
BUILT: /global/homes/b/bpeck/code/maos/optim by GCC (v12) on 2024/11/18 09:40:03 CPU(F64,+O3) with CUDA(v122,F32)
Launched at 2025/02/12 00:36:31 in nid008213 with PID 714077.
The web based job monitor can be accessed at http://localhost:10300
Main config file is /global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/10_lgs/8mag_lgs/kola_2750act.conf
[00;00m[0;36mWarning(path.c:48): Path not found: path=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/10_lgs/8mag_lgs/bin; abspath=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/10_lgs/8mag_lgs/bin; Ignored.
[00;00m[0;36mWarning(path.c:48): Path not found: path=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/10_lgs/8mag_lgs/atm; abspath=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/10_lgs/8mag_lgs/atm; Ignored.
[00;00m[0;36mWarning(readcfg.c:399): sim.apfsm has been renamed to powfs.apfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.epfsm has been renamed to powfs.epfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.alfsm has been renamed to powfs.alfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.commonfsm has been renamed to powfs.commonfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.idealfsm has been renamed to powfs.idealfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.zetafsm has been renamed to powfs.zetafsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.f0fsm has been renamed to powfs.f0fsm.
[00;00m[0;36mWarning(readcfg.c:399): tsurf has been renamed to ncpa.tsurf.
loaded 132 (132 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_sim.conf'
loaded  19 ( 19 new) records from '/global/u2/b/bpeck/work/vismcao/./dm_none.conf'
loaded  19 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_ASM.conf'
loaded  19 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_DM2.conf'
loaded  19 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_DM3.conf'
loaded   0 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_dm_multiple.conf'
loaded   7 (  5 new) records from '/global/u2/b/bpeck/work/vismcao/./atm_mk13n50p_ground_detail.conf'
loaded  76 ( 69 new) records from '/global/homes/b/bpeck/code/maos/config/maos/powfs_common.conf'
loaded  44 ( 38 new) records from '/global/u2/b/bpeck/work/vismcao/./powfs_none.conf'
loaded  44 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_shwfs_lgs.conf'
loaded  44 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_shwfs_ttf_strap.conf'
loaded  44 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_shwfs_twfs_lbwfs.conf'
loaded   0 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_wfs_lgs_strap_lbwfs.conf'
loaded  71 ( 71 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_recon.conf'
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_smooth has been renamed to powfs0_llt.na_smooth.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_interp has been renamed to powfs0_llt.na_interp.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_thres has been renamed to powfs0_llt.na_thres.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_maxit has been renamed to powfs0_llt.na_fit_maxit.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_svdthres has been renamed to powfs0_llt.na_fit_svdthres.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_dh has been renamed to powfs0_llt.na_fit_dh.
[00;00m[0;36mWarning(readcfg.c:399): dbg.ncpa_preload has been renamed to ncpa.preload.
[00;00m[0;36mWarning(readcfg.c:399): dbg.ncpa_rmsci has been renamed to ncpa.rmsci.
[00;00m[0;36mWarning(readcfg.c:399): dbg.draw_opdmax has been renamed to plot.opdmax.
[00;00m[0;36mWarning(readcfg.c:399): dbg.draw_gmax has been renamed to plot.gmax.
loaded  95 ( 93 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_dbg.conf'
loaded   4 (  4 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_fit_mcao.conf'
[00;00m[0;36mWarning(readcfg.c:399): surf has been renamed to ncpa.surf.
loaded  39 (  7 new) records from '/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/10_lgs/8mag_lgs/kola_2750act.conf'
loaded   0 (  0 new) records from 'command line'
loaded  24 ( 18 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_llt_CL.conf'
Adjust LGS range by telescope altitude 4145m.
Zenith angle is 30 degree.
    Scaling turbulence height and LGS hs by sec(za).
    Scaling r0 by cos(za)^(3/5).
    Scaling wind speed and LGS signal level by cos(za).
powfs0: Adjusting dx from 0.0078125 to 0.00775. 
powfs0.llt.fsm: f0=0 Hz, LPF ep=0
powfs0.epfsm is set to 0.517618 (auto)
powfs2: Adjusting dx from 0.03125 to 0.0312778. 
powfs2 is TWFS for powfs0
sim.ephi is set to 0.427717 (auto)
sim.eplo is set to 0.427717 (auto)
[00;00m[0;36mWarning(parms.c:2296): Layer 1 at 17.3205m is very close to layer 0 at 0m (OK).
[00;00m[0;36mWarning(parms.c:2296): Layer 2 at 34.641m is very close to layer 1 at 17.3205m (OK).
[00;00m[0;36mWarning(parms.c:2296): Layer 3 at 51.9615m is very close to layer 2 at 34.641m (OK).
dm 0: stroke=30 um is provided in micron.
dm 0: assume ia stroke=2 um is provided in micron.
dm 1: stroke=7 um is provided in micron.
dm 1: assume ia stroke=2 um is provided in micron.
dm 2: stroke=7 um is provided in micron.
dm 2: assume ia stroke=2 um is provided in micron.
Focus blending is not implemented yet for integrated tomography
parms->sim.mffocus is reset to 0
There are 1 valid simulation seeds:  1
Output PSF for 1 directions
Used 449 of 456 supplied keys
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_flate" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_flatv" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_psx" is not recognized, value is [0 0 0 0]
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_psy" is not recognized, value is [0 0 0 0]
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_pupelong" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_raw" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_side" is not recognized, value is 4
[00;00mAperture[00;00m is 11 m with sampling 1/128 m
[00;00mTurbulence at 30 degree zenith angle:[00;00m r0=0.128424m, L0=30m, 14 layers.
    Greenwood freq is 25.1Hz, anisoplanatic angle is 1.58 as
    Sampled 8192x8192 at 1/128m. wind dir is randomized.
    layer 0: ht=      0 m, wt= 0.302, ws=  4.8 m/s
    layer 1: ht=     17 m, wt= 0.154, ws=  5.0 m/s
    layer 2: ht=     35 m, wt= 0.041, ws=  5.4 m/s
    layer 3: ht=     52 m, wt= 0.002, ws=  6.6 m/s
    layer 4: ht=    139 m, wt= 0.021, ws=  6.1 m/s
    layer 5: ht=    231 m, wt= 0.010, ws=  6.1 m/s
    layer 6: ht=    323 m, wt= 0.008, ws=  6.1 m/s
    layer 7: ht=    416 m, wt= 0.005, ws=  6.1 m/s
    layer 8: ht=    508 m, wt= 0.001, ws=  6.1 m/s
    layer 9: ht=    932 m, wt= 0.107, ws=  5.6 m/s
    layer 10: ht=   5022 m, wt= 0.144, ws= 11.1 m/s
    layer 11: ht=   9238 m, wt= 0.093, ws= 19.1 m/s
    layer 12: ht=  13856 m, wt= 0.075, ws=  8.2 m/s
    layer 13: ht=  22518 m, wt= 0.036, ws=  4.8 m/s
[00;00mReconstruction[00;00m: r0=0.128424m L0=30m. 14 layers. use cone coordinate.
    layer 0: ht=      0 m, wt= 0.302
    layer 1: ht=     17 m, wt= 0.154
    layer 2: ht=     35 m, wt= 0.041
    layer 3: ht=     52 m, wt= 0.002
    layer 4: ht=    139 m, wt= 0.021
    layer 5: ht=    231 m, wt= 0.010
    layer 6: ht=    323 m, wt= 0.008
    layer 7: ht=    416 m, wt= 0.005
    layer 8: ht=    508 m, wt= 0.001
    layer 9: ht=    932 m, wt= 0.107
    layer 10: ht=   5022 m, wt= 0.144
    layer 11: ht=   9238 m, wt= 0.093
    layer 12: ht=  13856 m, wt= 0.075
    layer 13: ht=  22518 m, wt= 0.036
[00;00mThere are 3 powfs[00;00m
  powfs0: Order 60, LGS at 99.1 km. Sampling 1/129.032 m. Thres 30%. [00;00mT/T is removed in right hand side in tomography.[00;00m
    CCD image is 25x25 @ 500x500 mas, blur 27% (sigma), 1500Hz, wvl: [ 5.89e-07]
    Gtilt in reconstruction. Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
  powfs1: Order  2, NGS at inf km. Sampling 1/16 m. Thres 30%. 
    Ztilt in reconstruction. Geomtric optics start at 2 with ztilt [00;00m(noisy)[00;00m
  powfs2: Order 20, NGS at inf km. Sampling 1/31.9716 m. Thres 50%. 
    CCD image is 4x4 @ 1500x1500 mas, blur 0% (sigma), 0.015Hz, wvl: [ 7.2e-07]
    Gtilt in reconstruction. Geomtric optics start at 50 with gtilt Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
[00;00mThere are 14 wfs[00;00m
    wfs 0: type 0, at (  30.00,    0.00) arcsec,  99 km, siglev is 41.4818 bkgrnd is 0.1
    wfs 1: type 0, at (  24.27,   17.63) arcsec,  99 km, siglev is 41.4818 bkgrnd is 0.1
    wfs 2: type 0, at (   9.27,   28.53) arcsec,  99 km, siglev is 41.4818 bkgrnd is 0.1
    wfs 3: type 0, at (  -9.27,   28.53) arcsec,  99 km, siglev is 41.4818 bkgrnd is 0.1
    wfs 4: type 0, at ( -24.27,   17.63) arcsec,  99 km, siglev is 41.4818 bkgrnd is 0.1
    wfs 5: type 0, at ( -30.00,    0.00) arcsec,  99 km, siglev is 41.4818 bkgrnd is 0.1
    wfs 6: type 0, at ( -24.27,  -17.63) arcsec,  99 km, siglev is 41.4818 bkgrnd is 0.1
    wfs 7: type 0, at (  -9.27,  -28.53) arcsec,  99 km, siglev is 41.4818 bkgrnd is 0.1
    wfs 8: type 0, at (   9.27,  -28.53) arcsec,  99 km, siglev is 41.4818 bkgrnd is 0.1
    wfs 9: type 0, at (  24.27,  -17.63) arcsec,  99 km, siglev is 41.4818 bkgrnd is 0.1
    wfs 10: type 1, at (   5.00,    8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 11: type 1, at ( -10.00,    0.00) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 12: type 1, at (   5.00,   -8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 13: type 2, at (   0.00,    0.00) arcsec, inf km, siglev is 4.1558e+06 bkgrnd is 0.001
[00;00mThere are 3 DMs[00;00m
  DM 0 at -0.1km, actuator pitch 0.186m, offset   0, with 30.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 1 at    6km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 2 at   10km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
[00;00mTomography[00;00m is using CG, with [00;00mFourer Domain[00;00m preconditioner, [00;00m12[00;00m iterations, integrated tomo.
[00;00mDM Fitting [00;00mis using CG, with [00;00mNo[00;00m preconditioner, [00;00m10[00;00m iterations
[00;00mThere are 9 fit directions[00;00m
    Fit 0: weight is 0.444, at (   0.00,    0.00) arcsec
    Fit 1: weight is 0.111, at (  15.00,    0.00) arcsec
    Fit 2: weight is 0.111, at (   0.00,   15.00) arcsec
    Fit 3: weight is 0.111, at ( -15.00,    0.00) arcsec
    Fit 4: weight is 0.111, at (   0.00,  -15.00) arcsec
    Fit 5: weight is 0.028, at (  15.00,   15.00) arcsec
    Fit 6: weight is 0.028, at ( -15.00,   15.00) arcsec
    Fit 7: weight is 0.028, at ( -15.00,  -15.00) arcsec
    Fit 8: weight is 0.028, at (  15.00,  -15.00) arcsec
[00;00mThere are 1 evaluation directions[00;00m at sampling 1/128 m.
    Evl 0: weight is 1.000, at (   0.00,    0.00) arcsec
[00;00mSimulation[00;00m start at step 0, end at step 1600, with time step 1/1500s, [00;00mclose loop[00;00m.
After setup_parms:	120.6 MiB.
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid008213/scheduler) failed: Invalid argument. 
Step  1221: OL  747.4  164.0  OA  116.2  18.1 CL  116.2  18.1 nm  0.071 s
CUDA: minimum memory requirement is 0.4GB
GPU 0 is NVIDIA A100-SXM4-80GB with arch 8.0, 78.6GB free, 79.0GB total device memory.
Using GPU 0
Use 1 GPUs for WFS Tomo Fit Evl

*** Preparation started at 2025/02/12 00:36:32 in nid008213. ***

Using OpenMP version 201511 with 128 threads
Reading aperture amplitude map from KECK.fits
Step  1237: OL  750.4  164.0  OA  114.1   6.6 CL  114.1   6.6 nm  0.065 s
[00;00m[0;36mWarning(accphi.c:477): 108452 points not covered by input screen
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid008213/scheduler) failed: Invalid argument. 
 ->maos.c:447->setup.c:148->aper.c:74->utils.c:478->accphi.c:478
iwvl 0: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 1: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 2: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 3: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 4: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 5: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
Step  1253: OL  752.4  167.1  OA  113.1  17.6 CL  113.1  17.6 nm  0.071 s
iwvl 6: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 7: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 8: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
After setup_aper:	346.9 MiB.

[00;00mSetting up powfs 0 geom[00;00m

There are 24 points in each subaperture of 0.186m.
There are 2160 valid subaperture.

[00;00mSetting up powfs 1 geom[00;00m

There are 88 points in each subaperture of 5.5m.
There are 4 valid subaperture.

[00;00mSetting up powfs 2 geom[00;00m

There are 18 points in each subaperture of 0.563m.
There are 236 valid subaperture.
After setup_powfs_init:	441.5 MiB.

[00;00mSetting up reconstructor geometry.[00;00m

PLOC is 123x123, with sampling of 0.09m (square)
    DM 0: grid is 63 x 63
    DM 1: grid is 75 x 75
    DM 2: grid is 81 x 79
FLOC is 123x123, with sampling of 0.09m (not square)
Tomography grid is square:
    layer 0: xloc grid is 216 x 216, sampling is 0.093 m, 46656 points
    layer 1: xloc grid is 216 x 216, sampling is 0.093 m, 46656 points
    layer 2: xloc grid is 216 x 216, sampling is 0.093 m, 46656 points
    layer 3: xloc grid is 216 x 216, sampling is 0.093 m, 46656 points
    layer 4: xloc grid is 216 x 216, sampling is 0.093 m, 46656 points
    layer 5: xloc grid is 216 x 216, sampling is 0.093 m, 46656 points
    layer 6: xloc grid is 216 x 216, sampling is 0.093 m, 46656 points
    layer 7: xloc grid is 216 x 216, sampling is 0.093 m, 46656 points
    layer 8: xloc grid is 216 x 216, sampling is 0.093 m, 46656 points
    layer 9: xloc grid is 216 x 216, sampling is 0.092 m, 46656 points
    layer 10: xloc grid is 216 x 216, sampling is 0.088 m, 46656 points
    layer 11: xloc grid is 216 x 216, sampling is 0.084 m, 46656 points
    layer 12: xloc grid is 216 x 216, sampling is 0.080 m, 46656 points
    layer 13: xloc grid is 216 x 216, sampling is 0.072 m, 46656 points
Step  1268: OL  755.2  173.0  OA  115.6  22.6 CL  115.6  22.6 nm  0.065 s

[00;00mSetting up powfs 0 PO WFS[00;00m

OTF dimension is 48x48 (calculated)
Uplink FWHM (illt 0, iwvl 0) is 0.578619"
There is no bias
Downlink FWHM (illt 0, iwvl 0) is 1.36259"
Generating matched filter for powfs 0
Step  1279 updated high order loop gain: 0.270
Step  1283: OL  758.9  181.0  OA  112.1  13.9 CL  112.1  13.9 nm  0.063 s
Step  1298: OL  763.8  190.5  OA  117.0   9.0 CL  117.0   9.0 nm  0.062 s
sa index   location       noise equivalent angle
    1772: (  4.8,  -0.1) m, (163.81, 156.98) mas
    1765: (  3.8,  -0.1) m, (174.57, 158.80) mas
    1757: (  2.6,  -0.1) m, (189.91, 161.43) mas
    1750: (  1.6,  -0.1) m, (204.17, 163.91) mas
    1748: (  1.3,  -0.1) m, (208.37, 164.65) mas
    1277: ( -0.6,  -1.3) m, (237.66, 173.39) mas
    1743: ( -1.7,  -0.1) m, (254.66, 172.33) mas
    1735: ( -2.9,  -0.1) m, (274.69, 175.11) mas
    1728: ( -3.9,  -0.1) m, (293.99, 177.49) mas
    1720: ( -5.1,  -0.1) m, (318.58, 180.11) mas
    1718: ( -5.4,  -0.1) m, (324.67, 180.71) mas
sa index   location       noise equivalent angle
    3467: (  2.5,   4.3) m, (157.99, 160.64) mas
    3152: (  1.9,   3.3) m, (174.96, 184.78) mas
    2775: (  1.3,   2.3) m, (168.89, 182.82) mas
    2344: (  0.7,   1.3) m, (176.24, 196.98) mas
    2278: (  0.6,   1.2) m, (177.98, 199.11) mas
    1865: ( -1.4,   0.1) m, (205.15, 216.53) mas
    1210: ( -0.9,  -1.4) m, (199.37, 242.49) mas
     778: ( -1.4,  -2.5) m, (208.55, 261.26) mas
     669: ( -1.6,  -2.8) m, (210.80, 266.45) mas
     401: ( -2.0,  -3.5) m, (236.15, 309.03) mas
      85: ( -2.6,  -4.5) m, (228.18, 302.26) mas
sa index   location       noise equivalent angle
    3432: ( -2.6,   4.3) m, (157.99, 160.64) mas
    3125: ( -2.0,   3.3) m, (174.92, 185.21) mas
    2756: ( -1.4,   2.3) m, (168.89, 182.82) mas
    2333: ( -0.9,   1.3) m, (176.24, 196.98) mas
    2269: ( -0.7,   1.2) m, (177.98, 199.11) mas
    1868: (  1.3,   0.1) m, (205.15, 216.53) mas
    1221: (  0.7,  -1.4) m, (199.37, 242.49) mas
     797: (  1.3,  -2.5) m, (208.55, 261.26) mas
     690: (  1.4,  -2.8) m, (210.80, 266.45) mas
     428: (  1.9,  -3.5) m, (236.73, 309.03) mas
     120: (  2.5,  -4.5) m, (228.18, 302.26) mas
sa index   location       noise equivalent angle
    1721: ( -4.9,  -0.1) m, (163.81, 156.98) mas
    1728: ( -3.9,  -0.1) m, (174.57, 158.80) mas
    1736: ( -2.8,  -0.1) m, (189.91, 161.43) mas
    1743: ( -1.7,  -0.1) m, (204.17, 163.91) mas
    1745: ( -1.4,  -0.1) m, (208.37, 164.65) mas
    1284: (  0.4,  -1.3) m, (237.44, 173.03) mas
    1750: (  1.6,  -0.1) m, (254.66, 172.33) mas
    1758: (  2.8,  -0.1) m, (274.69, 175.11) mas
    1765: (  3.8,  -0.1) m, (293.99, 177.49) mas
    1773: (  4.9,  -0.1) m, (318.58, 180.11) mas
    1775: (  5.2,  -0.1) m, (324.67, 180.71) mas
sa index   location       noise equivalent angle
      85: ( -2.6,  -4.5) m, (157.99, 160.64) mas
     401: ( -2.0,  -3.5) m, (175.17, 187.15) mas
     778: ( -1.4,  -2.5) m, (168.89, 182.82) mas
    1210: ( -0.9,  -1.4) m, (176.24, 196.98) mas
    1276: ( -0.7,  -1.3) m, (177.98, 199.11) mas
    1688: (  1.3,  -0.3) m, (205.15, 216.53) mas
    2344: (  0.7,   1.3) m, (199.37, 242.49) mas
    2775: (  1.3,   2.3) m, (208.55, 261.26) mas
    2884: (  1.4,   2.6) m, (210.80, 266.45) mas
    3152: (  1.9,   3.3) m, (236.02, 306.17) mas
    3467: (  2.5,   4.3) m, (228.18, 302.26) mas
sa index   location       noise equivalent angle
     120: (  2.5,  -4.5) m, (157.99, 160.64) mas
     428: (  1.9,  -3.5) m, (175.67, 186.97) mas
     797: (  1.3,  -2.5) m, (168.89, 182.82) mas
    1221: (  0.7,  -1.4) m, (176.24, 196.98) mas
    1285: (  0.6,  -1.3) m, (177.98, 199.11) mas
    1685: ( -1.4,  -0.3) m, (205.15, 216.53) mas
    2333: ( -0.9,   1.3) m, (199.37, 242.49) mas
    2756: ( -1.4,   2.3) m, (208.55, 261.26) mas
    2863: ( -1.6,   2.6) m, (210.80, 266.45) mas
    3125: ( -2.0,   3.3) m, (236.08, 306.78) mas
    3432: ( -2.6,   4.3) m, (228.18, 302.26) mas

[00;00mSetting up powfs 2 PO WFS[00;00m

OTF dimension is 48x48 (calculated)
Generating matched filter for powfs 2
Use sanea to derive neasim
Use sanea to derive neasim

[00;00mSetting up reconstructor[00;00m

Recon NEA: cmf(212.83) cmf(214.09) cmf(213.90) cmf(212.50) cmf(213.83) cmf(214.02) geom(0.31) geom(0.31) geom(0.31) mf(0.14)  mas
Setup or update control matrix parameters.
RRtwfs svd threshold is 1e-10
Step  1314: OL  768.6  202.1  OA  116.3  13.4 CL  116.3  13.4 nm  0.070 s
Step  1330: OL  773.4  215.4  OA  116.4  10.2 CL  116.4  10.2 nm  0.063 s
Step  1343: OL  778.7  227.1  OA  114.6   6.6 CL  114.6   6.6 nm  0.064 s
Step  1359: OL  787.4  241.4  OA  114.5   2.7 CL  114.5   2.7 nm  0.065 s
Step  1374: OL  797.3  252.7  OA  113.3   6.8 CL  113.3   6.8 nm  0.065 s
Step  1390: OL  809.2  261.9  OA  115.6   8.4 CL  115.6   8.4 nm  0.069 s
Step  1405: OL  822.3  268.3  OA  115.3   9.0 CL  115.3   9.0 nm  0.065 s
Step  1421: OL  837.6  272.9  OA  119.4  11.1 CL  119.4  11.1 nm  0.066 s
Step  1437: OL  853.2  276.4  OA  119.6   5.5 CL  119.6   5.5 nm  0.068 s
Step  1453: OL  868.0  278.9  OA  117.3  14.4 CL  117.3  14.4 nm  0.064 s
Step  1469: OL  880.7  279.5  OA  115.5   1.7 CL  115.5   1.7 nm  0.073 s
Step  1484: OL  888.7  277.5  OA  114.4  17.1 CL  114.4  17.1 nm  0.063 s
Step  1499: OL  892.0  273.3  OA  113.4  10.9 CL  113.4  10.9 nm  0.066 s
Step  1515: OL  891.2  266.5  OA  109.5   5.6 CL  109.5   5.6 nm  0.068 s
Step  1531: OL  887.1  258.1  OA  113.5  18.6 CL  113.5  18.6 nm  0.063 s
Step  1535 updated high order loop gain: 0.265
Step  1546: OL  880.5  248.6  OA  109.9  10.9 CL  109.9  10.9 nm  0.062 s
Step  1561: OL  872.9  238.7  OA  114.0   7.6 CL  114.0   7.6 nm  0.070 s
Step  1577: OL  864.5  229.2  OA  120.0  16.7 CL  120.0  16.7 nm  0.064 s
Step  1592: OL  855.5  222.2  OA  120.4   8.0 CL  120.4   8.0 nm  0.074 s
Step 1599: Output PSF
Step  1599: OL  851.0  219.4  OA  117.7  11.0 CL  117.7  11.0 nm 14.476 s
Mean: 119.29 20.65 117.49  nm.

*** Simulation Finished at 2025/02/12 00:37:12 in nid008236. ***

[00;00m>>>>>>>>>>>>>>>>[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid008236/scheduler) failed: Invalid argument. 
/global/u2/b/bpeck/work/vismcao/maos -o studies/reduced_ngs/7_lgs/8mag_lgs/4250count -c master_files/reduced_ngs/7_lgs/8mag_lgs/kola_4250act.conf -O 
Output folder is 'studies/reduced_ngs/7_lgs/8mag_lgs/4250count'.
SRC: /global/homes/b/bpeck/code/maos v2.9 4c88b7c2 2024-11-13 16:45:33 -0800
BUILT: /global/homes/b/bpeck/code/maos/optim by GCC (v12) on 2024/11/18 09:40:03 CPU(F64,+O3) with CUDA(v122,F32)
Launched at 2025/02/12 00:37:13 in nid008236 with PID 41675.
The web based job monitor can be accessed at http://localhost:10300
Main config file is /global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/7_lgs/8mag_lgs/kola_4250act.conf
[00;00m[0;36mWarning(path.c:48): Path not found: path=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/7_lgs/8mag_lgs/bin; abspath=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/7_lgs/8mag_lgs/bin; Ignored.
[00;00m[0;36mWarning(path.c:48): Path not found: path=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/7_lgs/8mag_lgs/atm; abspath=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/7_lgs/8mag_lgs/atm; Ignored.
[00;00m[0;36mWarning(readcfg.c:399): sim.apfsm has been renamed to powfs.apfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.epfsm has been renamed to powfs.epfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.alfsm has been renamed to powfs.alfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.commonfsm has been renamed to powfs.commonfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.idealfsm has been renamed to powfs.idealfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.zetafsm has been renamed to powfs.zetafsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.f0fsm has been renamed to powfs.f0fsm.
[00;00m[0;36mWarning(readcfg.c:399): tsurf has been renamed to ncpa.tsurf.
loaded 132 (132 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_sim.conf'
loaded  19 ( 19 new) records from '/global/u2/b/bpeck/work/vismcao/./dm_none.conf'
loaded  19 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_ASM.conf'
loaded  19 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_DM2.conf'
loaded  19 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_DM3.conf'
loaded   0 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_dm_multiple.conf'
loaded   7 (  5 new) records from '/global/u2/b/bpeck/work/vismcao/./atm_mk13n50p_ground_detail.conf'
loaded  76 ( 69 new) records from '/global/homes/b/bpeck/code/maos/config/maos/powfs_common.conf'
loaded  44 ( 38 new) records from '/global/u2/b/bpeck/work/vismcao/./powfs_none.conf'
loaded  44 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_shwfs_lgs.conf'
loaded  44 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_shwfs_ttf_strap.conf'
loaded  44 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_shwfs_twfs_lbwfs.conf'
loaded   0 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_wfs_lgs_strap_lbwfs.conf'
loaded  71 ( 71 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_recon.conf'
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_smooth has been renamed to powfs0_llt.na_smooth.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_interp has been renamed to powfs0_llt.na_interp.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_thres has been renamed to powfs0_llt.na_thres.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_maxit has been renamed to powfs0_llt.na_fit_maxit.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_svdthres has been renamed to powfs0_llt.na_fit_svdthres.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_dh has been renamed to powfs0_llt.na_fit_dh.
[00;00m[0;36mWarning(readcfg.c:399): dbg.ncpa_preload has been renamed to ncpa.preload.
[00;00m[0;36mWarning(readcfg.c:399): dbg.ncpa_rmsci has been renamed to ncpa.rmsci.
[00;00m[0;36mWarning(readcfg.c:399): dbg.draw_opdmax has been renamed to plot.opdmax.
[00;00m[0;36mWarning(readcfg.c:399): dbg.draw_gmax has been renamed to plot.gmax.
loaded  95 ( 93 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_dbg.conf'
loaded   4 (  4 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_fit_mcao.conf'
[00;00m[0;36mWarning(readcfg.c:399): surf has been renamed to ncpa.surf.
loaded  39 (  7 new) records from '/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/7_lgs/8mag_lgs/kola_4250act.conf'
loaded   0 (  0 new) records from 'command line'
loaded  24 ( 18 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_llt_CL.conf'
Adjust LGS range by telescope altitude 4145m.
Zenith angle is 30 degree.
    Scaling turbulence height and LGS hs by sec(za).
    Scaling r0 by cos(za)^(3/5).
    Scaling wind speed and LGS signal level by cos(za).
powfs0: Adjusting dx from 0.0078125 to 0.0075. 
powfs0.llt.fsm: f0=0 Hz, LPF ep=0
powfs0.epfsm is set to 0.517618 (auto)
powfs2: Adjusting dx from 0.03125 to 0.0312778. 
powfs2 is TWFS for powfs0
sim.ephi is set to 0.427717 (auto)
sim.eplo is set to 0.427717 (auto)
[00;00m[0;36mWarning(parms.c:2296): Layer 1 at 17.3205m is very close to layer 0 at 0m (OK).
[00;00m[0;36mWarning(parms.c:2296): Layer 2 at 34.641m is very close to layer 1 at 17.3205m (OK).
[00;00m[0;36mWarning(parms.c:2296): Layer 3 at 51.9615m is very close to layer 2 at 34.641m (OK).
dm 0: stroke=30 um is provided in micron.
dm 0: assume ia stroke=2 um is provided in micron.
dm 1: stroke=7 um is provided in micron.
dm 1: assume ia stroke=2 um is provided in micron.
dm 2: stroke=7 um is provided in micron.
dm 2: assume ia stroke=2 um is provided in micron.
Focus blending is not implemented yet for integrated tomography
parms->sim.mffocus is reset to 0
There are 1 valid simulation seeds:  1
Output PSF for 1 directions
Used 449 of 456 supplied keys
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_flate" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_flatv" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_psx" is not recognized, value is [0 0 0 0]
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_psy" is not recognized, value is [0 0 0 0]
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_pupelong" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_raw" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_side" is not recognized, value is 4
[00;00mAperture[00;00m is 11 m with sampling 1/128 m
[00;00mTurbulence at 30 degree zenith angle:[00;00m r0=0.128424m, L0=30m, 14 layers.
    Greenwood freq is 25.1Hz, anisoplanatic angle is 1.58 as
    Sampled 8192x8192 at 1/128m. wind dir is randomized.
    layer 0: ht=      0 m, wt= 0.302, ws=  4.8 m/s
    layer 1: ht=     17 m, wt= 0.154, ws=  5.0 m/s
    layer 2: ht=     35 m, wt= 0.041, ws=  5.4 m/s
    layer 3: ht=     52 m, wt= 0.002, ws=  6.6 m/s
    layer 4: ht=    139 m, wt= 0.021, ws=  6.1 m/s
    layer 5: ht=    231 m, wt= 0.010, ws=  6.1 m/s
    layer 6: ht=    323 m, wt= 0.008, ws=  6.1 m/s
    layer 7: ht=    416 m, wt= 0.005, ws=  6.1 m/s
    layer 8: ht=    508 m, wt= 0.001, ws=  6.1 m/s
    layer 9: ht=    932 m, wt= 0.107, ws=  5.6 m/s
    layer 10: ht=   5022 m, wt= 0.144, ws= 11.1 m/s
    layer 11: ht=   9238 m, wt= 0.093, ws= 19.1 m/s
    layer 12: ht=  13856 m, wt= 0.075, ws=  8.2 m/s
    layer 13: ht=  22518 m, wt= 0.036, ws=  4.8 m/s
[00;00mReconstruction[00;00m: r0=0.128424m L0=30m. 14 layers. use cone coordinate.
    layer 0: ht=      0 m, wt= 0.302
    layer 1: ht=     17 m, wt= 0.154
    layer 2: ht=     35 m, wt= 0.041
    layer 3: ht=     52 m, wt= 0.002
    layer 4: ht=    139 m, wt= 0.021
    layer 5: ht=    231 m, wt= 0.010
    layer 6: ht=    323 m, wt= 0.008
    layer 7: ht=    416 m, wt= 0.005
    layer 8: ht=    508 m, wt= 0.001
    layer 9: ht=    932 m, wt= 0.107
    layer 10: ht=   5022 m, wt= 0.144
    layer 11: ht=   9238 m, wt= 0.093
    layer 12: ht=  13856 m, wt= 0.075
    layer 13: ht=  22518 m, wt= 0.036
[00;00mThere are 3 powfs[00;00m
  powfs0: Order 74, LGS at 99.1 km. Sampling 1/133.333 m. Thres 30%. [00;00mT/T is removed in right hand side in tomography.[00;00m
    CCD image is 25x25 @ 500x500 mas, blur 27% (sigma), 1500Hz, wvl: [ 5.89e-07]
    Gtilt in reconstruction. Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
  powfs1: Order  2, NGS at inf km. Sampling 1/16 m. Thres 30%. 
    Ztilt in reconstruction. Geomtric optics start at 2 with ztilt [00;00m(noisy)[00;00m
  powfs2: Order 20, NGS at inf km. Sampling 1/31.9716 m. Thres 50%. 
    CCD image is 4x4 @ 1500x1500 mas, blur 0% (sigma), 0.015Hz, wvl: [ 7.2e-07]
    Gtilt in reconstruction. Geomtric optics start at 50 with gtilt Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
[00;00mThere are 11 wfs[00;00m
    wfs 0: type 0, at (  30.00,    0.00) arcsec,  99 km, siglev is 26.9784 bkgrnd is 0.1
    wfs 1: type 0, at (  18.70,   23.45) arcsec,  99 km, siglev is 26.9784 bkgrnd is 0.1
    wfs 2: type 0, at (  -6.68,   29.25) arcsec,  99 km, siglev is 26.9784 bkgrnd is 0.1
    wfs 3: type 0, at ( -27.03,   13.02) arcsec,  99 km, siglev is 26.9784 bkgrnd is 0.1
    wfs 4: type 0, at ( -27.03,  -13.02) arcsec,  99 km, siglev is 26.9784 bkgrnd is 0.1
    wfs 5: type 0, at (  -6.68,  -29.25) arcsec,  99 km, siglev is 26.9784 bkgrnd is 0.1
    wfs 6: type 0, at (  18.70,  -23.45) arcsec,  99 km, siglev is 26.9784 bkgrnd is 0.1
    wfs 7: type 1, at (   5.00,    8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 8: type 1, at ( -10.00,    0.00) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 9: type 1, at (   5.00,   -8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 10: type 2, at (   0.00,    0.00) arcsec, inf km, siglev is 4.1558e+06 bkgrnd is 0.001
[00;00mThere are 3 DMs[00;00m
  DM 0 at -0.1km, actuator pitch 0.15m, offset   0, with 30.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 1 at    6km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 2 at   10km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
[00;00mTomography[00;00m is using CG, with [00;00mFourer Domain[00;00m preconditioner, [00;00m12[00;00m iterations, integrated tomo.
[00;00mDM Fitting [00;00mis using CG, with [00;00mNo[00;00m preconditioner, [00;00m10[00;00m iterations
[00;00mThere are 9 fit directions[00;00m
    Fit 0: weight is 0.444, at (   0.00,    0.00) arcsec
    Fit 1: weight is 0.111, at (  15.00,    0.00) arcsec
    Fit 2: weight is 0.111, at (   0.00,   15.00) arcsec
    Fit 3: weight is 0.111, at ( -15.00,    0.00) arcsec
    Fit 4: weight is 0.111, at (   0.00,  -15.00) arcsec
    Fit 5: weight is 0.028, at (  15.00,   15.00) arcsec
    Fit 6: weight is 0.028, at ( -15.00,   15.00) arcsec
    Fit 7: weight is 0.028, at ( -15.00,  -15.00) arcsec
    Fit 8: weight is 0.028, at (  15.00,  -15.00) arcsec
[00;00mThere are 1 evaluation directions[00;00m at sampling 1/128 m.
    Evl 0: weight is 1.000, at (   0.00,    0.00) arcsec
[00;00mSimulation[00;00m start at step 0, end at step 1600, with time step 1/1500s, [00;00mclose loop[00;00m.
After setup_parms:	120.5 MiB.
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid008236/scheduler) failed: Invalid argument. 
CUDA: minimum memory requirement is 0.3GB
GPU 0 is NVIDIA A100-SXM4-80GB with arch 8.0, 78.6GB free, 79.0GB total device memory.
Using GPU 0
Use 1 GPUs for WFS Tomo Fit Evl

*** Preparation started at 2025/02/12 00:37:15 in nid008236. ***

Using OpenMP version 201511 with 128 threads
Reading aperture amplitude map from KECK.fits
[00;00m[0;36mWarning(accphi.c:477): 108487 points not covered by input screen
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid008236/scheduler) failed: Invalid argument. 
Uplink FWHM (illt 0, iwvl 0) is 0.578423"
 ->maos.c:447->setup.c:148->aper.c:74->utils.c:478->accphi.c:478
Downlink FWHM (illt 0, iwvl 0) is 1.19849"
iwvl 0: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 1: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 2: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 3: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 4: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 5: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 6: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 7: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 8: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
After setup_aper:	344.8 MiB.

[00;00mSetting up powfs 0 geom[00;00m

There are 20 points in each subaperture of 0.15m.
There are 3300 valid subaperture.

[00;00mSetting up powfs 1 geom[00;00m

There are 88 points in each subaperture of 5.5m.
There are 4 valid subaperture.

[00;00mSetting up powfs 2 geom[00;00m

There are 18 points in each subaperture of 0.563m.
There are 236 valid subaperture.
After setup_powfs_init:	447.0 MiB.

[00;00mSetting up reconstructor geometry.[00;00m

PLOC is 151x151, with sampling of 0.07m (square)
    DM 0: grid is 77 x 77
    DM 1: grid is 75 x 75
    DM 2: grid is 80 x 79
FLOC is 151x151, with sampling of 0.07m (not square)
Generating matched filter for powfs 0
Tomography grid is square:
    layer 0: xloc grid is 280 x 280, sampling is 0.075 m, 78400 points
    layer 1: xloc grid is 280 x 280, sampling is 0.075 m, 78400 points
    layer 2: xloc grid is 280 x 280, sampling is 0.075 m, 78400 points
    layer 3: xloc grid is 280 x 280, sampling is 0.075 m, 78400 points
    layer 4: xloc grid is 280 x 280, sampling is 0.075 m, 78400 points
    layer 5: xloc grid is 280 x 280, sampling is 0.075 m, 78400 points
    layer 6: xloc grid is 280 x 280, sampling is 0.075 m, 78400 points
    layer 7: xloc grid is 280 x 280, sampling is 0.075 m, 78400 points
    layer 8: xloc grid is 280 x 280, sampling is 0.075 m, 78400 points
    layer 9: xloc grid is 280 x 280, sampling is 0.074 m, 78400 points
    layer 10: xloc grid is 280 x 280, sampling is 0.071 m, 78400 points
    layer 11: xloc grid is 280 x 280, sampling is 0.068 m, 78400 points
    layer 12: xloc grid is 280 x 280, sampling is 0.065 m, 78400 points
    layer 13: xloc grid is 280 x 280, sampling is 0.058 m, 78400 points

[00;00mSetting up powfs 0 PO WFS[00;00m

OTF dimension is 40x40 (calculated)
There is no bias
sa index   location       noise equivalent angle
    1076: (  4.8,  -0.2) m, (107.20, 104.30) mas
    1070: (  3.7,  -0.2) m, (114.51, 105.49) mas
    1064: (  2.6,  -0.2) m, (126.83, 106.72) mas
    1058: (  1.5,  -0.2) m, (143.37, 107.77) mas
    1057: (  1.3,  -0.2) m, (145.72, 107.91) mas
     732: ( -0.6,  -1.5) m, (169.35, 112.11) mas
    1053: ( -1.7,  -0.2) m, (179.95, 110.22) mas
    1047: ( -2.8,  -0.2) m, (194.46, 111.10) mas
    1041: ( -3.9,  -0.2) m, (211.28, 111.98) mas
    1035: ( -5.0,  -0.2) m, (228.27, 112.89) mas
    1033: ( -5.4,  -0.2) m, (233.50, 113.17) mas
sa index   location       noise equivalent angle
    1854: (  3.7,   3.0) m, (107.65, 105.96) mas
    1726: (  3.3,   2.4) m, (109.34, 107.39) mas
    1591: (  2.6,   1.9) m, (117.38, 112.66) mas
    1335: (  1.3,   0.9) m, (129.56, 118.92) mas
    1289: (  1.1,   0.7) m, (132.39, 121.09) mas
    1287: ( -1.1,   0.7) m, (170.14, 127.96) mas
     826: ( -1.5,  -1.1) m, (164.41, 141.85) mas
     673: ( -2.2,  -1.7) m, (172.75, 148.66) mas
     571: ( -2.8,  -2.0) m, (181.74, 154.88) mas
     436: ( -3.5,  -2.6) m, (188.80, 159.94) mas
      60: ( -3.0,  -4.5) m, (181.20, 181.91) mas
sa index   location       noise equivalent angle
    2130: (  1.9,   4.5) m, (104.31, 107.34) mas
    1956: (  1.1,   3.5) m, (106.39, 113.66) mas
    1712: (  0.7,   2.4) m, (114.11, 133.17) mas
    1580: (  0.6,   1.9) m, (110.02, 133.39) mas
    1430: (  0.4,   1.3) m, (111.18, 141.56) mas
     873: (  0.9,  -0.9) m, (116.37, 176.21) mas
     732: ( -0.6,  -1.5) m, (118.50, 177.74) mas
     582: ( -0.7,  -2.0) m, (120.18, 184.07) mas
     323: ( -1.1,  -3.2) m, (124.18, 199.91) mas
     102: ( -1.5,  -4.3) m, (128.35, 216.84) mas
       8: ( -2.2,  -4.8) m, (141.49, 231.87) mas
sa index   location       noise equivalent angle
    2109: ( -2.0,   4.5) m, (104.31, 107.34) mas
    1943: ( -1.3,   3.5) m, (106.39, 113.66) mas
    1703: ( -0.9,   2.4) m, (116.48, 133.53) mas
    1573: ( -0.7,   1.9) m, (110.02, 133.39) mas
    1425: ( -0.6,   1.3) m, (111.18, 141.56) mas
     872: ( -1.1,  -0.9) m, (118.81, 179.54) mas
     737: (  0.4,  -1.5) m, (118.50, 177.74) mas
     589: (  0.6,  -2.0) m, (120.18, 184.07) mas
     334: (  0.9,  -3.2) m, (124.18, 199.91) mas
     117: (  1.3,  -4.3) m, (128.35, 216.84) mas
      21: (  2.0,  -4.8) m, (139.99, 229.62) mas
sa index   location       noise equivalent angle
    1813: ( -3.9,   3.0) m, (106.81, 105.06) mas
    1689: ( -3.5,   2.4) m, (109.34, 107.39) mas
    1562: ( -2.8,   1.9) m, (116.81, 112.27) mas
    1326: ( -1.5,   0.9) m, (129.56, 118.92) mas
    1286: ( -1.3,   0.7) m, (131.94, 120.68) mas
    1288: (  0.9,   0.7) m, (167.50, 125.82) mas
     834: (  1.3,  -1.1) m, (164.41, 141.85) mas
     696: (  2.0,  -1.7) m, (172.75, 148.66) mas
     600: (  2.6,  -2.0) m, (182.43, 155.42) mas
     473: (  3.3,  -2.6) m, (188.80, 159.94) mas
      91: (  2.8,  -4.5) m, (181.20, 181.91) mas
sa index   location       noise equivalent angle
    1035: ( -5.0,  -0.2) m, (107.20, 104.30) mas
    1041: ( -3.9,  -0.2) m, (114.51, 105.49) mas
    1047: ( -2.8,  -0.2) m, (126.83, 106.72) mas
    1053: ( -1.7,  -0.2) m, (143.37, 107.77) mas
    1054: ( -1.5,  -0.2) m, (145.72, 107.91) mas
     737: (  0.4,  -1.5) m, (169.35, 112.11) mas
    1058: (  1.5,  -0.2) m, (179.95, 110.22) mas
    1064: (  2.6,  -0.2) m, (194.46, 111.10) mas
    1070: (  3.7,  -0.2) m, (211.28, 111.98) mas
    1076: (  4.8,  -0.2) m, (228.27, 112.89) mas
    1078: (  5.2,  -0.2) m, (233.50, 113.17) mas
sa index   location       noise equivalent angle
     308: ( -3.9,  -3.2) m, (106.79, 105.04) mas
     436: ( -3.5,  -2.6) m, (109.34, 107.39) mas
     571: ( -2.8,  -2.0) m, (116.09, 111.93) mas
     826: ( -1.5,  -1.1) m, (129.56, 118.92) mas
     871: ( -1.3,  -0.9) m, (132.67, 121.41) mas
     873: (  0.9,  -0.9) m, (169.66, 127.58) mas
    1335: (  1.3,   0.9) m, (164.41, 141.85) mas
    1489: (  2.0,   1.5) m, (172.75, 148.66) mas
    1591: (  2.6,   1.9) m, (183.61, 156.33) mas
    1726: (  3.3,   2.4) m, (188.80, 159.94) mas
    2101: (  2.8,   4.3) m, (181.20, 181.91) mas
sa index   location       noise equivalent angle
      31: ( -2.0,  -4.7) m, (104.31, 107.34) mas
     205: ( -1.3,  -3.7) m, (106.39, 113.66) mas
     450: ( -0.9,  -2.6) m, (116.48, 133.53) mas
     582: ( -0.7,  -2.0) m, (110.02, 133.39) mas
     732: ( -0.6,  -1.5) m, (111.18, 141.56) mas
    1287: ( -1.1,   0.7) m, (116.71, 176.61) mas
    1430: (  0.4,   1.3) m, (118.50, 177.74) mas
    1580: (  0.6,   1.9) m, (120.18, 184.07) mas
    1839: (  0.9,   3.0) m, (124.18, 199.91) mas
    2059: (  1.3,   4.1) m, (128.35, 216.84) mas
    2152: (  2.0,   4.7) m, (142.93, 233.96) mas
sa index   location       noise equivalent angle
      52: (  1.9,  -4.7) m, (104.31, 107.34) mas
     218: (  1.1,  -3.7) m, (106.39, 113.66) mas
     459: (  0.7,  -2.6) m, (114.11, 133.17) mas
     589: (  0.6,  -2.0) m, (110.02, 133.39) mas
     737: (  0.4,  -1.5) m, (111.18, 141.56) mas
    1288: (  0.9,   0.7) m, (114.77, 173.98) mas
    1425: ( -0.6,   1.3) m, (118.50, 177.74) mas
    1573: ( -0.7,   1.9) m, (120.18, 184.07) mas
    1828: ( -1.1,   3.0) m, (124.18, 199.91) mas
    2044: ( -1.5,   4.1) m, (128.35, 216.84) mas
    2140: ( -2.2,   4.7) m, (144.98, 237.01) mas
sa index   location       noise equivalent angle
     349: (  3.7,  -3.2) m, (107.52, 105.83) mas
     473: (  3.3,  -2.6) m, (109.34, 107.39) mas
     600: (  2.6,  -2.0) m, (116.58, 112.21) mas
     834: (  1.3,  -1.1) m, (129.56, 118.92) mas
     874: (  1.1,  -0.9) m, (133.50, 122.14) mas
     872: ( -1.1,  -0.9) m, (172.99, 130.28) mas
    1326: ( -1.5,   0.9) m, (164.41, 141.85) mas
    1466: ( -2.2,   1.5) m, (172.75, 148.66) mas
    1562: ( -2.8,   1.9) m, (182.87, 155.64) mas
    1689: ( -3.5,   2.4) m, (188.80, 159.94) mas
    2070: ( -3.0,   4.3) m, (181.20, 181.91) mas

[00;00mSetting up powfs 2 PO WFS[00;00m

OTF dimension is 48x48 (calculated)
Generating matched filter for powfs 2
Use sanea to derive neasim
Use sanea to derive neasim

[00;00mSetting up reconstructor[00;00m

Recon NEA: cmf(146.64) cmf(146.91) cmf(146.58) cmf(146.55) cmf(146.83) cmf(146.56) cmf(146.78) cmf(146.45) cmf(146.48) cmf(146.84) geom(0.31) geom(0.31) geom(0.31) mf(0.14)  mas
Setup or update control matrix parameters.
RRtwfs svd threshold is 1e-10
Uplink FWHM (illt 0, iwvl 0) is 0.580135"
Downlink FWHM (illt 0, iwvl 0) is 1.07529"
Generating matched filter for powfs 0
sa index   location       noise equivalent angle
     392: (  4.9,  -0.3) m, ( 57.13,  55.63) mas
     388: (  3.7,  -0.3) m, ( 61.18,  56.13) mas
     385: (  2.8,  -0.3) m, ( 65.41,  56.54) mas
     381: (  1.5,  -0.3) m, ( 72.76,  57.07) mas
     380: (  1.2,  -0.3) m, ( 74.62,  57.19) mas
     269: ( -0.6,  -1.5) m, ( 86.28,  59.01) mas
     378: ( -1.8,  -0.3) m, ( 93.80,  58.20) mas
     375: ( -2.8,  -0.3) m, ( 99.93,  58.50) mas
     371: ( -4.0,  -0.3) m, (108.66,  58.88) mas
     368: ( -4.9,  -0.3) m, (115.35,  59.15) mas
     367: ( -5.2,  -0.3) m, (117.66,  59.24) mas
sa index   location       noise equivalent angle
     666: (  3.4,   2.8) m, ( 57.38,  56.93) mas
     583: (  2.2,   1.8) m, ( 61.73,  59.87) mas
     522: (  1.5,   1.2) m, ( 65.50,  64.20) mas
     490: (  0.9,   0.9) m, ( 67.95,  63.84) mas
     515: ( -0.6,   1.2) m, ( 77.13,  62.76) mas
     297: ( -1.2,  -1.2) m, ( 80.31,  75.18) mas
     265: ( -1.8,  -1.5) m, ( 86.86,  79.45) mas
     204: ( -2.5,  -2.2) m, ( 87.71,  80.43) mas
     121: ( -3.7,  -3.1) m, ( 95.36,  85.84) mas
      12: ( -3.1,  -4.6) m, ( 93.75,  98.79) mas
sa index   location       noise equivalent angle
     782: (  0.6,   4.6) m, ( 57.48,  59.49) mas
     767: (  0.6,   4.3) m, ( 55.88,  58.47) mas
     630: (  0.3,   2.5) m, ( 56.92,  66.58) mas
     604: (  0.3,   2.2) m, ( 57.05,  68.19) mas
     517: (  0.0,   1.2) m, ( 58.27,  74.65) mas
     379: ( -1.5,  -0.3) m, ( 62.49,  84.55) mas
     270: ( -0.3,  -1.5) m, ( 61.65,  95.16) mas
     157: ( -0.6,  -2.8) m, ( 59.90,  99.51) mas
     131: ( -0.6,  -3.1) m, ( 59.97, 101.57) mas
      19: ( -0.9,  -4.6) m, ( 61.04, 112.90) mas
       1: ( -2.5,  -4.9) m, ( 68.53, 118.71) mas
sa index   location       noise equivalent angle
     756: ( -2.8,   4.3) m, ( 55.90,  56.68) mas
     697: ( -2.2,   3.4) m, ( 57.53,  59.50) mas
     649: ( -1.8,   2.8) m, ( 58.11,  61.71) mas
     514: ( -0.9,   1.2) m, ( 61.45,  69.82) mas
     515: ( -0.6,   1.2) m, ( 62.63,  69.83) mas
     436: (  1.2,   0.3) m, ( 71.85,  75.14) mas
     273: (  0.6,  -1.5) m, ( 68.58,  86.77) mas
     189: (  1.2,  -2.5) m, ( 71.83,  92.45) mas
     138: (  1.5,  -3.1) m, ( 73.50,  96.35) mas
      89: (  1.8,  -3.7) m, ( 75.81, 101.15) mas
      30: (  2.5,  -4.6) m, ( 78.56, 106.61) mas
sa index   location       noise equivalent angle
     504: ( -4.0,   1.2) m, ( 59.68,  56.49) mas
     481: ( -3.1,   0.9) m, ( 63.69,  57.37) mas
     459: ( -2.2,   0.6) m, ( 70.08,  59.44) mas
     435: ( -1.5,   0.3) m, ( 72.45,  59.25) mas
     270: ( -0.3,  -1.5) m, ( 83.50,  69.10) mas
     352: (  1.2,  -0.6) m, ( 90.00,  62.72) mas
     328: (  1.8,  -0.9) m, ( 95.94,  65.46) mas
     306: (  2.8,  -1.2) m, (100.06,  65.45) mas
     283: (  3.7,  -1.5) m, (106.44,  66.93) mas
sa index   location       noise equivalent angle
     258: ( -4.0,  -1.5) m, ( 59.68,  56.49) mas
     291: ( -3.1,  -1.2) m, ( 63.69,  57.37) mas
     321: ( -2.2,  -0.9) m, ( 70.20,  59.60) mas
     351: ( -1.5,  -0.6) m, ( 72.45,  59.25) mas
     516: ( -0.3,   1.2) m, ( 82.69,  68.50) mas
     436: (  1.2,   0.3) m, ( 90.00,  62.72) mas
     466: (  1.8,   0.6) m, ( 95.76,  65.28) mas
     496: (  2.8,   0.9) m, (100.06,  65.45) mas
     529: (  3.7,   1.2) m, (106.44,  66.93) mas
sa index   location       noise equivalent angle
      13: ( -2.8,  -4.6) m, ( 55.90,  56.68) mas
      76: ( -2.2,  -3.7) m, ( 57.63,  59.61) mas
     127: ( -1.8,  -3.1) m, ( 58.11,  61.71) mas
     268: ( -0.9,  -1.5) m, ( 61.45,  69.82) mas
     269: ( -0.6,  -1.5) m, ( 62.63,  69.83) mas
     352: (  1.2,  -0.6) m, ( 71.85,  75.14) mas
     519: (  0.6,   1.2) m, ( 68.58,  86.77) mas
     607: (  1.2,   2.2) m, ( 71.83,  92.45) mas
     660: (  1.5,   2.8) m, ( 73.50,  96.35) mas
     710: (  1.8,   3.4) m, ( 75.66, 100.89) mas
     773: (  2.5,   4.3) m, ( 78.56, 106.61) mas
sa index   location       noise equivalent angle
       7: (  0.6,  -4.9) m, ( 56.79,  58.76) mas
      24: (  0.6,  -4.6) m, ( 55.88,  58.47) mas
     160: (  0.3,  -2.8) m, ( 56.92,  66.58) mas
     186: (  0.3,  -2.5) m, ( 57.08,  68.23) mas
     271: (  0.0,  -1.5) m, ( 58.80,  75.28) mas
     407: ( -1.5,   0.0) m, ( 62.45,  84.49) mas
     516: ( -0.3,   1.2) m, ( 61.07,  94.36) mas
     627: ( -0.6,   2.5) m, ( 59.90,  99.51) mas
     653: ( -0.6,   2.8) m, ( 59.97, 101.57) mas
     762: ( -0.9,   4.3) m, ( 61.04, 112.90) mas
     776: ( -2.5,   4.6) m, ( 69.50, 120.27) mas
sa index   location       noise equivalent angle
     144: (  3.4,  -3.1) m, ( 57.38,  56.93) mas
     219: (  2.2,  -2.2) m, ( 61.71,  59.86) mas
     276: (  1.5,  -1.5) m, ( 65.50,  64.20) mas
     300: (  0.9,  -1.2) m, ( 67.95,  63.84) mas
     269: ( -0.6,  -1.5) m, ( 77.13,  62.76) mas
     487: ( -1.2,   0.9) m, ( 80.31,  75.18) mas
     511: ( -1.8,   1.2) m, ( 86.86,  79.45) mas
     568: ( -2.5,   1.8) m, ( 87.77,  80.47) mas
     643: ( -3.7,   2.8) m, ( 95.36,  85.84) mas
     755: ( -3.1,   4.3) m, ( 94.71,  99.84) mas

[00;00mSetting up powfs 2 PO WFS[00;00m

OTF dimension is 48x48 (calculated)
Generating matched filter for powfs 2
Use sanea to derive neasim
Use sanea to derive neasim

[00;00mSetting up reconstructor[00;00m

Recon NEA: cmf(75.71) cmf(75.76) cmf(75.58) cmf(75.76) cmf(75.66) cmf(75.63) cmf(75.69) cmf(75.49) cmf(75.70) geom(0.31) geom(0.31) geom(0.31) mf(0.14)  mas
Setup or update control matrix parameters.
RRtwfs svd threshold is 1e-10
Replacing HA by HA*fit->actextrap
Adding piston cr to fit matrix
Adding TT cr on upper DMs to fit matrix.
Before assembling fit matrix:	3809.2 MiB.
Building fit->FR
Building fit->FL
Adding tikhonov constraint of 1.0e-07 to FLM
The maximum eigen value is estimated to be around 3.6e-04
DM Fit number of Low rank terms: 16 in LHS
After assemble fit matrix:	4379.7 MiB.
After setup_recon:	4379.7 MiB.
Replacing HA by HA*fit->actextrap
Adding piston cr to fit matrix
Adding TT cr on upper DMs to fit matrix.
Before assembling fit matrix:	4399.4 MiB.
Building fit->FR
GPU 0: mem used 1898 MB (wfs init)
GPU 0: mem used 2274 MB (recon init)
GPU 0: mem used 2304 MB (perf init)
Building fit->FL
Adding tikhonov constraint of 1.0e-07 to FLM
The maximum eigen value is estimated to be around 2.7e-04
DM Fit number of Low rank terms: 16 in LHS
After assemble fit matrix:	6340.8 MiB.
After setup_recon:	6340.8 MiB.
Uplink FWHM (illt 0, iwvl 0) is 0.576822"
Downlink FWHM (illt 0, iwvl 0) is 1.3294"
GPU 0: mem used 1386 MB (wfs init)
Generating matched filter for powfs 0
GPU 0: mem used 2598 MB (recon init)
sa index   location       noise equivalent angle
    1648: (  4.8,  -0.1) m, (153.28, 147.67) mas
    1641: (  3.8,  -0.1) m, (162.88, 149.46) mas
    1634: (  2.7,  -0.1) m, (174.68, 151.70) mas
    1626: (  1.5,  -0.1) m, (189.26, 154.46) mas
    1625: (  1.3,  -0.1) m, (191.02, 154.79) mas
    1171: ( -0.6,  -1.3) m, (220.27, 162.54) mas
    1620: ( -1.8,  -0.1) m, (238.63, 162.08) mas
    1613: ( -2.9,  -0.1) m, (258.46, 164.30) mas
    1606: ( -3.9,  -0.1) m, (282.69, 166.46) mas
    1598: ( -5.1,  -0.1) m, (316.04, 168.77) mas
    1596: ( -5.4,  -0.1) m, (325.88, 169.40) mas
sa index   location       noise equivalent angle
    3100: (  2.9,   3.9) m, (150.23, 150.18) mas
    2770: (  2.2,   2.9) m, (181.77, 173.93) mas
    2505: (  1.6,   2.1) m, (161.57, 166.69) mas
    2199: (  1.1,   1.3) m, (168.76, 176.04) mas
    2073: (  0.8,   1.1) m, (172.33, 179.91) mas
    1797: ( -1.3,   0.3) m, (201.98, 194.12) mas
    1168: ( -1.1,  -1.3) m, (199.19, 217.87) mas
     799: ( -1.8,  -2.2) m, (210.94, 233.58) mas
     534: ( -2.4,  -3.0) m, (254.45, 272.64) mas
     287: ( -3.0,  -3.8) m, (231.06, 262.03) mas
     119: ( -3.0,  -4.3) m, (230.98, 273.36) mas
sa index   location       noise equivalent angle
    3272: ( -1.1,   4.6) m, (148.12, 152.98) mas
    3158: ( -1.1,   4.2) m, (148.46, 155.31) mas
    2750: ( -0.8,   2.9) m, (152.23, 170.84) mas
    2543: ( -0.6,   2.2) m, (154.01, 177.52) mas
    2189: ( -0.4,   1.3) m, (156.72, 189.14) mas
    1339: ( -1.2,  -0.9) m, (159.92, 220.52) mas
     991: (  0.3,  -1.8) m, (167.48, 238.40) mas
     761: (  0.4,  -2.4) m, (169.58, 250.27) mas
     312: (  0.8,  -3.8) m, (173.70, 279.53) mas
     145: (  0.9,  -4.3) m, (175.60, 294.75) mas
      32: (  2.1,  -4.8) m, (186.47, 308.76) mas
sa index   location       noise equivalent angle
    2351: ( -4.0,   1.8) m, (154.28, 149.62) mas
    2112: ( -2.7,   1.2) m, (169.60, 155.86) mas
    1959: ( -1.8,   0.8) m, (196.75, 178.97) mas
    1854: ( -1.3,   0.4) m, (186.55, 164.16) mas
    2018: (  0.9,   0.9) m, (218.62, 165.31) mas
    1396: (  1.3,  -0.8) m, (230.35, 180.88) mas
    1346: (  1.6,  -0.9) m, (255.61, 204.27) mas
    1192: (  2.5,  -1.3) m, (252.56, 189.04) mas
     953: (  3.9,  -1.9) m, (281.94, 197.90) mas
    1535: (  5.2,  -0.4) m, (311.93, 182.45) mas
sa index   location       noise equivalent angle
     900: ( -4.0,  -1.9) m, (154.28, 149.62) mas
    1157: ( -2.7,  -1.3) m, (169.60, 155.86) mas
    1335: ( -1.8,  -0.9) m, (197.03, 180.54) mas
    1448: ( -1.3,  -0.6) m, (186.55, 164.16) mas
    1289: (  0.9,  -1.1) m, (218.62, 165.31) mas
    1914: (  1.3,   0.6) m, (230.35, 180.88) mas
    1970: (  1.6,   0.8) m, (255.19, 202.28) mas
    2147: (  2.5,   1.2) m, (252.56, 189.04) mas
    2404: (  3.9,   1.8) m, (281.94, 197.90) mas
    1825: (  5.2,   0.3) m, (311.93, 182.45) mas
sa index   location       noise equivalent angle
      19: ( -1.1,  -4.8) m, (148.12, 152.98) mas
     132: ( -1.1,  -4.3) m, (148.46, 155.31) mas
     545: ( -0.8,  -3.0) m, (152.23, 170.84) mas
     754: ( -0.6,  -2.4) m, (154.01, 177.52) mas
    1110: ( -0.4,  -1.5) m, (156.72, 189.14) mas
    1740: (  1.2,   0.1) m, (186.10, 231.20) mas
    2318: (  0.3,   1.6) m, (167.48, 238.40) mas
    2550: (  0.4,   2.2) m, (169.58, 250.27) mas
    3002: (  0.8,   3.6) m, (173.70, 279.53) mas
    3171: (  0.9,   4.2) m, (175.60, 294.75) mas
    3284: (  2.1,   4.6) m, (186.47, 308.76) mas
sa index   location       noise equivalent angle
     242: (  2.9,  -4.0) m, (150.23, 150.18) mas
     565: (  2.2,  -3.0) m, (181.77, 173.93) mas
     822: (  1.6,  -2.2) m, (161.57, 166.69) mas
    1120: (  1.1,  -1.5) m, (168.76, 176.04) mas
    1236: (  0.8,  -1.2) m, (172.33, 179.91) mas
    1507: ( -1.3,  -0.4) m, (202.55, 194.65) mas
    2123: ( -1.1,   1.2) m, (199.19, 217.87) mas
    2482: ( -1.8,   2.1) m, (210.94, 233.58) mas
    2739: ( -2.4,   2.9) m, (254.45, 272.64) mas
    2977: ( -3.0,   3.6) m, (231.06, 262.03) mas
    3145: ( -3.0,   4.2) m, (230.98, 273.36) mas

[00;00mSetting up powfs 2 PO WFS[00;00m

OTF dimension is 48x48 (calculated)
GPU 0: mem used 2628 MB (perf init)
Generating matched filter for powfs 2
Use sanea to derive neasim
Use sanea to derive neasim

[00;00mSetting up reconstructor[00;00m

Recon NEA: cmf(200.76) cmf(201.07) cmf(200.51) cmf(200.94) cmf(200.91) cmf(200.44) cmf(201.03) geom(0.31) geom(0.31) geom(0.31) mf(0.14)  mas
Setup or update control matrix parameters.
RRtwfs svd threshold is 1e-10

*** Simulation started at 2025/02/12 00:37:58 in nid003544. ***

Running seed 1
GPU 0: mem used 2304 MB (wfs seeding)
Wind dir: 267.3 261.7 167.0 130.5 300.7  32.3 119.8 139.0 150.8 277.7 203.0 133.1  45.9 265.1 deg
Using /global/homes/b/bpeck/.aos/cache/atm/vonkarman_14_8192x8192_0.0078125_1115374592d.bin
After genatm:	4394.5 MiB.
Replacing HA by HA*fit->actextrap
Adding piston cr to fit matrix
Adding TT cr on upper DMs to fit matrix.
Before assembling fit matrix:	4360.1 MiB.
Building fit->FR
Building fit->FL
Adding tikhonov constraint of 1.0e-07 to FLM
The maximum eigen value is estimated to be around 3.1e-04
DM Fit number of Low rank terms: 16 in LHS
After assemble fit matrix:	5663.5 MiB.
After setup_recon:	5663.5 MiB.
Step     #  Open Loop  PR TT  On axis  PR TT  Field RMS PR TT     Timing 
Step     0: OL  884.6  248.3  OA  884.6 248.3 CL  884.6 248.3 nm  0.437 s
Step    15: OL  908.2  254.1  OA  122.9  42.0 CL  122.9  42.0 nm  0.036 s

*** Simulation started at 2025/02/12 00:38:08 in nid008652. ***

Running seed 1
Step    40: OL  947.6  260.4  OA  109.3  21.6 CL  109.3  21.6 nm  0.041 s
GPU 0: mem used 2628 MB (wfs seeding)
Step    64: OL  983.3  260.3  OA  107.3  13.6 CL  107.3  13.6 nm  0.040 s
Wind dir: 267.3 261.7 167.0 130.5 300.7  32.3 119.8 139.0 150.8 277.7 203.0 133.1  45.9 265.1 deg
Using /global/homes/b/bpeck/.aos/cache/atm/vonkarman_14_8192x8192_0.0078125_1115374592d.bin
After genatm:	6249.3 MiB.
GPU 0: mem used 1894 MB (wfs init)
Step    88: OL 1019.6  257.9  OA  108.4   9.2 CL  108.4   9.2 nm  0.045 s
GPU 0: mem used 2680 MB (recon init)
Step   112: OL 1056.1  257.6  OA  110.3   3.5 CL  110.3   3.5 nm  0.043 s
GPU 0: mem used 2710 MB (perf init)
Step   136: OL 1090.4  261.8  OA  107.7   6.7 CL  107.7   6.7 nm  0.044 s
Step   160: OL 1119.8  272.0  OA  111.6  14.0 CL  111.6  14.0 nm  0.041 s
Step   183: OL 1140.9  285.7  OA  111.8  15.3 CL  111.8  15.3 nm  0.044 s
Step   207: OL 1154.4  301.2  OA  106.7  14.1 CL  106.7  14.1 nm  0.044 s
Step   229: OL 1160.4  315.4  OA  105.8  12.7 CL  105.8  12.7 nm  0.042 s
Step     #  Open Loop  PR TT  On axis  PR TT  Field RMS PR TT     Timing 
Step     0: OL  884.6  248.3  OA  884.6 248.3 CL  884.6 248.3 nm  0.344 s
Step   253: OL 1158.5  332.0  OA  106.8  12.1 CL  106.8  12.1 nm  0.042 s
Step   255 updated high order loop gain: 0.373
Step    17: OL  911.0  254.8  OA  151.9  33.5 CL  151.9  33.5 nm  0.053 s
Step   277: OL 1144.1  349.3  OA  105.8  13.5 CL  105.8  13.5 nm  0.042 s
Step    33: OL  935.9  259.4  OA  134.4  17.1 CL  134.4  17.1 nm  0.067 s
Step   301: OL 1121.5  369.0  OA  105.7   4.1 CL  105.7   4.1 nm  0.039 s
Step    49: OL  959.8  261.2  OA  128.7  21.6 CL  128.7  21.6 nm  0.062 s
Step   325: OL 1093.7  391.8  OA  107.0   7.2 CL  107.0   7.2 nm  0.043 s
Step    65: OL  983.6  260.4  OA  129.0   7.4 CL  129.0   7.4 nm  0.069 s
Step   349: OL 1063.7  419.8  OA  107.2   6.6 CL  107.2   6.6 nm  0.048 s

*** Simulation started at 2025/02/12 00:38:22 in nid008213. ***

Running seed 1
GPU 0: mem used 2710 MB (wfs seeding)
Step    81: OL 1007.9  258.7  OA  134.0  11.4 CL  134.0  11.4 nm  0.072 s
Step   373: OL 1035.4  453.0  OA  109.2   8.2 CL  109.2   8.2 nm  0.044 s
Wind dir: 267.3 261.7 167.0 130.5 300.7  32.3 119.8 139.0 150.8 277.7 203.0 133.1  45.9 265.1 deg
Using /global/homes/b/bpeck/.aos/cache/atm/vonkarman_14_8192x8192_0.0078125_1115374592d.bin
After genatm:	5599.5 MiB.
Step    97: OL 1032.6  257.6  OA  128.3  17.1 CL  128.3  17.1 nm  0.064 s
Step   397: OL 1010.1  487.7  OA  113.2  13.3 CL  113.2  13.3 nm  0.043 s
Step   113: OL 1057.3  257.9  OA  125.2  30.0 CL  125.2  30.0 nm  0.073 s
Step   421: OL  984.6  521.1  OA  109.4  14.4 CL  109.4  14.4 nm  0.040 s
Step   129: OL 1080.9  260.1  OA  133.2  20.9 CL  133.2  20.9 nm  0.063 s
Step   445: OL  959.0  552.7  OA  109.3   5.0 CL  109.3   5.0 nm  0.041 s
Step   143: OL 1100.1  264.6  OA  132.4   3.5 CL  132.4   3.5 nm  0.076 s
Step   467: OL  941.6  581.5  OA  108.9  16.7 CL  108.9  16.7 nm  0.042 s
Step   158: OL 1118.2  271.2  OA  130.6  19.5 CL  130.6  19.5 nm  0.061 s
Step   491: OL  934.5  611.7  OA  111.6  23.7 CL  111.6  23.7 nm  0.044 s
Step   174: OL 1134.6  280.3  OA  133.1  18.7 CL  133.1  18.7 nm  0.066 s
Step   511 updated high order loop gain: 0.361
Step   514: OL  936.4  637.4  OA  114.8  24.7 CL  114.8  24.7 nm  0.044 s
Step   190: OL 1146.8  290.5  OA  131.1  20.9 CL  131.1  20.9 nm  0.064 s
Step   538: OL  944.7  657.0  OA  111.8  15.6 CL  111.8  15.6 nm  0.044 s
Step   206: OL 1155.5  300.8  OA  129.3   1.9 CL  129.3   1.9 nm  0.065 s
Step   562: OL  960.5  667.5  OA  110.4  10.1 CL  110.4  10.1 nm  0.042 s
Step   222: OL 1161.1  311.0  OA  136.8  17.9 CL  136.8  17.9 nm  0.062 s
Step     #  Open Loop  PR TT  On axis  PR TT  Field RMS PR TT     Timing 
Step     0: OL  884.6  248.3  OA  884.6 248.3 CL  884.6 248.3 nm  0.316 s
Step   586: OL  982.1  670.9  OA  113.1  16.5 CL  113.1  16.5 nm  0.041 s
Step   238: OL 1162.9  321.6  OA  131.6  33.0 CL  131.6  33.0 nm  0.068 s
Step    16: OL  909.7  254.4  OA   99.8  22.7 CL   99.8  22.7 nm  0.056 s
Step   610: OL 1008.2  665.8  OA  113.8  23.8 CL  113.8  23.8 nm  0.045 s
Step    32: OL  935.1  259.1  OA   94.5   6.4 CL   94.5   6.4 nm  0.066 s
Step   254: OL 1159.9  332.8  OA  134.0  22.7 CL  134.0  22.7 nm  0.065 s
Step   255 updated high order loop gain: 0.355
Step   634: OL 1035.0  652.0  OA  105.4   6.2 CL  105.4   6.2 nm  0.042 s
Step    48: OL  959.2  261.1  OA   99.0  13.3 CL   99.0  13.3 nm  0.063 s
Step   270: OL 1151.0  344.3  OA  137.4  29.4 CL  137.4  29.4 nm  0.065 s
Step   658: OL 1058.8  631.2  OA  109.9  11.9 CL  109.9  11.9 nm  0.043 s
Step   286: OL 1137.0  356.2  OA  129.6  26.9 CL  129.6  26.9 nm  0.062 s
Step    64: OL  982.9  260.4  OA  100.1  19.0 CL  100.1  19.0 nm  0.063 s
Step   682: OL 1079.3  606.6  OA  113.8  15.5 CL  113.8  15.5 nm  0.042 s
Step   302: OL 1120.3  369.9  OA  132.0  17.8 CL  132.0  17.8 nm  0.063 s
Step    80: OL 1007.1  258.6  OA   96.2   5.7 CL   96.2   5.7 nm  0.066 s
Step   704: OL 1094.9  582.3  OA  113.5   6.2 CL  113.5   6.2 nm  0.044 s
Step   318: OL 1101.1  384.7  OA  129.2  14.4 CL  129.2  14.4 nm  0.072 s
Step    96: OL 1031.5  257.5  OA   98.3   2.4 CL   98.3   2.4 nm  0.064 s
Step   728: OL 1103.7  552.8  OA  112.6  12.4 CL  112.6  12.4 nm  0.041 s
Step   334: OL 1079.9  401.5  OA  126.1   9.6 CL  126.1   9.6 nm  0.061 s
Step   112: OL 1055.9  257.6  OA   95.4  11.7 CL   95.4  11.7 nm  0.064 s
Step   752: OL 1102.6  523.4  OA  112.8  10.8 CL  112.8  10.8 nm  0.042 s
Step   767 updated high order loop gain: 0.356
Step   350: OL 1058.6  421.0  OA  131.9  33.4 CL  131.9  33.4 nm  0.070 s
Step   128: OL 1079.3  259.7  OA   93.3   4.1 CL   93.3   4.1 nm  0.070 s
Step   776: OL 1091.9  495.6  OA  113.5  17.7 CL  113.5  17.7 nm  0.044 s
Step   366: OL 1037.9  442.8  OA  121.9   5.3 CL  121.9   5.3 nm  0.062 s
Step   144: OL 1101.0  264.7  OA   95.9   8.2 CL   95.9   8.2 nm  0.064 s
Step   800: OL 1070.6  468.7  OA  110.9   6.7 CL  110.9   6.7 nm  0.045 s
Step   157: OL 1116.5  270.4  OA   99.1   8.6 CL   99.1   8.6 nm  0.063 s
Step   382: OL 1018.6  465.8  OA  129.2  12.9 CL  129.2  12.9 nm  0.070 s
Step   824: OL 1040.9  442.0  OA  112.2   5.5 CL  112.2   5.5 nm  0.043 s
Step   398: OL 1000.4  488.9  OA  125.7  14.6 CL  125.7  14.6 nm  0.062 s
Step   172: OL 1131.9  278.9  OA  101.7  15.5 CL  101.7  15.5 nm  0.064 s
Step   848: OL 1004.6  416.7  OA  109.9   4.2 CL  109.9   4.2 nm  0.043 s
Step   187: OL 1143.7  288.3  OA   97.9   8.3 CL   97.9   8.3 nm  0.064 s
Step   414: OL  982.0  511.4  OA  128.7   7.1 CL  128.7   7.1 nm  0.067 s
Step   872: OL  967.0  394.8  OA  109.2   6.5 CL  109.2   6.5 nm  0.064 s
Step   430: OL  963.3  532.7  OA  121.2  13.6 CL  121.2  13.6 nm  0.064 s
Step   896: OL  931.4  377.6  OA  110.8  17.9 CL  110.8  17.9 nm  0.041 s
Step   203: OL 1152.6  298.7  OA  100.0  23.4 CL  100.0  23.4 nm  0.064 s
Step   446: OL  945.8  553.7  OA  126.3   9.1 CL  126.3   9.1 nm  0.075 s
Step   216: OL 1157.7  306.9  OA   93.8  12.1 CL   93.8  12.1 nm  0.065 s
Step   920: OL  893.4  364.5  OA  111.9  13.4 CL  111.9  13.4 nm  0.041 s
Step   461: OL  932.7  573.3  OA  126.2   7.6 CL  126.2   7.6 nm  0.065 s
Step   232: OL 1160.5  317.3  OA   91.7   9.1 CL   91.7   9.1 nm  0.071 s
Step   943: OL  857.7  353.6  OA  114.4  14.3 CL  114.4  14.3 nm  0.046 s
Step   477: OL  924.0  594.0  OA  126.5  17.9 CL  126.5  17.9 nm  0.062 s
Step   248: OL 1159.4  328.4  OA   94.7   9.8 CL   94.7   9.8 nm  0.065 s
Step   967: OL  824.6  341.2  OA  111.2  13.4 CL  111.2  13.4 nm  0.045 s
Step   255 updated high order loop gain: 0.373
Step   493: OL  921.9  613.7  OA  129.7  13.1 CL  129.7  13.1 nm  0.063 s
Step   264: OL 1152.6  339.9  OA   91.7   7.3 CL   91.7   7.3 nm  0.063 s
Step   991: OL  799.1  326.1  OA  111.6  16.4 CL  111.6  16.4 nm  0.043 s
Step   509: OL  923.9  631.9  OA  129.7   6.5 CL  129.7   6.5 nm  0.064 s
Step  1015: OL  777.8  308.3  OA  110.7  10.9 CL  110.7  10.9 nm  0.043 s
Step   280: OL 1140.5  351.5  OA   93.4  18.0 CL   93.4  18.0 nm  0.062 s
Step   511 updated high order loop gain: 0.304
Step  1023 updated high order loop gain: 0.354
Step   525: OL  929.2  647.2  OA  129.0  12.6 CL  129.0  12.6 nm  0.064 s
Step   295: OL 1125.9  363.6  OA   92.5   4.5 CL   92.5   4.5 nm  0.065 s
Step  1039: OL  761.6  289.2  OA  112.0  11.5 CL  112.0  11.5 nm  0.041 s
Step   541: OL  937.5  658.4  OA  129.5   3.1 CL  129.5   3.1 nm  0.062 s
Step  1063: OL  747.8  267.1  OA  111.5  13.3 CL  111.5  13.3 nm  0.045 s
Step   311: OL 1108.4  378.1  OA   91.2   8.8 CL   91.2   8.8 nm  0.071 s
Step   557: OL  949.3  665.7  OA  135.1  17.2 CL  135.1  17.2 nm  0.062 s
Step  1087: OL  739.0  240.1  OA  112.8  17.9 CL  112.8  17.9 nm  0.041 s
Step   327: OL 1088.4  393.8  OA   94.6   7.7 CL   94.6   7.7 nm  0.063 s
Step   572: OL  962.9  669.3  OA  126.3   9.7 CL  126.3   9.7 nm  0.061 s
Step  1111: OL  736.6  214.1  OA  112.8  26.5 CL  112.8  26.5 nm  0.041 s
Step   343: OL 1068.1  412.1  OA   93.4  18.9 CL   93.4  18.9 nm  0.065 s
Step   588: OL  979.8  670.5  OA  124.0   8.6 CL  124.0   8.6 nm  0.080 s
Step  1135: OL  737.5  193.2  OA  108.4  11.4 CL  108.4  11.4 nm  0.043 s
Step   359: OL 1048.0  433.0  OA   92.8   5.2 CL   92.8   5.2 nm  0.062 s
Step   604: OL  998.5  667.6  OA  125.0  20.7 CL  125.0  20.7 nm  0.062 s
Step  1157: OL  739.3  179.6  OA  109.9  20.5 CL  109.9  20.5 nm  0.044 s
Step   375: OL 1029.2  455.7  OA   97.4   7.9 CL   97.4   7.9 nm  0.063 s
Step   620: OL 1017.9  660.6  OA  127.2   0.4 CL  127.2   0.4 nm  0.074 s
Step  1181: OL  741.2  171.3  OA  104.8  15.5 CL  104.8  15.5 nm  0.042 s
Step   391: OL 1011.7  478.9  OA   95.7   5.7 CL   95.7   5.7 nm  0.063 s
Step   636: OL 1036.6  650.1  OA  126.2   4.2 CL  126.2   4.2 nm  0.064 s
Step  1204: OL  746.3  166.5  OA  107.6  14.7 CL  107.6  14.7 nm  0.045 s
Step   407: OL  994.8  501.8  OA   94.2  14.2 CL   94.2  14.2 nm  0.071 s
Step   652: OL 1053.9  636.6  OA  128.6   5.2 CL  128.6   5.2 nm  0.073 s
Step  1228: OL  750.9  163.7  OA  109.4  18.2 CL  109.4  18.2 nm  0.043 s
Step   423: OL  977.2  523.6  OA   93.8   3.5 CL   93.8   3.5 nm  0.065 s
Step   668: OL 1069.2  620.8  OA  133.6  35.9 CL  133.6  35.9 nm  0.061 s
Step  1252: OL  753.4  166.9  OA  110.5  27.6 CL  110.5  27.6 nm  0.045 s
Step   439: OL  959.6  544.8  OA   96.3  13.4 CL   96.3  13.4 nm  0.073 s
Step   684: OL 1083.3  604.2  OA  132.8  20.5 CL  132.8  20.5 nm  0.066 s
Step  1275: OL  757.1  176.5  OA  107.8  19.4 CL  107.8  19.4 nm  0.041 s
Step   454: OL  945.1  564.3  OA   97.4  18.6 CL   97.4  18.6 nm  0.065 s
Step  1279 updated high order loop gain: 0.351
Step   700: OL 1095.6  586.7  OA  131.9  11.2 CL  131.9  11.2 nm  0.062 s
Step  1294: OL  762.4  187.9  OA  110.9  19.1 CL  110.9  19.1 nm  0.043 s
Step   468: OL  935.2  582.6  OA   96.1  20.6 CL   96.1  20.6 nm  0.064 s
Step   715: OL 1103.9  568.7  OA  133.8  15.1 CL  133.8  15.1 nm  0.064 s
Step  1318: OL  769.1  205.3  OA  110.6  21.2 CL  110.6  21.2 nm  0.042 s
Step   484: OL  929.0  603.0  OA   95.4  12.9 CL   95.4  12.9 nm  0.069 s
Step   731: OL 1108.4  548.9  OA  131.9  18.1 CL  131.9  18.1 nm  0.061 s
Step  1342: OL  777.5  226.2  OA  108.1  17.0 CL  108.1  17.0 nm  0.041 s
Step   500: OL  928.6  622.1  OA   97.3   7.2 CL   97.3   7.2 nm  0.066 s
Replacing HA by HA*fit->actextrap
Adding piston cr to fit matrix
Adding TT cr on upper DMs to fit matrix.
Before assembling fit matrix:	4790.7 MiB.
Building fit->FR
Step   511 updated high order loop gain: 0.347
Step   747: OL 1108.1  529.2  OA  128.4   6.6 CL  128.4   6.6 nm  0.063 s
Step  1366: OL  791.6  247.0  OA  104.6  10.0 CL  104.6  10.0 nm  0.043 s
Step   516: OL  931.7  639.2  OA   97.6  10.2 CL   97.6  10.2 nm  0.065 s
Step   763: OL 1103.4  510.2  OA  131.8   1.4 CL  131.8   1.4 nm  0.063 s
Step  1383: OL  803.7  258.2  OA  108.6  20.1 CL  108.6  20.1 nm  0.041 s
Step   532: OL  937.5  652.9  OA   97.7  12.8 CL   97.7  12.8 nm  0.064 s
Step   767 updated high order loop gain: 0.283
Step  1404: OL  821.5  267.9  OA  110.6  23.4 CL  110.6  23.4 nm  0.043 s
Step   779: OL 1094.3  492.0  OA  136.7  14.5 CL  136.7  14.5 nm  0.063 s
Step   548: OL  946.4  662.3  OA   96.8   5.4 CL   96.8   5.4 nm  0.063 s
Step  1428: OL  845.3  274.5  OA  108.2  16.0 CL  108.2  16.0 nm  0.042 s
Step   795: OL 1080.2  474.1  OA  131.6  11.0 CL  131.6  11.0 nm  0.063 s
Step   563: OL  957.8  667.7  OA   95.7  13.6 CL   95.7  13.6 nm  0.066 s
Step  1452: OL  867.9  278.8  OA  106.9  15.0 CL  106.9  15.0 nm  0.043 s
Step   811: OL 1062.3  456.2  OA  134.8  11.1 CL  134.8  11.1 nm  0.064 s
Step   579: OL  972.4  670.4  OA   92.9   8.2 CL   92.9   8.2 nm  0.065 s
Step  1476: OL  885.5  278.9  OA  106.9   6.4 CL  106.9   6.4 nm  0.044 s
Step   827: OL 1040.7  438.5  OA  135.8  10.0 CL  135.8  10.0 nm  0.064 s
Step   595: OL  989.5  670.0  OA   94.1   2.4 CL   94.1   2.4 nm  0.063 s
Step  1500: OL  892.0  272.9  OA  106.9   3.3 CL  106.9   3.3 nm  0.041 s
Step   843: OL 1016.1  421.6  OA  132.3   1.1 CL  132.3   1.1 nm  0.064 s
Step   611: OL 1007.7  665.3  OA   92.4   5.5 CL   92.4   5.5 nm  0.071 s
Step  1524: OL  889.9  262.1  OA  106.1   3.7 CL  106.1   3.7 nm  0.041 s
Step   858: OL  992.2  406.9  OA  139.2   8.9 CL  139.2   8.9 nm  0.066 s
Step   626: OL 1025.1  657.4  OA   92.7   8.2 CL   92.7   8.2 nm  0.064 s
Step  1535 updated high order loop gain: 0.350
Building fit->FL
Step   874: OL  966.9  393.1  OA  135.6  18.6 CL  135.6  18.6 nm  0.064 s
Step  1548: OL  880.9  247.3  OA  108.4   8.6 CL  108.4   8.6 nm  0.041 s
Step   642: OL 1042.9  645.5  OA   96.7  11.1 CL   96.7  11.1 nm  0.064 s
Adding tikhonov constraint of 1.0e-07 to FLM
The maximum eigen value is estimated to be around 2.7e-04
DM Fit number of Low rank terms: 16 in LHS
After assemble fit matrix:	6731.1 MiB.
After setup_recon:	6731.1 MiB.
Step  1566: OL  872.4  235.6  OA  108.0   7.3 CL  108.0   7.3 nm  0.041 s
Step   890: OL  942.9  381.4  OA  138.7  12.6 CL  138.7  12.6 nm  0.064 s
Step   658: OL 1058.7  631.1  OA   95.1   5.7 CL   95.1   5.7 nm  0.072 s
Step  1590: OL  859.0  223.0  OA  110.1  11.0 CL  110.1  11.0 nm  0.043 s
Step   906: OL  917.9  371.5  OA  138.6   5.5 CL  138.6   5.5 nm  0.064 s
GPU 0: mem used 1542 MB (wfs init)
Step 1599: Output PSF
Step   674: OL 1072.9  614.8  OA  100.3  16.1 CL  100.3  16.1 nm  0.064 s
Step   922: OL  891.9  363.4  OA  142.8  15.7 CL  142.8  15.7 nm  0.066 s
Step   687: OL 1083.8  601.2  OA   97.8   8.0 CL   97.8   8.0 nm  0.070 s
GPU 0: mem used 2708 MB (recon init)
Step   936: OL  869.6  356.8  OA  135.6  13.1 CL  135.6  13.1 nm  0.064 s
Step   703: OL 1095.0  583.4  OA   96.3   4.6 CL   96.3   4.6 nm  0.064 s
GPU 0: mem used 2738 MB (perf init)
Step   952: OL  845.2  349.1  OA  130.3  13.3 CL  130.3  13.3 nm  0.071 s
Step   719: OL 1102.6  563.9  OA   95.0   9.3 CL   95.0   9.3 nm  0.066 s
Step   968: OL  823.5  340.5  OA  133.5  15.9 CL  133.5  15.9 nm  0.062 s
Step   734: OL 1105.8  545.4  OA  100.6  19.2 CL  100.6  19.2 nm  0.083 s
Step   984: OL  805.3  330.7  OA  127.7  14.8 CL  127.7  14.8 nm  0.071 s
Step  1599: OL  853.4  219.3  OA  109.2  10.8 CL  109.2  10.8 nm  5.185 s
Step   750: OL 1104.6  525.7  OA   96.1   9.8 CL   96.1   9.8 nm  0.064 s
Mean: 110.22 14.41 109.27  nm.

*** Simulation Finished at 2025/02/12 00:39:22 in nid003544. ***

Step  1000: OL  789.4  319.6  OA  134.6   4.2 CL  134.6   4.2 nm  0.063 s
Step   766: OL 1099.1  506.9  OA   96.7   6.1 CL   96.7   6.1 nm  0.070 s
Step   767 updated high order loop gain: 0.335
Step  1016: OL  775.2  307.5  OA  127.9   2.5 CL  127.9   2.5 nm  0.069 s
[00;00m>>>>>>>>>>>>>>>>[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid003544/scheduler) failed: Invalid argument. 
/global/u2/b/bpeck/work/vismcao/maos -o studies/reduced_ngs/9_lgs/8mag_lgs/1250count -c master_files/reduced_ngs/9_lgs/8mag_lgs/kola_1250act.conf -O 
Output folder is 'studies/reduced_ngs/9_lgs/8mag_lgs/1250count'.
SRC: /global/homes/b/bpeck/code/maos v2.9 4c88b7c2 2024-11-13 16:45:33 -0800
BUILT: /global/homes/b/bpeck/code/maos/optim by GCC (v12) on 2024/11/18 09:40:03 CPU(F64,+O3) with CUDA(v122,F32)
Launched at 2025/02/12 00:39:23 in nid003544 with PID 2033277.
The web based job monitor can be accessed at http://localhost:10300
Main config file is /global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_1250act.conf
[00;00m[0;36mWarning(path.c:48): Path not found: path=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; abspath=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; Ignored.
Step   781: OL 1090.1  489.9  OA   94.0   4.8 CL   94.0   4.8 nm  0.063 s
[00;00m[0;36mWarning(path.c:48): Path not found: path=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; abspath=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; Ignored.
[00;00m[0;36mWarning(readcfg.c:399): sim.apfsm has been renamed to powfs.apfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.epfsm has been renamed to powfs.epfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.alfsm has been renamed to powfs.alfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.commonfsm has been renamed to powfs.commonfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.idealfsm has been renamed to powfs.idealfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.zetafsm has been renamed to powfs.zetafsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.f0fsm has been renamed to powfs.f0fsm.
[00;00m[0;36mWarning(readcfg.c:399): tsurf has been renamed to ncpa.tsurf.
loaded 132 (132 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_sim.conf'
loaded  19 ( 19 new) records from '/global/u2/b/bpeck/work/vismcao/./dm_none.conf'
loaded  19 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_ASM.conf'
loaded  19 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_DM2.conf'
loaded  19 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_DM3.conf'
loaded   0 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_dm_multiple.conf'
loaded   7 (  5 new) records from '/global/u2/b/bpeck/work/vismcao/./atm_mk13n50p_ground_detail.conf'
loaded  76 ( 69 new) records from '/global/homes/b/bpeck/code/maos/config/maos/powfs_common.conf'
loaded  44 ( 38 new) records from '/global/u2/b/bpeck/work/vismcao/./powfs_none.conf'
loaded  44 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_shwfs_lgs.conf'
loaded  44 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_shwfs_ttf_strap.conf'
loaded  44 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_shwfs_twfs_lbwfs.conf'
loaded   0 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_wfs_lgs_strap_lbwfs.conf'
loaded  71 ( 71 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_recon.conf'
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_smooth has been renamed to powfs0_llt.na_smooth.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_interp has been renamed to powfs0_llt.na_interp.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_thres has been renamed to powfs0_llt.na_thres.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_maxit has been renamed to powfs0_llt.na_fit_maxit.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_svdthres has been renamed to powfs0_llt.na_fit_svdthres.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_dh has been renamed to powfs0_llt.na_fit_dh.
[00;00m[0;36mWarning(readcfg.c:399): dbg.ncpa_preload has been renamed to ncpa.preload.
Step  1023 updated high order loop gain: 0.271
[00;00m[0;36mWarning(readcfg.c:399): dbg.ncpa_rmsci has been renamed to ncpa.rmsci.
[00;00m[0;36mWarning(readcfg.c:399): dbg.draw_opdmax has been renamed to plot.opdmax.
[00;00m[0;36mWarning(readcfg.c:399): dbg.draw_gmax has been renamed to plot.gmax.
loaded  95 ( 93 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_dbg.conf'
loaded   4 (  4 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_fit_mcao.conf'
[00;00m[0;36mWarning(readcfg.c:399): surf has been renamed to ncpa.surf.
loaded  39 (  7 new) records from '/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_1250act.conf'
loaded   0 (  0 new) records from 'command line'
loaded  24 ( 18 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_llt_CL.conf'
Adjust LGS range by telescope altitude 4145m.
Zenith angle is 30 degree.
    Scaling turbulence height and LGS hs by sec(za).
    Scaling r0 by cos(za)^(3/5).
    Scaling wind speed and LGS signal level by cos(za).
powfs0: Adjusting dx from 0.0078125 to 0.00766667. 
powfs0.llt.fsm: f0=0 Hz, LPF ep=0
powfs0.epfsm is set to 0.517618 (auto)
powfs2: Adjusting dx from 0.03125 to 0.0312778. 
powfs2 is TWFS for powfs0
sim.ephi is set to 0.427717 (auto)
sim.eplo is set to 0.427717 (auto)
[00;00m[0;36mWarning(parms.c:2296): Layer 1 at 17.3205m is very close to layer 0 at 0m (OK).
[00;00m[0;36mWarning(parms.c:2296): Layer 2 at 34.641m is very close to layer 1 at 17.3205m (OK).
[00;00m[0;36mWarning(parms.c:2296): Layer 3 at 51.9615m is very close to layer 2 at 34.641m (OK).
dm 0: stroke=30 um is provided in micron.
dm 0: assume ia stroke=2 um is provided in micron.
dm 1: stroke=7 um is provided in micron.
dm 1: assume ia stroke=2 um is provided in micron.
dm 2: stroke=7 um is provided in micron.
dm 2: assume ia stroke=2 um is provided in micron.
Focus blending is not implemented yet for integrated tomography
parms->sim.mffocus is reset to 0
There are 1 valid simulation seeds:  1
Output PSF for 1 directions
Used 449 of 456 supplied keys
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_flate" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_flatv" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_psx" is not recognized, value is [0 0 0 0]
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_psy" is not recognized, value is [0 0 0 0]
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_pupelong" is not recognized, value is 0
Step  1031: OL  764.2  295.8  OA  131.5   7.4 CL  131.5   7.4 nm  0.062 s
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_raw" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_side" is not recognized, value is 4
[00;00mAperture[00;00m is 11 m with sampling 1/128 m
[00;00mTurbulence at 30 degree zenith angle:[00;00m r0=0.128424m, L0=30m, 14 layers.
    Greenwood freq is 25.1Hz, anisoplanatic angle is 1.58 as
    Sampled 8192x8192 at 1/128m. wind dir is randomized.
    layer 0: ht=      0 m, wt= 0.302, ws=  4.8 m/s
    layer 1: ht=     17 m, wt= 0.154, ws=  5.0 m/s
    layer 2: ht=     35 m, wt= 0.041, ws=  5.4 m/s
    layer 3: ht=     52 m, wt= 0.002, ws=  6.6 m/s
    layer 4: ht=    139 m, wt= 0.021, ws=  6.1 m/s
    layer 5: ht=    231 m, wt= 0.010, ws=  6.1 m/s
    layer 6: ht=    323 m, wt= 0.008, ws=  6.1 m/s
    layer 7: ht=    416 m, wt= 0.005, ws=  6.1 m/s
    layer 8: ht=    508 m, wt= 0.001, ws=  6.1 m/s
    layer 9: ht=    932 m, wt= 0.107, ws=  5.6 m/s
    layer 10: ht=   5022 m, wt= 0.144, ws= 11.1 m/s
    layer 11: ht=   9238 m, wt= 0.093, ws= 19.1 m/s
    layer 12: ht=  13856 m, wt= 0.075, ws=  8.2 m/s
    layer 13: ht=  22518 m, wt= 0.036, ws=  4.8 m/s
[00;00mReconstruction[00;00m: r0=0.128424m L0=30m. 14 layers. use cone coordinate.
    layer 0: ht=      0 m, wt= 0.302
    layer 1: ht=     17 m, wt= 0.154
    layer 2: ht=     35 m, wt= 0.041
    layer 3: ht=     52 m, wt= 0.002
    layer 4: ht=    139 m, wt= 0.021
    layer 5: ht=    231 m, wt= 0.010
    layer 6: ht=    323 m, wt= 0.008
    layer 7: ht=    416 m, wt= 0.005
    layer 8: ht=    508 m, wt= 0.001
    layer 9: ht=    932 m, wt= 0.107
    layer 10: ht=   5022 m, wt= 0.144
    layer 11: ht=   9238 m, wt= 0.093
    layer 12: ht=  13856 m, wt= 0.075
    layer 13: ht=  22518 m, wt= 0.036
[00;00mThere are 3 powfs[00;00m
  powfs0: Order 40, LGS at 99.1 km. Sampling 1/130.435 m. Thres 30%. [00;00mT/T is removed in right hand side in tomography.[00;00m
    CCD image is 25x25 @ 500x500 mas, blur 27% (sigma), 1500Hz, wvl: [ 5.89e-07]
    Gtilt in reconstruction. Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
  powfs1: Order  2, NGS at inf km. Sampling 1/16 m. Thres 30%. 
    Ztilt in reconstruction. Geomtric optics start at 2 with ztilt [00;00m(noisy)[00;00m
  powfs2: Order 20, NGS at inf km. Sampling 1/31.9716 m. Thres 50%. 
    CCD image is 4x4 @ 1500x1500 mas, blur 0% (sigma), 0.015Hz, wvl: [ 7.2e-07]
    Gtilt in reconstruction. Geomtric optics start at 50 with gtilt Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
[00;00mThere are 13 wfs[00;00m
    wfs 0: type 0, at (  30.00,    0.00) arcsec,  99 km, siglev is 91.338 bkgrnd is 0.1
    wfs 1: type 0, at (  22.98,   19.28) arcsec,  99 km, siglev is 91.338 bkgrnd is 0.1
    wfs 2: type 0, at (   5.21,   29.54) arcsec,  99 km, siglev is 91.338 bkgrnd is 0.1
    wfs 3: type 0, at ( -15.00,   25.98) arcsec,  99 km, siglev is 91.338 bkgrnd is 0.1
    wfs 4: type 0, at ( -28.19,   10.26) arcsec,  99 km, siglev is 91.338 bkgrnd is 0.1
    wfs 5: type 0, at ( -28.19,  -10.26) arcsec,  99 km, siglev is 91.338 bkgrnd is 0.1
    wfs 6: type 0, at ( -15.00,  -25.98) arcsec,  99 km, siglev is 91.338 bkgrnd is 0.1
    wfs 7: type 0, at (   5.21,  -29.54) arcsec,  99 km, siglev is 91.338 bkgrnd is 0.1
    wfs 8: type 0, at (  22.98,  -19.28) arcsec,  99 km, siglev is 91.338 bkgrnd is 0.1
    wfs 9: type 1, at (   5.00,    8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 10: type 1, at ( -10.00,    0.00) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 11: type 1, at (   5.00,   -8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 12: type 2, at (   0.00,    0.00) arcsec, inf km, siglev is 4.1558e+06 bkgrnd is 0.001
[00;00mThere are 3 DMs[00;00m
  DM 0 at -0.1km, actuator pitch 0.276m, offset   0, with 30.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 1 at    6km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 2 at   10km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
[00;00mTomography[00;00m is using CG, with [00;00mFourer Domain[00;00m preconditioner, [00;00m12[00;00m iterations, integrated tomo.
[00;00mDM Fitting [00;00mis using CG, with [00;00mNo[00;00m preconditioner, [00;00m10[00;00m iterations
[00;00mThere are 9 fit directions[00;00m
    Fit 0: weight is 0.444, at (   0.00,    0.00) arcsec
    Fit 1: weight is 0.111, at (  15.00,    0.00) arcsec
    Fit 2: weight is 0.111, at (   0.00,   15.00) arcsec
    Fit 3: weight is 0.111, at ( -15.00,    0.00) arcsec
    Fit 4: weight is 0.111, at (   0.00,  -15.00) arcsec
    Fit 5: weight is 0.028, at (  15.00,   15.00) arcsec
    Fit 6: weight is 0.028, at ( -15.00,   15.00) arcsec
    Fit 7: weight is 0.028, at ( -15.00,  -15.00) arcsec
    Fit 8: weight is 0.028, at (  15.00,  -15.00) arcsec
[00;00mThere are 1 evaluation directions[00;00m at sampling 1/128 m.
    Evl 0: weight is 1.000, at (   0.00,    0.00) arcsec
[00;00mSimulation[00;00m start at step 0, end at step 1600, with time step 1/1500s, [00;00mclose loop[00;00m.
After setup_parms:	120.5 MiB.
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid003544/scheduler) failed: Invalid argument. 
Step   797: OL 1075.5  472.0  OA   98.5  13.2 CL   98.5  13.2 nm  0.064 s
CUDA: minimum memory requirement is 0.4GB
GPU 0 is NVIDIA A100-SXM4-40GB with arch 8.0, 38.9GB free, 39.3GB total device memory.
Using GPU 0
Use 1 GPUs for WFS Tomo Fit Evl

*** Preparation started at 2025/02/12 00:39:25 in nid003544. ***

Using OpenMP version 201511 with 128 threads
Reading aperture amplitude map from KECK.fits
Step  1047: OL  754.4  282.1  OA  133.5   9.5 CL  133.5   9.5 nm  0.063 s
Step   813: OL 1057.4  454.1  OA   96.2   9.6 CL   96.2   9.6 nm  0.071 s
Step  1063: OL  744.7  267.0  OA  133.5  17.7 CL  133.5  17.7 nm  0.060 s
[00;00m[0;36mWarning(accphi.c:477): 108130 points not covered by input screen
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid003544/scheduler) failed: Invalid argument. 
Step   829: OL 1035.7  436.4  OA   96.8   1.9 CL   96.8   1.9 nm  0.063 s
 ->maos.c:447->setup.c:148->aper.c:74->utils.c:478->accphi.c:478
iwvl 0: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 1: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 2: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 3: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
Step  1075: OL  738.8  254.0  OA  134.8  11.3 CL  134.8  11.3 nm  0.062 s
iwvl 4: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 5: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 6: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 7: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 8: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
After setup_aper:	344.7 MiB.

[00;00mSetting up powfs 0 geom[00;00m

There are 36 points in each subaperture of 0.276m.
There are 995 valid subaperture.

[00;00mSetting up powfs 1 geom[00;00m

There are 88 points in each subaperture of 5.5m.
There are 4 valid subaperture.

[00;00mSetting up powfs 2 geom[00;00m

There are 18 points in each subaperture of 0.563m.
There are 236 valid subaperture.
After setup_powfs_init:	430.8 MiB.

[00;00mSetting up reconstructor geometry.[00;00m

PLOC is 83x83, with sampling of 0.14m (square)
    DM 0: grid is 44 x 43
    DM 1: grid is 75 x 75
    DM 2: grid is 80 x 79
FLOC is 83x83, with sampling of 0.14m (not square)
Step   845: OL 1011.4  419.6  OA   94.8   7.0 CL   94.8   7.0 nm  0.065 s
Tomography grid is square:
    layer 0: xloc grid is 144 x 144, sampling is 0.138 m, 20736 points
    layer 1: xloc grid is 144 x 144, sampling is 0.138 m, 20736 points
    layer 2: xloc grid is 144 x 144, sampling is 0.138 m, 20736 points
    layer 3: xloc grid is 144 x 144, sampling is 0.138 m, 20736 points
    layer 4: xloc grid is 144 x 144, sampling is 0.138 m, 20736 points
    layer 5: xloc grid is 144 x 144, sampling is 0.138 m, 20736 points
    layer 6: xloc grid is 144 x 144, sampling is 0.138 m, 20736 points
    layer 7: xloc grid is 144 x 144, sampling is 0.137 m, 20736 points
    layer 8: xloc grid is 144 x 144, sampling is 0.137 m, 20736 points
    layer 9: xloc grid is 144 x 144, sampling is 0.137 m, 20736 points
    layer 10: xloc grid is 144 x 144, sampling is 0.131 m, 20736 points
    layer 11: xloc grid is 144 x 144, sampling is 0.125 m, 20736 points
    layer 12: xloc grid is 144 x 144, sampling is 0.119 m, 20736 points
[00;00m[0;36mWarning(map.c:195): ninx=144 is too small. need 145
[00;00m[0;36mWarning(map.c:200): niny=144 is too small. need 145
    layer 13: xloc grid is 144 x 144, sampling is 0.107 m, 20736 points

[00;00mSetting up powfs 0 PO WFS[00;00m

OTF dimension is 72x72 (calculated)
Step  1091: OL  733.9  235.3  OA  131.5  14.9 CL  131.5  14.9 nm  0.064 s

*** Simulation started at 2025/02/12 00:39:28 in nid008236. ***

Running seed 1
There is no bias
GPU 0: mem used 2740 MB (wfs seeding)
Step   861: OL  986.0  404.2  OA   97.4   7.4 CL   97.4   7.4 nm  0.065 s
Step  1107: OL  731.7  218.0  OA  130.7  21.7 CL  130.7  21.7 nm  0.062 s
Wind dir: 267.3 261.7 167.0 130.5 300.7  32.3 119.8 139.0 150.8 277.7 203.0 133.1  45.9 265.1 deg
Using /global/homes/b/bpeck/.aos/cache/atm/vonkarman_14_8192x8192_0.0078125_1115374592d.bin
Step   877: OL  961.3  390.8  OA   97.2   7.9 CL   97.2   7.9 nm  0.064 s
After genatm:	6616.8 MiB.
Step  1123: OL  731.1  202.6  OA  129.7  15.1 CL  129.7  15.1 nm  0.062 s
Step   893: OL  937.5  379.5  OA   95.4   7.3 CL   95.4   7.3 nm  0.063 s
Step  1139: OL  731.4  190.2  OA  129.0  26.7 CL  129.0  26.7 nm  0.063 s
Step   908: OL  913.9  370.4  OA   96.4  18.6 CL   96.4  18.6 nm  0.064 s
Step  1155: OL  732.2  180.4  OA  126.1  21.0 CL  126.1  21.0 nm  0.063 s
Step   924: OL  888.0  362.5  OA   96.0  14.3 CL   96.0  14.3 nm  0.062 s
Step  1170: OL  732.9  174.1  OA  124.7  15.3 CL  124.7  15.3 nm  0.072 s
Step   940: OL  862.8  354.9  OA   95.4   3.3 CL   95.4   3.3 nm  0.063 s
Step  1186: OL  735.1  169.8  OA  126.3  15.9 CL  126.3  15.9 nm  0.060 s
Step   956: OL  839.1  347.1  OA   95.6   8.9 CL   95.6   8.9 nm  0.070 s
Step  1199: OL  738.3  167.1  OA  130.7   5.9 CL  130.7   5.9 nm  0.068 s
Step   972: OL  818.6  338.2  OA   99.1  14.7 CL   99.1  14.7 nm  0.064 s
Step  1210: OL  741.1  165.1  OA  129.0  20.8 CL  129.0  20.8 nm  0.063 s
Step   988: OL  801.5  328.1  OA   99.5  18.6 CL   99.5  18.6 nm  0.064 s
Step  1226: OL  745.4  163.5  OA  122.8  19.4 CL  122.8  19.4 nm  0.062 s
Step  1004: OL  786.3  316.7  OA   97.3   3.5 CL   97.3   3.5 nm  0.062 s
Step     #  Open Loop  PR TT  On axis  PR TT  Field RMS PR TT     Timing 
Step     0: OL  884.6  248.3  OA  884.6 248.3 CL  884.6 248.3 nm  0.168 s
Step  1242: OL  748.7  164.4  OA  123.5  25.6 CL  123.5  25.6 nm  0.065 s
Step  1020: OL  773.3  304.5  OA  101.9  17.6 CL  101.9  17.6 nm  0.070 s
Step  1023 updated high order loop gain: 0.330
Step    17: OL  911.2  254.8  OA  129.4   9.9 CL  129.4   9.9 nm  0.058 s
Step  1258: OL  752.2  168.5  OA  127.7  25.4 CL  127.7  25.4 nm  0.064 s
Step  1036: OL  762.9  291.7  OA   96.4   2.2 CL   96.4   2.2 nm  0.064 s
Step    32: OL  934.8  259.1  OA  128.1  27.5 CL  128.1  27.5 nm  0.070 s
Step  1274: OL  756.8  175.7  OA  129.3  31.2 CL  129.3  31.2 nm  0.063 s
Step  1279 updated high order loop gain: 0.261
Step  1052: OL  753.9  277.7  OA   94.9   8.1 CL   94.9   8.1 nm  0.065 s
Step  1289: OL  762.7  184.4  OA  133.8  22.6 CL  133.8  22.6 nm  0.064 s
Step    47: OL  957.3  261.1  OA  131.3  13.1 CL  131.3  13.1 nm  0.067 s
Step  1067: OL  746.0  262.9  OA   94.5   6.5 CL   94.5   6.5 nm  0.063 s
Step  1305: OL  769.7  195.2  OA  133.1  17.2 CL  133.1  17.2 nm  0.071 s
Step    62: OL  979.4  260.6  OA  130.4  17.7 CL  130.4  17.7 nm  0.073 s
Step  1083: OL  740.4  244.8  OA   95.6  10.0 CL   95.6  10.0 nm  0.070 s
Step  1321: OL  775.9  207.5  OA  138.6  32.4 CL  138.6  32.4 nm  0.061 s
Step    77: OL 1002.0  259.0  OA  130.5   7.2 CL  130.5   7.2 nm  0.067 s
Step  1099: OL  738.2  226.5  OA   94.2  15.4 CL   94.2  15.4 nm  0.064 s
Step  1337: OL  783.0  221.4  OA  138.1  21.3 CL  138.1  21.3 nm  0.069 s
Step    92: OL 1025.0  257.8  OA  128.9  21.4 CL  128.9  21.4 nm  0.066 s
Step  1115: OL  737.9  210.2  OA   95.7  19.2 CL   95.7  19.2 nm  0.064 s
Step  1353: OL  791.9  236.0  OA  136.1  23.2 CL  136.1  23.2 nm  0.062 s
Step   107: OL 1048.0  257.5  OA  123.6  29.0 CL  123.6  29.0 nm  0.069 s
Step  1131: OL  738.6  196.2  OA   94.2  15.5 CL   94.2  15.5 nm  0.062 s
Step  1369: OL  803.0  249.0  OA  135.7  30.0 CL  135.7  30.0 nm  0.064 s
Step   122: OL 1070.6  258.8  OA  130.2   9.5 CL  130.2   9.5 nm  0.067 s
Step  1147: OL  739.8  185.2  OA   96.1  15.3 CL   96.1  15.3 nm  0.071 s
Step  1381: OL  811.9  256.8  OA  134.4  13.6 CL  134.4  13.6 nm  0.062 s
Step   137: OL 1091.7  262.3  OA  130.6  19.9 CL  130.6  19.9 nm  0.063 s
Step  1163: OL  741.0  177.0  OA   95.8  16.5 CL   95.8  16.5 nm  0.064 s
Step  1397: OL  825.3  265.0  OA  132.6  21.7 CL  132.6  21.7 nm  0.070 s
Step   152: OL 1111.0  268.2  OA  132.1  18.6 CL  132.1  18.6 nm  0.067 s
Step  1179: OL  742.3  171.8  OA   97.5  19.3 CL   97.5  19.3 nm  0.067 s
Step  1413: OL  840.5  270.6  OA  132.2  13.4 CL  132.2  13.4 nm  0.061 s
Step   167: OL 1127.4  276.1  OA  125.5  30.2 CL  125.5  30.2 nm  0.066 s
Step  1194: OL  745.0  168.4  OA  100.0  29.0 CL  100.0  29.0 nm  0.064 s
Step  1429: OL  856.4  274.6  OA  134.2  16.0 CL  134.2  16.0 nm  0.073 s
Step   182: OL 1140.8  285.3  OA  124.8  15.8 CL  124.8  15.8 nm  0.069 s
Step  1207: OL  747.6  166.0  OA   96.4  17.8 CL   96.4  17.8 nm  0.072 s
Step  1445: OL  871.4  277.7  OA  129.1   5.5 CL  129.1   5.5 nm  0.065 s
Step   197: OL 1150.5  295.0  OA  121.2  16.5 CL  121.2  16.5 nm  0.074 s
Step  1223: OL  750.8  163.9  OA   94.1  17.0 CL   94.1  17.0 nm  0.064 s
Step  1461: OL  885.0  279.3  OA  124.0  10.5 CL  124.0  10.5 nm  0.066 s
Step   212: OL 1157.5  304.5  OA  120.4  13.3 CL  120.4  13.3 nm  0.069 s
Step  1239: OL  752.9  164.3  OA   94.8  16.8 CL   94.8  16.8 nm  0.070 s
Step   227: OL 1161.4  314.2  OA  124.6  24.2 CL  124.6  24.2 nm  0.067 s
Step  1477: OL  895.1  278.6  OA  130.9  14.8 CL  130.9  14.8 nm  0.060 s
Step  1255: OL  754.3  167.8  OA   95.6  23.8 CL   95.6  23.8 nm  0.062 s
Step   242: OL 1162.0  324.3  OA  121.1  38.6 CL  121.1  38.6 nm  0.072 s
Step  1493: OL  900.0  275.2  OA  132.4   6.0 CL  132.4   6.0 nm  0.061 s
Step  1271: OL  756.7  174.5  OA   96.4  22.6 CL   96.4  22.6 nm  0.068 s
Step   255 updated high order loop gain: 0.357
Step   257: OL 1158.0  334.9  OA  114.8  16.9 CL  114.8  16.9 nm  0.068 s
Step  1509: OL  899.7  269.1  OA  134.6  15.1 CL  134.6  15.1 nm  0.062 s
Step  1279 updated high order loop gain: 0.325
Step  1287: OL  760.4  183.5  OA   98.0  29.2 CL   98.0  29.2 nm  0.064 s
Step  1524: OL  896.2  262.0  OA  126.1   5.2 CL  126.1   5.2 nm  0.064 s
Step   272: OL 1148.8  345.7  OA  121.2  28.9 CL  121.2  28.9 nm  0.071 s
Step  1303: OL  765.0  194.0  OA   99.2  31.1 CL   99.2  31.1 nm  0.065 s
Step  1535 updated high order loop gain: 0.259
Step   287: OL 1135.4  357.0  OA  122.1  23.3 CL  122.1  23.3 nm  0.068 s
Step  1540: OL  889.2  252.4  OA  130.5   2.9 CL  130.5   2.9 nm  0.063 s
Step  1319: OL  769.3  206.2  OA   95.9  13.2 CL   95.9  13.2 nm  0.066 s
Step   298: OL 1124.2  366.3  OA  122.7  28.6 CL  122.7  28.6 nm  0.076 s
Step  1556: OL  880.2  241.9  OA  131.5   3.7 CL  131.5   3.7 nm  0.065 s
Step  1335: OL  774.6  219.8  OA   95.4   9.6 CL   95.4   9.6 nm  0.065 s
Step  1572: OL  871.1  231.9  OA  134.1   9.7 CL  134.1   9.7 nm  0.063 s
Step   313: OL 1107.1  380.0  OA  127.2  42.5 CL  127.2  42.5 nm  0.065 s
Step  1351: OL  782.3  234.4  OA   95.3  15.6 CL   95.3  15.6 nm  0.063 s
Step  1588: OL  860.9  223.9  OA  134.3   6.8 CL  134.3   6.8 nm  0.062 s
Step   328: OL 1087.7  394.9  OA  126.3  44.4 CL  126.3  44.4 nm  0.067 s
Step  1366: OL  792.1  247.0  OA   94.4  16.2 CL   94.4  16.2 nm  0.068 s
Step 1599: Output PSF
Step   343: OL 1067.9  412.1  OA  126.4  31.8 CL  126.4  31.8 nm  0.071 s
Step  1382: OL  804.1  257.6  OA   98.6  19.8 CL   98.6  19.8 nm  0.065 s
Step   358: OL 1048.3  431.6  OA  130.5  35.1 CL  130.5  35.1 nm  0.068 s
Step  1398: OL  817.8  265.6  OA   98.3  25.2 CL   98.3  25.2 nm  0.064 s
Step   372: OL 1031.2  451.4  OA  126.8  25.1 CL  126.8  25.1 nm  0.066 s
Step  1414: OL  833.8  271.0  OA   97.0  16.7 CL   97.0  16.7 nm  0.070 s
Step   387: OL 1014.1  473.1  OA  129.4  37.2 CL  129.4  37.2 nm  0.069 s
Step  1430: OL  850.7  274.9  OA   95.2   8.8 CL   95.2   8.8 nm  0.063 s
Step  1599: OL  853.4  219.3  OA  138.6   2.3 CL  138.6   2.3 nm  4.342 s
Step   402: OL  997.4  494.6  OA  129.3  38.5 CL  129.3  38.5 nm  0.067 s
Mean: 131.15 16.42 130.11  nm.

*** Simulation Finished at 2025/02/12 00:40:07 in nid008652. ***

Step  1446: OL  866.8  277.9  OA   94.8   1.1 CL   94.8   1.1 nm  0.076 s
Step   417: OL  980.3  515.5  OA  125.9  31.0 CL  125.9  31.0 nm  0.067 s
Step  1462: OL  881.6  279.4  OA   94.8  18.1 CL   94.8  18.1 nm  0.064 s
Step   432: OL  963.1  535.5  OA  131.7  52.7 CL  131.7  52.7 nm  0.068 s
[00;00m>>>>>>>>>>>>>>>>[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid008652/scheduler) failed: Invalid argument. 
/global/u2/b/bpeck/work/vismcao/maos -o studies/reduced_ngs/6_lgs/8mag_lgs/4750count -c master_files/reduced_ngs/6_lgs/8mag_lgs/kola_4750act.conf -O 
Output folder is 'studies/reduced_ngs/6_lgs/8mag_lgs/4750count'.
SRC: /global/homes/b/bpeck/code/maos v2.9 4c88b7c2 2024-11-13 16:45:33 -0800
BUILT: /global/homes/b/bpeck/code/maos/optim by GCC (v12) on 2024/11/18 09:40:03 CPU(F64,+O3) with CUDA(v122,F32)
Launched at 2025/02/12 00:40:09 in nid008652 with PID 780768.
The web based job monitor can be accessed at http://localhost:10300
Main config file is /global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/6_lgs/8mag_lgs/kola_4750act.conf
[00;00m[0;36mWarning(path.c:48): Path not found: path=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/6_lgs/8mag_lgs/bin; abspath=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/6_lgs/8mag_lgs/bin; Ignored.
[00;00m[0;36mWarning(path.c:48): Path not found: path=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/6_lgs/8mag_lgs/atm; abspath=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/6_lgs/8mag_lgs/atm; Ignored.
[00;00m[0;36mWarning(readcfg.c:399): sim.apfsm has been renamed to powfs.apfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.epfsm has been renamed to powfs.epfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.alfsm has been renamed to powfs.alfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.commonfsm has been renamed to powfs.commonfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.idealfsm has been renamed to powfs.idealfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.zetafsm has been renamed to powfs.zetafsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.f0fsm has been renamed to powfs.f0fsm.
[00;00m[0;36mWarning(readcfg.c:399): tsurf has been renamed to ncpa.tsurf.
loaded 132 (132 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_sim.conf'
loaded  19 ( 19 new) records from '/global/u2/b/bpeck/work/vismcao/./dm_none.conf'
loaded  19 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_ASM.conf'
loaded  19 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_DM2.conf'
loaded  19 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_DM3.conf'
loaded   0 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_dm_multiple.conf'
loaded   7 (  5 new) records from '/global/u2/b/bpeck/work/vismcao/./atm_mk13n50p_ground_detail.conf'
loaded  76 ( 69 new) records from '/global/homes/b/bpeck/code/maos/config/maos/powfs_common.conf'
loaded  44 ( 38 new) records from '/global/u2/b/bpeck/work/vismcao/./powfs_none.conf'
loaded  44 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_shwfs_lgs.conf'
loaded  44 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_shwfs_ttf_strap.conf'
loaded  44 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_shwfs_twfs_lbwfs.conf'
loaded   0 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_wfs_lgs_strap_lbwfs.conf'
loaded  71 ( 71 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_recon.conf'
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_smooth has been renamed to powfs0_llt.na_smooth.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_interp has been renamed to powfs0_llt.na_interp.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_thres has been renamed to powfs0_llt.na_thres.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_maxit has been renamed to powfs0_llt.na_fit_maxit.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_svdthres has been renamed to powfs0_llt.na_fit_svdthres.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_dh has been renamed to powfs0_llt.na_fit_dh.
[00;00m[0;36mWarning(readcfg.c:399): dbg.ncpa_preload has been renamed to ncpa.preload.
[00;00m[0;36mWarning(readcfg.c:399): dbg.ncpa_rmsci has been renamed to ncpa.rmsci.
[00;00m[0;36mWarning(readcfg.c:399): dbg.draw_opdmax has been renamed to plot.opdmax.
[00;00m[0;36mWarning(readcfg.c:399): dbg.draw_gmax has been renamed to plot.gmax.
loaded  95 ( 93 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_dbg.conf'
loaded   4 (  4 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_fit_mcao.conf'
[00;00m[0;36mWarning(readcfg.c:399): surf has been renamed to ncpa.surf.
loaded  39 (  7 new) records from '/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/6_lgs/8mag_lgs/kola_4750act.conf'
loaded   0 (  0 new) records from 'command line'
loaded  24 ( 18 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_llt_CL.conf'
Adjust LGS range by telescope altitude 4145m.
Zenith angle is 30 degree.
    Scaling turbulence height and LGS hs by sec(za).
    Scaling r0 by cos(za)^(3/5).
    Scaling wind speed and LGS signal level by cos(za).
powfs0: Adjusting dx from 0.0078125 to 0.00783333. 
powfs0.llt.fsm: f0=0 Hz, LPF ep=0
powfs0.epfsm is set to 0.517618 (auto)
powfs2: Adjusting dx from 0.03125 to 0.0312778. 
powfs2 is TWFS for powfs0
sim.ephi is set to 0.427717 (auto)
sim.eplo is set to 0.427717 (auto)
[00;00m[0;36mWarning(parms.c:2296): Layer 1 at 17.3205m is very close to layer 0 at 0m (OK).
[00;00m[0;36mWarning(parms.c:2296): Layer 2 at 34.641m is very close to layer 1 at 17.3205m (OK).
[00;00m[0;36mWarning(parms.c:2296): Layer 3 at 51.9615m is very close to layer 2 at 34.641m (OK).
dm 0: stroke=30 um is provided in micron.
dm 0: assume ia stroke=2 um is provided in micron.
dm 1: stroke=7 um is provided in micron.
dm 1: assume ia stroke=2 um is provided in micron.
dm 2: stroke=7 um is provided in micron.
dm 2: assume ia stroke=2 um is provided in micron.
Focus blending is not implemented yet for integrated tomography
parms->sim.mffocus is reset to 0
There are 1 valid simulation seeds:  1
Output PSF for 1 directions
Used 449 of 456 supplied keys
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_flate" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_flatv" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_psx" is not recognized, value is [0 0 0 0]
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_psy" is not recognized, value is [0 0 0 0]
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_pupelong" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_raw" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_side" is not recognized, value is 4
[00;00mAperture[00;00m is 11 m with sampling 1/128 m
[00;00mTurbulence at 30 degree zenith angle:[00;00m r0=0.128424m, L0=30m, 14 layers.
    Greenwood freq is 25.1Hz, anisoplanatic angle is 1.58 as
    Sampled 8192x8192 at 1/128m. wind dir is randomized.
    layer 0: ht=      0 m, wt= 0.302, ws=  4.8 m/s
    layer 1: ht=     17 m, wt= 0.154, ws=  5.0 m/s
    layer 2: ht=     35 m, wt= 0.041, ws=  5.4 m/s
    layer 3: ht=     52 m, wt= 0.002, ws=  6.6 m/s
    layer 4: ht=    139 m, wt= 0.021, ws=  6.1 m/s
    layer 5: ht=    231 m, wt= 0.010, ws=  6.1 m/s
    layer 6: ht=    323 m, wt= 0.008, ws=  6.1 m/s
    layer 7: ht=    416 m, wt= 0.005, ws=  6.1 m/s
    layer 8: ht=    508 m, wt= 0.001, ws=  6.1 m/s
    layer 9: ht=    932 m, wt= 0.107, ws=  5.6 m/s
    layer 10: ht=   5022 m, wt= 0.144, ws= 11.1 m/s
    layer 11: ht=   9238 m, wt= 0.093, ws= 19.1 m/s
    layer 12: ht=  13856 m, wt= 0.075, ws=  8.2 m/s
    layer 13: ht=  22518 m, wt= 0.036, ws=  4.8 m/s
[00;00mReconstruction[00;00m: r0=0.128424m L0=30m. 14 layers. use cone coordinate.
    layer 0: ht=      0 m, wt= 0.302
    layer 1: ht=     17 m, wt= 0.154
    layer 2: ht=     35 m, wt= 0.041
    layer 3: ht=     52 m, wt= 0.002
    layer 4: ht=    139 m, wt= 0.021
    layer 5: ht=    231 m, wt= 0.010
    layer 6: ht=    323 m, wt= 0.008
    layer 7: ht=    416 m, wt= 0.005
    layer 8: ht=    508 m, wt= 0.001
    layer 9: ht=    932 m, wt= 0.107
    layer 10: ht=   5022 m, wt= 0.144
    layer 11: ht=   9238 m, wt= 0.093
    layer 12: ht=  13856 m, wt= 0.075
    layer 13: ht=  22518 m, wt= 0.036
[00;00mThere are 3 powfs[00;00m
  powfs0: Order 79, LGS at 99.1 km. Sampling 1/127.66 m. Thres 30%. [00;00mT/T is removed in right hand side in tomography.[00;00m
    CCD image is 25x25 @ 500x500 mas, blur 27% (sigma), 1500Hz, wvl: [ 5.89e-07]
    Gtilt in reconstruction. Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
  powfs1: Order  2, NGS at inf km. Sampling 1/16 m. Thres 30%. 
    Ztilt in reconstruction. Geomtric optics start at 2 with ztilt [00;00m(noisy)[00;00m
  powfs2: Order 20, NGS at inf km. Sampling 1/31.9716 m. Thres 50%. 
    CCD image is 4x4 @ 1500x1500 mas, blur 0% (sigma), 0.015Hz, wvl: [ 7.2e-07]
    Gtilt in reconstruction. Geomtric optics start at 50 with gtilt Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
[00;00mThere are 10 wfs[00;00m
    wfs 0: type 0, at (  30.00,    0.00) arcsec,  99 km, siglev is 23.8382 bkgrnd is 0.1
    wfs 1: type 0, at (  15.00,   25.98) arcsec,  99 km, siglev is 23.8382 bkgrnd is 0.1
    wfs 2: type 0, at ( -15.00,   25.98) arcsec,  99 km, siglev is 23.8382 bkgrnd is 0.1
    wfs 3: type 0, at ( -30.00,    0.00) arcsec,  99 km, siglev is 23.8382 bkgrnd is 0.1
    wfs 4: type 0, at ( -15.00,  -25.98) arcsec,  99 km, siglev is 23.8382 bkgrnd is 0.1
    wfs 5: type 0, at (  15.00,  -25.98) arcsec,  99 km, siglev is 23.8382 bkgrnd is 0.1
    wfs 6: type 1, at (   5.00,    8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 7: type 1, at ( -10.00,    0.00) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 8: type 1, at (   5.00,   -8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 9: type 2, at (   0.00,    0.00) arcsec, inf km, siglev is 4.1558e+06 bkgrnd is 0.001
[00;00mThere are 3 DMs[00;00m
  DM 0 at -0.1km, actuator pitch 0.141m, offset   0, with 30.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 1 at    6km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 2 at   10km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
[00;00mTomography[00;00m is using CG, with [00;00mFourer Domain[00;00m preconditioner, [00;00m12[00;00m iterations, integrated tomo.
[00;00mDM Fitting [00;00mis using CG, with [00;00mNo[00;00m preconditioner, [00;00m10[00;00m iterations
[00;00mThere are 9 fit directions[00;00m
    Fit 0: weight is 0.444, at (   0.00,    0.00) arcsec
    Fit 1: weight is 0.111, at (  15.00,    0.00) arcsec
    Fit 2: weight is 0.111, at (   0.00,   15.00) arcsec
    Fit 3: weight is 0.111, at ( -15.00,    0.00) arcsec
    Fit 4: weight is 0.111, at (   0.00,  -15.00) arcsec
    Fit 5: weight is 0.028, at (  15.00,   15.00) arcsec
    Fit 6: weight is 0.028, at ( -15.00,   15.00) arcsec
    Fit 7: weight is 0.028, at ( -15.00,  -15.00) arcsec
    Fit 8: weight is 0.028, at (  15.00,  -15.00) arcsec
[00;00mThere are 1 evaluation directions[00;00m at sampling 1/128 m.
    Evl 0: weight is 1.000, at (   0.00,    0.00) arcsec
[00;00mSimulation[00;00m start at step 0, end at step 1600, with time step 1/1500s, [00;00mclose loop[00;00m.
After setup_parms:	120.5 MiB.
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid008652/scheduler) failed: Invalid argument. 
CUDA: minimum memory requirement is 0.3GB
Step  1477: OL  892.2  278.6  OA   90.4  10.9 CL   90.4  10.9 nm  0.065 s
GPU 0 is NVIDIA A100-SXM4-80GB with arch 8.0, 78.6GB free, 79.0GB total device memory.
Using GPU 0
Use 1 GPUs for WFS Tomo Fit Evl

*** Preparation started at 2025/02/12 00:40:10 in nid008652. ***

Using OpenMP version 201511 with 128 threads
Reading aperture amplitude map from KECK.fits
Step   446: OL  948.0  553.8  OA  125.5  33.2 CL  125.5  33.2 nm  0.085 s
Step  1493: OL  898.3  275.2  OA   92.2   9.2 CL   92.2   9.2 nm  0.072 s
[00;00m[0;36mWarning(accphi.c:477): 108807 points not covered by input screen
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid008652/scheduler) failed: Invalid argument. 
Step   461: OL  935.0  573.4  OA  122.8  20.6 CL  122.8  20.6 nm  0.066 s
 ->maos.c:447->setup.c:148->aper.c:74->utils.c:478->accphi.c:478
iwvl 0: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 1: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 2: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 3: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 4: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 5: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 6: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 7: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 8: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
After setup_aper:	344.7 MiB.

[00;00mSetting up powfs 0 geom[00;00m

There are 18 points in each subaperture of 0.141m.
There are 3737 valid subaperture.

[00;00mSetting up powfs 1 geom[00;00m

There are 88 points in each subaperture of 5.5m.
There are 4 valid subaperture.

[00;00mSetting up powfs 2 geom[00;00m

There are 18 points in each subaperture of 0.563m.
There are 236 valid subaperture.
After setup_powfs_init:	441.5 MiB.

[00;00mSetting up reconstructor geometry.[00;00m

PLOC is 161x161, with sampling of 0.07m (square)
    DM 0: grid is 82 x 82
    DM 1: grid is 75 x 75
    DM 2: grid is 81 x 79
FLOC is 161x161, with sampling of 0.07m (not square)
Step  1509: OL  899.1  269.1  OA   91.1   9.2 CL   91.1   9.2 nm  0.062 s
Tomography grid is square:
    layer 0: xloc grid is 280 x 280, sampling is 0.070 m, 78400 points
    layer 1: xloc grid is 280 x 280, sampling is 0.070 m, 78400 points
    layer 2: xloc grid is 280 x 280, sampling is 0.070 m, 78400 points
    layer 3: xloc grid is 280 x 280, sampling is 0.070 m, 78400 points
    layer 4: xloc grid is 280 x 280, sampling is 0.070 m, 78400 points
    layer 5: xloc grid is 280 x 280, sampling is 0.070 m, 78400 points
    layer 6: xloc grid is 280 x 280, sampling is 0.070 m, 78400 points
    layer 7: xloc grid is 280 x 280, sampling is 0.070 m, 78400 points
    layer 8: xloc grid is 280 x 280, sampling is 0.070 m, 78400 points
    layer 9: xloc grid is 280 x 280, sampling is 0.070 m, 78400 points
    layer 10: xloc grid is 280 x 280, sampling is 0.067 m, 78400 points
    layer 11: xloc grid is 280 x 280, sampling is 0.064 m, 78400 points
    layer 12: xloc grid is 280 x 280, sampling is 0.061 m, 78400 points
[00;00m[0;36mWarning(map.c:195): ninx=280 is too small. need 281
[00;00m[0;36mWarning(map.c:200): niny=280 is too small. need 281
    layer 13: xloc grid is 280 x 280, sampling is 0.054 m, 78400 points
Step   475: OL  927.2  591.5  OA  128.1  36.5 CL  128.1  36.5 nm  0.068 s

[00;00mSetting up powfs 0 PO WFS[00;00m

OTF dimension is 36x36 (calculated)
There is no bias
Step  1520: OL  897.6  264.0  OA   92.4   9.1 CL   92.4   9.1 nm  0.063 s
Step   490: OL  924.2  610.2  OA  123.1  22.5 CL  123.1  22.5 nm  0.078 s
Uplink FWHM (illt 0, iwvl 0) is 0.581315"
Downlink FWHM (illt 0, iwvl 0) is 1.09963"
Step  1535: OL  892.7  255.6  OA   96.6  16.6 CL   96.6  16.6 nm  0.066 s
Step  1535 updated high order loop gain: 0.322
Generating matched filter for powfs 0
Step   505: OL  925.5  627.6  OA  122.1  17.6 CL  122.1  17.6 nm  0.067 s
Step   511 updated high order loop gain: 0.310
sa index   location       noise equivalent angle
     495: (  5.0,  -0.3) m, ( 65.70,  64.15) mas
     491: (  3.9,  -0.3) m, ( 69.57,  64.67) mas
     487: (  2.8,  -0.3) m, ( 75.24,  65.29) mas
     483: (  1.7,  -0.3) m, ( 81.84,  65.91) mas
     482: (  1.4,  -0.3) m, ( 83.63,  66.07) mas
     322: ( -0.6,  -1.7) m, ( 97.18,  68.45) mas
     479: ( -1.7,  -0.3) m, (105.05,  67.62) mas
     475: ( -2.8,  -0.3) m, (113.81,  68.13) mas
     471: ( -3.9,  -0.3) m, (123.27,  68.61) mas
     467: ( -5.0,  -0.3) m, (132.90,  69.05) mas
     466: ( -5.2,  -0.3) m, (135.30,  69.16) mas
sa index   location       noise equivalent angle
     807: (  3.0,   2.5) m, ( 67.23,  66.43) mas
     712: (  1.9,   1.7) m, ( 72.01,  69.62) mas
     642: (  1.4,   1.1) m, ( 80.09,  74.96) mas
     606: (  0.8,   0.8) m, ( 80.44,  75.86) mas
     604: ( -1.1,   0.8) m, ( 94.10,  77.14) mas
     387: ( -1.4,  -1.1) m, ( 92.59,  85.13) mas
     352: ( -1.7,  -1.4) m, (101.50,  90.75) mas
     216: ( -3.0,  -2.5) m, (104.71,  94.29) mas
     187: ( -3.3,  -2.8) m, (106.71,  96.17) mas
      33: ( -3.0,  -4.4) m, (104.28, 108.40) mas
sa index   location       noise equivalent angle
     929: (  0.6,   3.9) m, ( 64.73,  69.07) mas
     797: (  0.3,   2.5) m, ( 65.69,  76.12) mas
     769: (  0.3,   2.2) m, ( 65.82,  77.62) mas
     670: ( -0.3,   1.4) m, ( 69.74,  85.97) mas
     479: ( -1.7,  -0.3) m, ( 71.76,  94.46) mas
     323: ( -0.3,  -1.7) m, ( 71.14, 108.23) mas
     225: ( -0.6,  -2.5) m, ( 69.10, 110.95) mas
      89: ( -0.8,  -3.9) m, ( 70.15, 122.59) mas
      65: ( -0.8,  -4.1) m, ( 70.22, 124.99) mas
sa index   location       noise equivalent angle
     964: ( -2.8,   4.4) m, ( 64.37,  64.99) mas
     918: ( -2.5,   3.9) m, ( 64.96,  66.48) mas
     790: ( -1.7,   2.5) m, ( 67.39,  72.27) mas
     733: ( -1.4,   1.9) m, ( 70.57,  77.66) mas
     634: ( -0.8,   1.1) m, ( 70.85,  80.37) mas
     388: ( -1.1,  -1.1) m, ( 74.19,  99.70) mas
     360: (  0.6,  -1.4) m, ( 78.23,  97.43) mas
     261: (  1.1,  -2.2) m, ( 84.11, 107.25) mas
     204: (  1.4,  -2.8) m, ( 83.06, 107.89) mas
      76: (  2.2,  -4.1) m, ( 88.16, 118.79) mas
      30: (  2.5,  -4.7) m, ( 89.95, 123.38) mas
sa index   location       noise equivalent angle
     655: ( -4.4,   1.4) m, ( 66.98,  64.72) mas
     624: ( -3.6,   1.1) m, ( 70.34,  65.49) mas
     573: ( -1.9,   0.6) m, ( 82.19,  69.76) mas
     511: ( -1.7,   0.0) m, ( 81.41,  69.08) mas
     639: (  0.6,   1.1) m, ( 96.15,  67.50) mas
     450: (  1.4,  -0.6) m, (102.69,  72.03) mas
     395: (  2.5,  -1.1) m, (111.40,  74.65) mas
     370: (  3.3,  -1.4) m, (118.26,  76.12) mas
     339: (  4.1,  -1.7) m, (125.39,  77.63) mas
sa index   location       noise equivalent angle
     308: ( -4.4,  -1.7) m, ( 66.98,  64.72) mas
     345: ( -3.6,  -1.4) m, ( 70.34,  65.49) mas
     415: ( -1.9,  -0.8) m, ( 81.95,  69.43) mas
     479: ( -1.7,  -0.3) m, ( 81.41,  69.08) mas
     360: (  0.6,  -1.4) m, ( 96.17,  67.53) mas
     546: (  1.4,   0.3) m, (102.69,  72.03) mas
     612: (  2.5,   0.8) m, (111.40,  74.65) mas
     649: (  3.3,   1.1) m, (118.26,  76.12) mas
     686: (  4.1,   1.4) m, (125.39,  77.63) mas
sa index   location       noise equivalent angle
      11: ( -2.8,  -4.7) m, ( 64.37,  64.99) mas
      59: ( -2.5,  -4.1) m, ( 64.96,  66.48) mas
     193: ( -1.7,  -2.8) m, ( 67.39,  72.27) mas
     252: ( -1.4,  -2.2) m, ( 70.74,  77.93) mas
     355: ( -0.8,  -1.4) m, ( 70.90,  80.45) mas
     604: ( -1.1,   0.8) m, ( 73.40,  98.74) mas
     639: (  0.6,   1.1) m, ( 78.19,  97.38) mas
     742: (  1.1,   1.9) m, ( 83.82, 106.94) mas
     801: (  1.4,   2.5) m, ( 83.06, 107.89) mas
     935: (  2.2,   3.9) m, ( 88.16, 118.79) mas
     983: (  2.5,   4.4) m, ( 89.95, 123.38) mas
sa index   location       noise equivalent angle
      70: (  0.6,  -4.1) m, ( 64.73,  69.07) mas
     200: (  0.3,  -2.8) m, ( 65.69,  76.12) mas
     228: (  0.3,  -2.5) m, ( 65.82,  77.62) mas
     323: ( -0.3,  -1.7) m, ( 69.74,  85.97) mas
     511: ( -1.7,   0.0) m, ( 71.76,  94.46) mas
     670: ( -0.3,   1.4) m, ( 71.14, 108.23) mas
     766: ( -0.6,   2.2) m, ( 69.10, 110.95) mas
     901: ( -0.8,   3.6) m, ( 70.15, 122.59) mas
     924: ( -0.8,   3.9) m, ( 70.22, 124.99) mas
sa index   location       noise equivalent angle
     210: (  3.0,  -2.8) m, ( 67.23,  66.43) mas
     297: (  1.9,  -1.9) m, ( 72.01,  69.62) mas
     363: (  1.4,  -1.4) m, ( 80.09,  74.96) mas
     389: (  0.8,  -1.1) m, ( 81.12,  76.48) mas
     388: ( -1.1,  -1.1) m, ( 95.04,  77.94) mas
     603: ( -1.4,   0.8) m, ( 92.59,  85.13) mas
     631: ( -1.7,   1.1) m, (101.50,  90.75) mas
     757: ( -3.0,   2.2) m, (104.71,  94.29) mas
     784: ( -3.3,   2.5) m, (106.71,  96.17) mas
     940: ( -3.0,   4.1) m, (104.28, 108.40) mas

[00;00mSetting up powfs 2 PO WFS[00;00m

OTF dimension is 48x48 (calculated)
Step  1551: OL  885.0  245.2  OA   95.9   2.9 CL   95.9   2.9 nm  0.062 s
Step   520: OL  929.5  642.9  OA  122.5  20.8 CL  122.5  20.8 nm  0.067 s
Generating matched filter for powfs 2
Use sanea to derive neasim
Use sanea to derive neasim

[00;00mSetting up reconstructor[00;00m

Recon NEA: cmf(86.56) cmf(86.57) cmf(86.38) cmf(86.56) cmf(86.44) cmf(86.42) cmf(86.49) cmf(86.30) cmf(86.52) geom(0.31) geom(0.31) geom(0.31) mf(0.14)  mas
Setup or update control matrix parameters.
RRtwfs svd threshold is 1e-10
Step  1567: OL  876.3  234.9  OA   96.0   4.3 CL   96.0   4.3 nm  0.062 s
Step   535: OL  935.7  654.8  OA  121.2  10.1 CL  121.2  10.1 nm  0.066 s
Step  1583: OL  866.5  226.1  OA   95.7   3.3 CL   95.7   3.3 nm  0.069 s
Step   550: OL  945.1  663.0  OA  120.2  17.6 CL  120.2  17.6 nm  0.066 s
Step 1599: Output PSF
Step   565: OL  957.4  668.0  OA  119.5   8.7 CL  119.5   8.7 nm  0.066 s
Step   579: OL  970.6  670.3  OA  117.6   8.2 CL  117.6   8.2 nm  0.066 s
Step   594: OL  987.0  670.0  OA  116.3   9.8 CL  116.3   9.8 nm  0.078 s
Step   609: OL 1004.5  666.0  OA  116.2  13.3 CL  116.2  13.3 nm  0.067 s
Step   624: OL 1022.4  658.5  OA  123.0  13.1 CL  123.0  13.1 nm  0.066 s
Step   639: OL 1039.6  647.8  OA  120.6   2.0 CL  120.6   2.0 nm  0.068 s
Step  1599: OL  855.9  219.2  OA   99.9  14.8 CL   99.9  14.8 nm  5.436 s
Mean: 96.14 14.72 95.00  nm.

*** Simulation Finished at 2025/02/12 00:40:24 in nid008213. ***

Step   654: OL 1055.2  634.8  OA  121.5   5.2 CL  121.5   5.2 nm  0.067 s
[00;00m>>>>>>>>>>>>>>>>[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid008213/scheduler) failed: Invalid argument. 
/global/u2/b/bpeck/work/vismcao/maos -o studies/reduced_ngs/10_lgs/8mag_lgs/3000count -c master_files/reduced_ngs/10_lgs/8mag_lgs/kola_3000act.conf -O 
Output folder is 'studies/reduced_ngs/10_lgs/8mag_lgs/3000count'.
SRC: /global/homes/b/bpeck/code/maos v2.9 4c88b7c2 2024-11-13 16:45:33 -0800
BUILT: /global/homes/b/bpeck/code/maos/optim by GCC (v12) on 2024/11/18 09:40:03 CPU(F64,+O3) with CUDA(v122,F32)
Launched at 2025/02/12 00:40:25 in nid008213 with PID 715522.
The web based job monitor can be accessed at http://localhost:10300
Main config file is /global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/10_lgs/8mag_lgs/kola_3000act.conf
[00;00m[0;36mWarning(path.c:48): Path not found: path=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/10_lgs/8mag_lgs/bin; abspath=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/10_lgs/8mag_lgs/bin; Ignored.
[00;00m[0;36mWarning(path.c:48): Path not found: path=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/10_lgs/8mag_lgs/atm; abspath=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/10_lgs/8mag_lgs/atm; Ignored.
[00;00m[0;36mWarning(readcfg.c:399): sim.apfsm has been renamed to powfs.apfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.epfsm has been renamed to powfs.epfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.alfsm has been renamed to powfs.alfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.commonfsm has been renamed to powfs.commonfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.idealfsm has been renamed to powfs.idealfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.zetafsm has been renamed to powfs.zetafsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.f0fsm has been renamed to powfs.f0fsm.
[00;00m[0;36mWarning(readcfg.c:399): tsurf has been renamed to ncpa.tsurf.
loaded 132 (132 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_sim.conf'
loaded  19 ( 19 new) records from '/global/u2/b/bpeck/work/vismcao/./dm_none.conf'
loaded  19 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_ASM.conf'
loaded  19 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_DM2.conf'
loaded  19 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_DM3.conf'
loaded   0 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_dm_multiple.conf'
loaded   7 (  5 new) records from '/global/u2/b/bpeck/work/vismcao/./atm_mk13n50p_ground_detail.conf'
loaded  76 ( 69 new) records from '/global/homes/b/bpeck/code/maos/config/maos/powfs_common.conf'
loaded  44 ( 38 new) records from '/global/u2/b/bpeck/work/vismcao/./powfs_none.conf'
loaded  44 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_shwfs_lgs.conf'
loaded  44 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_shwfs_ttf_strap.conf'
loaded  44 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_shwfs_twfs_lbwfs.conf'
loaded   0 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_wfs_lgs_strap_lbwfs.conf'
loaded  71 ( 71 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_recon.conf'
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_smooth has been renamed to powfs0_llt.na_smooth.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_interp has been renamed to powfs0_llt.na_interp.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_thres has been renamed to powfs0_llt.na_thres.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_maxit has been renamed to powfs0_llt.na_fit_maxit.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_svdthres has been renamed to powfs0_llt.na_fit_svdthres.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_dh has been renamed to powfs0_llt.na_fit_dh.
[00;00m[0;36mWarning(readcfg.c:399): dbg.ncpa_preload has been renamed to ncpa.preload.
[00;00m[0;36mWarning(readcfg.c:399): dbg.ncpa_rmsci has been renamed to ncpa.rmsci.
[00;00m[0;36mWarning(readcfg.c:399): dbg.draw_opdmax has been renamed to plot.opdmax.
[00;00m[0;36mWarning(readcfg.c:399): dbg.draw_gmax has been renamed to plot.gmax.
loaded  95 ( 93 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_dbg.conf'
loaded   4 (  4 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_fit_mcao.conf'
[00;00m[0;36mWarning(readcfg.c:399): surf has been renamed to ncpa.surf.
loaded  39 (  7 new) records from '/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/10_lgs/8mag_lgs/kola_3000act.conf'
loaded   0 (  0 new) records from 'command line'
loaded  24 ( 18 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_llt_CL.conf'
Adjust LGS range by telescope altitude 4145m.
Zenith angle is 30 degree.
    Scaling turbulence height and LGS hs by sec(za).
    Scaling r0 by cos(za)^(3/5).
    Scaling wind speed and LGS signal level by cos(za).
powfs0: Adjusting dx from 0.0078125 to 0.00809091. 
powfs0.llt.fsm: f0=0 Hz, LPF ep=0
powfs0.epfsm is set to 0.517618 (auto)
powfs2: Adjusting dx from 0.03125 to 0.0312778. 
powfs2 is TWFS for powfs0
sim.ephi is set to 0.427717 (auto)
sim.eplo is set to 0.427717 (auto)
[00;00m[0;36mWarning(parms.c:2296): Layer 1 at 17.3205m is very close to layer 0 at 0m (OK).
[00;00m[0;36mWarning(parms.c:2296): Layer 2 at 34.641m is very close to layer 1 at 17.3205m (OK).
[00;00m[0;36mWarning(parms.c:2296): Layer 3 at 51.9615m is very close to layer 2 at 34.641m (OK).
dm 0: stroke=30 um is provided in micron.
dm 0: assume ia stroke=2 um is provided in micron.
dm 1: stroke=7 um is provided in micron.
dm 1: assume ia stroke=2 um is provided in micron.
dm 2: stroke=7 um is provided in micron.
dm 2: assume ia stroke=2 um is provided in micron.
Focus blending is not implemented yet for integrated tomography
parms->sim.mffocus is reset to 0
There are 1 valid simulation seeds:  1
Output PSF for 1 directions
Used 449 of 456 supplied keys
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_flate" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_flatv" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_psx" is not recognized, value is [0 0 0 0]
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_psy" is not recognized, value is [0 0 0 0]
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_pupelong" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_raw" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_side" is not recognized, value is 4
[00;00mAperture[00;00m is 11 m with sampling 1/128 m
[00;00mTurbulence at 30 degree zenith angle:[00;00m r0=0.128424m, L0=30m, 14 layers.
    Greenwood freq is 25.1Hz, anisoplanatic angle is 1.58 as
    Sampled 8192x8192 at 1/128m. wind dir is randomized.
    layer 0: ht=      0 m, wt= 0.302, ws=  4.8 m/s
    layer 1: ht=     17 m, wt= 0.154, ws=  5.0 m/s
    layer 2: ht=     35 m, wt= 0.041, ws=  5.4 m/s
    layer 3: ht=     52 m, wt= 0.002, ws=  6.6 m/s
    layer 4: ht=    139 m, wt= 0.021, ws=  6.1 m/s
    layer 5: ht=    231 m, wt= 0.010, ws=  6.1 m/s
    layer 6: ht=    323 m, wt= 0.008, ws=  6.1 m/s
    layer 7: ht=    416 m, wt= 0.005, ws=  6.1 m/s
    layer 8: ht=    508 m, wt= 0.001, ws=  6.1 m/s
    layer 9: ht=    932 m, wt= 0.107, ws=  5.6 m/s
    layer 10: ht=   5022 m, wt= 0.144, ws= 11.1 m/s
    layer 11: ht=   9238 m, wt= 0.093, ws= 19.1 m/s
    layer 12: ht=  13856 m, wt= 0.075, ws=  8.2 m/s
    layer 13: ht=  22518 m, wt= 0.036, ws=  4.8 m/s
[00;00mReconstruction[00;00m: r0=0.128424m L0=30m. 14 layers. use cone coordinate.
    layer 0: ht=      0 m, wt= 0.302
    layer 1: ht=     17 m, wt= 0.154
    layer 2: ht=     35 m, wt= 0.041
    layer 3: ht=     52 m, wt= 0.002
    layer 4: ht=    139 m, wt= 0.021
    layer 5: ht=    231 m, wt= 0.010
    layer 6: ht=    323 m, wt= 0.008
    layer 7: ht=    416 m, wt= 0.005
    layer 8: ht=    508 m, wt= 0.001
    layer 9: ht=    932 m, wt= 0.107
    layer 10: ht=   5022 m, wt= 0.144
    layer 11: ht=   9238 m, wt= 0.093
    layer 12: ht=  13856 m, wt= 0.075
    layer 13: ht=  22518 m, wt= 0.036
[00;00mThere are 3 powfs[00;00m
  powfs0: Order 62, LGS at 99.1 km. Sampling 1/123.596 m. Thres 30%. [00;00mT/T is removed in right hand side in tomography.[00;00m
    CCD image is 25x25 @ 500x500 mas, blur 27% (sigma), 1500Hz, wvl: [ 5.89e-07]
    Gtilt in reconstruction. Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
  powfs1: Order  2, NGS at inf km. Sampling 1/16 m. Thres 30%. 
    Ztilt in reconstruction. Geomtric optics start at 2 with ztilt [00;00m(noisy)[00;00m
  powfs2: Order 20, NGS at inf km. Sampling 1/31.9716 m. Thres 50%. 
    CCD image is 4x4 @ 1500x1500 mas, blur 0% (sigma), 0.015Hz, wvl: [ 7.2e-07]
    Gtilt in reconstruction. Geomtric optics start at 50 with gtilt Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
[00;00mThere are 14 wfs[00;00m
    wfs 0: type 0, at (  30.00,    0.00) arcsec,  99 km, siglev is 37.9899 bkgrnd is 0.1
    wfs 1: type 0, at (  24.27,   17.63) arcsec,  99 km, siglev is 37.9899 bkgrnd is 0.1
    wfs 2: type 0, at (   9.27,   28.53) arcsec,  99 km, siglev is 37.9899 bkgrnd is 0.1
    wfs 3: type 0, at (  -9.27,   28.53) arcsec,  99 km, siglev is 37.9899 bkgrnd is 0.1
    wfs 4: type 0, at ( -24.27,   17.63) arcsec,  99 km, siglev is 37.9899 bkgrnd is 0.1
    wfs 5: type 0, at ( -30.00,    0.00) arcsec,  99 km, siglev is 37.9899 bkgrnd is 0.1
    wfs 6: type 0, at ( -24.27,  -17.63) arcsec,  99 km, siglev is 37.9899 bkgrnd is 0.1
    wfs 7: type 0, at (  -9.27,  -28.53) arcsec,  99 km, siglev is 37.9899 bkgrnd is 0.1
    wfs 8: type 0, at (   9.27,  -28.53) arcsec,  99 km, siglev is 37.9899 bkgrnd is 0.1
    wfs 9: type 0, at (  24.27,  -17.63) arcsec,  99 km, siglev is 37.9899 bkgrnd is 0.1
    wfs 10: type 1, at (   5.00,    8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 11: type 1, at ( -10.00,    0.00) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 12: type 1, at (   5.00,   -8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 13: type 2, at (   0.00,    0.00) arcsec, inf km, siglev is 4.1558e+06 bkgrnd is 0.001
[00;00mThere are 3 DMs[00;00m
  DM 0 at -0.1km, actuator pitch 0.178m, offset   0, with 30.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 1 at    6km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 2 at   10km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
[00;00mTomography[00;00m is using CG, with [00;00mFourer Domain[00;00m preconditioner, [00;00m12[00;00m iterations, integrated tomo.
[00;00mDM Fitting [00;00mis using CG, with [00;00mNo[00;00m preconditioner, [00;00m10[00;00m iterations
[00;00mThere are 9 fit directions[00;00m
    Fit 0: weight is 0.444, at (   0.00,    0.00) arcsec
    Fit 1: weight is 0.111, at (  15.00,    0.00) arcsec
    Fit 2: weight is 0.111, at (   0.00,   15.00) arcsec
    Fit 3: weight is 0.111, at ( -15.00,    0.00) arcsec
    Fit 4: weight is 0.111, at (   0.00,  -15.00) arcsec
    Fit 5: weight is 0.028, at (  15.00,   15.00) arcsec
    Fit 6: weight is 0.028, at ( -15.00,   15.00) arcsec
    Fit 7: weight is 0.028, at ( -15.00,  -15.00) arcsec
    Fit 8: weight is 0.028, at (  15.00,  -15.00) arcsec
[00;00mThere are 1 evaluation directions[00;00m at sampling 1/128 m.
    Evl 0: weight is 1.000, at (   0.00,    0.00) arcsec
[00;00mSimulation[00;00m start at step 0, end at step 1600, with time step 1/1500s, [00;00mclose loop[00;00m.
After setup_parms:	120.5 MiB.
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid008213/scheduler) failed: Invalid argument. 
Step   669: OL 1069.2  619.9  OA  119.8   7.4 CL  119.8   7.4 nm  0.075 s
CUDA: minimum memory requirement is 0.4GB
GPU 0 is NVIDIA A100-SXM4-80GB with arch 8.0, 78.6GB free, 79.0GB total device memory.
Using GPU 0
Use 1 GPUs for WFS Tomo Fit Evl

*** Preparation started at 2025/02/12 00:40:26 in nid008213. ***

Using OpenMP version 201511 with 128 threads
Reading aperture amplitude map from KECK.fits
Step   684: OL 1082.2  604.3  OA  117.6  11.3 CL  117.6  11.3 nm  0.069 s
[00;00m[0;36mWarning(accphi.c:477): 108666 points not covered by input screen
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid008213/scheduler) failed: Invalid argument. 
Step   699: OL 1093.6  587.9  OA  119.6   4.0 CL  119.6   4.0 nm  0.065 s
 ->maos.c:447->setup.c:148->aper.c:74->utils.c:478->accphi.c:478
iwvl 0: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 1: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 2: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 3: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 4: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 5: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 6: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 7: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 8: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
After setup_aper:	344.7 MiB.

[00;00mSetting up powfs 0 geom[00;00m

There are 22 points in each subaperture of 0.178m.
There are 2360 valid subaperture.

[00;00mSetting up powfs 1 geom[00;00m

There are 88 points in each subaperture of 5.5m.
There are 4 valid subaperture.

[00;00mSetting up powfs 2 geom[00;00m

There are 18 points in each subaperture of 0.563m.
There are 236 valid subaperture.
After setup_powfs_init:	416.7 MiB.

[00;00mSetting up reconstructor geometry.[00;00m

PLOC is 127x127, with sampling of 0.09m (square)
    DM 0: grid is 67 x 67
    DM 1: grid is 75 x 75
    DM 2: grid is 81 x 79
FLOC is 127x127, with sampling of 0.09m (not square)
Tomography grid is square:
    layer 0: xloc grid is 224 x 224, sampling is 0.089 m, 50176 points
    layer 1: xloc grid is 224 x 224, sampling is 0.089 m, 50176 points
    layer 2: xloc grid is 224 x 224, sampling is 0.089 m, 50176 points
    layer 3: xloc grid is 224 x 224, sampling is 0.089 m, 50176 points
    layer 4: xloc grid is 224 x 224, sampling is 0.089 m, 50176 points
    layer 5: xloc grid is 224 x 224, sampling is 0.089 m, 50176 points
    layer 6: xloc grid is 224 x 224, sampling is 0.089 m, 50176 points
    layer 7: xloc grid is 224 x 224, sampling is 0.089 m, 50176 points
    layer 8: xloc grid is 224 x 224, sampling is 0.089 m, 50176 points
    layer 9: xloc grid is 224 x 224, sampling is 0.088 m, 50176 points
    layer 10: xloc grid is 224 x 224, sampling is 0.084 m, 50176 points
    layer 11: xloc grid is 224 x 224, sampling is 0.081 m, 50176 points
    layer 12: xloc grid is 224 x 224, sampling is 0.077 m, 50176 points
    layer 13: xloc grid is 224 x 224, sampling is 0.069 m, 50176 points
Step   714: OL 1101.9  570.0  OA  120.8   3.3 CL  120.8   3.3 nm  0.067 s

[00;00mSetting up powfs 0 PO WFS[00;00m

OTF dimension is 48x48 (calculated)
There is no bias
Step   729: OL 1106.2  551.4  OA  125.2   9.4 CL  125.2   9.4 nm  0.068 s
Step   744: OL 1106.6  532.9  OA  125.1  21.9 CL  125.1  21.9 nm  0.068 s
Step   759: OL 1103.1  515.0  OA  119.7  17.1 CL  119.7  17.1 nm  0.066 s
Step   767 updated high order loop gain: 0.288
Step   774: OL 1095.7  497.7  OA  123.7  14.6 CL  123.7  14.6 nm  0.069 s
Replacing HA by HA*fit->actextrap
Adding piston cr to fit matrix
Adding TT cr on upper DMs to fit matrix.
Before assembling fit matrix:	3643.2 MiB.
Building fit->FR
Step   789: OL 1084.0  480.9  OA  120.6  17.2 CL  120.6  17.2 nm  0.067 s
Step   804: OL 1068.4  464.1  OA  122.2  16.5 CL  122.2  16.5 nm  0.068 s
Step   819: OL 1050.0  447.4  OA  124.8   3.5 CL  124.8   3.5 nm  0.067 s
Building fit->FL
Adding tikhonov constraint of 1.0e-07 to FLM
The maximum eigen value is estimated to be around 3.5e-04
DM Fit number of Low rank terms: 16 in LHS
After assemble fit matrix:	4324.7 MiB.
After setup_recon:	4324.7 MiB.
Step   834: OL 1028.4  431.0  OA  122.7   2.5 CL  122.7   2.5 nm  0.065 s
Step   849: OL 1005.1  415.6  OA  122.1   6.3 CL  122.1   6.3 nm  0.070 s
GPU 0: mem used 1916 MB (wfs init)
GPU 0: mem used 2334 MB (recon init)
Step   864: OL  981.2  401.5  OA  119.8  10.4 CL  119.8  10.4 nm  0.067 s
GPU 0: mem used 2364 MB (perf init)
Step   878: OL  959.8  390.0  OA  117.9  12.6 CL  117.9  12.6 nm  0.075 s
Step   893: OL  937.6  379.5  OA  125.6  25.4 CL  125.6  25.4 nm  0.066 s
Step   907: OL  915.7  370.9  OA  120.6   5.7 CL  120.6   5.7 nm  0.065 s
Step   922: OL  891.5  363.5  OA  119.0   7.6 CL  119.0   7.6 nm  0.074 s
Step   937: OL  867.8  356.3  OA  125.4   2.3 CL  125.4   2.3 nm  0.066 s
Step   952: OL  845.1  349.1  OA  120.9   9.0 CL  120.9   9.0 nm  0.068 s
Uplink FWHM (illt 0, iwvl 0) is 0.580741"
Downlink FWHM (illt 0, iwvl 0) is 1.39318"
Generating matched filter for powfs 0
Step   967: OL  824.7  341.1  OA  122.8   8.7 CL  122.8   8.7 nm  0.079 s
Step   982: OL  807.4  332.0  OA  122.2  10.3 CL  122.2  10.3 nm  0.066 s
sa index   location       noise equivalent angle
    1838: (  4.9,  -0.2) m, (171.57, 164.44) mas
    1830: (  3.7,  -0.2) m, (184.57, 166.46) mas
    1822: (  2.6,  -0.2) m, (201.52, 169.12) mas
    1815: (  1.6,  -0.2) m, (217.69, 171.66) mas
    1813: (  1.3,  -0.2) m, (222.80, 172.45) mas
    1334: ( -0.5,  -1.3) m, (253.63, 181.08) mas
    1808: ( -1.8,  -0.2) m, (274.68, 180.73) mas
    1800: ( -2.9,  -0.2) m, (294.25, 183.67) mas
    1792: ( -4.0,  -0.2) m, (314.77, 186.51) mas
    1785: ( -5.0,  -0.2) m, (333.94, 188.95) mas
    1782: ( -5.4,  -0.2) m, (342.18, 189.95) mas
sa index   location       noise equivalent angle
    3714: (  2.6,   4.6) m, (163.89, 164.80) mas
    3406: (  2.0,   3.6) m, (168.40, 174.69) mas
    3147: (  1.6,   2.9) m, (173.03, 184.16) mas
    2749: (  1.1,   1.9) m, (183.99, 202.22) mas
    2413: (  0.6,   1.2) m, (186.38, 210.55) mas
    1459: (  0.8,  -1.1) m, (204.61, 265.15) mas
    1332: ( -0.8,  -1.3) m, (207.82, 254.88) mas
     996: ( -1.2,  -2.0) m, (216.09, 269.77) mas
     597: ( -1.8,  -3.0) m, (224.33, 287.51) mas
     336: ( -2.2,  -3.7) m, (232.14, 302.50) mas
      28: ( -2.7,  -4.7) m, (242.46, 323.00) mas
sa index   location       noise equivalent angle
    3685: ( -2.7,   4.6) m, (163.78, 164.63) mas
    3376: ( -2.2,   3.6) m, (168.40, 174.69) mas
    3123: ( -1.8,   2.9) m, (173.03, 184.16) mas
    2733: ( -1.2,   1.9) m, (182.79, 200.87) mas
    2403: ( -0.8,   1.2) m, (186.38, 210.55) mas
    1995: (  1.2,   0.2) m, (221.50, 235.03) mas
    1342: (  0.6,  -1.3) m, (207.82, 254.88) mas
    1012: (  1.1,  -2.0) m, (217.05, 270.88) mas
     621: (  1.6,  -3.0) m, (224.33, 287.51) mas
     366: (  2.0,  -3.7) m, (232.14, 302.50) mas
      57: (  2.6,  -4.7) m, (242.46, 323.00) mas
sa index   location       noise equivalent angle
    1843: ( -5.4,  -0.1) m, (164.71, 163.27) mas
    1847: ( -4.9,  -0.1) m, (172.80, 164.55) mas
    1855: ( -3.7,  -0.1) m, (186.25, 166.63) mas
    1863: ( -2.6,  -0.1) m, (203.64, 169.33) mas
    1871: ( -1.5,  -0.1) m, (222.79, 172.29) mas
    1340: (  0.4,  -1.3) m, (253.61, 181.06) mas
    1874: (  1.3,  -0.1) m, (268.50, 179.59) mas
    1877: (  1.8,  -0.1) m, (277.01, 180.86) mas
    1885: (  2.9,  -0.1) m, (296.66, 183.75) mas
    1893: (  4.0,  -0.1) m, (317.47, 186.57) mas
    1900: (  5.0,  -0.1) m, (336.73, 188.97) mas
sa index   location       noise equivalent angle
      28: ( -2.7,  -4.7) m, (163.73, 164.58) mas
     336: ( -2.2,  -3.7) m, (168.40, 174.69) mas
     597: ( -1.8,  -3.0) m, (173.03, 184.16) mas
     996: ( -1.2,  -2.0) m, (181.39, 199.83) mas
    1332: ( -0.8,  -1.3) m, (186.38, 210.55) mas
    2285: ( -0.9,   0.9) m, (203.50, 263.80) mas
    2413: (  0.6,   1.2) m, (207.82, 254.88) mas
    2749: (  1.1,   1.9) m, (219.26, 273.56) mas
    3147: (  1.6,   2.9) m, (224.33, 287.51) mas
    3406: (  2.0,   3.6) m, (232.14, 302.50) mas
    3714: (  2.6,   4.6) m, (242.70, 323.43) mas
sa index   location       noise equivalent angle
      57: (  2.6,  -4.7) m, (163.73, 164.58) mas
     366: (  2.0,  -3.7) m, (168.40, 174.69) mas
     621: (  1.6,  -3.0) m, (173.03, 184.16) mas
    1012: (  1.1,  -2.0) m, (182.16, 200.48) mas
    1342: (  0.6,  -1.3) m, (186.38, 210.55) mas
    2287: (  0.8,   0.9) m, (197.81, 257.76) mas
    2403: ( -0.8,   1.2) m, (207.82, 254.88) mas
    2733: ( -1.2,   1.9) m, (217.80, 271.46) mas
    3123: ( -1.8,   2.9) m, (224.33, 287.51) mas
    3376: ( -2.2,   3.6) m, (232.14, 302.50) mas
    3685: ( -2.7,   4.6) m, (242.54, 323.11) mas

[00;00mSetting up powfs 2 PO WFS[00;00m

OTF dimension is 48x48 (calculated)
Step   997: OL  792.4  321.8  OA  121.7  15.1 CL  121.7  15.1 nm  0.069 s
Generating matched filter for powfs 2
Use sanea to derive neasim
Use sanea to derive neasim

[00;00mSetting up reconstructor[00;00m

Recon NEA: cmf(224.82) cmf(226.07) cmf(226.38) cmf(225.37) cmf(226.36) cmf(226.04) geom(0.31) geom(0.31) geom(0.31) mf(0.14)  mas
Setup or update control matrix parameters.
RRtwfs svd threshold is 1e-10
Step  1012: OL  778.8  310.5  OA  124.7  15.2 CL  124.7  15.2 nm  0.067 s

*** Simulation started at 2025/02/12 00:40:50 in nid003544. ***

Running seed 1
Step  1023 updated high order loop gain: 0.276
GPU 0: mem used 2364 MB (wfs seeding)
Step  1026: OL  768.2  299.8  OA  124.9  18.1 CL  124.9  18.1 nm  0.077 s
Wind dir: 267.3 261.7 167.0 130.5 300.7  32.3 119.8 139.0 150.8 277.7 203.0 133.1  45.9 265.1 deg
Using /global/homes/b/bpeck/.aos/cache/atm/vonkarman_14_8192x8192_0.0078125_1115374592d.bin
After genatm:	4337.0 MiB.
Step  1041: OL  758.7  287.4  OA  121.0  10.6 CL  121.0  10.6 nm  0.066 s
Step  1056: OL  749.8  273.9  OA  129.5  35.4 CL  129.5  35.4 nm  0.066 s
Step  1071: OL  741.7  258.5  OA  125.8  23.3 CL  125.8  23.3 nm  0.075 s
Step  1086: OL  736.4  241.2  OA  125.4  28.3 CL  125.4  28.3 nm  0.066 s
Step  1101: OL  733.9  224.3  OA  122.5  19.2 CL  122.5  19.2 nm  0.065 s
Step  1116: OL  733.1  209.1  OA  119.9  10.9 CL  119.9  10.9 nm  0.065 s
Step  1131: OL  733.2  196.1  OA  122.1  34.9 CL  122.1  34.9 nm  0.069 s
Step  1146: OL  733.8  185.6  OA  112.6  22.3 CL  112.6  22.3 nm  0.066 s
Step  1160: OL  734.4  178.1  OA  113.6  18.0 CL  113.6  18.0 nm  0.067 s
Step     #  Open Loop  PR TT  On axis  PR TT  Field RMS PR TT     Timing 
Step     0: OL  884.6  248.3  OA  884.6 248.3 CL  884.6 248.3 nm  0.160 s
Step  1175: OL  735.3  172.6  OA  117.7  16.5 CL  117.7  16.5 nm  0.075 s
Step    20: OL  916.3  255.7  OA  112.1   4.5 CL  112.1   4.5 nm  0.049 s
Step  1190: OL  737.8  169.0  OA  118.1  14.5 CL  118.1  14.5 nm  0.067 s
Step    42: OL  950.8  260.7  OA  103.4  15.0 CL  103.4  15.0 nm  0.047 s
Step  1205: OL  741.4  166.1  OA  115.9   4.8 CL  115.9   4.8 nm  0.068 s
Step    64: OL  983.5  260.3  OA  104.8  13.5 CL  104.8  13.5 nm  0.047 s
Step  1220: OL  745.1  163.9  OA  119.1  22.2 CL  119.1  22.2 nm  0.065 s
Step    86: OL 1016.7  258.1  OA  108.5  15.0 CL  108.5  15.0 nm  0.045 s
Step   107: OL 1048.6  257.3  OA  105.9   9.7 CL  105.9   9.7 nm  0.045 s
Step  1235: OL  748.3  163.7  OA  117.3  13.1 CL  117.3  13.1 nm  0.063 s
Step   129: OL 1081.0  259.8  OA  109.2   9.5 CL  109.2   9.5 nm  0.047 s
Step  1250: OL  750.7  166.1  OA  118.7  20.1 CL  118.7  20.1 nm  0.075 s
Step   151: OL 1109.8  267.6  OA  104.9  16.3 CL  104.9  16.3 nm  0.053 s
Step  1265: OL  754.0  171.5  OA  116.1  16.3 CL  116.1  16.3 nm  0.067 s
Step   173: OL 1132.8  279.4  OA  107.0   8.7 CL  107.0   8.7 nm  0.046 s
Step  1279 updated high order loop gain: 0.267
Step  1280: OL  758.1  179.1  OA  116.8  34.8 CL  116.8  34.8 nm  0.076 s
Step   195: OL 1148.5  293.5  OA  104.6   7.3 CL  104.6   7.3 nm  0.047 s
Step  1295: OL  763.6  188.4  OA  110.8  10.0 CL  110.8  10.0 nm  0.069 s
Uplink FWHM (illt 0, iwvl 0) is 0.577526"
Downlink FWHM (illt 0, iwvl 0) is 1.12996"
Generating matched filter for powfs 0
Step   212: OL 1156.2  304.3  OA  101.4   6.4 CL  101.4   6.4 nm  0.048 s
Step  1310: OL  769.0  199.0  OA  115.1  11.3 CL  115.1  11.3 nm  0.066 s
Step   233: OL 1160.4  318.0  OA  103.1   9.8 CL  103.1   9.8 nm  0.048 s
Step  1325: OL  773.9  211.0  OA  116.3  25.6 CL  116.3  25.6 nm  0.072 s
sa index   location       noise equivalent angle
    1178: (  4.8,  -0.2) m, (113.97, 110.64) mas
    1172: (  3.7,  -0.2) m, (120.83, 111.85) mas
    1166: (  2.7,  -0.2) m, (132.45, 113.30) mas
    1160: (  1.6,  -0.2) m, (148.78, 114.57) mas
    1158: (  1.2,  -0.2) m, (154.66, 114.94) mas
     821: ( -0.5,  -1.4) m, (181.19, 119.19) mas
    1155: ( -1.8,  -0.2) m, (194.50, 117.62) mas
    1149: ( -2.8,  -0.2) m, (208.52, 118.57) mas
    1143: ( -3.9,  -0.2) m, (224.77, 119.55) mas
    1137: ( -5.0,  -0.2) m, (242.53, 120.51) mas
    1135: ( -5.3,  -0.2) m, (248.23, 120.82) mas
sa index   location       noise equivalent angle
    1858: (  3.2,   2.3) m, (116.99, 114.59) mas
    1713: (  2.5,   1.8) m, (123.03, 118.63) mas
    1446: (  1.2,   0.9) m, (138.04, 127.17) mas
    1398: (  1.1,   0.7) m, (141.17, 129.53) mas
    1395: ( -1.2,   0.7) m, (175.43, 130.09) mas
     918: ( -1.4,  -1.1) m, (175.35, 149.93) mas
     759: ( -2.1,  -1.6) m, (184.40, 157.25) mas
     650: ( -2.7,  -2.0) m, (190.95, 162.12) mas
     504: ( -3.4,  -2.5) m, (199.97, 169.42) mas
      66: ( -3.0,  -4.5) m, (194.61, 194.53) mas
sa index   location       noise equivalent angle
    2325: (  1.8,   4.5) m, (110.67, 114.05) mas
    2215: (  1.2,   3.9) m, (112.10, 117.71) mas
    1977: (  0.9,   2.8) m, (114.51, 126.82) mas
    1702: (  0.5,   1.8) m, (117.28, 141.09) mas
    1543: (  0.4,   1.2) m, (118.65, 150.16) mas
    1157: ( -1.4,  -0.2) m, (132.66, 172.56) mas
     821: ( -0.5,  -1.4) m, (126.00, 190.40) mas
     661: ( -0.7,  -2.0) m, (127.88, 197.77) mas
     385: ( -1.1,  -3.0) m, (131.75, 212.38) mas
     147: ( -1.4,  -4.1) m, (135.91, 228.24) mas
      11: ( -2.3,  -4.8) m, (145.91, 238.45) mas
sa index   location       noise equivalent angle
    2304: ( -2.0,   4.5) m, (110.71, 114.10) mas
    2200: ( -1.4,   3.9) m, (112.10, 117.71) mas
    1966: ( -1.1,   2.8) m, (114.51, 126.82) mas
    1695: ( -0.7,   1.8) m, (117.28, 141.09) mas
    1538: ( -0.5,   1.2) m, (118.65, 150.16) mas
    1158: (  1.2,  -0.2) m, (132.66, 172.56) mas
     826: (  0.4,  -1.4) m, (126.00, 190.40) mas
     668: (  0.5,  -2.0) m, (127.88, 197.77) mas
     396: (  0.9,  -3.0) m, (131.75, 212.38) mas
     162: (  1.2,  -4.1) m, (135.91, 228.24) mas
      26: (  2.1,  -4.8) m, (145.91, 238.45) mas
sa index   location       noise equivalent angle
    1994: ( -3.9,   3.0) m, (119.97, 118.54) mas
    1821: ( -3.4,   2.3) m, (116.99, 114.59) mas
    1684: ( -2.7,   1.8) m, (123.03, 118.63) mas
    1439: ( -1.4,   0.9) m, (138.04, 127.17) mas
    1395: ( -1.2,   0.7) m, (140.75, 129.13) mas
    1398: (  1.1,   0.7) m, (175.93, 130.55) mas
     925: (  1.2,  -1.1) m, (175.35, 149.93) mas
     782: (  2.0,  -1.6) m, (184.40, 157.25) mas
     679: (  2.5,  -2.0) m, (190.95, 162.12) mas
     541: (  3.2,  -2.5) m, (199.97, 169.42) mas
      99: (  2.8,  -4.5) m, (194.61, 194.53) mas
sa index   location       noise equivalent angle
    1137: ( -5.0,  -0.2) m, (113.97, 110.64) mas
    1143: ( -3.9,  -0.2) m, (120.83, 111.85) mas
    1149: ( -2.8,  -0.2) m, (132.45, 113.30) mas
    1155: ( -1.8,  -0.2) m, (148.78, 114.57) mas
    1157: ( -1.4,  -0.2) m, (154.66, 114.94) mas
     826: (  0.4,  -1.4) m, (181.18, 119.19) mas
    1160: (  1.6,  -0.2) m, (194.49, 117.62) mas
    1166: (  2.7,  -0.2) m, (208.52, 118.57) mas
    1172: (  3.7,  -0.2) m, (224.76, 119.55) mas
    1178: (  4.8,  -0.2) m, (242.53, 120.51) mas
    1180: (  5.2,  -0.2) m, (248.22, 120.82) mas
sa index   location       noise equivalent angle
     325: ( -3.9,  -3.2) m, (117.40, 115.86) mas
     504: ( -3.4,  -2.5) m, (116.99, 114.59) mas
     650: ( -2.7,  -2.0) m, (123.03, 118.63) mas
     918: ( -1.4,  -1.1) m, (138.04, 127.17) mas
     965: ( -1.2,  -0.9) m, (141.53, 129.93) mas
     968: (  1.1,  -0.9) m, (177.17, 131.85) mas
    1446: (  1.2,   0.9) m, (175.35, 149.93) mas
    1605: (  2.0,   1.4) m, (184.40, 157.25) mas
    1713: (  2.5,   1.8) m, (190.95, 162.12) mas
    1858: (  3.2,   2.3) m, (199.97, 169.42) mas
    2296: (  2.8,   4.3) m, (194.61, 194.53) mas
sa index   location       noise equivalent angle
      37: ( -2.0,  -4.6) m, (110.67, 114.05) mas
     147: ( -1.4,  -4.1) m, (112.10, 117.71) mas
     385: ( -1.1,  -3.0) m, (114.51, 126.82) mas
     661: ( -0.7,  -2.0) m, (117.28, 141.09) mas
     821: ( -0.5,  -1.4) m, (118.65, 150.16) mas
    1206: (  1.2,   0.0) m, (132.66, 172.56) mas
    1543: (  0.4,   1.2) m, (126.00, 190.40) mas
    1702: (  0.5,   1.8) m, (127.88, 197.77) mas
    1977: (  0.9,   2.8) m, (131.75, 212.37) mas
    2215: (  1.2,   3.9) m, (135.91, 228.23) mas
    2349: (  2.1,   4.6) m, (145.91, 238.44) mas
sa index   location       noise equivalent angle
      58: (  1.8,  -4.6) m, (110.67, 114.05) mas
     162: (  1.2,  -4.1) m, (112.10, 117.71) mas
     396: (  0.9,  -3.0) m, (114.51, 126.82) mas
     668: (  0.5,  -2.0) m, (117.28, 141.09) mas
     826: (  0.4,  -1.4) m, (118.65, 150.16) mas
    1205: ( -1.4,   0.0) m, (132.66, 172.56) mas
    1538: ( -0.5,   1.2) m, (126.00, 190.40) mas
    1695: ( -0.7,   1.8) m, (127.88, 197.77) mas
    1966: ( -1.1,   2.8) m, (131.75, 212.37) mas
    2200: ( -1.4,   3.9) m, (135.91, 228.23) mas
    2335: ( -2.3,   4.6) m, (145.91, 238.44) mas
sa index   location       noise equivalent angle
     541: (  3.2,  -2.5) m, (116.99, 114.59) mas
     679: (  2.5,  -2.0) m, (123.03, 118.63) mas
     925: (  1.2,  -1.1) m, (138.04, 127.17) mas
     968: (  1.1,  -0.9) m, (142.37, 130.69) mas
     965: ( -1.2,  -0.9) m, (176.23, 131.02) mas
    1439: ( -1.4,   0.9) m, (175.35, 149.93) mas
    1582: ( -2.1,   1.4) m, (184.40, 157.25) mas
    1684: ( -2.7,   1.8) m, (190.95, 162.12) mas
    1821: ( -3.4,   2.3) m, (199.97, 169.42) mas
    2263: ( -3.0,   4.3) m, (194.61, 194.53) mas

[00;00mSetting up powfs 2 PO WFS[00;00m

OTF dimension is 48x48 (calculated)
Step  1340: OL  780.2  224.3  OA  113.8  11.0 CL  113.8  11.0 nm  0.067 s
Step   255: OL 1157.2  333.4  OA  101.9  10.3 CL  101.9  10.3 nm  0.047 s
Step   255 updated high order loop gain: 0.375
Generating matched filter for powfs 2
Use sanea to derive neasim
Use sanea to derive neasim

[00;00mSetting up reconstructor[00;00m

Recon NEA: cmf(156.10) cmf(156.54) cmf(156.04) cmf(156.04) cmf(156.54) cmf(156.10) cmf(156.50) cmf(155.97) cmf(155.97) cmf(156.49) geom(0.31) geom(0.31) geom(0.31) mf(0.14)  mas
Setup or update control matrix parameters.
RRtwfs svd threshold is 1e-10
Step   272: OL 1147.3  345.7  OA  102.9   4.9 CL  102.9   4.9 nm  0.048 s
Step  1355: OL  788.5  237.9  OA  116.3  10.1 CL  116.3  10.1 nm  0.066 s
Step   294: OL 1127.6  362.8  OA  102.8  14.1 CL  102.8  14.1 nm  0.046 s
Step  1370: OL  798.7  249.8  OA  113.4  13.9 CL  113.4  13.9 nm  0.072 s
Step   315: OL 1104.8  381.9  OA  105.2  21.1 CL  105.2  21.1 nm  0.047 s
Step  1385: OL  810.0  259.2  OA  116.0   2.0 CL  116.0   2.0 nm  0.066 s
Step   336: OL 1078.5  403.8  OA  107.1   8.1 CL  107.1   8.1 nm  0.048 s
Step  1400: OL  823.0  266.3  OA  116.7  14.8 CL  116.7  14.8 nm  0.070 s
Step   358: OL 1051.1  431.7  OA  105.4   9.8 CL  105.4   9.8 nm  0.049 s
Step  1412: OL  834.3  270.4  OA  120.1  20.2 CL  120.1  20.2 nm  0.064 s
Step   380: OL 1026.0  463.0  OA  106.9   6.5 CL  106.9   6.5 nm  0.048 s
Step  1427: OL  849.4  274.2  OA  117.7   7.1 CL  117.7   7.1 nm  0.069 s
Step   401: OL 1004.1  493.4  OA  108.5  16.2 CL  108.5  16.2 nm  0.046 s
Step  1439: OL  860.9  276.7  OA  121.0  19.3 CL  121.0  19.3 nm  0.065 s
Step   422: OL  981.5  522.3  OA  108.9   8.6 CL  108.9   8.6 nm  0.044 s
Step  1453: OL  873.5  278.8  OA  117.8  24.7 CL  117.8  24.7 nm  0.067 s
Step   444: OL  958.0  551.4  OA  109.8  21.3 CL  109.8  21.3 nm  0.049 s
Step  1468: OL  885.3  279.4  OA  117.3   8.8 CL  117.3   8.8 nm  0.071 s
Step   466: OL  940.0  580.1  OA  104.8  11.0 CL  104.8  11.0 nm  0.046 s
Step  1483: OL  892.9  277.7  OA  120.7   9.5 CL  120.7   9.5 nm  0.066 s
Step   488: OL  932.2  608.0  OA  106.8  12.1 CL  106.8  12.1 nm  0.047 s
Step  1498: OL  895.8  273.6  OA  115.4  12.4 CL  115.4  12.4 nm  0.071 s
Step   509: OL  933.4  632.2  OA  109.9  17.0 CL  109.9  17.0 nm  0.047 s
Step  1513: OL  894.9  267.4  OA  115.4  13.7 CL  115.4  13.7 nm  0.066 s
Step   511 updated high order loop gain: 0.356
Step   530: OL  939.8  651.5  OA  108.0   9.9 CL  108.0   9.9 nm  0.046 s
Step  1528: OL  890.7  259.9  OA  112.3  16.6 CL  112.3  16.6 nm  0.066 s
Step  1535 updated high order loop gain: 0.264
Step   552: OL  951.9  664.1  OA  105.7  11.7 CL  105.7  11.7 nm  0.062 s
Step  1543: OL  883.6  250.6  OA  116.2  13.2 CL  116.2  13.2 nm  0.073 s
Step  1558: OL  875.4  240.6  OA  117.3   1.3 CL  117.3   1.3 nm  0.067 s
Step   573: OL  968.7  669.8  OA  105.5  12.7 CL  105.5  12.7 nm  0.048 s
Step   590: OL  985.5  670.7  OA  106.3  10.7 CL  106.3  10.7 nm  0.047 s
Step  1573: OL  867.2  231.4  OA  119.8   9.3 CL  119.8   9.3 nm  0.068 s
Step   610: OL 1007.5  665.8  OA  108.7  19.4 CL  108.7  19.4 nm  0.046 s
Step  1587: OL  858.7  224.4  OA  118.8   4.2 CL  118.8   4.2 nm  0.067 s
Step 1599: Output PSF
Step   631: OL 1031.3  654.1  OA  103.2   3.6 CL  103.2   3.6 nm  0.049 s
Step   653: OL 1054.0  636.0  OA  105.0   2.6 CL  105.0   2.6 nm  0.047 s
Step   674: OL 1072.7  614.8  OA  105.9   6.2 CL  105.9   6.2 nm  0.047 s
Step  1599: OL  850.8  219.4  OA  117.2   3.0 CL  117.2   3.0 nm  2.131 s
Mean: 120.80 19.08 119.29  nm.

*** Simulation Finished at 2025/02/12 00:41:33 in nid008236. ***

Step   696: OL 1090.1  591.5  OA  111.3   4.0 CL  111.3   4.0 nm  0.047 s
[00;00m>>>>>>>>>>>>>>>>[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid008236/scheduler) failed: Invalid argument. 
/global/u2/b/bpeck/work/vismcao/maos -o studies/reduced_ngs/7_lgs/8mag_lgs/4500count -c master_files/reduced_ngs/7_lgs/8mag_lgs/kola_4500act.conf -O 
Output folder is 'studies/reduced_ngs/7_lgs/8mag_lgs/4500count'.
SRC: /global/homes/b/bpeck/code/maos v2.9 4c88b7c2 2024-11-13 16:45:33 -0800
BUILT: /global/homes/b/bpeck/code/maos/optim by GCC (v12) on 2024/11/18 09:40:03 CPU(F64,+O3) with CUDA(v122,F32)
Launched at 2025/02/12 00:41:34 in nid008236 with PID 43097.
The web based job monitor can be accessed at http://localhost:10300
Main config file is /global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/7_lgs/8mag_lgs/kola_4500act.conf
[00;00m[0;36mWarning(path.c:48): Path not found: path=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/7_lgs/8mag_lgs/bin; abspath=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/7_lgs/8mag_lgs/bin; Ignored.
[00;00m[0;36mWarning(path.c:48): Path not found: path=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/7_lgs/8mag_lgs/atm; abspath=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/7_lgs/8mag_lgs/atm; Ignored.
[00;00m[0;36mWarning(readcfg.c:399): sim.apfsm has been renamed to powfs.apfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.epfsm has been renamed to powfs.epfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.alfsm has been renamed to powfs.alfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.commonfsm has been renamed to powfs.commonfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.idealfsm has been renamed to powfs.idealfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.zetafsm has been renamed to powfs.zetafsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.f0fsm has been renamed to powfs.f0fsm.
[00;00m[0;36mWarning(readcfg.c:399): tsurf has been renamed to ncpa.tsurf.
loaded 132 (132 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_sim.conf'
loaded  19 ( 19 new) records from '/global/u2/b/bpeck/work/vismcao/./dm_none.conf'
loaded  19 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_ASM.conf'
loaded  19 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_DM2.conf'
loaded  19 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_DM3.conf'
loaded   0 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_dm_multiple.conf'
loaded   7 (  5 new) records from '/global/u2/b/bpeck/work/vismcao/./atm_mk13n50p_ground_detail.conf'
loaded  76 ( 69 new) records from '/global/homes/b/bpeck/code/maos/config/maos/powfs_common.conf'
loaded  44 ( 38 new) records from '/global/u2/b/bpeck/work/vismcao/./powfs_none.conf'
loaded  44 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_shwfs_lgs.conf'
loaded  44 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_shwfs_ttf_strap.conf'
loaded  44 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_shwfs_twfs_lbwfs.conf'
loaded   0 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_wfs_lgs_strap_lbwfs.conf'
loaded  71 ( 71 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_recon.conf'
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_smooth has been renamed to powfs0_llt.na_smooth.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_interp has been renamed to powfs0_llt.na_interp.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_thres has been renamed to powfs0_llt.na_thres.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_maxit has been renamed to powfs0_llt.na_fit_maxit.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_svdthres has been renamed to powfs0_llt.na_fit_svdthres.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_dh has been renamed to powfs0_llt.na_fit_dh.
[00;00m[0;36mWarning(readcfg.c:399): dbg.ncpa_preload has been renamed to ncpa.preload.
[00;00m[0;36mWarning(readcfg.c:399): dbg.ncpa_rmsci has been renamed to ncpa.rmsci.
[00;00m[0;36mWarning(readcfg.c:399): dbg.draw_opdmax has been renamed to plot.opdmax.
[00;00m[0;36mWarning(readcfg.c:399): dbg.draw_gmax has been renamed to plot.gmax.
loaded  95 ( 93 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_dbg.conf'
loaded   4 (  4 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_fit_mcao.conf'
[00;00m[0;36mWarning(readcfg.c:399): surf has been renamed to ncpa.surf.
loaded  39 (  7 new) records from '/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/7_lgs/8mag_lgs/kola_4500act.conf'
loaded   0 (  0 new) records from 'command line'
loaded  24 ( 18 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_llt_CL.conf'
Step   718: OL 1101.8  565.2  OA  108.2   9.2 CL  108.2   9.2 nm  0.046 s
Adjust LGS range by telescope altitude 4145m.
Zenith angle is 30 degree.
    Scaling turbulence height and LGS hs by sec(za).
    Scaling r0 by cos(za)^(3/5).
    Scaling wind speed and LGS signal level by cos(za).
powfs0: Adjusting dx from 0.0078125 to 0.00805556. 
powfs0.llt.fsm: f0=0 Hz, LPF ep=0
powfs0.epfsm is set to 0.517618 (auto)
powfs2: Adjusting dx from 0.03125 to 0.0312778. 
powfs2 is TWFS for powfs0
sim.ephi is set to 0.427717 (auto)
sim.eplo is set to 0.427717 (auto)
[00;00m[0;36mWarning(parms.c:2296): Layer 1 at 17.3205m is very close to layer 0 at 0m (OK).
[00;00m[0;36mWarning(parms.c:2296): Layer 2 at 34.641m is very close to layer 1 at 17.3205m (OK).
[00;00m[0;36mWarning(parms.c:2296): Layer 3 at 51.9615m is very close to layer 2 at 34.641m (OK).
dm 0: stroke=30 um is provided in micron.
dm 0: assume ia stroke=2 um is provided in micron.
dm 1: stroke=7 um is provided in micron.
dm 1: assume ia stroke=2 um is provided in micron.
dm 2: stroke=7 um is provided in micron.
dm 2: assume ia stroke=2 um is provided in micron.
Focus blending is not implemented yet for integrated tomography
parms->sim.mffocus is reset to 0
There are 1 valid simulation seeds:  1
Output PSF for 1 directions
Used 449 of 456 supplied keys
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_flate" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_flatv" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_psx" is not recognized, value is [0 0 0 0]
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_psy" is not recognized, value is [0 0 0 0]
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_pupelong" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_raw" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_side" is not recognized, value is 4
[00;00mAperture[00;00m is 11 m with sampling 1/128 m
[00;00mTurbulence at 30 degree zenith angle:[00;00m r0=0.128424m, L0=30m, 14 layers.
    Greenwood freq is 25.1Hz, anisoplanatic angle is 1.58 as
    Sampled 8192x8192 at 1/128m. wind dir is randomized.
    layer 0: ht=      0 m, wt= 0.302, ws=  4.8 m/s
    layer 1: ht=     17 m, wt= 0.154, ws=  5.0 m/s
    layer 2: ht=     35 m, wt= 0.041, ws=  5.4 m/s
    layer 3: ht=     52 m, wt= 0.002, ws=  6.6 m/s
    layer 4: ht=    139 m, wt= 0.021, ws=  6.1 m/s
    layer 5: ht=    231 m, wt= 0.010, ws=  6.1 m/s
    layer 6: ht=    323 m, wt= 0.008, ws=  6.1 m/s
    layer 7: ht=    416 m, wt= 0.005, ws=  6.1 m/s
    layer 8: ht=    508 m, wt= 0.001, ws=  6.1 m/s
    layer 9: ht=    932 m, wt= 0.107, ws=  5.6 m/s
    layer 10: ht=   5022 m, wt= 0.144, ws= 11.1 m/s
    layer 11: ht=   9238 m, wt= 0.093, ws= 19.1 m/s
    layer 12: ht=  13856 m, wt= 0.075, ws=  8.2 m/s
    layer 13: ht=  22518 m, wt= 0.036, ws=  4.8 m/s
[00;00mReconstruction[00;00m: r0=0.128424m L0=30m. 14 layers. use cone coordinate.
    layer 0: ht=      0 m, wt= 0.302
    layer 1: ht=     17 m, wt= 0.154
    layer 2: ht=     35 m, wt= 0.041
    layer 3: ht=     52 m, wt= 0.002
    layer 4: ht=    139 m, wt= 0.021
    layer 5: ht=    231 m, wt= 0.010
    layer 6: ht=    323 m, wt= 0.008
    layer 7: ht=    416 m, wt= 0.005
    layer 8: ht=    508 m, wt= 0.001
    layer 9: ht=    932 m, wt= 0.107
    layer 10: ht=   5022 m, wt= 0.144
    layer 11: ht=   9238 m, wt= 0.093
    layer 12: ht=  13856 m, wt= 0.075
    layer 13: ht=  22518 m, wt= 0.036
[00;00mThere are 3 powfs[00;00m
  powfs0: Order 76, LGS at 99.1 km. Sampling 1/124.138 m. Thres 30%. [00;00mT/T is removed in right hand side in tomography.[00;00m
    CCD image is 25x25 @ 500x500 mas, blur 27% (sigma), 1500Hz, wvl: [ 5.89e-07]
    Gtilt in reconstruction. Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
  powfs1: Order  2, NGS at inf km. Sampling 1/16 m. Thres 30%. 
    Ztilt in reconstruction. Geomtric optics start at 2 with ztilt [00;00m(noisy)[00;00m
  powfs2: Order 20, NGS at inf km. Sampling 1/31.9716 m. Thres 50%. 
    CCD image is 4x4 @ 1500x1500 mas, blur 0% (sigma), 0.015Hz, wvl: [ 7.2e-07]
    Gtilt in reconstruction. Geomtric optics start at 50 with gtilt Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
[00;00mThere are 11 wfs[00;00m
    wfs 0: type 0, at (  30.00,    0.00) arcsec,  99 km, siglev is 25.21 bkgrnd is 0.1
    wfs 1: type 0, at (  18.70,   23.45) arcsec,  99 km, siglev is 25.21 bkgrnd is 0.1
    wfs 2: type 0, at (  -6.68,   29.25) arcsec,  99 km, siglev is 25.21 bkgrnd is 0.1
    wfs 3: type 0, at ( -27.03,   13.02) arcsec,  99 km, siglev is 25.21 bkgrnd is 0.1
    wfs 4: type 0, at ( -27.03,  -13.02) arcsec,  99 km, siglev is 25.21 bkgrnd is 0.1
    wfs 5: type 0, at (  -6.68,  -29.25) arcsec,  99 km, siglev is 25.21 bkgrnd is 0.1
    wfs 6: type 0, at (  18.70,  -23.45) arcsec,  99 km, siglev is 25.21 bkgrnd is 0.1
    wfs 7: type 1, at (   5.00,    8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 8: type 1, at ( -10.00,    0.00) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 9: type 1, at (   5.00,   -8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 10: type 2, at (   0.00,    0.00) arcsec, inf km, siglev is 4.1558e+06 bkgrnd is 0.001
[00;00mThere are 3 DMs[00;00m
  DM 0 at -0.1km, actuator pitch 0.145m, offset   0, with 30.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 1 at    6km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 2 at   10km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
[00;00mTomography[00;00m is using CG, with [00;00mFourer Domain[00;00m preconditioner, [00;00m12[00;00m iterations, integrated tomo.
[00;00mDM Fitting [00;00mis using CG, with [00;00mNo[00;00m preconditioner, [00;00m10[00;00m iterations
[00;00mThere are 9 fit directions[00;00m
    Fit 0: weight is 0.444, at (   0.00,    0.00) arcsec
    Fit 1: weight is 0.111, at (  15.00,    0.00) arcsec
    Fit 2: weight is 0.111, at (   0.00,   15.00) arcsec
    Fit 3: weight is 0.111, at ( -15.00,    0.00) arcsec
    Fit 4: weight is 0.111, at (   0.00,  -15.00) arcsec
    Fit 5: weight is 0.028, at (  15.00,   15.00) arcsec
    Fit 6: weight is 0.028, at ( -15.00,   15.00) arcsec
    Fit 7: weight is 0.028, at ( -15.00,  -15.00) arcsec
    Fit 8: weight is 0.028, at (  15.00,  -15.00) arcsec
[00;00mThere are 1 evaluation directions[00;00m at sampling 1/128 m.
    Evl 0: weight is 1.000, at (   0.00,    0.00) arcsec
[00;00mSimulation[00;00m start at step 0, end at step 1600, with time step 1/1500s, [00;00mclose loop[00;00m.
After setup_parms:	120.5 MiB.
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid008236/scheduler) failed: Invalid argument. 
CUDA: minimum memory requirement is 0.3GB
GPU 0 is NVIDIA A100-SXM4-80GB with arch 8.0, 78.6GB free, 79.0GB total device memory.
Using GPU 0
Use 1 GPUs for WFS Tomo Fit Evl

*** Preparation started at 2025/02/12 00:41:35 in nid008236. ***

Using OpenMP version 201511 with 128 threads
Reading aperture amplitude map from KECK.fits
Step   740: OL 1105.1  538.0  OA  111.0  17.9 CL  111.0  17.9 nm  0.047 s
Step   761: OL 1100.4  512.7  OA  105.9   3.1 CL  105.9   3.1 nm  0.049 s
Step   767 updated high order loop gain: 0.351
[00;00m[0;36mWarning(accphi.c:477): 108653 points not covered by input screen
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid008236/scheduler) failed: Invalid argument. 
Step   782: OL 1088.2  488.8  OA  108.6   8.0 CL  108.6   8.0 nm  0.047 s
 ->maos.c:447->setup.c:148->aper.c:74->utils.c:478->accphi.c:478
iwvl 0: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 1: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 2: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 3: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 4: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 5: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 6: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 7: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 8: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
After setup_aper:	344.6 MiB.

[00;00mSetting up powfs 0 geom[00;00m

There are 18 points in each subaperture of 0.145m.
There are 3550 valid subaperture.

[00;00mSetting up powfs 1 geom[00;00m

There are 88 points in each subaperture of 5.5m.
There are 4 valid subaperture.

[00;00mSetting up powfs 2 geom[00;00m

There are 18 points in each subaperture of 0.563m.
There are 236 valid subaperture.
After setup_powfs_init:	420.2 MiB.

[00;00mSetting up reconstructor geometry.[00;00m

PLOC is 155x155, with sampling of 0.07m (square)
    DM 0: grid is 81 x 81
    DM 1: grid is 75 x 75
    DM 2: grid is 80 x 79
FLOC is 155x155, with sampling of 0.07m (not square)
Tomography grid is square:
    layer 0: xloc grid is 280 x 280, sampling is 0.072 m, 78400 points
    layer 1: xloc grid is 280 x 280, sampling is 0.072 m, 78400 points
    layer 2: xloc grid is 280 x 280, sampling is 0.072 m, 78400 points
    layer 3: xloc grid is 280 x 280, sampling is 0.072 m, 78400 points
    layer 4: xloc grid is 280 x 280, sampling is 0.072 m, 78400 points
    layer 5: xloc grid is 280 x 280, sampling is 0.072 m, 78400 points
    layer 6: xloc grid is 280 x 280, sampling is 0.072 m, 78400 points
    layer 7: xloc grid is 280 x 280, sampling is 0.072 m, 78400 points
    layer 8: xloc grid is 280 x 280, sampling is 0.072 m, 78400 points
    layer 9: xloc grid is 280 x 280, sampling is 0.072 m, 78400 points
    layer 10: xloc grid is 280 x 280, sampling is 0.069 m, 78400 points
    layer 11: xloc grid is 280 x 280, sampling is 0.066 m, 78400 points
    layer 12: xloc grid is 280 x 280, sampling is 0.062 m, 78400 points
    layer 13: xloc grid is 280 x 280, sampling is 0.056 m, 78400 points
Step   804: OL 1066.8  464.2  OA  107.7  10.4 CL  107.7  10.4 nm  0.049 s

[00;00mSetting up powfs 0 PO WFS[00;00m

OTF dimension is 36x36 (calculated)
There is no bias
Step   826: OL 1038.8  439.7  OA  109.5  19.7 CL  109.5  19.7 nm  0.047 s
Step   847: OL 1006.9  417.6  OA  107.5  19.8 CL  107.5  19.8 nm  0.047 s
Replacing HA by HA*fit->actextrap
Adding piston cr to fit matrix
Adding TT cr on upper DMs to fit matrix.
Before assembling fit matrix:	4654.7 MiB.
Building fit->FR
Step   869: OL  972.4  397.2  OA  105.8  10.7 CL  105.8  10.7 nm  0.043 s
Step   891: OL  939.7  380.8  OA  105.8   7.3 CL  105.8   7.3 nm  0.049 s
Step   908: OL  913.1  370.4  OA  106.2  12.1 CL  106.2  12.1 nm  0.045 s
Step   929: OL  879.4  360.2  OA  107.3   4.4 CL  107.3   4.4 nm  0.049 s
Step   951: OL  846.0  349.7  OA  108.6   5.3 CL  108.6   5.3 nm  0.044 s
Step   973: OL  817.5  337.7  OA  107.2  10.5 CL  107.2  10.5 nm  0.048 s
Building fit->FL
Step   995: OL  795.2  323.3  OA  106.6   7.0 CL  106.6   7.0 nm  0.049 s
Adding tikhonov constraint of 1.0e-07 to FLM
The maximum eigen value is estimated to be around 3.0e-04
DM Fit number of Low rank terms: 16 in LHS
After assemble fit matrix:	6074.9 MiB.
After setup_recon:	6074.9 MiB.
Step  1017: OL  776.4  306.8  OA  109.9   9.1 CL  109.9   9.1 nm  0.048 s
Step  1023 updated high order loop gain: 0.346
Step  1038: OL  762.6  290.1  OA  109.6  13.2 CL  109.6  13.2 nm  0.047 s
Step  1060: OL  750.2  270.1  OA  107.6  16.5 CL  107.6  16.5 nm  0.046 s
Step  1082: OL  741.3  246.0  OA  108.5   9.6 CL  108.5   9.6 nm  0.048 s
GPU 0: mem used 2134 MB (wfs init)
Step  1104: OL  737.9  221.2  OA  108.5  12.6 CL  108.5  12.6 nm  0.044 s
Replacing HA by HA*fit->actextrap
Adding piston cr to fit matrix
Adding TT cr on upper DMs to fit matrix.
Before assembling fit matrix:	4601.3 MiB.
Building fit->FR
GPU 0: mem used 2976 MB (recon init)
Step  1126: OL  738.0  200.2  OA  106.4  23.2 CL  106.4  23.2 nm  0.046 s
GPU 0: mem used 3008 MB (perf init)
Step  1147: OL  739.0  185.2  OA  104.0  18.5 CL  104.0  18.5 nm  0.049 s
Step  1169: OL  740.0  174.7  OA  106.6  23.3 CL  106.6  23.3 nm  0.046 s
Step  1190: OL  743.0  169.2  OA  106.0  23.7 CL  106.0  23.7 nm  0.051 s
Step  1212: OL  747.5  165.1  OA  108.5  23.9 CL  108.5  23.9 nm  0.047 s
Step  1233: OL  751.2  163.8  OA  107.5  20.3 CL  107.5  20.3 nm  0.049 s
Step  1254: OL  753.4  167.5  OA  104.6  19.7 CL  104.6  19.7 nm  0.049 s
Step  1276: OL  757.2  177.1  OA  104.4  20.4 CL  104.4  20.4 nm  0.046 s
Step  1279 updated high order loop gain: 0.340
Step  1298: OL  763.6  190.5  OA  110.7  30.4 CL  110.7  30.4 nm  0.047 s
Building fit->FL
Step  1320: OL  770.0  206.9  OA  109.2  27.2 CL  109.2  27.2 nm  0.051 s
Adding tikhonov constraint of 1.0e-07 to FLM
The maximum eigen value is estimated to be around 2.6e-04
DM Fit number of Low rank terms: 16 in LHS
After assemble fit matrix:	6554.9 MiB.
After setup_recon:	6554.9 MiB.

*** Simulation started at 2025/02/12 00:42:04 in nid008213. ***

Running seed 1
Step  1342: OL  778.0  226.2  OA  105.0  19.5 CL  105.0  19.5 nm  0.047 s
GPU 0: mem used 3010 MB (wfs seeding)
Wind dir: 267.3 261.7 167.0 130.5 300.7  32.3 119.8 139.0 150.8 277.7 203.0 133.1  45.9 265.1 deg
Using /global/homes/b/bpeck/.aos/cache/atm/vonkarman_14_8192x8192_0.0078125_1115374592d.bin
After genatm:	5896.3 MiB.
Step  1364: OL  790.9  245.5  OA  104.3  19.0 CL  104.3  19.0 nm  0.046 s
GPU 0: mem used 1398 MB (wfs init)
Step  1386: OL  806.9  259.8  OA  105.2  20.9 CL  105.2  20.9 nm  0.046 s
GPU 0: mem used 2658 MB (recon init)
Step  1408: OL  826.5  269.2  OA  107.1  19.7 CL  107.1  19.7 nm  0.047 s
GPU 0: mem used 2688 MB (perf init)
Step  1430: OL  848.5  274.9  OA  106.5  21.8 CL  106.5  21.8 nm  0.047 s
Step  1452: OL  869.2  278.8  OA  106.3  24.0 CL  106.3  24.0 nm  0.051 s
Step  1473: OL  885.6  279.2  OA  105.5  16.3 CL  105.5  16.3 nm  0.049 s
Step  1494: OL  893.0  275.0  OA  104.1   3.2 CL  104.1   3.2 nm  0.049 s
Step     #  Open Loop  PR TT  On axis  PR TT  Field RMS PR TT     Timing 
Step     0: OL  884.6  248.3  OA  884.6 248.3 CL  884.6 248.3 nm  0.418 s
Step  1516: OL  892.8  266.0  OA  104.0   9.9 CL  104.0   9.9 nm  0.046 s
Step    12: OL  903.2  253.0  OA  122.6  34.0 CL  122.6  34.0 nm  0.062 s
Step  1534: OL  887.3  256.3  OA  102.2   6.0 CL  102.2   6.0 nm  0.047 s
Step  1535 updated high order loop gain: 0.339
Step    28: OL  928.3  258.2  OA  103.0   9.6 CL  103.0   9.6 nm  0.066 s
Uplink FWHM (illt 0, iwvl 0) is 0.578619"
Downlink FWHM (illt 0, iwvl 0) is 1.36259"
Step  1554: OL  878.2  243.3  OA  106.3   6.2 CL  106.3   6.2 nm  0.047 s
Generating matched filter for powfs 0
Step    43: OL  951.2  260.8  OA  104.7   4.6 CL  104.7   4.6 nm  0.068 s
Step  1575: OL  867.6  230.3  OA  109.5   4.5 CL  109.5   4.5 nm  0.046 s
Step    57: OL  971.8  261.0  OA  101.9  11.8 CL  101.9  11.8 nm  0.074 s
Step  1597: OL  854.3  220.1  OA  107.4   7.5 CL  107.4   7.5 nm  0.044 s
Step 1599: Output PSF
sa index   location       noise equivalent angle
    1772: (  4.8,  -0.1) m, (163.86, 156.99) mas
    1765: (  3.8,  -0.1) m, (174.59, 158.80) mas
    1757: (  2.6,  -0.1) m, (189.93, 161.43) mas
    1750: (  1.6,  -0.1) m, (204.25, 163.92) mas
    1748: (  1.3,  -0.1) m, (208.45, 164.66) mas
    1277: ( -0.6,  -1.3) m, (237.65, 173.38) mas
    1743: ( -1.7,  -0.1) m, (254.72, 172.33) mas
    1735: ( -2.9,  -0.1) m, (274.79, 175.12) mas
    1728: ( -3.9,  -0.1) m, (294.01, 177.49) mas
    1720: ( -5.1,  -0.1) m, (318.65, 180.12) mas
    1718: ( -5.4,  -0.1) m, (324.60, 180.70) mas
sa index   location       noise equivalent angle
    3294: (  2.9,   3.8) m, (159.83, 160.83) mas
    3205: (  2.8,   3.5) m, (160.68, 162.62) mas
    2943: (  2.2,   2.8) m, (166.22, 170.17) mas
    2346: (  1.0,   1.3) m, (180.59, 189.15) mas
    2214: (  0.7,   1.0) m, (184.55, 193.46) mas
    1985: ( -1.3,   0.4) m, (214.12, 204.36) mas
    1208: ( -1.2,  -1.4) m, (213.75, 233.80) mas
     886: ( -1.7,  -2.2) m, (223.59, 246.95) mas
     610: ( -2.3,  -2.9) m, (233.76, 260.57) mas
     348: ( -2.9,  -3.6) m, (243.77, 273.92) mas
     170: ( -3.0,  -4.2) m, (247.40, 286.11) mas
sa index   location       noise equivalent angle
    3519: ( -1.2,   4.6) m, (167.56, 174.91) mas
    3355: ( -1.0,   4.1) m, (158.22, 167.75) mas
    3180: ( -0.9,   3.5) m, (160.00, 175.53) mas
    2708: ( -0.6,   2.2) m, (163.99, 192.67) mas
    2336: ( -0.4,   1.3) m, (166.91, 205.84) mas
    1451: ( -1.2,  -0.9) m, (170.12, 237.78) mas
    1088: (  0.3,  -1.7) m, (178.38, 254.01) mas
     845: (  0.4,  -2.3) m, (180.39, 263.12) mas
     373: (  0.7,  -3.6) m, (185.31, 289.26) mas
     197: (  0.9,  -4.2) m, (187.42, 300.67) mas
      34: (  2.0,  -4.8) m, (199.27, 317.32) mas
sa index   location       noise equivalent angle
    2567: ( -4.2,   1.9) m, (164.02, 158.89) mas
    2256: ( -2.6,   1.2) m, (183.23, 166.39) mas
    2095: ( -1.7,   0.7) m, (208.15, 183.41) mas
    2041: ( -1.4,   0.6) m, (199.70, 173.67) mas
    2158: (  0.9,   0.9) m, (234.93, 176.34) mas
    1512: (  1.3,  -0.7) m, (244.92, 192.37) mas
    1458: (  1.6,  -0.9) m, (265.00, 207.17) mas
    1235: (  2.8,  -1.4) m, (271.69, 203.28) mas
     986: (  4.1,  -2.0) m, (298.47, 212.94) mas
    1655: (  5.2,  -0.4) m, (318.90, 195.60) mas
sa index   location       noise equivalent angle
     989: ( -4.6,  -1.9) m, (172.35, 171.94) mas
     929: ( -4.2,  -2.0) m, (164.02, 158.89) mas
    1263: ( -2.6,  -1.3) m, (183.23, 166.39) mas
    1447: ( -1.7,  -0.9) m, (205.50, 180.08) mas
    1507: ( -1.4,  -0.7) m, (199.70, 173.66) mas
    1399: (  0.9,  -1.0) m, (235.49, 177.01) mas
    2046: (  1.3,   0.6) m, (244.92, 192.37) mas
    2106: (  1.6,   0.7) m, (267.88, 211.01) mas
    2358: (  2.8,   1.3) m, (271.69, 203.28) mas
    2624: (  4.1,   1.9) m, (298.47, 212.94) mas
    1955: (  5.2,   0.3) m, (318.90, 195.60) mas
sa index   location       noise equivalent angle
      20: ( -1.2,  -4.8) m, (162.23, 169.03) mas
     184: ( -1.0,  -4.2) m, (158.22, 167.75) mas
     362: ( -0.9,  -3.6) m, (160.00, 175.53) mas
     838: ( -0.6,  -2.3) m, (163.99, 192.67) mas
    1213: ( -0.4,  -1.4) m, (166.91, 205.84) mas
    2099: ( -1.2,   0.7) m, (170.06, 237.74) mas
    2471: (  0.3,   1.6) m, (178.38, 254.01) mas
    2715: (  0.4,   2.2) m, (180.39, 263.12) mas
    3191: (  0.7,   3.5) m, (185.31, 289.26) mas
    3368: (  0.9,   4.1) m, (187.42, 300.67) mas
    3533: (  2.0,   4.6) m, (199.70, 317.74) mas
sa index   location       noise equivalent angle
     299: (  2.9,  -3.9) m, (159.83, 160.83) mas
     387: (  2.8,  -3.6) m, (161.04, 162.97) mas
     641: (  2.2,  -2.9) m, (166.22, 170.17) mas
    1223: (  1.0,  -1.4) m, (180.59, 189.15) mas
    1343: (  0.7,  -1.2) m, (184.55, 193.47) mas
    1567: ( -1.3,  -0.6) m, (214.49, 204.67) mas
    2331: ( -1.2,   1.3) m, (213.75, 233.80) mas
    2644: ( -1.7,   2.0) m, (223.59, 246.95) mas
    2912: ( -2.3,   2.8) m, (233.76, 260.57) mas
    3166: ( -2.9,   3.5) m, (243.62, 273.77) mas
    3341: ( -3.0,   4.1) m, (247.40, 286.11) mas

[00;00mSetting up powfs 2 PO WFS[00;00m

OTF dimension is 48x48 (calculated)
Step    72: OL  994.3  259.6  OA  101.0  18.3 CL  101.0  18.3 nm  0.067 s
Generating matched filter for powfs 2
Use sanea to derive neasim
Use sanea to derive neasim

[00;00mSetting up reconstructor[00;00m

Recon NEA: cmf(212.87) cmf(213.97) cmf(212.64) cmf(213.23) cmf(213.19) cmf(212.56) cmf(213.91) geom(0.31) geom(0.31) geom(0.31) mf(0.14)  mas
Setup or update control matrix parameters.
RRtwfs svd threshold is 1e-10
Step  1599: OL  853.0  219.3  OA  107.2  14.0 CL  107.2  14.0 nm  1.455 s
Step    86: OL 1015.7  258.2  OA  101.8  13.2 CL  101.8  13.2 nm  0.073 s
Mean: 106.99 15.40 105.87  nm.

*** Simulation Finished at 2025/02/12 00:42:18 in nid003544. ***

Step   101: OL 1038.7  257.5  OA  101.9  13.1 CL  101.9  13.1 nm  0.069 s
[00;00m>>>>>>>>>>>>>>>>[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid003544/scheduler) failed: Invalid argument. 
/global/u2/b/bpeck/work/vismcao/maos -o studies/reduced_ngs/9_lgs/8mag_lgs/1500count -c master_files/reduced_ngs/9_lgs/8mag_lgs/kola_1500act.conf -O 
Output folder is 'studies/reduced_ngs/9_lgs/8mag_lgs/1500count'.
SRC: /global/homes/b/bpeck/code/maos v2.9 4c88b7c2 2024-11-13 16:45:33 -0800
BUILT: /global/homes/b/bpeck/code/maos/optim by GCC (v12) on 2024/11/18 09:40:03 CPU(F64,+O3) with CUDA(v122,F32)
Launched at 2025/02/12 00:42:20 in nid003544 with PID 2033659.
The web based job monitor can be accessed at http://localhost:10300
Main config file is /global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_1500act.conf
[00;00m[0;36mWarning(path.c:48): Path not found: path=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; abspath=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; Ignored.
[00;00m[0;36mWarning(path.c:48): Path not found: path=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; abspath=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; Ignored.
[00;00m[0;36mWarning(readcfg.c:399): sim.apfsm has been renamed to powfs.apfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.epfsm has been renamed to powfs.epfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.alfsm has been renamed to powfs.alfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.commonfsm has been renamed to powfs.commonfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.idealfsm has been renamed to powfs.idealfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.zetafsm has been renamed to powfs.zetafsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.f0fsm has been renamed to powfs.f0fsm.
[00;00m[0;36mWarning(readcfg.c:399): tsurf has been renamed to ncpa.tsurf.
loaded 132 (132 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_sim.conf'
loaded  19 ( 19 new) records from '/global/u2/b/bpeck/work/vismcao/./dm_none.conf'
loaded  19 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_ASM.conf'
loaded  19 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_DM2.conf'
loaded  19 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_DM3.conf'
loaded   0 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_dm_multiple.conf'
loaded   7 (  5 new) records from '/global/u2/b/bpeck/work/vismcao/./atm_mk13n50p_ground_detail.conf'
loaded  76 ( 69 new) records from '/global/homes/b/bpeck/code/maos/config/maos/powfs_common.conf'
loaded  44 ( 38 new) records from '/global/u2/b/bpeck/work/vismcao/./powfs_none.conf'
loaded  44 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_shwfs_lgs.conf'
loaded  44 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_shwfs_ttf_strap.conf'
loaded  44 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_shwfs_twfs_lbwfs.conf'
loaded   0 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_wfs_lgs_strap_lbwfs.conf'
loaded  71 ( 71 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_recon.conf'

*** Simulation started at 2025/02/12 00:42:20 in nid008652. ***

Running seed 1
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_smooth has been renamed to powfs0_llt.na_smooth.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_interp has been renamed to powfs0_llt.na_interp.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_thres has been renamed to powfs0_llt.na_thres.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_maxit has been renamed to powfs0_llt.na_fit_maxit.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_svdthres has been renamed to powfs0_llt.na_fit_svdthres.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_dh has been renamed to powfs0_llt.na_fit_dh.
[00;00m[0;36mWarning(readcfg.c:399): dbg.ncpa_preload has been renamed to ncpa.preload.
[00;00m[0;36mWarning(readcfg.c:399): dbg.ncpa_rmsci has been renamed to ncpa.rmsci.
[00;00m[0;36mWarning(readcfg.c:399): dbg.draw_opdmax has been renamed to plot.opdmax.
[00;00m[0;36mWarning(readcfg.c:399): dbg.draw_gmax has been renamed to plot.gmax.
loaded  95 ( 93 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_dbg.conf'
loaded   4 (  4 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_fit_mcao.conf'
[00;00m[0;36mWarning(readcfg.c:399): surf has been renamed to ncpa.surf.
loaded  39 (  7 new) records from '/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_1500act.conf'
loaded   0 (  0 new) records from 'command line'
loaded  24 ( 18 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_llt_CL.conf'
Adjust LGS range by telescope altitude 4145m.
Zenith angle is 30 degree.
    Scaling turbulence height and LGS hs by sec(za).
    Scaling r0 by cos(za)^(3/5).
    Scaling wind speed and LGS signal level by cos(za).
powfs0: Adjusting dx from 0.0078125 to 0.007875. 
powfs0.llt.fsm: f0=0 Hz, LPF ep=0
powfs0.epfsm is set to 0.517618 (auto)
powfs2: Adjusting dx from 0.03125 to 0.0312778. 
powfs2 is TWFS for powfs0
sim.ephi is set to 0.427717 (auto)
sim.eplo is set to 0.427717 (auto)
[00;00m[0;36mWarning(parms.c:2296): Layer 1 at 17.3205m is very close to layer 0 at 0m (OK).
[00;00m[0;36mWarning(parms.c:2296): Layer 2 at 34.641m is very close to layer 1 at 17.3205m (OK).
[00;00m[0;36mWarning(parms.c:2296): Layer 3 at 51.9615m is very close to layer 2 at 34.641m (OK).
dm 0: stroke=30 um is provided in micron.
dm 0: assume ia stroke=2 um is provided in micron.
dm 1: stroke=7 um is provided in micron.
dm 1: assume ia stroke=2 um is provided in micron.
dm 2: stroke=7 um is provided in micron.
dm 2: assume ia stroke=2 um is provided in micron.
Focus blending is not implemented yet for integrated tomography
parms->sim.mffocus is reset to 0
GPU 0: mem used 2688 MB (wfs seeding)
There are 1 valid simulation seeds:  1
Output PSF for 1 directions
Used 449 of 456 supplied keys
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_flate" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_flatv" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_psx" is not recognized, value is [0 0 0 0]
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_psy" is not recognized, value is [0 0 0 0]
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_pupelong" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_raw" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_side" is not recognized, value is 4
[00;00mAperture[00;00m is 11 m with sampling 1/128 m
[00;00mTurbulence at 30 degree zenith angle:[00;00m r0=0.128424m, L0=30m, 14 layers.
    Greenwood freq is 25.1Hz, anisoplanatic angle is 1.58 as
    Sampled 8192x8192 at 1/128m. wind dir is randomized.
    layer 0: ht=      0 m, wt= 0.302, ws=  4.8 m/s
    layer 1: ht=     17 m, wt= 0.154, ws=  5.0 m/s
    layer 2: ht=     35 m, wt= 0.041, ws=  5.4 m/s
    layer 3: ht=     52 m, wt= 0.002, ws=  6.6 m/s
    layer 4: ht=    139 m, wt= 0.021, ws=  6.1 m/s
    layer 5: ht=    231 m, wt= 0.010, ws=  6.1 m/s
    layer 6: ht=    323 m, wt= 0.008, ws=  6.1 m/s
    layer 7: ht=    416 m, wt= 0.005, ws=  6.1 m/s
    layer 8: ht=    508 m, wt= 0.001, ws=  6.1 m/s
    layer 9: ht=    932 m, wt= 0.107, ws=  5.6 m/s
    layer 10: ht=   5022 m, wt= 0.144, ws= 11.1 m/s
    layer 11: ht=   9238 m, wt= 0.093, ws= 19.1 m/s
    layer 12: ht=  13856 m, wt= 0.075, ws=  8.2 m/s
    layer 13: ht=  22518 m, wt= 0.036, ws=  4.8 m/s
[00;00mReconstruction[00;00m: r0=0.128424m L0=30m. 14 layers. use cone coordinate.
    layer 0: ht=      0 m, wt= 0.302
    layer 1: ht=     17 m, wt= 0.154
    layer 2: ht=     35 m, wt= 0.041
    layer 3: ht=     52 m, wt= 0.002
    layer 4: ht=    139 m, wt= 0.021
    layer 5: ht=    231 m, wt= 0.010
    layer 6: ht=    323 m, wt= 0.008
    layer 7: ht=    416 m, wt= 0.005
    layer 8: ht=    508 m, wt= 0.001
    layer 9: ht=    932 m, wt= 0.107
    layer 10: ht=   5022 m, wt= 0.144
    layer 11: ht=   9238 m, wt= 0.093
    layer 12: ht=  13856 m, wt= 0.075
    layer 13: ht=  22518 m, wt= 0.036
[00;00mThere are 3 powfs[00;00m
  powfs0: Order 44, LGS at 99.1 km. Sampling 1/126.984 m. Thres 30%. [00;00mT/T is removed in right hand side in tomography.[00;00m
    CCD image is 25x25 @ 500x500 mas, blur 27% (sigma), 1500Hz, wvl: [ 5.89e-07]
    Gtilt in reconstruction. Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
  powfs1: Order  2, NGS at inf km. Sampling 1/16 m. Thres 30%. 
    Ztilt in reconstruction. Geomtric optics start at 2 with ztilt [00;00m(noisy)[00;00m
  powfs2: Order 20, NGS at inf km. Sampling 1/31.9716 m. Thres 50%. 
    CCD image is 4x4 @ 1500x1500 mas, blur 0% (sigma), 0.015Hz, wvl: [ 7.2e-07]
    Gtilt in reconstruction. Geomtric optics start at 50 with gtilt Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
[00;00mThere are 13 wfs[00;00m
    wfs 0: type 0, at (  30.00,    0.00) arcsec,  99 km, siglev is 76.1436 bkgrnd is 0.1
    wfs 1: type 0, at (  22.98,   19.28) arcsec,  99 km, siglev is 76.1436 bkgrnd is 0.1
    wfs 2: type 0, at (   5.21,   29.54) arcsec,  99 km, siglev is 76.1436 bkgrnd is 0.1
    wfs 3: type 0, at ( -15.00,   25.98) arcsec,  99 km, siglev is 76.1436 bkgrnd is 0.1
    wfs 4: type 0, at ( -28.19,   10.26) arcsec,  99 km, siglev is 76.1436 bkgrnd is 0.1
    wfs 5: type 0, at ( -28.19,  -10.26) arcsec,  99 km, siglev is 76.1436 bkgrnd is 0.1
    wfs 6: type 0, at ( -15.00,  -25.98) arcsec,  99 km, siglev is 76.1436 bkgrnd is 0.1
    wfs 7: type 0, at (   5.21,  -29.54) arcsec,  99 km, siglev is 76.1436 bkgrnd is 0.1
    wfs 8: type 0, at (  22.98,  -19.28) arcsec,  99 km, siglev is 76.1436 bkgrnd is 0.1
    wfs 9: type 1, at (   5.00,    8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 10: type 1, at ( -10.00,    0.00) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 11: type 1, at (   5.00,   -8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 12: type 2, at (   0.00,    0.00) arcsec, inf km, siglev is 4.1558e+06 bkgrnd is 0.001
[00;00mThere are 3 DMs[00;00m
  DM 0 at -0.1km, actuator pitch 0.252m, offset   0, with 30.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 1 at    6km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 2 at   10km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
[00;00mTomography[00;00m is using CG, with [00;00mFourer Domain[00;00m preconditioner, [00;00m12[00;00m iterations, integrated tomo.
[00;00mDM Fitting [00;00mis using CG, with [00;00mNo[00;00m preconditioner, [00;00m10[00;00m iterations
[00;00mThere are 9 fit directions[00;00m
    Fit 0: weight is 0.444, at (   0.00,    0.00) arcsec
    Fit 1: weight is 0.111, at (  15.00,    0.00) arcsec
    Fit 2: weight is 0.111, at (   0.00,   15.00) arcsec
    Fit 3: weight is 0.111, at ( -15.00,    0.00) arcsec
    Fit 4: weight is 0.111, at (   0.00,  -15.00) arcsec
    Fit 5: weight is 0.028, at (  15.00,   15.00) arcsec
    Fit 6: weight is 0.028, at ( -15.00,   15.00) arcsec
    Fit 7: weight is 0.028, at ( -15.00,  -15.00) arcsec
    Fit 8: weight is 0.028, at (  15.00,  -15.00) arcsec
[00;00mThere are 1 evaluation directions[00;00m at sampling 1/128 m.
    Evl 0: weight is 1.000, at (   0.00,    0.00) arcsec
[00;00mSimulation[00;00m start at step 0, end at step 1600, with time step 1/1500s, [00;00mclose loop[00;00m.
After setup_parms:	120.5 MiB.
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid003544/scheduler) failed: Invalid argument. 
CUDA: minimum memory requirement is 0.3GB
Step   116: OL 1061.8  258.1  OA   97.6   5.5 CL   97.6   5.5 nm  0.068 s
Wind dir: 267.3 261.7 167.0 130.5 300.7  32.3 119.8 139.0 150.8 277.7 203.0 133.1  45.9 265.1 deg
Using /global/homes/b/bpeck/.aos/cache/atm/vonkarman_14_8192x8192_0.0078125_1115374592d.bin
GPU 0 is NVIDIA A100-SXM4-40GB with arch 8.0, 38.9GB free, 39.3GB total device memory.
Using GPU 0
Use 1 GPUs for WFS Tomo Fit Evl

*** Preparation started at 2025/02/12 00:42:20 in nid003544. ***

Using OpenMP version 201511 with 128 threads
Reading aperture amplitude map from KECK.fits
After genatm:	6473.2 MiB.
Step   130: OL 1082.1  260.3  OA   98.8  17.6 CL   98.8  17.6 nm  0.076 s
[00;00m[0;36mWarning(accphi.c:477): 108280 points not covered by input screen
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid003544/scheduler) failed: Invalid argument. 
 ->maos.c:447->setup.c:148->aper.c:74->utils.c:478->accphi.c:478
iwvl 0: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 1: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 2: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 3: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 4: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 5: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 6: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 7: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
iwvl 8: Science PSF is using grid size of 2880. The PSF will sum to 6.95167232825486
After setup_aper:	343.1 MiB.

[00;00mSetting up powfs 0 geom[00;00m

There are 32 points in each subaperture of 0.252m.
There are 1201 valid subaperture.

[00;00mSetting up powfs 1 geom[00;00m

There are 88 points in each subaperture of 5.5m.
There are 4 valid subaperture.

[00;00mSetting up powfs 2 geom[00;00m

There are 18 points in each subaperture of 0.563m.
There are 236 valid subaperture.
After setup_powfs_init:	423.8 MiB.

[00;00mSetting up reconstructor geometry.[00;00m

PLOC is 91x91, with sampling of 0.13m (square)
    DM 0: grid is 47 x 47
    DM 1: grid is 75 x 75
    DM 2: grid is 80 x 79
FLOC is 91x91, with sampling of 0.13m (not square)
Step   144: OL 1101.1  264.9  OA  101.0   9.3 CL  101.0   9.3 nm  0.072 s
Tomography grid is square:
    layer 0: xloc grid is 160 x 160, sampling is 0.126 m, 25600 points
    layer 1: xloc grid is 160 x 160, sampling is 0.126 m, 25600 points
    layer 2: xloc grid is 160 x 160, sampling is 0.126 m, 25600 points
    layer 3: xloc grid is 160 x 160, sampling is 0.126 m, 25600 points
    layer 4: xloc grid is 160 x 160, sampling is 0.126 m, 25600 points
    layer 5: xloc grid is 160 x 160, sampling is 0.126 m, 25600 points
    layer 6: xloc grid is 160 x 160, sampling is 0.126 m, 25600 points
    layer 7: xloc grid is 160 x 160, sampling is 0.125 m, 25600 points
    layer 8: xloc grid is 160 x 160, sampling is 0.125 m, 25600 points
    layer 9: xloc grid is 160 x 160, sampling is 0.125 m, 25600 points
    layer 10: xloc grid is 160 x 160, sampling is 0.120 m, 25600 points
    layer 11: xloc grid is 160 x 160, sampling is 0.114 m, 25600 points
    layer 12: xloc grid is 160 x 160, sampling is 0.108 m, 25600 points
    layer 13: xloc grid is 160 x 160, sampling is 0.097 m, 25600 points

[00;00mSetting up powfs 0 PO WFS[00;00m

OTF dimension is 64x64 (calculated)
There is no bias
Step   158: OL 1117.8  271.1  OA  102.6  15.9 CL  102.6  15.9 nm  0.068 s
Step   173: OL 1133.1  279.6  OA  104.5  12.0 CL  104.5  12.0 nm  0.069 s
Step   188: OL 1144.9  289.1  OA  102.6  16.7 CL  102.6  16.7 nm  0.070 s
Step   203: OL 1153.3  298.8  OA  100.0   2.4 CL  100.0   2.4 nm  0.070 s
Step   217: OL 1158.8  307.7  OA   99.7  12.2 CL   99.7  12.2 nm  0.086 s
Step     #  Open Loop  PR TT  On axis  PR TT  Field RMS PR TT     Timing 
Step     0: OL  884.6  248.3  OA  884.6 248.3 CL  884.6 248.3 nm  0.431 s
Step   232: OL 1161.5  317.4  OA   97.1   9.3 CL   97.1   9.3 nm  0.069 s
Step    16: OL  909.4  254.4  OA  143.0  34.0 CL  143.0  34.0 nm  0.056 s
Step   246: OL 1160.9  327.0  OA   95.4   5.7 CL   95.4   5.7 nm  0.074 s
Step    32: OL  934.4  259.2  OA  138.2  16.1 CL  138.2  16.1 nm  0.073 s
Step   255 updated high order loop gain: 0.366
Step   260: OL 1155.8  337.0  OA   97.2  18.4 CL   97.2  18.4 nm  0.070 s
Step    47: OL  956.8  261.1  OA  138.8  12.5 CL  138.8  12.5 nm  0.064 s
Step   275: OL 1145.5  347.8  OA   96.9  11.2 CL   96.9  11.2 nm  0.068 s
Step    62: OL  979.0  260.7  OA  135.1  19.0 CL  135.1  19.0 nm  0.074 s
Step   289: OL 1132.5  358.6  OA   99.8  10.3 CL   99.8  10.3 nm  0.068 s
Step    76: OL 1000.2  259.2  OA  133.5  25.5 CL  133.5  25.5 nm  0.068 s
Step   304: OL 1116.6  371.7  OA  100.9  29.2 CL  100.9  29.2 nm  0.077 s
Step    91: OL 1023.4  258.0  OA  126.9  15.6 CL  126.9  15.6 nm  0.065 s
Step   319: OL 1098.4  385.6  OA  104.0  22.9 CL  104.0  22.9 nm  0.071 s
Step   106: OL 1046.5  257.6  OA  127.6  20.8 CL  127.6  20.8 nm  0.065 s
Step   331: OL 1082.6  398.1  OA  100.2  17.1 CL  100.2  17.1 nm  0.078 s
Step   121: OL 1069.5  258.7  OA  126.5  21.8 CL  126.5  21.8 nm  0.064 s
Step   346: OL 1062.9  415.8  OA  101.3  18.0 CL  101.3  18.0 nm  0.068 s
Step   136: OL 1090.8  262.1  OA  130.6  13.2 CL  130.6  13.2 nm  0.066 s
Step   360: OL 1044.6  434.4  OA   99.5  12.7 CL   99.5  12.7 nm  0.068 s
Step   151: OL 1110.4  267.9  OA  143.5  37.4 CL  143.5  37.4 nm  0.071 s
Step   374: OL 1027.7  454.2  OA  102.8  18.9 CL  102.8  18.9 nm  0.069 s
Step   167: OL 1128.1  276.2  OA  140.3  39.9 CL  140.3  39.9 nm  0.065 s
Step   389: OL 1010.7  475.9  OA  101.4   1.3 CL  101.4   1.3 nm  0.069 s
Step   182: OL 1141.6  285.4  OA  130.7   5.1 CL  130.7   5.1 nm  0.079 s
Step   402: OL  996.3  494.6  OA  103.5  20.1 CL  103.5  20.1 nm  0.075 s
Step   197: OL 1151.4  295.1  OA  131.1  21.5 CL  131.1  21.5 nm  0.064 s
Step   417: OL  979.3  515.5  OA  102.9  20.7 CL  102.9  20.7 nm  0.070 s
Step   212: OL 1158.6  304.6  OA  127.9   7.7 CL  127.9   7.7 nm  0.071 s
Step   431: OL  963.3  534.1  OA  103.6  16.7 CL  103.6  16.7 nm  0.068 s
Step   227: OL 1162.6  314.3  OA  138.4  32.6 CL  138.4  32.6 nm  0.067 s
Step   446: OL  947.2  553.7  OA  105.3  29.8 CL  105.3  29.8 nm  0.068 s
Step   243: OL 1163.2  325.0  OA  130.2  10.0 CL  130.2  10.0 nm  0.067 s
Step   460: OL  934.9  572.1  OA  101.2   7.7 CL  101.2   7.7 nm  0.076 s
Step   255 updated high order loop gain: 0.353
Step   258: OL 1159.1  335.7  OA  141.9  16.0 CL  141.9  16.0 nm  0.062 s
Step   475: OL  926.4  591.5  OA  103.1  12.7 CL  103.1  12.7 nm  0.071 s
Step   273: OL 1149.7  346.5  OA  132.3  12.2 CL  132.3  12.2 nm  0.071 s
Step   490: OL  923.4  610.2  OA  106.4  15.8 CL  106.4  15.8 nm  0.069 s
Step   289: OL 1135.2  358.7  OA  131.9  20.4 CL  131.9  20.4 nm  0.065 s
Step   505: OL  924.7  627.6  OA  104.8  10.4 CL  104.8  10.4 nm  0.067 s
Step   302: OL 1121.6  370.0  OA  127.0   2.5 CL  127.0   2.5 nm  0.071 s
Step   511 updated high order loop gain: 0.369
Step   519: OL  928.4  642.0  OA  105.4  15.8 CL  105.4  15.8 nm  0.074 s
Step   317: OL 1103.8  383.8  OA  129.9  20.7 CL  129.9  20.7 nm  0.065 s
Step   533: OL  934.2  653.4  OA  105.5   9.6 CL  105.5   9.6 nm  0.094 s
Step   332: OL 1084.2  399.3  OA  127.6  24.5 CL  127.6  24.5 nm  0.072 s
Step   548: OL  943.2  662.1  OA  100.9   7.2 CL  100.9   7.2 nm  0.069 s
Step   347: OL 1064.4  417.2  OA  123.2  15.2 CL  123.2  15.2 nm  0.065 s
Step   559: OL  951.8  666.4  OA  100.0   0.7 CL  100.0   0.7 nm  0.072 s
Step   362: OL 1044.8  437.2  OA  126.0  23.5 CL  126.0  23.5 nm  0.077 s
Step   574: OL  965.5  669.7  OA  103.0   6.8 CL  103.0   6.8 nm  0.072 s
Step   377: OL 1026.5  458.6  OA  126.1  27.5 CL  126.1  27.5 nm  0.067 s
Step   589: OL  981.2  670.5  OA  100.9   9.6 CL  100.9   9.6 nm  0.069 s
Step   392: OL 1009.0  480.3  OA  126.0  14.8 CL  126.0  14.8 nm  0.071 s
Step   603: OL  997.4  668.0  OA  100.1   3.1 CL  100.1   3.1 nm  0.069 s
Step   404: OL  995.2  497.5  OA  130.1  20.3 CL  130.1  20.3 nm  0.064 s
Step   419: OL  977.5  518.2  OA  127.0  23.5 CL  127.0  23.5 nm  0.068 s
Step   618: OL 1015.3  661.8  OA  103.5  24.9 CL  103.5  24.9 nm  0.075 s
Step   434: OL  959.9  538.1  OA  127.7   5.4 CL  127.7   5.4 nm  0.066 s
Step   633: OL 1032.8  652.5  OA  100.6   8.1 CL  100.6   8.1 nm  0.074 s
Step   449: OL  943.7  557.6  OA  128.8  17.0 CL  128.8  17.0 nm  0.074 s
Step   647: OL 1048.2  641.2  OA  104.5  10.5 CL  104.5  10.5 nm  0.072 s
Step   464: OL  931.4  577.3  OA  129.7   3.0 CL  129.7   3.0 nm  0.064 s
Step   660: OL 1061.0  629.1  OA   98.7  10.5 CL   98.7  10.5 nm  0.070 s
Step   479: OL  924.1  596.5  OA  130.1  21.4 CL  130.1  21.4 nm  0.067 s
Step   674: OL 1073.6  614.7  OA  103.0  11.7 CL  103.0  11.7 nm  0.076 s
Step   494: OL  922.4  614.9  OA  132.7  26.5 CL  132.7  26.5 nm  0.065 s
Step   689: OL 1086.4  599.0  OA  105.1  18.6 CL  105.1  18.6 nm  0.069 s
Step   509: OL  924.2  631.9  OA  132.2  14.1 CL  132.2  14.1 nm  0.093 s
Step   703: OL 1096.3  583.3  OA  104.4   9.0 CL  104.4   9.0 nm  0.077 s
Step   511 updated high order loop gain: 0.298
Step   524: OL  928.9  646.4  OA  131.9  10.6 CL  131.9  10.6 nm  0.066 s
Step   718: OL 1103.7  565.1  OA  100.1  20.7 CL  100.1  20.7 nm  0.067 s
Uplink FWHM (illt 0, iwvl 0) is 0.579373"
Downlink FWHM (illt 0, iwvl 0) is 1.12518"
Step   539: OL  936.2  657.3  OA  130.7  17.8 CL  130.7  17.8 nm  0.072 s
Step   733: OL 1107.2  546.5  OA   99.6  10.1 CL   99.6  10.1 nm  0.077 s
Generating matched filter for powfs 0
sa index   location       noise equivalent angle
     598: (  4.8,  -0.3) m, ( 74.61,  72.44) mas
     594: (  3.8,  -0.3) m, ( 78.78,  72.92) mas
     590: (  2.8,  -0.3) m, ( 84.75,  73.49) mas
     585: (  1.5,  -0.3) m, ( 93.98,  74.26) mas
     584: (  1.3,  -0.3) m, ( 95.72,  74.40) mas
     411: ( -0.5,  -1.5) m, (109.99,  76.32) mas
     582: ( -1.8,  -0.3) m, (120.72,  76.18) mas
     578: ( -2.8,  -0.3) m, (129.71,  76.76) mas
     573: ( -4.0,  -0.3) m, (141.30,  77.44) mas
     569: ( -5.0,  -0.3) m, (150.67,  77.97) mas
     568: ( -5.3,  -0.3) m, (153.21,  78.10) mas
sa index   location       noise equivalent angle
     945: (  2.8,   2.3) m, ( 76.63,  75.43) mas
     911: (  2.5,   2.0) m, ( 80.46,  79.11) mas
     758: (  1.3,   1.0) m, ( 84.88,  81.34) mas
     721: (  1.0,   0.8) m, ( 86.38,  82.68) mas
     718: ( -1.3,   0.8) m, (103.36,  83.14) mas
     480: ( -1.3,  -1.0) m, (102.99,  94.58) mas
     445: ( -1.5,  -1.3) m, (104.90,  96.34) mas
     258: ( -3.0,  -2.5) m, (117.29, 105.81) mas
     225: ( -3.3,  -2.8) m, (119.43, 107.84) mas
      27: ( -3.0,  -4.5) m, (116.96, 122.80) mas
sa index   location       noise equivalent angle
    1115: (  0.5,   3.8) m, ( 72.99,  78.06) mas
    1089: (  0.5,   3.5) m, ( 73.13,  79.43) mas
     902: (  0.3,   2.0) m, ( 75.50,  90.59) mas
     791: (  0.0,   1.3) m, ( 75.70,  95.84) mas
     583: ( -1.5,  -0.3) m, ( 79.42, 106.47) mas
     373: ( -0.5,  -1.8) m, ( 76.99, 119.61) mas
     301: ( -0.5,  -2.3) m, ( 78.77, 126.48) mas
     114: ( -0.8,  -3.8) m, ( 78.36, 137.79) mas
      13: ( -1.0,  -4.8) m, ( 79.39, 147.18) mas
       8: ( -2.5,  -4.8) m, ( 85.66, 147.06) mas
sa index   location       noise equivalent angle
    1179: ( -2.8,   4.5) m, ( 75.57,  76.34) mas
    1129: ( -2.5,   4.0) m, ( 73.05,  74.38) mas
     928: ( -1.5,   2.3) m, ( 75.99,  82.36) mas
     861: ( -1.3,   1.8) m, ( 77.44,  86.03) mas
     788: ( -0.8,   1.3) m, ( 79.32,  89.24) mas
     653: (  1.3,   0.3) m, ( 91.74,  96.41) mas
     416: (  0.8,  -1.5) m, ( 88.39, 110.61) mas
     275: (  1.3,  -2.5) m, ( 91.84, 119.31) mas
     212: (  1.5,  -3.0) m, ( 93.59, 123.65) mas
      74: (  2.3,  -4.3) m, ( 98.90, 134.68) mas
      24: (  2.5,  -4.8) m, (105.00, 145.29) mas
sa index   location       noise equivalent angle
     775: ( -4.0,   1.3) m, ( 76.91,  73.25) mas
     742: ( -3.3,   1.0) m, ( 80.63,  73.94) mas
     713: ( -2.5,   0.8) m, ( 85.53,  74.77) mas
     651: ( -1.5,   0.3) m, ( 92.62,  76.43) mas
     412: ( -0.3,  -1.5) m, (106.49,  88.37) mas
     550: (  1.3,  -0.5) m, (115.19,  80.18) mas
     488: (  2.3,  -1.0) m, (123.78,  82.81) mas
     459: (  3.0,  -1.3) m, (130.51,  84.32) mas
     428: (  3.8,  -1.5) m, (137.41,  85.88) mas
     565: (  5.0,  -0.5) m, (149.57,  81.51) mas
sa index   location       noise equivalent angle
     397: ( -4.0,  -1.5) m, ( 76.91,  73.25) mas
     438: ( -3.3,  -1.3) m, ( 80.63,  73.94) mas
     475: ( -2.5,  -1.0) m, ( 85.53,  74.77) mas
     548: ( -1.5,  -0.5) m, ( 92.62,  76.43) mas
     790: ( -0.3,   1.3) m, (106.49,  88.37) mas
     653: (  1.3,   0.3) m, (115.19,  80.18) mas
     726: (  2.3,   0.8) m, (123.78,  82.81) mas
     765: (  3.0,   1.0) m, (130.51,  84.32) mas
     806: (  3.8,   1.3) m, (137.41,  85.88) mas
     668: (  5.0,   0.3) m, (149.57,  81.51) mas
sa index   location       noise equivalent angle
       7: ( -2.8,  -4.8) m, ( 74.59,  75.31) mas
      55: ( -2.5,  -4.3) m, ( 73.05,  74.38) mas
     264: ( -1.5,  -2.5) m, ( 75.99,  82.36) mas
     333: ( -1.3,  -2.0) m, ( 77.21,  85.90) mas
     410: ( -0.8,  -1.5) m, ( 79.32,  89.24) mas
     550: (  1.3,  -0.5) m, ( 91.74,  96.41) mas
     794: (  0.8,   1.3) m, ( 88.39, 110.61) mas
     939: (  1.3,   2.3) m, ( 91.84, 119.31) mas
    1004: (  1.5,   2.8) m, ( 93.59, 123.65) mas
    1148: (  2.3,   4.0) m, ( 98.90, 134.68) mas
    1194: (  2.5,   4.5) m, (106.61, 147.55) mas
sa index   location       noise equivalent angle
      93: (  0.5,  -4.0) m, ( 72.99,  78.06) mas
     119: (  0.5,  -3.8) m, ( 73.13,  79.43) mas
     304: (  0.3,  -2.3) m, ( 75.75,  90.91) mas
     413: (  0.0,  -1.5) m, ( 75.70,  95.84) mas
     617: ( -1.5,   0.0) m, ( 79.42, 106.47) mas
     827: ( -0.5,   1.5) m, ( 76.99, 119.61) mas
     899: ( -0.5,   2.0) m, ( 78.51, 125.97) mas
    1084: ( -0.8,   3.5) m, ( 78.36, 137.79) mas
    1184: ( -1.0,   4.5) m, ( 79.39, 147.18) mas
    1180: ( -2.5,   4.5) m, ( 85.66, 147.06) mas
sa index   location       noise equivalent angle
     281: (  2.8,  -2.5) m, ( 76.63,  75.43) mas
     313: (  2.5,  -2.3) m, ( 80.58,  79.45) mas
     452: (  1.3,  -1.3) m, ( 84.88,  81.34) mas
     483: (  1.0,  -1.0) m, ( 86.38,  82.68) mas
     480: ( -1.3,  -1.0) m, (103.36,  83.14) mas
     718: ( -1.3,   0.8) m, (102.99,  94.58) mas
     749: ( -1.5,   1.0) m, (104.90,  96.34) mas
     922: ( -3.0,   2.3) m, (117.29, 105.81) mas
     953: ( -3.3,   2.5) m, (119.43, 107.84) mas
    1153: ( -3.0,   4.3) m, (116.96, 122.80) mas

[00;00mSetting up powfs 2 PO WFS[00;00m

OTF dimension is 48x48 (calculated)
Step   554: OL  946.8  664.6  OA  130.5   4.7 CL  130.5   4.7 nm  0.064 s
Step   748: OL 1106.5  528.0  OA  102.0   9.8 CL  102.0   9.8 nm  0.068 s
Generating matched filter for powfs 2
Use sanea to derive neasim
Use sanea to derive neasim

[00;00mSetting up reconstructor[00;00m

Recon NEA: cmf(97.26) cmf(97.07) cmf(97.02) cmf(97.18) cmf(97.17) cmf(97.18) cmf(97.21) cmf(97.06) cmf(97.10) geom(0.31) geom(0.31) geom(0.31) mf(0.14)  mas
Setup or update control matrix parameters.
RRtwfs svd threshold is 1e-10
Step   569: OL  960.0  668.8  OA  127.4  12.1 CL  127.4  12.1 nm  0.065 s
Step   762: OL 1102.4  511.4  OA  105.2  15.3 CL  105.2  15.3 nm  0.078 s
Step   767 updated high order loop gain: 0.369
Step   584: OL  975.2  670.5  OA  128.0  17.3 CL  128.0  17.3 nm  0.064 s
Step   771: OL 1097.9  501.1  OA  103.3   5.7 CL  103.3   5.7 nm  0.069 s
Step   599: OL  992.6  669.0  OA  122.1  13.4 CL  122.1  13.4 nm  0.065 s
Step   785: OL 1088.0  485.3  OA  100.8   2.8 CL  100.8   2.8 nm  0.071 s
Step   614: OL 1010.6  663.7  OA  126.7  30.9 CL  126.7  30.9 nm  0.070 s
Step   800: OL 1073.3  468.6  OA   99.8   2.5 CL   99.8   2.5 nm  0.071 s
Step   629: OL 1028.6  655.2  OA  126.8  14.8 CL  126.8  14.8 nm  0.066 s
Step   815: OL 1055.8  451.8  OA  103.4   2.9 CL  103.4   2.9 nm  0.072 s
Step   644: OL 1045.6  643.7  OA  124.6   7.0 CL  124.6   7.0 nm  0.077 s
Step   829: OL 1036.4  436.4  OA  102.0   2.5 CL  102.0   2.5 nm  0.077 s
Step   659: OL 1060.8  629.9  OA  128.6  17.6 CL  128.6  17.6 nm  0.066 s
Step   844: OL 1013.6  420.6  OA  102.7   9.9 CL  102.7   9.9 nm  0.067 s
Step   674: OL 1074.6  614.6  OA  130.8  18.2 CL  130.8  18.2 nm  0.065 s
Step   859: OL  989.9  406.0  OA  101.8   9.8 CL  101.8   9.8 nm  0.075 s
Step   690: OL 1088.3  597.8  OA  132.9  12.9 CL  132.9  12.9 nm  0.063 s
Step   873: OL  968.1  393.9  OA  103.8  15.1 CL  103.8  15.1 nm  0.069 s
Step   705: OL 1098.8  580.9  OA  137.4  19.0 CL  137.4  19.0 nm  0.061 s
Step   888: OL  946.0  382.8  OA  101.5   6.4 CL  101.5   6.4 nm  0.070 s
Step   720: OL 1105.6  562.5  OA  139.4  28.9 CL  139.4  28.9 nm  0.066 s
Step   903: OL  922.8  373.1  OA   99.9   3.9 CL   99.9   3.9 nm  0.069 s
Step   735: OL 1108.6  544.0  OA  135.7  22.8 CL  135.7  22.8 nm  0.069 s
Step   918: OL  898.5  365.3  OA  101.6  11.9 CL  101.6  11.9 nm  0.074 s
Step   751: OL 1107.2  524.4  OA  134.2  22.7 CL  134.2  22.7 nm  0.069 s
Step   932: OL  876.0  358.7  OA   98.5   5.5 CL   98.5   5.5 nm  0.071 s
Step   766: OL 1101.7  506.8  OA  132.2  15.5 CL  132.2  15.5 nm  0.068 s
Step   946: OL  854.3  352.0  OA  102.0   6.4 CL  102.0   6.4 nm  0.071 s
Step   767 updated high order loop gain: 0.279
Step   781: OL 1092.4  489.8  OA  139.5  16.7 CL  139.5  16.7 nm  0.066 s
Step   961: OL  832.5  344.4  OA  101.5   3.4 CL  101.5   3.4 nm  0.077 s
Step   796: OL 1078.7  473.0  OA  141.0  15.1 CL  141.0  15.1 nm  0.076 s
Step   975: OL  815.2  336.4  OA  104.1  15.7 CL  104.1  15.7 nm  0.069 s
Step   811: OL 1061.9  456.3  OA  140.7  19.4 CL  140.7  19.4 nm  0.063 s
Step   989: OL  800.2  327.4  OA  106.4  18.6 CL  106.4  18.6 nm  0.075 s
Step   826: OL 1041.6  439.6  OA  143.8  22.9 CL  143.8  22.9 nm  0.065 s
Step  1003: OL  786.4  317.3  OA  106.9  10.8 CL  106.9  10.8 nm  0.070 s
Replacing HA by HA*fit->actextrap
Adding piston cr to fit matrix
Adding TT cr on upper DMs to fit matrix.
Before assembling fit matrix:	4726.0 MiB.
Building fit->FR
Step   841: OL 1018.8  423.6  OA  134.8   1.0 CL  134.8   1.0 nm  0.063 s
Step  1018: OL  773.6  305.9  OA  106.7   8.1 CL  106.7   8.1 nm  0.069 s
Step  1023 updated high order loop gain: 0.372
Step   856: OL  994.9  408.7  OA  134.9  16.3 CL  134.9  16.3 nm  0.071 s
Step  1029: OL  765.6  297.4  OA  105.8  13.0 CL  105.8  13.0 nm  0.075 s
Step   871: OL  971.2  395.5  OA  137.6  17.1 CL  137.6  17.1 nm  0.067 s
Step  1044: OL  756.3  284.8  OA  102.1  11.7 CL  102.1  11.7 nm  0.068 s
Step   886: OL  948.7  384.2  OA  139.2  25.6 CL  139.2  25.6 nm  0.064 s
Step  1058: OL  747.9  272.0  OA  103.1  10.5 CL  103.1  10.5 nm  0.072 s
Replacing HA by HA*fit->actextrap
Adding piston cr to fit matrix
Adding TT cr on upper DMs to fit matrix.
Before assembling fit matrix:	3539.5 MiB.
Building fit->FR
Step   901: OL  925.6  374.3  OA  139.3   7.4 CL  139.3   7.4 nm  0.064 s
Step  1073: OL  740.2  256.3  OA  104.4  14.7 CL  104.4  14.7 nm  0.069 s
Step   916: OL  901.3  366.3  OA  136.3  15.0 CL  136.3  15.0 nm  0.065 s
Step  1088: OL  735.3  238.8  OA  103.8  22.5 CL  103.8  22.5 nm  0.069 s
Step   931: OL  877.2  359.2  OA  134.6   1.8 CL  134.6   1.8 nm  0.065 s
Step  1103: OL  733.1  222.2  OA   99.8   9.4 CL   99.8   9.4 nm  0.069 s
Step   945: OL  855.5  352.5  OA  134.8  10.1 CL  134.8  10.1 nm  0.107 s
Building fit->FL
Step  1115: OL  732.5  210.0  OA  101.5  11.4 CL  101.5  11.4 nm  0.070 s
Adding tikhonov constraint of 1.0e-07 to FLM
The maximum eigen value is estimated to be around 3.4e-04
DM Fit number of Low rank terms: 16 in LHS
After assemble fit matrix:	4285.7 MiB.
After setup_recon:	4285.7 MiB.
Step   960: OL  833.8  345.0  OA  136.9  22.6 CL  136.9  22.6 nm  0.066 s
Step  1129: OL  732.6  197.6  OA   97.8  10.7 CL   97.8  10.7 nm  0.074 s
Building fit->FL
Step   975: OL  815.2  336.4  OA  135.7  10.0 CL  135.7  10.0 nm  0.064 s
Step  1144: OL  733.3  186.9  OA  101.0  16.8 CL  101.0  16.8 nm  0.070 s
Adding tikhonov constraint of 1.0e-07 to FLM
The maximum eigen value is estimated to be around 2.7e-04
DM Fit number of Low rank terms: 16 in LHS
After assemble fit matrix:	6646.8 MiB.
After setup_recon:	6646.8 MiB.
GPU 0: mem used 1880 MB (wfs init)
Step   990: OL  799.2  326.7  OA  129.8   6.7 CL  129.8   6.7 nm  0.065 s
Step  1159: OL  734.0  178.5  OA  101.6  20.8 CL  101.6  20.8 nm  0.067 s
GPU 0: mem used 2364 MB (recon init)
Step  1002: OL  787.6  318.1  OA  132.7   4.6 CL  132.7   4.6 nm  0.064 s
Step  1174: OL  734.7  172.9  OA  102.2  21.0 CL  102.2  21.0 nm  0.070 s
GPU 0: mem used 2394 MB (perf init)
Step  1017: OL  774.6  306.7  OA  134.6  10.8 CL  134.6  10.8 nm  0.073 s
GPU 0: mem used 1496 MB (wfs init)
Step  1188: OL  736.9  169.5  OA  101.6  18.7 CL  101.6  18.7 nm  0.067 s
Step  1023 updated high order loop gain: 0.266
Step  1032: OL  763.9  295.0  OA  136.4   3.4 CL  136.4   3.4 nm  0.064 s
Step  1202: OL  740.2  166.6  OA  104.9  28.8 CL  104.9  28.8 nm  0.069 s
GPU 0: mem used 2708 MB (recon init)
Step  1047: OL  754.7  282.2  OA  135.6   9.9 CL  135.6   9.9 nm  0.063 s
GPU 0: mem used 2738 MB (perf init)
Step  1217: OL  743.8  164.2  OA   98.6  17.0 CL   98.6  17.0 nm  0.069 s
Step  1063: OL  745.1  267.0  OA  131.6   7.5 CL  131.6   7.5 nm  0.064 s
Step  1232: OL  747.3  163.5  OA  102.7  29.0 CL  102.7  29.0 nm  0.079 s
Step  1078: OL  738.1  250.5  OA  134.4  18.8 CL  134.4  18.8 nm  0.064 s
Step  1247: OL  749.9  165.4  OA   98.6   6.2 CL   98.6   6.2 nm  0.069 s
Step  1093: OL  733.8  233.1  OA  135.3  27.9 CL  135.3  27.9 nm  0.066 s
Step  1261: OL  753.0  169.8  OA  104.9  29.3 CL  104.9  29.3 nm  0.074 s
Step  1108: OL  731.9  217.0  OA  131.1  24.8 CL  131.1  24.8 nm  0.065 s
Step  1276: OL  757.0  176.8  OA   99.1  20.2 CL   99.1  20.2 nm  0.069 s
Step  1279 updated high order loop gain: 0.373
Step  1123: OL  731.3  202.6  OA  128.2  19.6 CL  128.2  19.6 nm  0.072 s
[00;00m>>>>>>>>>>>>>>>>[0;36mWarning(bin.c:410): evlpsfdl.fits: Unknown error
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 2880 bytes to evlpsfdl.fits failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 2880 bytes to evlpsfdl.fits failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 2880 bytes to evlpsfdl.fits failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 2880 bytes to evlpsfdl.fits failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 2880 bytes to evlpsfdl.fits failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 2880 bytes to evlpsfdl.fits failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 2880 bytes to evlpsfdl.fits failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 2880 bytes to evlpsfdl.fits failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 2880 bytes to evlpsfdl.fits failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 2880 bytes to evlpsfdl.fits failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 2880 bytes to evlpsfdl.fits failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 2880 bytes to evlpsfdl.fits failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 2880 bytes to evlpsfdl.fits failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 2880 bytes to evlpsfdl.fits failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 2880 bytes to evlpsfdl.fits failed
Step  1290: OL  762.4  185.1  OA  101.4  28.6 CL  101.4  28.6 nm  0.073 s

*** Simulation started at 2025/02/12 00:43:46 in nid003544. ***

Running seed 1
GPU 0: mem used 2394 MB (wfs seeding)
[00;00m[0;36mWarning(bin.c:410): extra/Resfsmerr_1.bin: Unknown error
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 1 bytes to extra/Resfsmerr_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 4 bytes to extra/Resfsmerr_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 4 bytes to extra/Resfsmerr_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 8 bytes to extra/Resfsmerr_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 8 bytes to extra/Resfsmerr_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 1 bytes to extra/Resfsmerr_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 4 bytes to extra/Resfsmerr_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 4 bytes to extra/Resfsmerr_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 8 bytes to extra/Resfsmerr_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 8 bytes to extra/Resfsmerr_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 1 bytes to extra/Resfsmerr_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 4 bytes to extra/Resfsmerr_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 4 bytes to extra/Resfsmerr_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 8 bytes to extra/Resfsmerr_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 8 bytes to extra/Resfsmerr_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 1 bytes to extra/Resfsmerr_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 4 bytes to extra/Resfsmerr_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 4 bytes to extra/Resfsmerr_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 8 bytes to extra/Resfsmerr_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 8 bytes to extra/Resfsmerr_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 1 bytes to extra/Resfsmerr_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 4 bytes to extra/Resfsmerr_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 4 bytes to extra/Resfsmerr_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 8 bytes to extra/Resfsmerr_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 8 bytes to extra/Resfsmerr_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 1 bytes to extra/Resfsmerr_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 4 bytes to extra/Resfsmerr_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 4 bytes to extra/Resfsmerr_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 8 bytes to extra/Resfsmerr_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 8 bytes to extra/Resfsmerr_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 1 bytes to extra/Resfsmerr_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 4 bytes to extra/Resfsmerr_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 4 bytes to extra/Resfsmerr_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 8 bytes to extra/Resfsmerr_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 8 bytes to extra/Resfsmerr_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 1 bytes to extra/Resfsmerr_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 4 bytes to extra/Resfsmerr_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 4 bytes to extra/Resfsmerr_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 8 bytes to extra/Resfsmerr_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 8 bytes to extra/Resfsmerr_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 1 bytes to extra/Resfsmerr_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 4 bytes to extra/Resfsmerr_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 4 bytes to extra/Resfsmerr_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 8 bytes to extra/Resfsmerr_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 8 bytes to extra/Resfsmerr_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 4 bytes to extra/Resfsmerr_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 4 bytes to extra/Resfsmerr_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 8 bytes to extra/Resfsmerr_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 8 bytes to extra/Resfsmerr_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 4 bytes to extra/Resfsmerr_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 4 bytes to extra/Resfsmerr_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 8 bytes to extra/Resfsmerr_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 8 bytes to extra/Resfsmerr_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 4 bytes to extra/Resfsmerr_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 4 bytes to extra/Resfsmerr_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 8 bytes to extra/Resfsmerr_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 8 bytes to extra/Resfsmerr_1.bin failed
[00;00m[0;36mWarning(bin.c:410): extra/Resfsmcmd_1.bin: Unknown error
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 1 bytes to extra/Resfsmcmd_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 4 bytes to extra/Resfsmcmd_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 4 bytes to extra/Resfsmcmd_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 8 bytes to extra/Resfsmcmd_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 8 bytes to extra/Resfsmcmd_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 1 bytes to extra/Resfsmcmd_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 4 bytes to extra/Resfsmcmd_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 4 bytes to extra/Resfsmcmd_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 8 bytes to extra/Resfsmcmd_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 8 bytes to extra/Resfsmcmd_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 1 bytes to extra/Resfsmcmd_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 4 bytes to extra/Resfsmcmd_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 4 bytes to extra/Resfsmcmd_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 8 bytes to extra/Resfsmcmd_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 8 bytes to extra/Resfsmcmd_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 1 bytes to extra/Resfsmcmd_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 4 bytes to extra/Resfsmcmd_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 4 bytes to extra/Resfsmcmd_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 8 bytes to extra/Resfsmcmd_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 8 bytes to extra/Resfsmcmd_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 1 bytes to extra/Resfsmcmd_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 4 bytes to extra/Resfsmcmd_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 4 bytes to extra/Resfsmcmd_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 8 bytes to extra/Resfsmcmd_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 8 bytes to extra/Resfsmcmd_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 1 bytes to extra/Resfsmcmd_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 4 bytes to extra/Resfsmcmd_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 4 bytes to extra/Resfsmcmd_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 8 bytes to extra/Resfsmcmd_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 8 bytes to extra/Resfsmcmd_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 1 bytes to extra/Resfsmcmd_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 4 bytes to extra/Resfsmcmd_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 4 bytes to extra/Resfsmcmd_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 8 bytes to extra/Resfsmcmd_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 8 bytes to extra/Resfsmcmd_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 1 bytes to extra/Resfsmcmd_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 4 bytes to extra/Resfsmcmd_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 4 bytes to extra/Resfsmcmd_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 8 bytes to extra/Resfsmcmd_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 8 bytes to extra/Resfsmcmd_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 1 bytes to extra/Resfsmcmd_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 4 bytes to extra/Resfsmcmd_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 4 bytes to extra/Resfsmcmd_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 8 bytes to extra/Resfsmcmd_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 8 bytes to extra/Resfsmcmd_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 4 bytes to extra/Resfsmcmd_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 4 bytes to extra/Resfsmcmd_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 8 bytes to extra/Resfsmcmd_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 8 bytes to extra/Resfsmcmd_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 4 bytes to extra/Resfsmcmd_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 4 bytes to extra/Resfsmcmd_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 8 bytes to extra/Resfsmcmd_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 8 bytes to extra/Resfsmcmd_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 4 bytes to extra/Resfsmcmd_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 4 bytes to extra/Resfsmcmd_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 8 bytes to extra/Resfsmcmd_1.bin failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 8 bytes to extra/Resfsmcmd_1.bin failed
[00;00mopen for write: Disk quota exceeded

Signal caught: Segmentation fault (11)
Memory location: 0x1c
[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid003544/scheduler) failed: Invalid argument. 
Step  1138: OL  731.5  190.9  OA  127.3  18.2 CL  127.3  18.2 nm  0.064 s
 ->sim.c:268->sim.c:68->sim_utils.c:1111
maos_signal_handler: Segmentation fault (11)
Step  1304: OL  768.0  194.5  OA  103.2  25.2 CL  103.2  25.2 nm  0.070 s
Step  1153: OL  732.2  181.5  OA  123.5  27.0 CL  123.5  27.0 nm  0.065 s
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid003544/scheduler) failed: Invalid argument. 
/global/u2/b/bpeck/work/vismcao/maos -o studies/reduced_ngs/9_lgs/8mag_lgs/1750count -c master_files/reduced_ngs/9_lgs/8mag_lgs/kola_1750act.conf -O 
Output folder is 'studies/reduced_ngs/9_lgs/8mag_lgs/1750count'.
SRC: /global/homes/b/bpeck/code/maos v2.9 4c88b7c2 2024-11-13 16:45:33 -0800
BUILT: /global/homes/b/bpeck/code/maos/optim by GCC (v12) on 2024/11/18 09:40:03 CPU(F64,+O3) with CUDA(v122,F32)
Launched at 2025/02/12 00:43:47 in nid003544 with PID 2033906.
The web based job monitor can be accessed at http://localhost:10300
Main config file is /global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_1750act.conf
[00;00m[0;36mWarning(path.c:48): Path not found: path=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; abspath=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/bin; Ignored.
[00;00m[0;36mWarning(path.c:48): Path not found: path=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; abspath=/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/atm; Ignored.
[00;00m[0;36mWarning(readcfg.c:399): sim.apfsm has been renamed to powfs.apfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.epfsm has been renamed to powfs.epfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.alfsm has been renamed to powfs.alfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.commonfsm has been renamed to powfs.commonfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.idealfsm has been renamed to powfs.idealfsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.zetafsm has been renamed to powfs.zetafsm.
[00;00m[0;36mWarning(readcfg.c:399): sim.f0fsm has been renamed to powfs.f0fsm.
[00;00m[0;36mWarning(readcfg.c:399): tsurf has been renamed to ncpa.tsurf.
loaded 132 (132 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_sim.conf'
loaded  19 ( 19 new) records from '/global/u2/b/bpeck/work/vismcao/./dm_none.conf'
loaded  19 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_ASM.conf'
loaded  19 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_DM2.conf'
loaded  19 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_DM3.conf'
loaded   0 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_dm_multiple.conf'
loaded   7 (  5 new) records from '/global/u2/b/bpeck/work/vismcao/./atm_mk13n50p_ground_detail.conf'
loaded  76 ( 69 new) records from '/global/homes/b/bpeck/code/maos/config/maos/powfs_common.conf'
loaded  44 ( 38 new) records from '/global/u2/b/bpeck/work/vismcao/./powfs_none.conf'
loaded  44 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_shwfs_lgs.conf'
loaded  44 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_shwfs_ttf_strap.conf'
loaded  44 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_shwfs_twfs_lbwfs.conf'
loaded   0 (  0 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_wfs_lgs_strap_lbwfs.conf'
loaded  71 ( 71 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_recon.conf'
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_smooth has been renamed to powfs0_llt.na_smooth.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_interp has been renamed to powfs0_llt.na_interp.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_thres has been renamed to powfs0_llt.na_thres.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_maxit has been renamed to powfs0_llt.na_fit_maxit.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_svdthres has been renamed to powfs0_llt.na_fit_svdthres.
[00;00m[0;36mWarning(readcfg.c:399): dbg.na_fit_dh has been renamed to powfs0_llt.na_fit_dh.
[00;00m[0;36mWarning(readcfg.c:399): dbg.ncpa_preload has been renamed to ncpa.preload.
[00;00m[0;36mWarning(readcfg.c:399): dbg.ncpa_rmsci has been renamed to ncpa.rmsci.
[00;00m[0;36mWarning(readcfg.c:399): dbg.draw_opdmax has been renamed to plot.opdmax.
[00;00m[0;36mWarning(readcfg.c:399): dbg.draw_gmax has been renamed to plot.gmax.
loaded  95 ( 93 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_dbg.conf'
loaded   4 (  4 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_fit_mcao.conf'
[00;00m[0;36mWarning(readcfg.c:399): surf has been renamed to ncpa.surf.
loaded  39 (  7 new) records from '/global/u2/b/bpeck/work/vismcao/master_files/reduced_ngs/9_lgs/8mag_lgs/kola_1750act.conf'
loaded   0 (  0 new) records from 'command line'
loaded  24 ( 18 new) records from '/global/u2/b/bpeck/work/vismcao/./keck_llt_CL.conf'
Adjust LGS range by telescope altitude 4145m.
Zenith angle is 30 degree.
    Scaling turbulence height and LGS hs by sec(za).
    Scaling r0 by cos(za)^(3/5).
    Scaling wind speed and LGS signal level by cos(za).
powfs0: Adjusting dx from 0.0078125 to 0.00776667. 
powfs0.llt.fsm: f0=0 Hz, LPF ep=0
powfs0.epfsm is set to 0.517618 (auto)
powfs2: Adjusting dx from 0.03125 to 0.0312778. 
powfs2 is TWFS for powfs0
sim.ephi is set to 0.427717 (auto)
sim.eplo is set to 0.427717 (auto)
[00;00m[0;36mWarning(parms.c:2296): Layer 1 at 17.3205m is very close to layer 0 at 0m (OK).
[00;00m[0;36mWarning(parms.c:2296): Layer 2 at 34.641m is very close to layer 1 at 17.3205m (OK).
[00;00m[0;36mWarning(parms.c:2296): Layer 3 at 51.9615m is very close to layer 2 at 34.641m (OK).
dm 0: stroke=30 um is provided in micron.
dm 0: assume ia stroke=2 um is provided in micron.
dm 1: stroke=7 um is provided in micron.
dm 1: assume ia stroke=2 um is provided in micron.
dm 2: stroke=7 um is provided in micron.
dm 2: assume ia stroke=2 um is provided in micron.
Focus blending is not implemented yet for integrated tomography
parms->sim.mffocus is reset to 0
There are 1 valid simulation seeds:  1
Output PSF for 1 directions
Used 449 of 456 supplied keys
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_flate" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_flatv" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_psx" is not recognized, value is [0 0 0 0]
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_psy" is not recognized, value is [0 0 0 0]
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_pupelong" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_raw" is not recognized, value is 0
[00;00m[0;36mWarning(readcfg.c:158): key "dbg.pwfs_side" is not recognized, value is 4
[00;00mAperture[00;00m is 11 m with sampling 1/128 m
[00;00mTurbulence at 30 degree zenith angle:[00;00m r0=0.128424m, L0=30m, 14 layers.
    Greenwood freq is 25.1Hz, anisoplanatic angle is 1.58 as
    Sampled 8192x8192 at 1/128m. wind dir is randomized.
    layer 0: ht=      0 m, wt= 0.302, ws=  4.8 m/s
    layer 1: ht=     17 m, wt= 0.154, ws=  5.0 m/s
    layer 2: ht=     35 m, wt= 0.041, ws=  5.4 m/s
    layer 3: ht=     52 m, wt= 0.002, ws=  6.6 m/s
    layer 4: ht=    139 m, wt= 0.021, ws=  6.1 m/s
    layer 5: ht=    231 m, wt= 0.010, ws=  6.1 m/s
    layer 6: ht=    323 m, wt= 0.008, ws=  6.1 m/s
    layer 7: ht=    416 m, wt= 0.005, ws=  6.1 m/s
    layer 8: ht=    508 m, wt= 0.001, ws=  6.1 m/s
    layer 9: ht=    932 m, wt= 0.107, ws=  5.6 m/s
    layer 10: ht=   5022 m, wt= 0.144, ws= 11.1 m/s
    layer 11: ht=   9238 m, wt= 0.093, ws= 19.1 m/s
    layer 12: ht=  13856 m, wt= 0.075, ws=  8.2 m/s
    layer 13: ht=  22518 m, wt= 0.036, ws=  4.8 m/s
[00;00mReconstruction[00;00m: r0=0.128424m L0=30m. 14 layers. use cone coordinate.
    layer 0: ht=      0 m, wt= 0.302
    layer 1: ht=     17 m, wt= 0.154
    layer 2: ht=     35 m, wt= 0.041
    layer 3: ht=     52 m, wt= 0.002
    layer 4: ht=    139 m, wt= 0.021
    layer 5: ht=    231 m, wt= 0.010
    layer 6: ht=    323 m, wt= 0.008
    layer 7: ht=    416 m, wt= 0.005
    layer 8: ht=    508 m, wt= 0.001
    layer 9: ht=    932 m, wt= 0.107
    layer 10: ht=   5022 m, wt= 0.144
    layer 11: ht=   9238 m, wt= 0.093
    layer 12: ht=  13856 m, wt= 0.075
    layer 13: ht=  22518 m, wt= 0.036
[00;00mThere are 3 powfs[00;00m
  powfs0: Order 48, LGS at 99.1 km. Sampling 1/128.755 m. Thres 30%. [00;00mT/T is removed in right hand side in tomography.[00;00m
    CCD image is 25x25 @ 500x500 mas, blur 27% (sigma), 1500Hz, wvl: [ 5.89e-07]
    Gtilt in reconstruction. Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
  powfs1: Order  2, NGS at inf km. Sampling 1/16 m. Thres 30%. 
    Ztilt in reconstruction. Geomtric optics start at 2 with ztilt [00;00m(noisy)[00;00m
  powfs2: Order 20, NGS at inf km. Sampling 1/31.9716 m. Thres 50%. 
    CCD image is 4x4 @ 1500x1500 mas, blur 0% (sigma), 0.015Hz, wvl: [ 7.2e-07]
    Gtilt in reconstruction. Geomtric optics start at 50 with gtilt Physical optics start at 0 with [00;00m'matched filter'[00;00m [00;00m(noisy)[00;00m
[00;00mThere are 13 wfs[00;00m
    wfs 0: type 0, at (  30.00,    0.00) arcsec,  99 km, siglev is 65.0948 bkgrnd is 0.1
    wfs 1: type 0, at (  22.98,   19.28) arcsec,  99 km, siglev is 65.0948 bkgrnd is 0.1
Step  1319: OL  773.6  205.9  OA  101.4  19.3 CL  101.4  19.3 nm  0.069 s
    wfs 2: type 0, at (   5.21,   29.54) arcsec,  99 km, siglev is 65.0948 bkgrnd is 0.1
    wfs 3: type 0, at ( -15.00,   25.98) arcsec,  99 km, siglev is 65.0948 bkgrnd is 0.1
    wfs 4: type 0, at ( -28.19,   10.26) arcsec,  99 km, siglev is 65.0948 bkgrnd is 0.1
    wfs 5: type 0, at ( -28.19,  -10.26) arcsec,  99 km, siglev is 65.0948 bkgrnd is 0.1
    wfs 6: type 0, at ( -15.00,  -25.98) arcsec,  99 km, siglev is 65.0948 bkgrnd is 0.1
    wfs 7: type 0, at (   5.21,  -29.54) arcsec,  99 km, siglev is 65.0948 bkgrnd is 0.1
    wfs 8: type 0, at (  22.98,  -19.28) arcsec,  99 km, siglev is 65.0948 bkgrnd is 0.1
    wfs 9: type 1, at (   5.00,    8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 10: type 1, at ( -10.00,    0.00) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 11: type 1, at (   5.00,   -8.66) arcsec, inf km, siglev is 42387.6 bkgrnd is 1.056
    wfs 12: type 2, at (   0.00,    0.00) arcsec, inf km, siglev is 4.1558e+06 bkgrnd is 0.001
[00;00mThere are 3 DMs[00;00m
  DM 0 at -0.1km, actuator pitch 0.233m, offset   0, with 30.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 1 at    6km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
  DM 2 at   10km, actuator pitch 0.168m, offset   0, with 7.000000 micron stroke.
    Normalized cubic influence function with inter-actuator coupling of 0.223
[00;00mTomography[00;00m is using CG, with [00;00mFourer Domain[00;00m preconditioner, [00;00m12[00;00m iterations, integrated tomo.
[00;00mDM Fitting [00;00mis using CG, with [00;00mNo[00;00m preconditioner, [00;00m10[00;00m iterations
[00;00mThere are 9 fit directions[00;00m
    Fit 0: weight is 0.444, at (   0.00,    0.00) arcsec
    Fit 1: weight is 0.111, at (  15.00,    0.00) arcsec
    Fit 2: weight is 0.111, at (   0.00,   15.00) arcsec
    Fit 3: weight is 0.111, at ( -15.00,    0.00) arcsec
    Fit 4: weight is 0.111, at (   0.00,  -15.00) arcsec
    Fit 5: weight is 0.028, at (  15.00,   15.00) arcsec
    Fit 6: weight is 0.028, at ( -15.00,   15.00) arcsec
    Fit 7: weight is 0.028, at ( -15.00,  -15.00) arcsec
    Fit 8: weight is 0.028, at (  15.00,  -15.00) arcsec
[00;00mThere are 1 evaluation directions[00;00m at sampling 1/128 m.
    Evl 0: weight is 1.000, at (   0.00,    0.00) arcsec
[00;00mSimulation[00;00m start at step 0, end at step 1600, with time step 1/1500s, [00;00mclose loop[00;00m.
After setup_parms:	120.6 MiB.
[00;00m[0;36mWarning(sock.c:516): connect locally (/global/homes/b/bpeck/.aos/tmp/nid003544/scheduler) failed: Invalid argument. 
CUDA: minimum memory requirement is 0.4GB
GPU 0 is NVIDIA A100-SXM4-40GB with arch 8.0, 38.9GB free, 39.3GB total device memory.
Using GPU 0
Use 1 GPUs for WFS Tomo Fit Evl

*** Preparation started at 2025/02/12 00:43:48 in nid003544. ***

Using OpenMP version 201511 with 128 threads
Reading aperture amplitude map from KECK.fits
Step  1168: OL  732.8  174.8  OA  127.6  10.8 CL  127.6  10.8 nm  0.066 s
[00;00m>>>>>>>>>>>>>>>>[0;36mWarning(bin.c:410): evlpsfdl.fits: Unknown error
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 2880 bytes to evlpsfdl.fits failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 2880 bytes to evlpsfdl.fits failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 2880 bytes to evlpsfdl.fits failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 2880 bytes to evlpsfdl.fits failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 2880 bytes to evlpsfdl.fits failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 2880 bytes to evlpsfdl.fits failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 2880 bytes to evlpsfdl.fits failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 2880 bytes to evlpsfdl.fits failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 2880 bytes to evlpsfdl.fits failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 2880 bytes to evlpsfdl.fits failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 2880 bytes to evlpsfdl.fits failed
[00;00mzfwrite_do: Disk quota exceeded
[0;36mWarning(bin.c:516): write 2880 bytes to 